problem_id,description,name,tag,difficulty,try_count,accepted_count
0,"
Score : 200 points


Problem StatementAn integer N is a multiple of 9 if and only if the sum of the digits in the decimal representation of N is a multiple of 9.
Determine whether N is a multiple of 9.




Constraints
0 \leq N < 10^{200000}
N is an integer.







InputInput is given from Standard Input in the following format:
N





OutputIf N is a multiple of 9, print Yes; otherwise, print No.






Sample Input 1123456789





Sample Output 1Yes

The sum of these digits is 1+2+3+4+5+6+7+8+9=45, which is a multiple of 9, so 123456789 is a multiple of 9.





Sample Input 20





Sample Output 2Yes






Sample Input 331415926535897932384626433832795028841971693993751058209749445923078164062862089986280





Sample Output 3No


",Multiple of 9,"String, Bruteforcing, Implementation, Arithmetic",0.729,774,480
1,"
Score : 300 points


Problem StatementN persons are standing in a row. The height of the i-th person from the front is A_i.
We want to have each person stand on a stool of some heights - at least zero - so that the following condition is satisfied for every person:
Condition: Nobody in front of the person is taller than the person. Here, the height of a person includes the stool.
Find the minimum total height of the stools needed to meet this goal.




Constraints
1 \leq N \leq 2\times 10^5
1 \leq A_i \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
A_1 \ldots A_N





OutputPrint the minimum total height of the stools needed to meet the goal.






Sample Input 15
2 1 5 4 3





Sample Output 14

If the persons stand on stools of heights 0, 1, 0, 1, and 2, respectively, their heights will be 2, 2, 5, 5, and 5, satisfying the condition.
We cannot meet the goal with a smaller total height of the stools.





Sample Input 25
3 3 3 3 3





Sample Output 20

Giving a stool of height 0 to everyone will work.

",Step,"Greedy Algorithm, Implementation, Array, Arithmetic",0.525,856,435
2,"
Score : 400 points


Problem StatementA maze is composed of a grid of H \times W squares - H vertical, W horizontal.
The square at the i-th row from the top and the j-th column from the left - (i,j) - is a wall if S_{ij} is # and a road if S_{ij} is ..
There is a magician in (C_h,C_w). He can do the following two kinds of moves:

Move A: Walk to a road square that is vertically or horizontally adjacent to the square he is currently in.
Move B: Use magic to warp himself to a road square in the 5\times 5 area centered at the square he is currently in.

In either case, he cannot go out of the maze.
At least how many times does he need to use the magic to reach (D_h, D_w)?




Constraints
1 \leq H,W \leq 10^3
1 \leq C_h,D_h \leq H
1 \leq C_w,D_w \leq W
S_{ij} is # or ..
S_{C_h C_w} and S_{D_h D_w} are ..
(C_h,C_w) \neq (D_h,D_w)







InputInput is given from Standard Input in the following format:
H W
C_h C_w
D_h D_w
S_{11}\ldots S_{1W}
\vdots
S_{H1}\ldots S_{HW}





OutputPrint the minimum number of times the magician needs to use the magic. If he cannot reach (D_h,D_w), print -1 instead.






Sample Input 14 4
1 1
4 4
..#.
..#.
.#..
.#..





Sample Output 11

For example, by walking to (2,2) and then using the magic to travel to (4,4), just one use of magic is enough.
Note that he cannot walk diagonally.





Sample Input 24 4
1 4
4 1
.##.
####
####
.##.





Sample Output 2-1

He cannot move from there.





Sample Input 34 4
2 2
3 3
....
....
....
....





Sample Output 30

No use of magic is needed.





Sample Input 44 5
1 2
2 5
#.###
####.
#..##
#..##





Sample Output 42


",Wizard in Maze,"Graph Theory, Breadth-first Search, Breadth-first Search, Graph Traversal, Array, Deque",0.335,587,169
3,"
Score : 300 points


Problem StatementThere are N squares arranged in a row from left to right.
The height of the i-th square from the left is H_i.
You will land on a square of your choice, then repeat moving to the adjacent square on the right as long as the height of the next square is not greater than that of the current square.
Find the maximum number of times you can move.




Constraints
All values in input are integers.
1 \leq N \leq 10^5
1 \leq H_i \leq 10^9







InputInput is given from Standard Input in the following format:
N
H_1 H_2 ... H_N





OutputPrint the maximum number of times you can move.






Sample Input 15
10 4 8 7 3





Sample Output 12

By landing on the third square from the left, you can move to the right twice.





Sample Input 27
4 4 5 6 6 5 5





Sample Output 23

By landing on the fourth square from the left, you can move to the right three times.





Sample Input 34
1 2 3 4





Sample Output 30


",Lower,"Bruteforcing, Greedy Algorithm, Sliding Window, Boolean Operations On Geometric Objects",0.608,504,249
4,"
Score : 100 points


Problem StatementTakahashi is meeting up with Aoki.
They have planned to meet at a place that is D meters away from Takahashi's house in T minutes from now.
Takahashi will leave his house now and go straight to the place at a speed of S meters per minute.
Will he arrive in time?




Constraints
1 \leq D \leq 10000
1 \leq T \leq 10000
1 \leq S \leq 10000
All values in input are integers.







InputInput is given from Standard Input in the following format:
D T S





OutputIf Takahashi will reach the place in time, print Yes; otherwise, print No.






Sample Input 11000 15 80





Sample Output 1Yes

It takes 12.5 minutes to go 1000 meters to the place at a speed of 80 meters per minute. They have planned to meet in 15 minutes so he will arrive in time.





Sample Input 22000 20 100





Sample Output 2Yes

It takes 20 minutes to go 2000 meters to the place at a speed of 100 meters per minute. They have planned to meet in 20 minutes so he will arrive just on time.





Sample Input 310000 1 1





Sample Output 3No

He will be late.

",Don't be late,"Arithmetic, Implementation",0.607,1005,514
5,"
Score : 200 points


Problem StatementGiven are two strings S and T.
Let us change some of the characters in S so that T will be a substring of S.
At least how many characters do we need to change?
Here, a substring is a consecutive subsequence. For example, xxx is a substring of yxxxy, but not a substring of xxyxx.




Constraints
The lengths of S and T are each at least 1 and at most 1000.
The length of T is at most that of S.
S and T consist of lowercase English letters.







InputInput is given from Standard Input in the following format:
S
T





OutputPrint the minimum number of characters in S that need to be changed.






Sample Input 1cabacc
abc





Sample Output 11

For example, changing the fourth character a in S to c will match the second through fourth characters in S to T.
Since S itself does not have T as its substring, this number of changes - one - is the minimum needed.





Sample Input 2codeforces
atcoder





Sample Output 26


",Substring,"Sliding Window, String, Counting, Mathematics",0.507,794,400
6,"
Score : 300 points


Problem StatementYou have a pot and N ingredients. Each ingredient has a real number parameter called value, and the value of the i-th ingredient (1 \leq i \leq N) is v_i.
When you put two ingredients in the pot, they will vanish and result in the formation of a new ingredient. The value of the new ingredient will be (x + y) / 2 where x and y are the values of the ingredients consumed, and you can put this ingredient again in the pot.
After you compose ingredients in this way N-1 times, you will end up with one ingredient. Find the maximum possible value of this ingredient.




Constraints
2 \leq N \leq 50
1 \leq v_i \leq 1000
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
v_1 v_2 \ldots v_N





OutputPrint a decimal number (or an integer) representing the maximum possible value of the last ingredient remaining.
Your output will be judged correct when its absolute or relative error from the judge's output is at most 10^{-5}.






Sample Input 12
3 4





Sample Output 13.5

If you start with two ingredients, the only choice is to put both of them in the pot. The value of the ingredient resulting from the ingredients of values 3 and 4 is (3 + 4) / 2 = 3.5.
Printing 3.50001, 3.49999, and so on will also be accepted.





Sample Input 23
500 300 200





Sample Output 2375

You start with three ingredients this time, and you can choose what to use in the first composition. There are three possible choices:

Use the ingredients of values 500 and 300 to produce an ingredient of value (500 + 300) / 2 = 400. The next composition will use this ingredient and the ingredient of value 200, resulting in an ingredient of value (400 + 200) / 2 = 300.
Use the ingredients of values 500 and 200 to produce an ingredient of value (500 + 200) / 2 = 350. The next composition will use this ingredient and the ingredient of value 300, resulting in an ingredient of value (350 + 300) / 2 = 325.
Use the ingredients of values 300 and 200 to produce an ingredient of value (300 + 200) / 2 = 250. The next composition will use this ingredient and the ingredient of value 500, resulting in an ingredient of value (250 + 500) / 2 = 375.

Thus, the maximum possible value of the last ingredient remaining is 375.
Printing 375.0 and so on will also be accepted.





Sample Input 35
138 138 138 138 138





Sample Output 3138


",Alchemist,"Sorting, Greedy Algorithm, Recursion, Arithmetic",0.726,397,267
7,"
Score : 300 points


Problem StatementGiven are N integers A_1,\ldots,A_N.
Find the sum of A_i \times A_j over all pairs (i,j) such that 1\leq i < j \leq N, modulo (10^9+7).




Constraints
2 \leq N \leq 2\times 10^5
0 \leq A_i \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
A_1 \ldots A_N





OutputPrint \sum_{i=1}^{N-1}\sum_{j=i+1}^{N} A_i A_j, modulo (10^9+7).






Sample Input 13
1 2 3





Sample Output 111

We have 1 \times 2 + 1 \times 3 + 2 \times 3 = 11.





Sample Input 24
141421356 17320508 22360679 244949





Sample Output 2437235829


",Sum of product of pairs,"Arithmetic, Mathematics, Prefix sum, Array",0.234,1251,329
8,"
Score : 400 points


Problem StatementThere are N persons called Person 1 through Person N.
You are given M facts that ""Person A_i and Person B_i are friends."" The same fact may be given multiple times.
If X and Y are friends, and Y and Z are friends, then X and Z are also friends. There is no friendship that cannot be derived from the M given facts.
Takahashi the evil wants to divide the N persons into some number of groups so that every person has no friend in his/her group.
At least how many groups does he need to make?




Constraints
2 \leq N \leq 2\times 10^5
0 \leq M \leq 2\times 10^5
1\leq A_i,B_i\leq N
A_i \neq B_i







InputInput is given from Standard Input in the following format:
N M
A_1 B_1
\vdots
A_M B_M





OutputPrint the answer.






Sample Input 15 3
1 2
3 4
5 1





Sample Output 13

Dividing them into three groups such as \{1,3\}, \{2,4\}, and \{5\} achieves the goal.





Sample Input 24 10
1 2
2 1
1 2
2 1
1 2
1 3
1 4
2 3
2 4
3 4





Sample Output 24






Sample Input 310 4
3 1
4 1
5 9
2 6





Sample Output 33


",Friends,"Graph Theory, Depth-first Search, Disjoint Set, Counting, Mathematics",0.59,512,219
9,"
Score : 300 points


Problem StatementThere is an integer sequence A of length N whose values are unknown.
Given is an integer sequence B of length N-1 which is known to satisfy the following:
 B_i \geq \max(A_i, A_{i+1}) 
Find the maximum possible sum of the elements of A.




Constraints
All values in input are integers.
2 \leq N \leq 100
0 \leq B_i \leq 10^5







InputInput is given from Standard Input in the following format:
N
B_1 B_2 ... B_{N-1}





OutputPrint the maximum possible sum of the elements of A.






Sample Input 13
2 5





Sample Output 19

A can be, for example, ( 2 , 1 , 5 ), ( -1 , -2 , -3 ), or ( 2 , 2 , 5 ). Among those candidates, A = ( 2 , 2 , 5 ) has the maximum possible sum.





Sample Input 22
3





Sample Output 26






Sample Input 36
0 153 10 10 23





Sample Output 353


",Maximal Value,"Greedy Algorithm, Array, Bruteforcing, Dynamic Programming",0.824,297,221
10,"
Score: 300 points


Problem Statement
Takahashi has decided to hold fastest-finger-fast quiz games. Kizahashi, who is in charge of making the scoreboard, is struggling to write the program that manages the players' scores in a game, which proceeds as follows.
A game is played by N players, numbered 1 to N. At the beginning of a game, each player has K points.
When a player correctly answers a question, each of the other N-1 players receives minus one (-1) point. There is no other factor that affects the players' scores.
At the end of a game, the players with 0 points or lower are eliminated, and the remaining players survive.
In the last game, the players gave a total of Q correct answers, the i-th of which was given by Player A_i.
For Kizahashi, write a program that determines whether each of the N players survived this game.




Constraints

All values in input are integers.
2 \leq N \leq 10^5
1 \leq K \leq 10^9
1 \leq Q \leq 10^5
1 \leq A_i \leq N\ (1 \leq i \leq Q)







Input
Input is given from Standard Input in the following format:
N K Q
A_1
A_2
.
.
.
A_Q





Output
Print N lines. The i-th line should contain Yes if Player i survived the game, and No otherwise.






Sample Input 16 3 4
3
1
3
2





Sample Output 1No
No
Yes
No
No
No

In the beginning, the players' scores are (3, 3, 3, 3, 3, 3).

Player 3 correctly answers a question. The players' scores are now (2, 2, 3, 2, 2, 2).
Player 1 correctly answers a question. The players' scores are now (2, 1, 2, 1, 1, 1).
Player 3 correctly answers a question. The players' scores are now (1, 0, 2, 0, 0, 0).
Player 2 correctly answers a question. The players' scores are now (0, 0, 1, -1, -1, -1).

Players 1, 2, 4, 5 and 6, who have 0 points or lower, are eliminated, and Player 3 survives this game.





Sample Input 26 5 4
3
1
3
2





Sample Output 2Yes
Yes
Yes
Yes
Yes
Yes






Sample Input 310 13 15
3
1
4
1
5
9
2
6
5
3
5
8
9
7
9





Sample Output 3No
No
No
No
Yes
No
No
No
Yes
No


",Attack Survival,"Counting, Array, Bruteforcing, Implementation",0.59,412,232
11,"
Score : 300 points


Problem Statement
Takahashi is a teacher responsible for a class of N students.
The students are given distinct student numbers from 1 to N.
Today, all the students entered the classroom at different times.
According to Takahashi's record, there were A_i students in the classroom when student number i entered the classroom (including student number i).
From these records, reconstruct the order in which the students entered the classroom.




Constraints

 1 \le N \le 10^5 
 1 \le A_i \le N 
 A_i \neq A_j  (i \neq j)
All values in input are integers.







Input
Input is given from Standard Input in the following format:
N
A_1 A_2 \ldots A_N





Output
Print the student numbers of the students in the order the students entered the classroom.






Sample Input 13
2 3 1





Sample Output 13 1 2

First, student number 3 entered the classroom.
Then, student number 1 entered the classroom.
Finally, student number 2 entered the classroom.





Sample Input 25
1 2 3 4 5





Sample Output 21 2 3 4 5






Sample Input 38
8 2 7 3 4 5 6 1





Sample Output 38 2 4 5 6 7 3 1


",Go to School,"Array, Sorting, Set / Map, Hashing, Mathematics",0.673,471,274
12,"
Score : 300 points


Problem StatementThere are N slimes lining up from left to right. The colors of these slimes will be given as a string S of length N consisting of lowercase English letters. The i-th slime from the left has the color that corresponds to the i-th character of S.
Adjacent slimes with the same color will fuse into one larger slime without changing the color. If there were a slime adjacent to this group of slimes before fusion, that slime is now adjacent to the new larger slime.
Ultimately, how many slimes will be there?




Constraints
1 \leq N \leq 10^5
|S| = N
S consists of lowercase English letters.







InputInput is given from Standard Input in the following format:
N
S





OutputPrint the final number of slimes.






Sample Input 110
aabbbbaaca





Sample Output 15

Ultimately, these slimes will fuse into abaca.





Sample Input 25
aaaaa





Sample Output 21

All the slimes will fuse into one.





Sample Input 320
xxzaffeeeeddfkkkkllq





Sample Output 310


",Slimes,"Bruteforcing, String, Counting",0.873,321,257
13,"
Score : 300 points


Problem StatementTakahashi is standing on a multiplication table with infinitely many rows and columns.
The square (i,j) contains the integer i \times j. Initially, Takahashi is standing at (1,1).
In one move, he can move from (i,j) to either (i+1,j) or (i,j+1).
Given an integer N, find the minimum number of moves needed to reach a square that contains N.




Constraints
2 \leq N \leq 10^{12}
N is an integer.







InputInput is given from Standard Input in the following format:
N





OutputPrint the minimum number of moves needed to reach a square that contains the integer N.






Sample Input 110





Sample Output 15

(2,5) can be reached in five moves. We cannot reach a square that contains 10 in less than five moves.





Sample Input 250





Sample Output 213

(5, 10) can be reached in 13 moves.





Sample Input 310000000019





Sample Output 310000000018

Both input and output may be enormous.

",Walk on Multiplication Table,"Bruteforcing, Prime Factorization, Mathematics, Arithmetic",0.473,487,192
14,"
Score : 300 points


Problem StatementThere are N towns in a coordinate plane. Town i is located at coordinates (x_i, y_i). The distance between Town i and Town j is \sqrt{\left(x_i-x_j\right)^2+\left(y_i-y_j\right)^2}.
There are N! possible paths to visit all of these towns once. Let the length of a path be the distance covered when we start at the first town in the path, visit the second, third, \dots, towns, and arrive at the last town (assume that we travel in a straight line from a town to another). Compute the average length of these N! paths.




Constraints
2 \leq N \leq 8
-1000 \leq x_i \leq 1000
-1000 \leq y_i \leq 1000
\left(x_i, y_i\right) \neq \left(x_j, y_j\right) (if i \neq j)
(Added 21:12 JST) All values in input are integers.







InputInput is given from Standard Input in the following format:
N
x_1 y_1
:
x_N y_N





OutputPrint the average length of the paths.
Your output will be judges as correct when the absolute difference from the judge's output is at most 10^{-6}.






Sample Input 13
0 0
1 0
0 1





Sample Output 12.2761423749

There are six paths to visit the towns: 1 → 2 → 3, 1 → 3 → 2, 2 → 1 → 3, 2 → 3 → 1, 3 → 1 → 2, and 3 → 2 → 1.
The length of the path 1 → 2 → 3 is \sqrt{\left(0-1\right)^2+\left(0-0\right)^2} + \sqrt{\left(1-0\right)^2+\left(0-1\right)^2} = 1+\sqrt{2}.
By calculating the lengths of the other paths in this way, we see that the average length of all routes is:
\frac{\left(1+\sqrt{2}\right)+\left(1+\sqrt{2}\right)+\left(2\right)+\left(1+\sqrt{2}\right)+\left(2\right)+\left(1+\sqrt{2}\right)}{6} = 2.276142...





Sample Input 22
-879 981
-866 890





Sample Output 291.9238815543

There are two paths to visit the towns: 1 → 2 and 2 → 1. These paths have the same length.





Sample Input 38
-406 10
512 859
494 362
-955 -475
128 553
-986 -885
763 77
449 310





Sample Output 37641.9817824387


",Average Length,"Backtracking, Mathematics, Bruteforcing, Arithmetic",0.784,214,168
15,"
Score : 300 points


Problem StatementFennec is fighting with N monsters.
The health of the i-th monster is H_i.
Fennec can do the following two actions:

Attack: Fennec chooses one monster. That monster's health will decrease by 1.
Special Move: Fennec chooses one monster. That monster's health will become 0.

There is no way other than Attack and Special Move to decrease the monsters' health.
Fennec wins when all the monsters' healths become 0 or below.
Find the minimum number of times Fennec needs to do Attack (not counting Special Move) before winning when she can use Special Move at most K times.




Constraints
1 \leq N \leq 2 \times 10^5
0 \leq K \leq 2 \times 10^5
1 \leq H_i \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N K
H_1 ... H_N





OutputPrint the minimum number of times Fennec needs to do Attack (not counting Special Move) before winning.






Sample Input 13 1
4 1 5





Sample Output 15

By using Special Move on the third monster, and doing Attack four times on the first monster and once on the second monster, Fennec can win with five Attacks.





Sample Input 28 9
7 9 3 2 3 8 4 6





Sample Output 20

She can use Special Move on all the monsters.





Sample Input 33 0
1000000000 1000000000 1000000000





Sample Output 33000000000

Watch out for overflow.

",Fennec vs Monster,"Sorting, Greedy Algorithm, Arithmetic, Array",0.695,494,272
16,"
Score: 300 points


Problem Statement
Find the minimum prime number greater than or equal to X.




Notes
A prime number is an integer greater than 1 that cannot be evenly divided by any positive integer except 1 and itself.
For example, 2, 3, and 5 are prime numbers, while 4 and 6 are not.




Constraints

 2 \le X \le 10^5 
All values in input are integers.







Input
Input is given from Standard Input in the following format:
X





Output
Print the minimum prime number greater than or equal to X.






Sample Input 120





Sample Output 123

The minimum prime number greater than or equal to 20 is 23.





Sample Input 22





Sample Output 22

X itself can be a prime number.





Sample Input 399992





Sample Output 3100003


",Next Prime,"Bruteforcing, Number Theory, Mathematics",0.729,276,186
17,"
Score : 300 points


Problem StatementTakahashi participated in a contest on AtCoder.
The contest had N problems.
Takahashi made M submissions during the contest.
The i-th submission was made for the p_i-th problem and received the verdict S_i (AC or WA).
The number of Takahashi's correct answers is the number of problems on which he received an AC once or more.
The number of Takahashi's penalties is the sum of the following count for the problems on which he received an AC once or more: the number of WAs received before receiving an AC for the first time on that problem.
Find the numbers of Takahashi's correct answers and penalties.




Constraints
N, M, and p_i are integers.
1 \leq N \leq 10^5
0 \leq M \leq 10^5
1 \leq p_i \leq N
S_i is AC or WA.







InputInput is given from Standard Input in the following format:
N M
p_1 S_1
:
p_M S_M





OutputPrint the number of Takahashi's correct answers and the number of Takahashi's penalties.






Sample Input 12 5
1 WA
1 AC
2 WA
2 AC
2 WA





Sample Output 12 2

In his second submission, he received an AC on the first problem for the first time. Before this, he received one WA on this problem.
In his fourth submission, he received an AC on the second problem for the first time. Before this, he received one WA on this problem.
Thus, he has two correct answers and two penalties.





Sample Input 2100000 3
7777 AC
7777 AC
7777 AC





Sample Output 21 0

Note that it is pointless to get an AC more than once on the same problem.





Sample Input 36 0





Sample Output 30 0


",Welcome to AtCoder,"Array, Bruteforcing, Boolean Operations On Geometric Objects, Counting",0.208,599,176
18,"
Score : 300 points


Problem StatementFind the price of a product before tax such that, when the consumption tax rate is 8 percent and 10 percent, the amount of consumption tax levied on it is A yen and B yen, respectively. (Yen is the currency of Japan.)
Here, the price before tax must be a positive integer, and the amount of consumption tax is rounded down to the nearest integer.
If multiple prices satisfy the condition, print the lowest such price; if no price satisfies the condition, print -1.




Constraints
1 \leq A \leq B \leq 100
A and B are integers.







InputInput is given from Standard Input in the following format:
A B





OutputIf there is a price that satisfies the condition, print an integer representing the lowest such price; otherwise, print -1.






Sample Input 12 2





Sample Output 125

If the price of a product before tax is 25 yen, the amount of consumption tax levied on it is:

When the consumption tax rate is 8 percent: \lfloor 25 \times 0.08 \rfloor = \lfloor 2 \rfloor = 2 yen.
When the consumption tax rate is 10 percent: \lfloor 25 \times 0.1 \rfloor = \lfloor 2.5 \rfloor = 2 yen.

Thus, the price of 25 yen satisfies the condition. There are other possible prices, such as 26 yen, but print the minimum such price, 25.





Sample Input 28 10





Sample Output 2100

If the price of a product before tax is 100 yen, the amount of consumption tax levied on it is:

When the consumption tax rate is 8 percent: \lfloor 100 \times 0.08 \rfloor = 8 yen.
When the consumption tax rate is 10 percent: \lfloor 100 \times 0.1 \rfloor = 10 yen.






Sample Input 319 99





Sample Output 3-1

There is no price before tax satisfying this condition, so print -1.

",Tax Increase,"Bruteforcing, Mathematics, Heuristics",0.496,553,232
19,"
Score : 300 points


Problem StatementIf there is an integer not less than 0 satisfying the following conditions, print the smallest such integer; otherwise, print -1.

The integer has exactly N digits in base ten. (We assume 0 to be a 1-digit integer. For other integers, leading zeros are not allowed.)
The s_i-th digit from the left is c_i. \left(i = 1, 2, \cdots, M\right)





Constraints
All values in input are integers.
1 \leq N \leq 3
0 \leq M \leq 5
1 \leq s_i \leq N
0 \leq c_i \leq 9







InputInput is given from Standard Input in the following format:
N M
s_1 c_1
\vdots
s_M c_M





OutputPrint the answer.






Sample Input 13 3
1 7
3 2
1 7





Sample Output 1702

702 satisfies the conditions - its 1-st and 3-rd digits are 7 and 2, respectively - while no non-negative integer less than 702 satisfies them.





Sample Input 23 2
2 1
2 3





Sample Output 2-1






Sample Input 33 1
1 0





Sample Output 3-1


",Guess The Number,"Backtracking, Graph Theory, Greedy Algorithm, Array, Boolean Operations On Geometric Objects",0.121,904,153
20,"
Score: 200 points


Problem Statement
You are an immigration officer in the Kingdom of AtCoder. The document carried by an immigrant has some number of integers written on it, and you need to check whether they meet certain criteria.
According to the regulation, the immigrant should be allowed entry to the kingdom if and only if the following condition is satisfied:

All even numbers written on the document are divisible by 3 or 5.

If the immigrant should be allowed entry according to the regulation, output APPROVED; otherwise, print DENIED.




Notes

The condition in the statement can be rephrased as ""If x is an even number written on the document, x is divisible by 3 or 5"".
Here ""if"" and ""or"" are logical terms.





Constraints

All values in input are integers.
1 \leq N \leq 100
1 \leq A_i \leq 1000







Input
Input is given from Standard Input in the following format:
N
A_1 A_2 \dots A_N





Output
If the immigrant should be allowed entry according to the regulation, print APPROVED; otherwise, print DENIED.






Sample Input 15
6 7 9 10 31





Sample Output 1APPROVED

The even numbers written on the document are 6 and 10.
All of them are divisible by 3 or 5, so the immigrant should be allowed entry.





Sample Input 23
28 27 24





Sample Output 2DENIED

28 violates the condition, so the immigrant should not be allowed entry.

",Papers  Please,"Bruteforcing, Implementation, Boolean Operations On Geometric Objects",0.758,425,257
21,"
Score : 200 points


Problem StatementRaccoon is fighting with a monster.
The health of the monster is H.
Raccoon can use N kinds of special moves. Using the i-th move decreases the monster's health by A_i.
There is no other way to decrease the monster's health.
Raccoon wins when the monster's health becomes 0 or below.
If Raccoon can win without using the same move twice or more, print Yes; otherwise, print No.




Constraints
1 \leq H \leq 10^9
1 \leq N \leq 10^5
1 \leq A_i \leq 10^4
All values in input are integers.







InputInput is given from Standard Input in the following format:
H N
A_1 A_2 ... A_N





OutputIf Raccoon can win without using the same move twice or more, print Yes; otherwise, print No.






Sample Input 110 3
4 5 6





Sample Output 1Yes

The monster's health will become 0 or below after, for example, using the second and third moves.





Sample Input 220 3
4 5 6





Sample Output 2No






Sample Input 3210 5
31 41 59 26 53





Sample Output 3Yes






Sample Input 4211 5
31 41 59 26 53





Sample Output 4No


",Common Raccoon vs Monster,"Arithmetic, Implementation, Bruteforcing",0.799,416,283
22,"
Score : 200 points


Problem StatementTakahashi has many red balls and blue balls. Now, he will place them in a row.
Initially, there is no ball placed.
Takahashi, who is very patient, will do the following operation 10^{100} times:

Place A blue balls at the end of the row of balls already placed. Then, place B red balls at the end of the row.

How many blue balls will be there among the first N balls in the row of balls made this way?




Constraints
1 \leq N \leq 10^{18}
A, B \geq 0
0 < A + B \leq 10^{18}
All values in input are integers.







InputInput is given from Standard Input in the following format:
N A B





OutputPrint the number of blue balls that will be there among the first N balls in the row of balls.






Sample Input 18 3 4





Sample Output 14

Let b denote a blue ball, and r denote a red ball. The first eight balls in the row will be bbbrrrrb, among which there are four blue balls.





Sample Input 28 0 4





Sample Output 20

He placed only red balls from the beginning.





Sample Input 36 2 4





Sample Output 32

Among bbrrrr, there are two blue balls.

",Count Balls,"Arithmetic, Counting",0.279,904,258
23,"
Score : 200 points


Problem StatementWe have a bingo card with a 3\times3 grid. The square at the i-th row from the top and the j-th column from the left contains the number A_{i, j}.
The MC will choose N numbers, b_1, b_2, \cdots, b_N. If our bingo sheet contains some of those numbers, we will mark them on our sheet.
Determine whether we will have a bingo when the N numbers are chosen, that is, the sheet will contain three marked numbers in a row, column, or diagonal.




Constraints
All values in input are integers.
1 \leq A_{i, j} \leq 100
A_{i_1, j_1} \neq A_{i_2, j_2} ((i_1, j_1) \neq (i_2, j_2))
1 \leq N \leq 10
1 \leq b_i \leq 100
b_i \neq b_j (i \neq j)







InputInput is given from Standard Input in the following format:
A_{1, 1} A_{1, 2} A_{1, 3}
A_{2, 1} A_{2, 2} A_{2, 3}
A_{3, 1} A_{3, 2} A_{3, 3}
N
b_1
\vdots
b_N





OutputIf we will have a bingo, print Yes; otherwise, print No.






Sample Input 184 97 66
79 89 11
61 59 7
7
89
7
87
79
24
84
30





Sample Output 1Yes

We will mark A_{1, 1}, A_{2, 1}, A_{2, 2}, A_{3, 3}, and complete the diagonal from the top-left to the bottom-right.





Sample Input 241 7 46
26 89 2
78 92 8
5
6
45
16
57
17





Sample Output 2No

We will mark nothing.





Sample Input 360 88 34
92 41 43
65 73 48
10
60
43
88
11
48
73
65
41
92
34





Sample Output 3Yes

We will mark all the squares.

",Bingo,"Array, Bruteforcing, Implementation",0.61,496,264
24,"
Score : 200 points


Problem Statement
Takahashi loves palindromes. Non-palindromic strings are unacceptable to him. Each time he hugs a string, he can change one of its characters to any character of his choice.
Given is a string S. Find the minimum number of hugs needed to make S palindromic.




Constraints

S is a string consisting of lowercase English letters.
The length of S is between 1 and 100 (inclusive).







Input
Input is given from Standard Input in the following format:
S





Output
Print the minimum number of hugs needed to make S palindromic.






Sample Input 1redcoder





Sample Output 11

For example, we can change the fourth character to o and get a palindrome redooder.





Sample Input 2vvvvvv





Sample Output 20

We might need no hugs at all.





Sample Input 3abcdabc





Sample Output 32


",Palindrome-philia,"Two-pointer, Bruteforcing, String",0.837,358,239
25,"
Score : 200 points


Problem StatementWe have a string S consisting of uppercase English letters. Additionally, an integer N will be given.
Shift each character of S by N in alphabetical order (see below), and print the resulting string.
We assume that A follows Z. For example, shifting A by 2 results in C (A \to B \to C), and shifting Y by 3 results in B (Y \to Z \to A \to B).




Constraints
0 \leq N \leq 26
1 \leq |S| \leq 10^4
S consists of uppercase English letters.







InputInput is given from Standard Input in the following format:
N
S





OutputPrint the string resulting from shifting each character of S by N in alphabetical order.






Sample Input 12
ABCXYZ





Sample Output 1CDEZAB

Note that A follows Z.





Sample Input 20
ABCXYZ





Sample Output 2ABCXYZ






Sample Input 313
ABCDEFGHIJKLMNOPQRSTUVWXYZ





Sample Output 3NOPQRSTUVWXYZABCDEFGHIJKLM


",ROT N,"Bruteforcing, Arithmetic, String",0.819,318,230
26,"
Score : 200 points


Problem StatementGiven are a positive integer N and a string S of length N consisting of lowercase English letters.
Determine whether the string is a concatenation of two copies of some string.
That is, determine whether there is a string T such that S = T + T.




Constraints
1 \leq N \leq 100
S consists of lowercase English letters.
|S| = N







InputInput is given from Standard Input in the following format:
N
S





OutputIf S is a concatenation of two copies of some string, print Yes; otherwise, print No.






Sample Input 16
abcabc





Sample Output 1Yes

Let T =  abc, and S = T + T.





Sample Input 26
abcadc





Sample Output 2No






Sample Input 31
z





Sample Output 3No


",Echo,"String, Implementation",0.701,421,250
27,"
Score : 200 points


Problem StatementHaving learned the multiplication table, Takahashi can multiply two integers between 1 and 9 (inclusive) together.
Given an integer N, determine whether N can be represented as the product of two integers between 1 and 9. If it can, print Yes; if it cannot, print No.




Constraints
1 \leq N \leq 100
N is an integer.







InputInput is given from Standard Input in the following format:
N





OutputIf N can be represented as the product of two integers between 1 and 9 (inclusive), print Yes; if it cannot, print No.






Sample Input 110





Sample Output 1Yes

10 can be represented as, for example, 2 \times 5.





Sample Input 250





Sample Output 2No

50 cannot be represented as the product of two integers between 1 and 9.





Sample Input 381





Sample Output 3Yes


",81,"Bruteforcing, Arithmetic, Implementation",0.719,518,335
28,"
Score : 100 points


Problem StatementFind the number of ways to choose a pair of an even number and an odd number from the positive integers between 1 and K (inclusive). The order does not matter.




Constraints
2\leq K\leq 100
K is an integer.







InputInput is given from Standard Input in the following format:
K





OutputPrint the number of ways to choose a pair of an even number and an odd number from the positive integers between 1 and K (inclusive).






Sample Input 13





Sample Output 12

Two pairs can be chosen: (2,1) and (2,3).





Sample Input 26





Sample Output 29






Sample Input 311





Sample Output 330






Sample Input 450





Sample Output 4625


",Pair,"Arithmetic, Counting, Boolean Operations On Geometric Objects",0.863,175,134
29,"
Score: 200 points


Problem StatementA country decides to build a palace.
In this country, the average temperature of a point at an elevation of x meters is T-x \times 0.006 degrees Celsius.
There are N places proposed for the place. The elevation of Place i is H_i meters.
Among them, Princess Joisino orders you to select the place whose average temperature is the closest to A degrees Celsius, and build the palace there.
Print the index of the place where the palace should be built.
It is guaranteed that the solution is unique.




Constraints
1 \leq N \leq 1000
0 \leq T \leq 50
-60 \leq A \leq T
0 \leq H_i \leq 10^5
All values in input are integers.
The solution is unique.







InputInput is given from Standard Input in the following format:
N
T A
H_1 H_2 ... H_N





OutputPrint the index of the place where the palace should be built.






Sample Input 12
12 5
1000 2000





Sample Output 11


The average temperature of Place 1 is 12-1000 \times 0.006=6 degrees Celsius.
The average temperature of Place 2 is 12-2000 \times 0.006=0 degrees Celsius.

Thus, the palace should be built at Place 1.





Sample Input 23
21 -11
81234 94124 52141





Sample Output 23


",Palace,"Bruteforcing, Arithmetic, Array",0.585,321,159
30,"
Score : 200 points


Problem StatementIt's now the season of TAKOYAKI FESTIVAL!
This year, N takoyaki (a ball-shaped food with a piece of octopus inside) will be served. The deliciousness of the i-th takoyaki is d_i.
As is commonly known, when you eat two takoyaki of deliciousness x and y together, you restore x \times y health points.
There are \frac{N \times (N - 1)}{2} ways to choose two from the N takoyaki served in the festival. For each of these choices, find the health points restored from eating the two takoyaki, then compute the sum of these \frac{N \times (N - 1)}{2} values.




Constraints
All values in input are integers.
2 \leq N \leq 50
0 \leq d_i \leq 100







InputInput is given from Standard Input in the following format:
N
d_1 d_2 ... d_N





OutputPrint the sum of the health points restored from eating two takoyaki over all possible choices of two takoyaki from the N takoyaki served.






Sample Input 13
3 1 2





Sample Output 111

There are three possible choices:

Eat the first and second takoyaki. You will restore 3 health points.
Eat the second and third takoyaki. You will restore 2 health points.
Eat the first and third takoyaki. You will restore 6 health points.

The sum of these values is 11.





Sample Input 27
5 0 7 8 3 3 2





Sample Output 2312


",TAKOYAKI FESTIVAL 2019,"Bruteforcing, Combinatorics, Arithmetic",0.901,353,285
31,"
Score : 200 points


Problem Statement
N friends of Takahashi has come to a theme park.
To ride the most popular roller coaster in the park, you must be at least K centimeters tall.
The i-th friend is h_i centimeters tall.
How many of the Takahashi's friends can ride the roller coaster?




Constraints

 1 \le N \le 10^5 
 1 \le K \le 500 
 1 \le h_i \le 500
All values in input are integers.







Input
Input is given from Standard Input in the following format:
N K
h_1 h_2 \ldots h_N





Output
Print the number of people among the Takahashi's friends who can ride the roller coaster.






Sample Input 14 150
150 140 100 200





Sample Output 12

Two of them can ride the roller coaster: the first and fourth friends.





Sample Input 21 500
499





Sample Output 20






Sample Input 35 1
100 200 300 400 500





Sample Output 35


",Roller Coaster,"Bruteforcing, Implementation, Counting",0.93,310,277
32,"
Score: 200 points


Problem Statement
Takahashi will do a tap dance. The dance is described by a string S where each character is L, R, U, or D. These characters indicate the positions on which Takahashi should step. He will follow these instructions one by one in order, starting with the first character.
S is said to be easily playable if and only if it satisfies both of the following conditions:

Every character in an odd position (1-st, 3-rd, 5-th, \ldots) is R, U, or D.
Every character in an even position (2-nd, 4-th, 6-th, \ldots) is L, U, or D.

Your task is to print Yes if S is easily playable, and No otherwise.




Constraints

S is a string of length between 1 and 100 (inclusive).
Each character of S is L, R, U, or D.







Input
Input is given from Standard Input in the following format:
S





Output
Print Yes if S is easily playable, and No otherwise.






Sample Input 1RUDLUDR





Sample Output 1Yes

Every character in an odd position (1-st, 3-rd, 5-th, 7-th) is R, U, or D.
Every character in an even position (2-nd, 4-th, 6-th) is L, U, or D.
Thus, S is easily playable.





Sample Input 2DULL





Sample Output 2No

The 3-rd character is not R, U, nor D, so S is not easily playable.





Sample Input 3UUUUUUUUUUUUUUU





Sample Output 3Yes






Sample Input 4ULURU





Sample Output 4No






Sample Input 5RDULULDURURLRDULRLR





Sample Output 5Yes


",Tap Dance,"Bruteforcing, Implementation, Bit Set",0.816,351,260
33,"
Score : 200 points


Problem StatementTakahashi's house has only one socket.
Takahashi wants to extend it with some number of power strips, each with A sockets, into B or more empty sockets.
One power strip with A sockets can extend one empty socket into A empty sockets.
Find the minimum number of power strips required.




Constraints
All values in input are integers.
2 \leq A \leq 20
1 \leq B \leq 20







InputInput is given from Standard Input in the following format:
A B





OutputPrint the minimum number of power strips required.






Sample Input 14 10





Sample Output 13

3 power strips, each with 4 sockets, extend the socket into 10 empty sockets.





Sample Input 28 9





Sample Output 22

2 power strips, each with 8 sockets, extend the socket into 15 empty sockets.





Sample Input 38 8





Sample Output 31


",Power Socket,"Bruteforcing, Arithmetic, Greedy Algorithm",0.361,852,279
34,"
Score : 200 points


Problem StatementGiven is a sequence of N integers A_1, \ldots, A_N.
Find the (multiplicative) inverse of the sum of the inverses of these numbers, \frac{1}{\frac{1}{A_1} + \ldots + \frac{1}{A_N}}.




Constraints
1 \leq N \leq 100
1 \leq A_i \leq 1000







InputInput is given from Standard Input in the following format:
N
A_1 A_2 \ldots A_N





OutputPrint a decimal number (or an integer) representing the value of \frac{1}{\frac{1}{A_1} + \ldots + \frac{1}{A_N}}.
Your output will be judged correct when its absolute or relative error from the judge's output is at most 10^{-5}.






Sample Input 12
10 30





Sample Output 17.5

\frac{1}{\frac{1}{10} + \frac{1}{30}} = \frac{1}{\frac{4}{30}} = \frac{30}{4} = 7.5.
Printing 7.50001, 7.49999, and so on will also be accepted.





Sample Input 23
200 200 200





Sample Output 266.66666666666667

\frac{1}{\frac{1}{200} + \frac{1}{200} + \frac{1}{200}} = \frac{1}{\frac{3}{200}} = \frac{200}{3} = 66.6666....
Printing 6.66666e+1 and so on will also be accepted.





Sample Input 31
1000





Sample Output 31000

\frac{1}{\frac{1}{1000}} = 1000.
Printing +1000.0 and so on will also be accepted.

",Resistors in Parallel,"Arithmetic, Bruteforcing",0.788,379,255
35,"
Score : 200 points


Problem StatementThere are 2000001 stones placed on a number line. The coordinates of these stones are -1000000, -999999, -999998, \ldots, 999999, 1000000.
Among them, some K consecutive stones are painted black, and the others are painted white.
Additionally, we know that the stone at coordinate X is painted black.
Print all coordinates that potentially contain a stone painted black, in ascending order.




Constraints
1 \leq K \leq 100
0 \leq X \leq 100
All values in input are integers.







InputInput is given from Standard Input in the following format:
K X





OutputPrint all coordinates that potentially contain a stone painted black, in ascending order, with spaces in between.






Sample Input 13 7





Sample Output 15 6 7 8 9

We know that there are three stones painted black, and the stone at coordinate 7 is painted black. There are three possible cases:

The three stones painted black are placed at coordinates 5, 6, and 7.
The three stones painted black are placed at coordinates 6, 7, and 8.
The three stones painted black are placed at coordinates 7, 8, and 9.

Thus, five coordinates potentially contain a stone painted black: 5, 6, 7, 8, and 9.





Sample Input 24 0





Sample Output 2-3 -2 -1 0 1 2 3

Negative coordinates can also contain a stone painted black.





Sample Input 31 100





Sample Output 3100


",One Clue,"Arithmetic, Bruteforcing, Array, Implementation",0.889,329,264
36,"
Score : 200 points


Problem StatementGiven is an integer N. Find the number of positive integers less than or equal to N that have an odd number of digits (in base ten without leading zeros).




Constraints
1 \leq N \leq 10^5







InputInput is given from Standard Input in the following format:
N





OutputPrint the number of positive integers less than or equal to N that have an odd number of digits.






Sample Input 111





Sample Output 19

Among the positive integers less than or equal to 11, nine integers have an odd number of digits: 1, 2, \ldots, 9.





Sample Input 2136





Sample Output 246

In addition to 1, 2, \ldots, 9, another 37 integers also have an odd number of digits: 100, 101, \ldots, 136.





Sample Input 3100000





Sample Output 390909


",Uneven Numbers,"String, Bruteforcing, Mathematics, Boolean Operations On Geometric Objects, Arithmetic",0.777,346,249
37,"
Score : 300 points


Problem StatementYou are given two non-negative integers L and R.
We will choose two integers i and j such that L \leq i < j \leq R.
Find the minimum possible value of (i \times j) \mbox{ mod } 2019.




Constraints
All values in input are integers.
0 \leq L < R \leq 2 \times 10^9







InputInput is given from Standard Input in the following format:
L R





OutputPrint the minimum possible value of (i \times j) \mbox{ mod } 2019 when i and j are chosen under the given condition.






Sample Input 12020 2040





Sample Output 12

When (i, j) = (2020, 2021), (i \times j) \mbox{ mod } 2019  = 2.





Sample Input 24 5





Sample Output 220

We have only one choice: (i, j) = (4, 5).

",Remainder Minimization 2019,"Arithmetic, Combinatorics, Bruteforcing, Heuristics",0.114,856,169
38,"
Score : 100 points


Problem StatementGiven is an integer x that is greater than or equal to 0, and less than or equal to 1.
Output 1 if x is equal to 0, or 0 if x is equal to 1.




Constraints
0 \leq x \leq 1
x is an integer







InputInput is given from Standard Input in the following format:
x





OutputPrint 1 if x is equal to 0, or 0 if x is equal to 1.






Sample Input 11





Sample Output 10






Sample Input 20





Sample Output 21


",Not,"Implementation, Bitmask",0.894,540,440
39,"
Score : 200 points


Problem StatementGiven are integers a,b,c and d.
If x and y are integers and a \leq x \leq b and c\leq y \leq d hold, what is the maximum possible value of x \times y?




Constraints
-10^9 \leq a \leq b \leq 10^9
-10^9 \leq c \leq d \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
a b c d





OutputPrint the answer.






Sample Input 11 2 1 1





Sample Output 12

If x = 1 and y = 1 then x \times y = 1.
If x = 2 and y = 1 then x \times y = 2.
Therefore, the answer is 2.





Sample Input 23 5 -4 -2





Sample Output 2-6

The answer can be negative.





Sample Input 3-1000000000 0 -1000000000 0





Sample Output 31000000000000000000


",Product Max,"Implementation, Bruteforcing, Greedy Algorithm, Arithmetic",0.748,623,417
40,"
Score : 500 points


Problem StatementThere are N points on the 2D plane, i-th of which is located on (x_i, y_i).
There can be multiple points that share the same coordinate.
What is the maximum possible Manhattan distance between two distinct points?
Here, the Manhattan distance between two points (x_i, y_i) and (x_j, y_j) is defined by |x_i-x_j| + |y_i-y_j|.




Constraints
2 \leq N \leq 2 \times 10^5
1 \leq x_i,y_i \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
x_1 y_1
x_2 y_2
:
x_N y_N





OutputPrint the answer.






Sample Input 13
1 1
2 4
3 2





Sample Output 14

The Manhattan distance between the first point and the second point is |1-2|+|1-4|=4, which is maximum possible.





Sample Input 22
1 1
1 1





Sample Output 20


",Dist Max,"Geometry; 3d, Bruteforcing, Data Structure, Mathematics, Arithmetic",0.385,365,134
41,"
Score : 100 points


Problem StatementIn the Kingdom of AtCoder, people use a language called Taknese, which uses lowercase English letters.
In Taknese, the plural form of a noun is spelled based on the following rules:

If a noun's singular form does not end with s, append s to the end of the singular form.
If a noun's singular form ends with s, append es to the end of the singular form.

You are given the singular form S of a Taknese noun. Output its plural form.




Constraints
S is a string of length 1 between 1000, inclusive.
S contains only lowercase English letters.







InputInput is given from Standard Input in the following format:
S





OutputPrint the plural form of the given Taknese word.






Sample Input 1apple





Sample Output 1apples

apple ends with e, so its plural form is apples.





Sample Input 2bus





Sample Output 2buses

bus ends with s, so its plural form is buses.





Sample Input 3box





Sample Output 3boxs


",Plural Form,"String, Implementation",0.887,440,354
42,"
Score : 200 points


Problem StatementTak performed the following action N times: rolling two dice.
The result of the i-th roll is D_{i,1} and D_{i,2}.
Check if doublets occurred at least three times in a row.
Specifically, check if there exists at lease one i such that D_{i,1}=D_{i,2}, D_{i+1,1}=D_{i+1,2} and D_{i+2,1}=D_{i+2,2} hold.




Constraints
3 \leq N \leq 100
1\leq D_{i,j} \leq 6
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
D_{1,1} D_{1,2}
\vdots
D_{N,1} D_{N,2}





OutputPrint Yes if doublets occurred at least three times in a row. Print No otherwise.






Sample Input 15
1 2
6 6
4 4
3 3
3 2





Sample Output 1Yes

From the second roll to the fourth roll, three doublets occurred in a row.





Sample Input 25
1 1
2 2
3 4
5 5
6 6





Sample Output 2No






Sample Input 36
1 1
2 2
3 3
4 4
5 5
6 6





Sample Output 3Yes


",Go to Jail,"Bruteforcing, Implementation, Dynamic Programming",0.84,442,341
43,"
Score : 300 points


Problem StatementGiven is a positive integer N.
How many tuples (A,B,C) of positive integers satisfy A \times B + C = N?




Constraints
 2 \leq N \leq 10^6
All values in input are integers.







InputInput is given from Standard Input in the following format:
N





OutputPrint the answer.






Sample Input 13





Sample Output 13

There are 3 tuples of integers that satisfy A \times B + C = 3: (A, B, C) = (1, 1, 2), (1, 2, 1), (2, 1, 1).





Sample Input 2100





Sample Output 2473






Sample Input 31000000





Sample Output 313969985


",A x B + C,"Bruteforcing, Arithmetic, Number Theory, Dynamic Programming",0.728,390,260
44,"
Score: 100 points


Problem Statement
A triple of numbers is said to be poor when two of those numbers are equal but the other number is different from those two numbers.
You will be given three integers A, B, and C. If this triple is poor, print Yes; otherwise, print No.




Constraints

A, B, and C are all integers between 1 and 9 (inclusive).







Input
Input is given from Standard Input in the following format:
A B C





Output
If the given triple is poor, print Yes; otherwise, print No.






Sample Input 15 7 5





Sample Output 1Yes

A and C are equal, but B is different from those two numbers, so this triple is poor.





Sample Input 24 4 4





Sample Output 2No

A, B, and C are all equal, so this triple is not poor.





Sample Input 34 9 6





Sample Output 3No






Sample Input 43 3 4





Sample Output 4Yes


",Poor,"Implementation, Boolean Operations On Geometric Objects",0.671,508,284
45,"
Score : 100 points


Problem StatementServal is fighting with a monster.
The health of the monster is H.
In one attack, Serval can decrease the monster's health by A.
There is no other way to decrease the monster's health.
Serval wins when the monster's health becomes 0 or below.
Find the number of attacks Serval needs to make before winning.




Constraints
1 \leq H \leq 10^4
1 \leq A \leq 10^4
All values in input are integers.







InputInput is given from Standard Input in the following format:
H A





OutputPrint the number of attacks Serval needs to make before winning.






Sample Input 110 4





Sample Output 13


After one attack, the monster's health will be 6.
After two attacks, the monster's health will be 2.
After three attacks, the monster's health will be -2.

Thus, Serval needs to make three attacks to win.





Sample Input 21 10000





Sample Output 21






Sample Input 310000 1





Sample Output 310000


",Serval vs Monster,"Arithmetic, Implementation",0.726,504,296
46,"
Score : 100 points


Problem StatementGiven is a lowercase English letter C that is not z. Print the letter that follows C in alphabetical order.




Constraints
C is a lowercase English letter that is not z.







InputInput is given from Standard Input in the following format:
C





OutputPrint the letter that follows C in alphabetical order.






Sample Input 1a





Sample Output 1b

a is followed by b.





Sample Input 2y





Sample Output 2z

y is followed by z.

",Next Alphabet,"String, Implementation, Arithmetic",0.818,317,213
47,"
Score : 100 points


Problem StatementIn AtCoder City, there are three stations numbered 1, 2, and 3.
Each of these stations is operated by one of the two railway companies, A and B. A string S of length 3 represents which company operates each station. If S_i is A, Company A operates Station i; if S_i is B, Company B operates Station i.
To improve the transportation condition, for each pair of a station operated by Company A and one operated by Company B, there will be a bus service connecting them.
Determine if there is a pair of stations that will be connected by a bus service.




Constraints
Each character of S is A or B.
|S| = 3







InputInput is given from Standard Input in the following format:
S





OutputIf there is a pair of stations that will be connected by a bus service, print Yes; otherwise, print No.






Sample Input 1ABA





Sample Output 1Yes

Company A operates Station 1 and 3, while Company B operates Station 2.
There will be a bus service between Station 1 and 2, and between Station 2 and 3, so print Yes.





Sample Input 2BBA





Sample Output 2Yes

Company B operates Station 1 and 2, while Company A operates Station 3.
There will be a bus service between Station 1 and 3, and between Station 2 and 3, so print Yes.





Sample Input 3BBB





Sample Output 3No

Company B operates all the stations. Thus, there will be no bus service, so print No.

",Station and Bus,"String, Boolean Operations On Geometric Objects",0.696,596,327
48,"
Score : 100 points


Problem StatementTakahashi wants to print a document with N pages double-sided, where two pages of data can be printed on one sheet of paper.
At least how many sheets of paper does he need?




Constraints
N is an integer.
1 \leq N \leq 100







InputInput is given from Standard Input in the following format:
N





OutputPrint the answer.






Sample Input 15





Sample Output 13

By printing the 1-st, 2-nd pages on the 1-st sheet, 3-rd and 4-th pages on the 2-nd sheet, and 5-th page on the 3-rd sheet, we can print all the data on 3 sheets of paper.





Sample Input 22





Sample Output 21






Sample Input 3100





Sample Output 350


",Duplex Printing,"Arithmetic, Boolean Operations On Geometric Objects",0.805,459,302
49,"
Score : 100 points


Problem StatementYou are given an integer K.
Print the string obtained by repeating the string ACL K times and concatenating them.
For example, if K = 3, print ACLACLACL.




Constraints
1 \leq K \leq 5
All values in input are integers.







InputInput is given from Standard Input in the following format:
K





OutputPrint the string obtained by repeating the string ACL K times and concatenating them.






Sample Input 13





Sample Output 1ACLACLACL


",Repeat ACL,"Bruteforcing, String",0.917,158,134
50,"
Score : 100 points


Problem StatementAtCoDeer the deer found two positive integers, a and b.
Determine whether the product of a and b is even or odd.




Constraints
1 ≤ a,b ≤ 10000
a and b are integers.







InputInput is given from Standard Input in the following format:
a b





OutputIf the product is odd, print Odd; if it is even, print Even.






Sample Input 13 4





Sample Output 1Even

As 3 × 4 = 12 is even, print Even.





Sample Input 21 21





Sample Output 2Odd

As 1 × 21 = 21 is odd, print Odd.

",Product,"Arithmetic, Implementation",0.697,721,428
51,"
Score : 100 points


Problem StatementAtCoDeer has three cards, one red, one green and one blue.
An integer between 1 and 9 (inclusive) is written on each card: r on the red card, g on the green card and b on the blue card.
We will arrange the cards in the order red, green and blue from left to right, and read them as a three-digit integer.
Is this integer a multiple of 4?  




Constraints
1 ≤ r, g, b ≤ 9







InputInput is given from Standard Input in the following format:
r g b





OutputIf the three-digit integer is a multiple of 4, print YES (case-sensitive); otherwise, print NO.






Sample Input 14 3 2





Sample Output 1YES

432 is a multiple of 4, and thus YES should be printed.





Sample Input 22 3 4





Sample Output 2NO

234 is not a multiple of 4, and thus NO should be printed.

",RGB Cards,"Arithmetic, Implementation",0.707,349,203
52,"
Score: 100 points


Problem Statement
E869120 has A 1-yen coins and infinitely many 500-yen coins.
Determine if he can pay exactly N yen using only these coins.




Constraints

N is an integer between 1 and 10000 (inclusive).
A is an integer between 0 and 1000 (inclusive).







Input
Input is given from Standard Input in the following format:
N
A





Output
If E869120 can pay exactly N yen using only his 1-yen and 500-yen coins, print Yes; otherwise, print No.






Sample Input 12018
218





Sample Output 1Yes

We can pay 2018 yen with four 500-yen coins and 18 1-yen coins, so the answer is Yes.





Sample Input 22763
0





Sample Output 2No

When we have no 1-yen coins, we can only pay a multiple of 500 yen using only 500-yen coins. Since 2763 is not a multiple of 500, we cannot pay this amount.





Sample Input 337
514





Sample Output 3Yes


",Infinite Coins,"Arithmetic, Implementation",0.595,356,191
53,"
Score : 100 points


Problem StatementSnuke has a grid consisting of three squares numbered 1, 2 and 3.
In each square, either 0 or 1 is written. The number written in Square i is s_i.
Snuke will place a marble on each square that says 1.
Find the number of squares on which Snuke will place a marble.




Constraints
Each of s_1, s_2 and s_3 is either 1 or 0.







InputInput is given from Standard Input in the following format:
s_{1}s_{2}s_{3}





OutputPrint the answer.






Sample Input 1101





Sample Output 12


A marble will be placed on Square 1 and 3.






Sample Input 2000





Sample Output 20


No marble will be placed on any square.


",Placing Marbles,"String, Implementation, Prefix sum",0.681,660,338
54,"
Score : 100 points


Problem StatementIn ""Takahashi-ya"", a ramen restaurant, a bowl of ramen costs 700 yen (the currency of Japan), plus 100 yen for each kind of topping (boiled egg, sliced pork, green onions).
A customer ordered a bowl of ramen and told which toppings to put on his ramen to a clerk. The clerk took a memo of the order as a string S. S is three characters long, and if the first character in S is o, it means the ramen should be topped with boiled egg; if that character is x, it means the ramen should not be topped with boiled egg. Similarly, the second and third characters in S mean the presence or absence of sliced pork and green onions on top of the ramen.
Write a program that, when S is given, prints the price of the corresponding bowl of ramen.




Constraints
S is a string of length 3.
Each character in S is o or x.







InputInput is given from Standard Input in the following format:
S





OutputPrint the price of the bowl of ramen corresponding to S.






Sample Input 1oxo





Sample Output 1900

The price of a ramen topped with two kinds of toppings, boiled egg and green onions, is 700 + 100 \times 2 = 900 yen.





Sample Input 2ooo





Sample Output 21000

The price of a ramen topped with all three kinds of toppings is 700 + 100 \times 3 = 1000 yen.





Sample Input 3xxx





Sample Output 3700

The price of a ramen without any toppings is 700 yen.

",Something on It,"String, Counting, Arithmetic",0.813,276,203
55,"
Score : 100 points


Problem StatementOn some day in January 2018, Takaki is writing a document. The document has a column where the current date is written in yyyy/mm/dd format. For example, January 23, 2018 should be written as 2018/01/23.
After finishing the document, she noticed that she had mistakenly wrote 2017 at the beginning of the date column. Write a program that, when the string that Takaki wrote in the date column, S, is given as input, modifies the first four characters in S to 2018 and prints it.




Constraints
S is a string of length 10.
The first eight characters in S are 2017/01/.
The last two characters in S are digits and represent an integer between 1 and 31 (inclusive).







InputInput is given from Standard Input in the following format:
S





OutputReplace the first four characters in S with 2018 and print it.






Sample Input 12017/01/07





Sample Output 12018/01/07






Sample Input 22017/01/31





Sample Output 22018/01/31


",Already 2018,String,0.835,258,193
56,"
Score : 200 points


Problem StatementThe word internationalization is sometimes abbreviated to i18n.
This comes from the fact that there are 18 letters between the first i and the last n.
You are given a string s of length at least 3 consisting of lowercase English letters.
Abbreviate s in the same way.




Constraints
3 ≤ |s| ≤ 100 (|s| denotes the length of s.)
s consists of lowercase English letters.







InputInput is given from Standard Input in the following format:
s





OutputPrint the abbreviation of s.






Sample Input 1internationalization





Sample Output 1i18n






Sample Input 2smiles





Sample Output 2s4s






Sample Input 3xyz





Sample Output 3x1z


",i18n,"String, Arithmetic",0.889,203,176
57,"
Score : 200 points


Problem StatementYou are given strings s and t, consisting of lowercase English letters.
You will create a string s' by freely rearranging the characters in s.
You will also create a string t' by freely rearranging the characters in t.
Determine whether it is possible to satisfy s' < t' for the lexicographic order.




NotesFor a string a = a_1 a_2 ... a_N of length N and a string b = b_1 b_2 ... b_M of length M, we say a < b for the lexicographic order if either one of the following two conditions holds true:

N < M and a_1 = b_1, a_2 = b_2, ..., a_N = b_N.
There exists i (1 \leq i \leq N, M) such that a_1 = b_1, a_2 = b_2, ..., a_{i - 1} = b_{i - 1} and a_i < b_i. Here, letters are compared using alphabetical order.

For example, xy < xya and atcoder < atlas.




Constraints
The lengths of s and t are between 1 and 100 (inclusive).
s and t consists of lowercase English letters.







InputInput is given from Standard Input in the following format:
s
t





OutputIf it is possible to satisfy s' < t', print Yes; if it is not, print No.






Sample Input 1yx
axy





Sample Output 1Yes

We can, for example, rearrange yx into xy and axy into yxa. Then, xy < yxa.





Sample Input 2ratcode
atlas





Sample Output 2Yes

We can, for example, rearrange ratcode into acdeort and atlas into tslaa. Then, acdeort < tslaa.





Sample Input 3cd
abc





Sample Output 3No

No matter how we rearrange cd and abc, we cannot achieve our objective.





Sample Input 4w
ww





Sample Output 4Yes






Sample Input 5zzz
zzz





Sample Output 5No


",Two Anagrams,"Sorting, String, Array",0.569,263,129
58,"
Score : 200 points


Problem StatementThere are N positive integers written on a blackboard: A_1, ..., A_N.
Snuke can perform the following operation when all integers on the blackboard are even:

Replace each integer X on the blackboard by X divided by 2.

Find the maximum possible number of operations that Snuke can perform.




Constraints
1 \leq N \leq 200
1 \leq A_i \leq 10^9







InputInput is given from Standard Input in the following format:
N
A_1 A_2 ... A_N





OutputPrint the maximum possible number of operations that Snuke can perform.






Sample Input 13
8 12 40





Sample Output 12

Initially, [8, 12, 40] are written on the blackboard.
Since all those integers are even, Snuke can perform the operation.
After the operation is performed once, [4, 6, 20] are written on the blackboard.
Since all those integers are again even, he can perform the operation.
After the operation is performed twice, [2, 3, 10] are written on the blackboard.
Now, there is an odd number 3 on the blackboard, so he cannot perform the operation any more.
Thus, Snuke can perform the operation at most twice.





Sample Input 24
5 6 8 10





Sample Output 20

Since there is an odd number 5 on the blackboard already in the beginning, Snuke cannot perform the operation at all.





Sample Input 36
382253568 723152896 37802240 379425024 404894720 471526144





Sample Output 38


",Shift only,"Bruteforcing, Implementation, Array, Arithmetic",0.701,579,357
59,"
Score : 200 points


Problem StatementTakahashi loves numbers divisible by 2.
You are given a positive integer N. Among the integers between 1 and N (inclusive), find the one that can be divisible by 2 for the most number of times. The solution is always unique.
Here, the number of times an integer can be divisible by 2, is how many times the integer can be divided by 2 without remainder.
For example,

6 can be divided by 2 once: 6 -> 3.
8 can be divided by 2 three times: 8 -> 4 -> 2 -> 1.
3 can be divided by 2 zero times.





Constraints
1 ≤ N ≤ 100







InputInput is given from Standard Input in the following format:
N





OutputPrint the answer.






Sample Input 17





Sample Output 14

4 can be divided by 2 twice, which is the most number of times among 1, 2, ..., 7.





Sample Input 232





Sample Output 232






Sample Input 31





Sample Output 31






Sample Input 4100





Sample Output 464


",Break Number,"Bruteforcing, Implementation, Counting, Greedy Algorithm",0.712,247,159
60,"
Score : 200 points


Problem StatementYou are given an integer sequence A of length N.
Find the maximum absolute difference of two elements (with different indices) in A.




Constraints
2 \leq N \leq 100
1 \leq A_i \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
A_1 A_2 ... A_N





OutputPrint the maximum absolute difference of two elements (with different indices) in A.






Sample Input 14
1 4 6 3





Sample Output 15

The maximum absolute difference of two elements is A_3-A_1=6-1=5.





Sample Input 22
1000000000 1





Sample Output 2999999999






Sample Input 35
1 1 1 1 1





Sample Output 30


",Maximum Difference,"Bruteforcing, Array, Mathematics, Arithmetic",0.826,248,195
61,"
Score : 200 points


Problem StatementYou are given a string s consisting of lowercase English letters. Extract all the characters in the odd-indexed positions and print the string obtained by concatenating them. Here, the leftmost character is assigned the index 1.




Constraints
Each character in s is a lowercase English letter.
1≤|s|≤10^5







InputThe input is given from Standard Input in the following format:
s





OutputPrint the string obtained by concatenating all the characters in the odd-numbered positions.






Sample Input 1atcoder





Sample Output 1acdr

Extract the first character a, the third character c, the fifth character d and the seventh character r to obtain acdr.





Sample Input 2aaaa





Sample Output 2aa






Sample Input 3z





Sample Output 3z






Sample Input 4fukuokayamaguchi





Sample Output 4fkoaaauh


",OddString,"Bruteforcing, String, Array",0.682,231,154
62,"
Score : 200 points


Problem StatementSnuke has decided to construct a string that starts with A and ends with Z, by taking out a substring of a string s (that is, a consecutive part of s).
Find the greatest length of the string Snuke can construct. Here, the test set guarantees that there always exists a substring of s that starts with A and ends with Z.




Constraints
1 ≦ |s| ≦ 200{,}000
s consists of uppercase English letters.
There exists a substring of s that starts with A and ends with Z.







InputThe input is given from Standard Input in the following format:
s





OutputPrint the answer.






Sample Input 1QWERTYASDFZXCV





Sample Output 15

By taking out the seventh through eleventh characters, it is possible to construct ASDFZ, which starts with A and ends with Z.





Sample Input 2ZABCZ





Sample Output 24






Sample Input 3HASFJGHOGAKZZFEGA





Sample Output 312


",A to Z String,"Array, String, Arithmetic",0.822,241,183
63,"
Score : 200 points


Problem StatementAkaki, a patissier, can make N kinds of doughnut using only a certain powder called ""Okashi no Moto"" (literally ""material of pastry"", simply called Moto below) as ingredient. These doughnuts are called Doughnut 1, Doughnut 2, ..., Doughnut N. In order to make one Doughnut i (1 ≤ i ≤ N), she needs to consume m_i grams of Moto. She cannot make a non-integer number of doughnuts, such as 0.5 doughnuts.
Now, she has X grams of Moto. She decides to make as many doughnuts as possible for a party tonight. However, since the tastes of the guests differ, she will obey the following condition:

For each of the N kinds of doughnuts, make at least one doughnut of that kind.

At most how many doughnuts can be made here? She does not necessarily need to consume all of her Moto. Also, under the constraints of this problem, it is always possible to obey the condition.




Constraints
2 ≤ N ≤ 100
1 ≤ m_i ≤ 1000
m_1 + m_2 + ... + m_N ≤ X ≤ 10^5
All values in input are integers.







InputInput is given from Standard Input in the following format:
N X
m_1
m_2
:
m_N





OutputPrint the maximum number of doughnuts that can be made under the condition.






Sample Input 13 1000
120
100
140





Sample Output 19

She has 1000 grams of Moto and can make three kinds of doughnuts. If she makes one doughnut for each of the three kinds, she consumes 120 + 100 + 140 = 360 grams of Moto. From the 640 grams of Moto that remains here, she can make additional six Doughnuts 2. This is how she can made a total of nine doughnuts, which is the maximum.





Sample Input 24 360
90
90
90
90





Sample Output 24

Making one doughnut for each of the four kinds consumes all of her Moto.





Sample Input 35 3000
150
130
150
130
110





Sample Output 326


",Bitter Alchemy,"Greedy Algorithm, Arithmetic, Bruteforcing, Sorting",0.854,218,174
64,"
Score : 200 points


Problem StatementYou have A 500-yen coins, B 100-yen coins and C 50-yen coins (yen is the currency of Japan).
In how many ways can we select some of these coins so that they are X yen in total?
Coins of the same kind cannot be distinguished. Two ways to select coins are distinguished when, for some kind of coin, the numbers of that coin are different.




Constraints
0 \leq A, B, C \leq 50
A + B + C \geq 1
50 \leq X \leq 20 000
A, B and C are integers.
X is a multiple of 50.







InputInput is given from Standard Input in the following format:
A
B
C
X





OutputPrint the number of ways to select coins.






Sample Input 12
2
2
100





Sample Output 12

There are two ways to satisfy the condition:

Select zero 500-yen coins, one 100-yen coin and zero 50-yen coins.
Select zero 500-yen coins, zero 100-yen coins and two 50-yen coins.






Sample Input 25
1
0
150





Sample Output 20

Note that the total must be exactly X yen.





Sample Input 330
40
50
6000





Sample Output 3213


",Coins,"Bruteforcing, Backtracking, Arithmetic, Counting",0.775,513,340
65,"
Score : 200 points


Problem StatementLa Confiserie d'ABC sells cakes at 4 dollars each and doughnuts at 7 dollars each.
Determine if there is a way to buy some of them for exactly N dollars. You can buy two or more doughnuts and two or more cakes, and you can also choose to buy zero doughnuts or zero cakes.




Constraints
N is an integer between 1 and 100, inclusive.







InputInput is given from Standard Input in the following format:
N





OutputIf there is a way to buy some cakes and some doughnuts for exactly N dollars, print Yes; otherwise, print No.






Sample Input 111





Sample Output 1Yes

If you buy one cake and one doughnut, the total will be 4 + 7 = 11 dollars.





Sample Input 240





Sample Output 2Yes

If you buy ten cakes, the total will be 4 \times 10 = 40 dollars.





Sample Input 33





Sample Output 3No

The prices of cakes (4 dollars) and doughnuts (7 dollars) are both higher than 3 dollars, so there is no such way.

",Cakes and Donuts,"Bruteforcing, Arithmetic",0.677,264,155
66,"
Score : 200 points


Problem StatementThere are N points in a D-dimensional space.
The coordinates of the i-th point are (X_{i1}, X_{i2}, ..., X_{iD}).
The distance between two points with coordinates (y_1, y_2, ..., y_D) and (z_1, z_2, ..., z_D) is \sqrt{(y_1 - z_1)^2 + (y_2 - z_2)^2 + ... + (y_D - z_D)^2}.
How many pairs (i, j) (i < j) are there such that the distance between the i-th point and the j-th point is an integer?




Constraints
All values in input are integers.
2 \leq N \leq 10
1 \leq D \leq 10
-20 \leq X_{ij} \leq 20
No two given points have the same coordinates. That is, if i \neq j, there exists k such that X_{ik} \neq X_{jk}.







InputInput is given from Standard Input in the following format:
N D
X_{11} X_{12} ... X_{1D}
X_{21} X_{22} ... X_{2D}
\vdots
X_{N1} X_{N2} ... X_{ND}





OutputPrint the number of pairs (i, j) (i < j) such that the distance between the i-th point and the j-th point is an integer.






Sample Input 13 2
1 2
5 5
-2 8





Sample Output 11

The number of pairs with an integer distance is one, as follows:

The distance between the first point and the second point is \sqrt{|1-5|^2 + |2-5|^2} = 5, which is an integer.
The distance between the second point and the third point is \sqrt{|5-(-2)|^2 + |5-8|^2} = \sqrt{58}, which is not an integer.
The distance between the third point and the first point is \sqrt{|-2-1|^2+|8-2|^2} = 3\sqrt{5}, which is not an integer.






Sample Input 23 4
-3 7 8 2
-12 1 10 2
-2 8 9 3





Sample Output 22






Sample Input 35 1
1
2
3
4
5





Sample Output 310


",Good Distance,"Bruteforcing, Mathematics, Arithmetic",0.804,263,193
67,"
Score : 200 points


Problem StatementFind the sum of the integers between 1 and N (inclusive), whose sum of digits written in base 10 is between A and B (inclusive).




Constraints
1 \leq N \leq 10^4
1 \leq A \leq B \leq 36
All input values are integers.







InputInput is given from Standard Input in the following format:
N A B





OutputPrint the sum of the integers between 1 and N (inclusive), whose sum of digits written in base 10 is between A and B (inclusive).






Sample Input 120 2 5





Sample Output 184

Among the integers not greater than 20, the ones whose sums of digits are between 2 and 5, are: 2,3,4,5,11,12,13,14 and 20. We should print the sum of these, 84.





Sample Input 210 1 2





Sample Output 213






Sample Input 3100 4 16





Sample Output 34554


",Some Sums,"Bruteforcing, Arithmetic, Implementation, Prefix sum",0.757,443,282
68,"
Score : 200 points


Problem StatementFind the number of palindromic numbers among the integers between A and B (inclusive).
Here, a palindromic number is a positive integer whose string representation in base 10 (without leading zeros) reads the same forward and backward.




Constraints
10000 \leq A \leq B \leq 99999
All input values are integers.







InputInput is given from Standard Input in the following format:
A B





OutputPrint the number of palindromic numbers among the integers between A and B (inclusive).






Sample Input 111009 11332





Sample Output 14

There are four integers that satisfy the conditions: 11011, 11111, 11211 and 11311.





Sample Input 231415 92653





Sample Output 2612


",Palindromic Numbers,"Bruteforcing, Arithmetic, String, Implementation, Counting",0.739,230,162
69,"
Score : 200 points


Problem StatementTakahashi has two positive integers A and B.
It is known that A plus B equals N.
Find the minimum possible value of ""the sum of the digits of A"" plus ""the sum of the digits of B"" (in base 10).




Constraints
2 ≤ N ≤ 10^5
N is an integer.







InputInput is given from Standard Input in the following format:
N





OutputPrint the minimum possible value of ""the sum of the digits of A"" plus ""the sum of the digits of B"".






Sample Input 115





Sample Output 16

When A=2 and B=13, the sums of their digits are 2 and 4, which minimizes the value in question.





Sample Input 2100000





Sample Output 210


",Digits Sum,"Bruteforcing, Arithmetic, Data Structure",0.711,182,113
70,"
Score : 200 points


Problem StatementGiven is an integer N. Find the number of digits that N has in base K.




NotesFor information on base-K representation, see Positional notation - Wikipedia.




Constraints
All values in input are integers.
1 \leq N \leq 10^9
2 \leq K \leq 10







InputInput is given from Standard Input in the following format:
N K





OutputPrint the number of digits that N has in base K.






Sample Input 111 2





Sample Output 14

In binary, 11 is represented as 1011.





Sample Input 21010101 10





Sample Output 27






Sample Input 3314159265 3





Sample Output 318


",Digits,"Arithmetic, Bruteforcing, Counting, Mathematics",0.767,342,232
71,"
Score: 200 points


Problem Statement
We have N cards. A number a_i is written on the i-th card.
Alice and Bob will play a game using these cards. In this game, Alice and Bob alternately take one card. Alice goes first.
The game ends when all the cards are taken by the two players, and the score of each player is the sum of the numbers written on the cards he/she has taken. When both players take the optimal strategy to maximize their scores, find Alice's score minus Bob's score.




Constraints

N is an integer between 1 and 100 (inclusive).
a_i \ (1 \leq i \leq N) is an integer between 1 and 100 (inclusive).







Input
Input is given from Standard Input in the following format:  
N
a_1 a_2 a_3 ... a_N





Output
Print Alice's score minus Bob's score when both players take the optimal strategy to maximize their scores.






Sample Input 12
3 1





Sample Output 12

First, Alice will take the card with 3. Then, Bob will take the card with 1.
The difference of their scores will be 3 - 1 = 2.





Sample Input 23
2 7 4





Sample Output 25

First, Alice will take the card with 7. Then, Bob will take the card with 4. Lastly, Alice will take the card with 2. The difference of their scores will be 7 - 4 + 2 = 5. The difference of their scores will be 3 - 1 = 2.





Sample Input 34
20 18 2 18





Sample Output 318


",Card Game for Two,"Sorting, Greedy Algorithm, Bruteforcing, Dynamic Programming, Arithmetic",0.788,460,327
72,"
Score : 200 points


Problem StatementSnuke has N sticks.
The length of the i-th stick is l_i.
Snuke is making a snake toy by joining K of the sticks together.
The length of the toy is represented by the sum of the individual sticks that compose it.
Find the maximum possible length of the toy.




Constraints
1 \leq K \leq N \leq 50
1 \leq l_i \leq 50
l_i is an integer.







InputInput is given from Standard Input in the following format:
N K
l_1 l_2 l_3 ... l_{N}





OutputPrint the answer.






Sample Input 15 3
1 2 3 4 5





Sample Output 112

You can make a toy of length 12 by joining the sticks of lengths 3, 4 and 5, which is the maximum possible length.





Sample Input 215 14
50 26 27 21 41 7 42 35 7 5 5 36 39 1 45





Sample Output 2386


",Snake Toy,"Sorting, Greedy Algorithm, Bruteforcing",0.876,195,155
73,"
Score : 200 points


Problem StatementIroha has a sequence of N strings S_1, S_2, ..., S_N. The length of each string is L.
She will concatenate all of the strings in some order, to produce a long string.
Among all strings that she can produce in this way, find the lexicographically smallest one.
Here, a string s=s_1s_2s_3...s_n is lexicographically smaller than another string t=t_1t_2t_3...t_m if and only if one of the following holds:

There exists an index i(1≦i≦min(n,m)), such that s_j = t_j for all indices j(1≦j<i), and s_i<t_i.
s_i = t_i for all integers i(1≦i≦min(n,m)), and n<m.





Constraints
1 ≦ N, L ≦ 100
For each i, the length of S_i equals L.
For each i, S_i consists of lowercase letters.







InputThe input is given from Standard Input in the following format:
N L
S_1
S_2
:
S_N





OutputPrint the lexicographically smallest string that Iroha can produce.






Sample Input 13 3
dxx
axx
cxx





Sample Output 1axxcxxdxx

The following order should be used: axx, cxx, dxx.

",Iroha Loves Strings (ABC Edition),"Sorting, String, Array",0.688,477,292
74,"
Score : 200 points


Problem StatementThere are N children, numbered 1, 2, ..., N.
Snuke has decided to distribute x sweets among them.
He needs to give out all the x sweets, but some of the children may get zero sweets.
For each i (1 \leq i \leq N), Child i will be happy if he/she gets exactly a_i sweets.
Snuke is trying to maximize the number of happy children by optimally distributing the sweets.
Find the maximum possible number of happy children.




Constraints
All values in input are integers.
2 \leq N \leq 100
1 \leq x \leq 10^9
1 \leq a_i \leq 10^9







InputInput is given from Standard Input in the following format:
N x
a_1 a_2 ... a_N





OutputPrint the maximum possible number of happy children.






Sample Input 13 70
20 30 10





Sample Output 12

One optimal way to distribute sweets is (20, 30, 20).





Sample Input 23 10
20 30 10





Sample Output 21

The optimal way to distribute sweets is (0, 0, 10).





Sample Input 34 1111
1 10 100 1000





Sample Output 34

The optimal way to distribute sweets is (1, 10, 100, 1000).





Sample Input 42 10
20 20





Sample Output 40

No children will be happy, no matter how the sweets are distributed.

",Candy Distribution Again,"Sorting, Greedy Algorithm, Bruteforcing, Boolean Operations On Geometric Objects",0.512,261,116
75,"
Score : 200 points


Problem StatementAn X-layered kagami mochi (X ≥ 1) is a pile of X round mochi (rice cake) stacked vertically where each mochi (except the bottom one) has a smaller diameter than that of the mochi directly below it. For example, if you stack three mochi with diameters of 10, 8 and 6 centimeters from bottom to top in this order, you have a 3-layered kagami mochi; if you put just one mochi, you have a 1-layered kagami mochi.
Lunlun the dachshund has N round mochi, and the diameter of the i-th mochi is d_i centimeters. When we make a kagami mochi using some or all of them, at most how many layers can our kagami mochi have?




Constraints
1 ≤ N ≤ 100
1 ≤ d_i ≤ 100
All input values are integers.







InputInput is given from Standard Input in the following format:
N
d_1
:
d_N





OutputPrint the maximum number of layers in a kagami mochi that can be made.






Sample Input 14
10
8
8
6





Sample Output 13

If we stack the mochi with diameters of 10, 8 and 6 centimeters from bottom to top in this order, we have a 3-layered kagami mochi, which is the maximum number of layers.





Sample Input 23
15
15
15





Sample Output 21

When all the mochi have the same diameter, we can only have a 1-layered kagami mochi.





Sample Input 37
50
30
50
100
50
80
30





Sample Output 34


",Kagami Mochi,"Set / Map, Sorting, Bruteforcing",0.856,416,340
76,"
Score : 200 points


Problem StatementYou are given a string S consisting of lowercase English letters.
Find the lexicographically (alphabetically) smallest lowercase English letter that does not occur in S.
If every lowercase English letter occurs in S, print None instead.




Constraints
1 \leq |S| \leq 10^5 (|S| is the length of string S.)
S consists of lowercase English letters.







InputInput is given from Standard Input in the following format:
S





OutputPrint the lexicographically smallest lowercase English letter that does not occur in S.
If every lowercase English letter occurs in S, print None instead.






Sample Input 1atcoderregularcontest





Sample Output 1b

The string atcoderregularcontest contains a, but does not contain b.





Sample Input 2abcdefghijklmnopqrstuvwxyz





Sample Output 2None

This string contains every lowercase English letter.





Sample Input 3fajsonlslfepbjtsaayxbymeskptcumtwrmkkinjxnnucagfrg





Sample Output 3d


",Not Found,"Counting, Set / Map, Hashing, Bruteforcing, Sorting",0.689,210,131
77,"
Score : 200 points


Problem StatementThere are N cities and M roads.
The i-th road (1≤i≤M) connects two cities a_i and b_i (1≤a_i,b_i≤N) bidirectionally.
There may be more than one road that connects the same pair of two cities.
For each city, how many roads are connected to the city?




Constraints
2≤N,M≤50
1≤a_i,b_i≤N
a_i ≠ b_i
All input values are integers.







InputInput is given from Standard Input in the following format:  
N M
a_1 b_1
:  
a_M b_M





OutputPrint the answer in N lines.
In the i-th line (1≤i≤N), print the number of roads connected to city i.






Sample Input 14 3
1 2
2 3
1 4





Sample Output 12
2
1
1


City 1 is connected to the 1-st and 3-rd roads.
City 2 is connected to the 1-st and 2-nd roads.
City 3 is connected to the 2-nd road.
City 4 is connected to the 3-rd road.






Sample Input 22 5
1 2
2 1
1 2
2 1
1 2





Sample Output 25
5






Sample Input 38 8
1 2
3 4
1 5
2 8
3 7
5 2
4 1
6 8





Sample Output 33
3
2
2
2
1
1
2


",Counting Roads,"Array, Bruteforcing, Graph Theory, Counting",0.854,184,146
78,"
Score : 200 points


Problem StatementThere is a rectangle in the xy-plane, with its lower left corner at (0, 0) and its upper right corner at (W, H). Each of its sides is parallel to the x-axis or y-axis. Initially, the whole region within the rectangle is painted white.
Snuke plotted N points into the rectangle. The coordinate of the i-th (1 ≦ i ≦ N) point was (x_i, y_i).
Then, he created an integer sequence a of length N, and for each 1 ≦ i ≦ N, he painted some region within the rectangle black, as follows:

If a_i = 1, he painted the region satisfying x < x_i within the rectangle.
If a_i = 2, he painted the region satisfying x > x_i within the rectangle.
If a_i = 3, he painted the region satisfying y < y_i within the rectangle.
If a_i = 4, he painted the region satisfying y > y_i within the rectangle.

Find the area of the white region within the rectangle after he finished painting.




Constraints
1 ≦ W, H ≦ 100
1 ≦ N ≦ 100
0 ≦ x_i ≦ W (1 ≦ i ≦ N)
0 ≦ y_i ≦ H (1 ≦ i ≦ N)
W, H (21:32, added), x_i and y_i are integers.
a_i (1 ≦ i ≦ N) is 1, 2, 3 or 4.







InputThe input is given from Standard Input in the following format:
W H N
x_1 y_1 a_1
x_2 y_2 a_2
:
x_N y_N a_N





OutputPrint the area of the white region within the rectangle after Snuke finished painting.






Sample Input 15 4 2
2 1 1
3 3 4





Sample Output 19

The figure below shows the rectangle before Snuke starts painting.



First, as (x_1, y_1) = (2, 1) and a_1 = 1, he paints the region satisfying x < 2 within the rectangle:



Then, as (x_2, y_2) = (3, 3) and a_2 = 4, he paints the region satisfying y > 3 within the rectangle:



Now, the area of the white region within the rectangle is 9.





Sample Input 25 4 3
2 1 1
3 3 4
1 4 2





Sample Output 20

It is possible that the whole region within the rectangle is painted black.





Sample Input 310 10 5
1 6 1
4 1 3
6 9 4
9 4 2
3 1 3





Sample Output 364


",Snuke's Coloring 2 (ABC Edit),"Greedy Algorithm, Bruteforcing, Boolean Operations On Geometric Objects",0.556,245,122
79,"
Score : 200 points


Problem StatementTakahashi has N blue cards and M red cards.
A string is written on each card. The string written on the i-th blue card is s_i, and the string written on the i-th red card is t_i.
Takahashi will now announce a string, and then check every card. Each time he finds a blue card with the string announced by him, he will earn 1 yen (the currency of Japan); each time he finds a red card with that string, he will lose 1 yen.
Here, we only consider the case where the string announced by Takahashi and the string on the card are exactly the same. For example, if he announces atcoder, he will not earn money even if there are blue cards with atcoderr, atcode, btcoder, and so on. (On the other hand, he will not lose money even if there are red cards with such strings, either.)
At most how much can he earn on balance?
Note that the same string may be written on multiple cards.




Constraints
N and M are integers.
1 \leq N, M \leq 100
s_1, s_2, ..., s_N, t_1, t_2, ..., t_M are all strings of lengths between 1 and 10 (inclusive) consisting of lowercase English letters.







InputInput is given from Standard Input in the following format:
N
s_1
s_2
:
s_N
M
t_1
t_2
:
t_M





OutputIf Takahashi can earn at most X yen on balance, print X.






Sample Input 13
apple
orange
apple
1
grape





Sample Output 12

He can earn 2 yen by announcing apple.





Sample Input 23
apple
orange
apple
5
apple
apple
apple
apple
apple





Sample Output 21

If he announces apple, he will lose 3 yen. If he announces orange, he can earn 1 yen.





Sample Input 31
voldemort
10
voldemort
voldemort
voldemort
voldemort
voldemort
voldemort
voldemort
voldemort
voldemort
voldemort





Sample Output 30

If he announces voldemort, he will lose 9 yen. If he announces orange, for example, he can avoid losing a yen.





Sample Input 46
red
red
blue
yellow
yellow
red
5
red
red
yellow
green
blue





Sample Output 41


",Two Colors Card Game,"Set / Map, Hashing, Bruteforcing, Counting, Binary Search",0.772,204,145
80,"
Score : 300 points


Problem StatementTakahashi has N balls. Initially, an integer A_i is written on the i-th ball.
He would like to rewrite the integer on some balls so that there are at most K different integers written on the N balls.
Find the minimum number of balls that Takahashi needs to rewrite the integers on them.




Constraints
1 \leq K \leq N \leq 200000
1 \leq A_i \leq N
All input values are integers.







InputInput is given from Standard Input in the following format:
N K
A_1 A_2 ... A_N





OutputPrint the minimum number of balls that Takahashi needs to rewrite the integers on them.






Sample Input 15 2
1 1 2 2 5





Sample Output 11

For example, if we rewrite the integer on the fifth ball to 2, there are two different integers written on the balls: 1 and 2.
On the other hand, it is not possible to rewrite the integers on zero balls so that there are at most two different integers written on the balls, so we should print 1.





Sample Input 24 4
1 1 2 2





Sample Output 20

Already in the beginning, there are two different integers written on the balls, so we do not need to rewrite anything.





Sample Input 310 3
5 1 3 2 4 1 1 2 3 4





Sample Output 33


",Not so Diverse,"Counting, Sorting, Greedy Algorithm, Arithmetic",0.711,163,100
81,"
Score : 300 points


Problem StatementThe commonly used bills in Japan are 10000-yen, 5000-yen and 1000-yen bills. Below, the word ""bill"" refers to only these.
According to Aohashi, he received an otoshidama (New Year money gift) envelope from his grandfather that contained N bills for a total of Y yen, but he may be lying. Determine whether such a situation is possible, and if it is, find a possible set of bills contained in the envelope. Assume that his grandfather is rich enough, and the envelope was large enough.




Constraints
1 ≤ N ≤ 2000
1000 ≤ Y ≤ 2 × 10^7
N is an integer.
Y is a multiple of 1000.







InputInput is given from Standard Input in the following format:
N Y





OutputIf the total value of N bills cannot be Y yen, print -1 -1 -1.
If the total value of N bills can be Y yen, let one such set of bills be ""x 10000-yen bills, y 5000-yen bills and z 1000-yen bills"", and print x, y, z with spaces in between. If there are multiple possibilities, any of them may be printed.






Sample Input 19 45000





Sample Output 14 0 5

If the envelope contained 4 10000-yen bills and 5 1000-yen bills, he had 9 bills and 45000 yen in total. It is also possible that the envelope contained 9 5000-yen bills, so the output 0 9 0 is also correct.





Sample Input 220 196000





Sample Output 2-1 -1 -1

When the envelope contained 20 bills in total, the total value would be 200000 yen if all the bills were 10000-yen bills, and would be at most 195000 yen otherwise, so it would never be 196000 yen.





Sample Input 31000 1234000





Sample Output 314 27 959

There are also many other possibilities.





Sample Input 42000 20000000





Sample Output 42000 0 0


",Otoshidama,"Bruteforcing, Arithmetic",0.503,709,317
82,"
Score: 300 points


Problem Statement
We have a 3 \times 3 grid. A number c_{i, j} is written in the square (i, j), where (i, j) denotes the square at the i-th row from the top and the j-th column from the left.
According to Takahashi, there are six integers a_1, a_2, a_3, b_1, b_2, b_3 whose values are fixed, and the number written in the square (i, j) is equal to a_i + b_j.
Determine if he is correct.  




Constraints

c_{i, j} \ (1 \leq i \leq 3, 1 \leq j \leq 3) is an integer between 0 and 100 (inclusive).







Input
Input is given from Standard Input in the following format:
c_{1,1} c_{1,2} c_{1,3}
c_{2,1} c_{2,2} c_{2,3}
c_{3,1} c_{3,2} c_{3,3}





Output
If Takahashi's statement is correct, print Yes; otherwise, print No.






Sample Input 11 0 1
2 1 2
1 0 1





Sample Output 1Yes

Takahashi is correct, since there are possible sets of integers such as: a_1=0,a_2=1,a_3=0,b_1=1,b_2=0,b_3=1.





Sample Input 22 2 2
2 1 2
2 2 2





Sample Output 2No

Takahashi is incorrect in this case.





Sample Input 30 8 8
0 8 8
0 8 8





Sample Output 3Yes






Sample Input 41 8 6
2 9 7
0 7 7





Sample Output 4No


",Takahashi's Information,"Mathematics, Bruteforcing, 2-sat, Array",0.845,146,116
83,"
Score : 300 points


Problem StatementYou are given an integer N.
For two positive integers A and B, we will define F(A,B) as the larger of the following: the number of digits in the decimal notation of A, and the number of digits in the decimal notation of B.
For example, F(3,11) = 2 since 3 has one digit and 11 has two digits.
Find the minimum value of F(A,B) as (A,B) ranges over all pairs of positive integers such that N = A \times B.




Constraints
1 \leq N \leq 10^{10}
N is an integer.







InputThe input is given from Standard Input in the following format:
N





OutputPrint the minimum value of F(A,B) as (A,B) ranges over all pairs of positive integers such that N = A \times B.






Sample Input 110000





Sample Output 13

F(A,B) has a minimum value of 3 at (A,B)=(100,100).





Sample Input 21000003





Sample Output 27

There are two pairs (A,B) that satisfy the condition: (1,1000003) and (1000003,1). For these pairs, F(1,1000003)=F(1000003,1)=7.





Sample Input 39876543210





Sample Output 36


",Digits in Multiplication,"Bruteforcing, Number Theory, Mathematics, String, Arithmetic, Greedy Algorithm",0.602,247,117
84,"
Score : 200 points


Problem StatementYou are given an H × W grid.
The squares in the grid are described by H strings, S_1,...,S_H.
The j-th character in the string S_i corresponds to the square at the i-th row from the top and j-th column from the left (1 \leq i \leq H,1 \leq j \leq W).
. stands for an empty square, and # stands for a square containing a bomb.  
Dolphin is interested in how many bomb squares are horizontally, vertically or diagonally adjacent to each empty square.
(Below, we will simply say ""adjacent"" for this meaning. For each square, there are at most eight adjacent squares.)
He decides to replace each . in our H strings with a digit that represents the number of bomb squares adjacent to the corresponding empty square.  
Print the strings after the process.  




Constraints
1 \leq H,W \leq 50
S_i is a string of length W consisting of # and ..







InputInput is given from Standard Input in the following format:  
H W
S_1
:
S_H





OutputPrint the H strings after the process.
The i-th line should contain a string T_i of length W, where the j-th character in T_i corresponds to the square at the i-th row from the top and j-th row from the left in the grid (1 \leq i \leq H, 1 \leq j \leq W).  






Sample Input 13 5
.....
.#.#.
.....





Sample Output 111211
1#2#1
11211

For example, let us observe the empty square at the first row from the top and first column from the left.
There is one bomb square adjacent to this empty square: the square at the second row and second column.
Thus, the . corresponding to this empty square is replaced with 1.  





Sample Input 23 5
#####
#####
#####





Sample Output 2#####
#####
#####

It is possible that there is no empty square.  





Sample Input 36 6
#####.
#.#.##
####.#
.#..#.
#.##..
#.#...





Sample Output 3#####3
#8#7##
####5#
4#65#2
#5##21
#4#310


",Minesweeper,"Bruteforcing, Array, Graph Traversal, Implementation, Counting",0.75,214,146
85,"
Score : 200 points


Problem StatementAlice and Bob are controlling a robot. They each have one switch that controls the robot.
Alice started holding down her button A second after the start-up of the robot, and released her button B second after the start-up.
Bob started holding down his button C second after the start-up, and released his button D second after the start-up.
For how many seconds both Alice and Bob were holding down their buttons?




Constraints
0≤A<B≤100
0≤C<D≤100
All input values are integers.







InputInput is given from Standard Input in the following format:  
A B C D





OutputPrint the length of the duration (in seconds) in which both Alice and Bob were holding down their buttons.






Sample Input 10 75 25 100





Sample Output 150

Alice started holding down her button 0 second after the start-up of the robot, and released her button 75 second after the start-up.
Bob started holding down his button 25 second after the start-up, and released his button 100 second after the start-up.
Therefore, the time when both of them were holding down their buttons, is the 50 seconds from 25 seconds after the start-up to 75 seconds after the start-up.





Sample Input 20 33 66 99





Sample Output 20

Alice and Bob were not holding their buttons at the same time, so the answer is zero seconds.





Sample Input 310 90 20 80





Sample Output 360


",Two Switches,"Sorting, Boolean Operations On Geometric Objects, Arithmetic",0.599,300,158
86,"
Score : 200 points


Problem StatementSnuke loves working out. He is now exercising N times.
Before he starts exercising, his power is 1. After he exercises for the i-th time, his power gets multiplied by i.
Find Snuke's power after he exercises N times. Since the answer can be extremely large, print the answer modulo 10^{9}+7.




Constraints
1 ≤ N ≤ 10^{5}







InputThe input is given from Standard Input in the following format:
N





OutputPrint the answer modulo 10^{9}+7.






Sample Input 13





Sample Output 16


After Snuke exercises for the first time, his power gets multiplied by 1 and becomes 1.
After Snuke exercises for the second time, his power gets multiplied by 2 and becomes 2.
After Snuke exercises for the third time, his power gets multiplied by 3 and becomes 6.






Sample Input 210





Sample Output 23628800






Sample Input 3100000





Sample Output 3457992974

Print the answer modulo 10^{9}+7.

",Training Camp,"Arithmetic, Bruteforcing",0.638,343,180
87,"
Score : 200 points


Problem StatementThere are N balls placed in a row.
AtCoDeer the deer is painting each of these in one of the K colors of his paint cans.
For aesthetic reasons, any two adjacent balls must be painted in different colors.
Find the number of the possible ways to paint the balls.




Constraints
1≦N≦1000
2≦K≦1000
The correct answer is at most 2^{31}-1.







InputThe input is given from Standard Input in the following format:
N K





OutputPrint the number of the possible ways to paint the balls.






Sample Input 12 2





Sample Output 12

We will denote the colors by 0 and 1. There are two possible ways: we can either paint the left ball in color 0 and the right ball in color 1, or paint the left in color 1 and the right in color 0.





Sample Input 21 10





Sample Output 210

Since there is only one ball, we can use any of the ten colors to paint it. Thus, the answer is ten.

",Painting Balls with AtCoDeer,"Exponentiation By Squaring, Combinatorics, Bruteforcing, Arithmetic",0.846,207,171
88,"
Score : 100 points


Problem StatementTakahashi wants to be a member of some web service.
He tried to register himself with the ID S, which turned out to be already used by another user.
Thus, he decides to register using a string obtained by appending one character at the end of S as his ID.
He is now trying to register with the ID T. Determine whether this string satisfies the property above.




Constraints
S and T are strings consisting of lowercase English letters.
1 \leq |S| \leq 10
|T| = |S| + 1







InputInput is given from Standard Input in the following format:
S
T





OutputIf T satisfies the property in Problem Statement, print Yes; otherwise, print No.






Sample Input 1chokudai
chokudaiz





Sample Output 1Yes

chokudaiz can be obtained by appending z at the end of chokudai.





Sample Input 2snuke
snekee





Sample Output 2No

snekee cannot be obtained by appending one character at the end of snuke.





Sample Input 3a
aa





Sample Output 3Yes


",Registration,"String, Implementation",0.734,896,557
89,"
Score : 200 points


Problem StatementWe have A cards, each of which has an integer 1 written on it. Similarly, we also have B cards with 0s and C cards with -1s.
We will pick up K among these cards. What is the maximum possible sum of the numbers written on the cards chosen?




Constraints
All values in input are integers.
0 \leq A, B, C
1 \leq K \leq A + B + C \leq 2 \times 10^9







InputInput is given from Standard Input in the following format:
A B C K





OutputPrint the maximum possible sum of the numbers written on the cards chosen.






Sample Input 12 1 1 3





Sample Output 12

Consider picking up two cards with 1s and one card with a 0.
In this case, the sum of the numbers written on the cards is 2, which is the maximum possible value.





Sample Input 21 2 3 4





Sample Output 20






Sample Input 32000000000 0 0 2000000000





Sample Output 32000000000


",Easy Linear Programming,"Greedy Algorithm, Boolean Operations On Geometric Objects, Arithmetic",0.616,947,498
90,"
Score : 400 points


Problem Statement
Given is a positive integer N. Consider repeatedly applying the operation below on N:

First, choose a positive integer z satisfying all of the conditions below:
z can be represented as z=p^e, where p is a prime number and e is a positive integer;
z divides N;
z is different from all integers chosen in previous operations.


Then, replace N with N/z.

Find the maximum number of times the operation can be applied.




Constraints

All values in input are integers.
1 \leq N \leq 10^{12}







Input
Input is given from Standard Input in the following format:
N





Output
Print the maximum number of times the operation can be applied.






Sample Input 124





Sample Output 13

We can apply the operation three times by, for example, making the following choices:

Choose z=2 (=2^1). (Now we have N=12.)
Choose z=3 (=3^1). (Now we have N=4.)
Choose z=4 (=2^2). (Now we have N=1.)






Sample Input 21





Sample Output 20

We cannot apply the operation at all.





Sample Input 364





Sample Output 33

We can apply the operation three times by, for example, making the following choices:

Choose z=2 (=2^1). (Now we have N=32.)
Choose z=4 (=2^2). (Now we have N=8.)
Choose z=8 (=2^3). (Now we have N=1.)






Sample Input 41000000007





Sample Output 41

We can apply the operation once by, for example, making the following choice:

z=1000000007 (=1000000007^1). (Now we have N=1.)






Sample Input 5997764507000





Sample Output 57


",Div Game,"Prime Factorization, Arithmetic, Greedy Algorithm, Mathematics, Bruteforcing",0.304,588,144
91,"
Score : 500 points


Problem StatementThere are N integers X_1, X_2, \cdots, X_N, and we know that A_i \leq X_i \leq B_i.
Find the number of different values that the median of X_1, X_2, \cdots, X_N can take.




NotesThe median of X_1, X_2, \cdots, X_N is defined as follows. Let x_1, x_2, \cdots, x_N be the result of sorting X_1, X_2, \cdots, X_N in ascending order.

If N is odd, the median is x_{(N+1)/2};
if N is even, the median is (x_{N/2} + x_{N/2+1}) / 2.





Constraints
2 \leq N \leq 2 \times 10^5
1 \leq A_i \leq B_i \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
A_1 B_1
A_2 B_2
:
A_N B_N





OutputPrint the answer.






Sample Input 12
1 2
2 3





Sample Output 13



If X_1 = 1 and X_2 = 2, the median is \frac{3}{2};


if X_1 = 1 and X_2 = 3, the median is 2;


if X_1 = 2 and X_2 = 2, the median is 2;


if X_1 = 2 and X_2 = 3, the median is \frac{5}{2}.


Thus, the median can take three values: \frac{3}{2}, 2, and \frac{5}{2}.





Sample Input 23
100 100
10 10000
1 1000000000





Sample Output 29991


",Count Median,"Sorting, Mathematics, Arithmetic, Array",0.618,104,51
92,"
Score : 100 points


Problem StatementWe have five variables x_1, x_2, x_3, x_4, and x_5.
The variable x_i was initially assigned a value of i.
Snuke chose one of these variables and assigned it 0.
You are given the values of the five variables after this assignment.
Find out which variable Snuke assigned 0.




Constraints
The values of x_1, x_2, x_3, x_4, and x_5 given as input are a possible outcome of the assignment by Snuke.







InputInput is given from Standard Input in the following format:
x_1 x_2 x_3 x_4 x_5





OutputIf the variable Snuke assigned 0 was x_i, print the integer i.






Sample Input 10 2 3 4 5





Sample Output 11

In this case, Snuke assigned 0 to x_1, so we should print 1.





Sample Input 21 2 0 4 5





Sample Output 23


",Five Variables,"Array, Implementation",0.821,811,567
93,"
Score : 200 points


Problem StatementThere are some animals in a garden. Each of them is a crane with two legs or a turtle with four legs.
Takahashi says: ""there are X animals in total in the garden, and they have Y legs in total."" Determine whether there is a combination of numbers of cranes and turtles in which this statement is correct.




Constraints
1 \leq X \leq 100
1 \leq Y \leq 100
All values in input are integers.







InputInput is given from Standard Input in the following format:
X Y





OutputIf there is a combination of numbers of cranes and turtles in which the statement is correct, print Yes; otherwise, print No.






Sample Input 13 8





Sample Output 1Yes

The statement ""there are 3 animals in total in the garden, and they have 8 legs in total"" is correct if there are two cranes and one turtle. Thus, there is a combination of numbers of cranes and turtles in which the statement is correct.





Sample Input 22 100





Sample Output 2No

There is no combination of numbers of cranes and turtles in which this statement is correct.





Sample Input 31 2





Sample Output 3Yes

We also consider the case in which there are only cranes or only turtles.

",Crane and Turtle,"Mathematics, Arithmetic, Bruteforcing",0.517,1175,518
94,"
Score : 300 points


Problem StatementGiven are an integer X and an integer sequence of length N: p_1, \ldots, p_N.
Among the integers not contained in the sequence p_1, \ldots, p_N (not necessarily positive), find the integer nearest to X, that is, find the integer whose absolute difference with X is the minimum. If there are multiple such integers, report the smallest such integer.




Constraints
1 \leq X \leq 100
0 \leq N \leq 100
1 \leq p_i \leq 100
p_1, \ldots, p_N are all distinct.
All values in input are integers.







InputInput is given from Standard Input in the following format:
X N
p_1 ... p_N





OutputPrint the answer.






Sample Input 16 5
4 7 10 6 5





Sample Output 18

Among the integers not contained in the sequence 4, 7, 10, 6, 5, the one nearest to 6 is 8.





Sample Input 210 5
4 7 10 6 5





Sample Output 29

Among the integers not contained in the sequence 4, 7, 10, 6, 5, the ones nearest to 10 are 9 and 11. We should print the smaller one, 9.





Sample Input 3100 0






Sample Output 3100

When N = 0, the second line in the input will be empty. Also, as seen here, X itself can be the answer.

",Forbidden List,"Array, Set / Map, Greedy Algorithm, Bruteforcing, Implementation",0.473,1094,438
95,"
Score : 400 points


Problem StatementGiven is a number sequence A of length N.
Find the number of integers i \left(1 \leq i \leq N\right) with the following property:

For every integer j \left(1 \leq j \leq N\right) such that i \neq j , A_j does not divide A_i.





Constraints
All values in input are integers.
1 \leq N \leq 2 \times 10^5
1 \leq A_i \leq 10^6







InputInput is given from Standard Input in the following format:
N
A_1 A_2 \cdots A_N





OutputPrint the answer.






Sample Input 15
24 11 8 3 16





Sample Output 13

The integers with the property are 2, 3, and 4.





Sample Input 24
5 5 5 5





Sample Output 20

Note that there can be multiple equal numbers.





Sample Input 310
33 18 45 28 8 19 89 86 2 4





Sample Output 35


",Not Divisible,"Counting, Sorting, Sieve Of Eratosthenes, Bruteforcing, Array",0.143,1003,194
96,"
Score : 100 points


Problem StatementAtCoder Inc. holds a contest every Saturday.
There are two types of contests called ABC and ARC, and just one of them is held at a time.
The company holds these two types of contests alternately: an ARC follows an ABC and vice versa.
Given a string S representing the type of the contest held last week, print the string representing the type of the contest held this week.




Constraints
S is ABC or ARC.







InputInput is given from Standard Input in the following format:
S





OutputPrint the string representing the type of the contest held this week.






Sample Input 1ABC





Sample Output 1ARC

They held an ABC last week, so they will hold an ARC this week.

",A?C,"String, Implementation",0.77,743,492
97,"
Score : 200 points


Problem StatementN Snukes called Snuke 1, Snuke 2, ..., Snuke N live in a town.
There are K kinds of snacks sold in this town, called Snack 1, Snack 2, ..., Snack K. The following d_i Snukes have Snack i: Snuke A_{i, 1}, A_{i, 2}, \cdots, A_{i, {d_i}}.
Takahashi will walk around this town and make mischief on the Snukes who have no snacks. How many Snukes will fall victim to Takahashi's mischief?




Constraints
All values in input are integers.
1 \leq N \leq 100
1 \leq K \leq 100
1 \leq d_i \leq N
1 \leq A_{i, 1} < \cdots < A_{i, d_i} \leq N







InputInput is given from Standard Input in the following format:
N K
d_1
A_{1, 1} \cdots A_{1, d_1}
\vdots
d_K
A_{K, 1} \cdots A_{K, d_K}





OutputPrint the answer.






Sample Input 13 2
2
1 3
1
3





Sample Output 11


Snuke 1 has Snack 1.
Snuke 2 has no snacks.
Snuke 3 has Snack 1 and 2.

Thus, there will be one victim: Snuke 2.





Sample Input 23 3
1
3
1
3
1
3





Sample Output 22


",Trick or Treat,"Array, Set / Map, Bruteforcing, Counting",0.784,567,398
98,"
Score : 300 points


Problem StatementThere are N observatories in AtCoder Hill, called Obs. 1, Obs. 2, ..., Obs. N. The elevation of Obs. i is H_i.
There are also M roads, each connecting two different observatories. Road j connects Obs. A_j and Obs. B_j.
Obs. i is said to be good when its elevation is higher than those of all observatories that can be reached from Obs. i using just one road.
Note that Obs. i is also good when no observatory can be reached from Obs. i using just one road.
How many good observatories are there?




Constraints
2 \leq N \leq 10^5
1 \leq M \leq 10^5
1 \leq H_i \leq 10^9
1 \leq A_i,B_i \leq N
A_i \neq B_i
Multiple roads may connect the same pair of observatories.
All values in input are integers.







InputInput is given from Standard Input in the following format:
N M
H_1 H_2 ... H_N
A_1 B_1
A_2 B_2
:
A_M B_M





OutputPrint the number of good observatories.






Sample Input 14 3
1 2 3 4
1 3
2 3
2 4





Sample Output 12



From Obs. 1, you can reach Obs. 3 using just one road. The elevation of Obs. 1 is not higher than that of Obs. 3, so Obs. 1 is not good.


From Obs. 2, you can reach Obs. 3 and 4 using just one road. The elevation of Obs. 2 is not higher than that of Obs. 3, so Obs. 2 is not good.


From Obs. 3, you can reach Obs. 1 and 2 using just one road. The elevation of Obs. 3 is higher than those of Obs. 1 and 2, so Obs. 3 is good.


From Obs. 4, you can reach Obs. 2 using just one road. The elevation of Obs. 4 is higher than that of Obs. 2, so Obs. 4 is good.


Thus, the good observatories are Obs. 3 and 4, so there are two good observatories.





Sample Input 26 5
8 6 9 1 2 1
1 3
4 2
4 3
4 6
4 6





Sample Output 23


",Peaks,"Graph Traversal, Array, Data Structure, Boolean Operations On Geometric Objects, Counting",0.507,725,318
99,"
Score : 400 points


Problem StatementGive a pair of integers (A, B) such that A^5-B^5 = X.
It is guaranteed that there exists such a pair for the given integer X.




Constraints
1 \leq X \leq 10^9
X is an integer.
There exists a pair of integers (A, B) satisfying the condition in Problem Statement.







InputInput is given from Standard Input in the following format:
X





OutputPrint A and B, with space in between.
If there are multiple pairs of integers (A, B) satisfying the condition, you may print any of them.
A B







Sample Input 133





Sample Output 12 -1

For A=2 and B=-1, A^5-B^5 = 33.





Sample Input 21





Sample Output 20 -1


",I hate Factorization,"Bruteforcing, Exponentiation By Squaring, Mathematics",0.33,600,173
100,"
Score: 500 points


Problem Statement
You are the top spy of AtCoder Kingdom. To prevent the stolen secret from being handed to AlDebaran Kingdom, you have sneaked into the party where the transaction happens.
There are N attendees in the party, and they are given attendee numbers from 1 through N. The height of Attendee i is A_i.
According to an examination beforehand, you know that a pair of attendees satisfying the condition below will make the transaction.

The absolute difference of their attendee numbers is equal to the sum of their heights.

There are \frac{N(N-1)}{2} ways to choose two from the N attendees and make a pair. Among them, how many satisfy the condition above?
P.S.: We cannot let you know the secret.




Constraints

All values in input are integers.
2 \leq N \leq 2 \times 10^5
1 \leq A_i \leq 10^9\ (1 \leq i \leq N)







Input
Input is given from Standard Input in the following format:
N
A_1 A_2 \dots A_N





Output
Print the number of pairs satisfying the condition.






Sample Input 16
2 3 3 1 3 1





Sample Output 13


A_1 + A_4 = 3, so the pair of Attendee 1 and 4 satisfy the condition.
A_2 + A_6 = 4, so the pair of Attendee 2 and 6 satisfy the condition.
A_4 + A_6 = 2, so the pair of Attendee 4 and 6 satisfy the condition.

No other pair satisfies the condition, so you should print 3.





Sample Input 26
5 2 4 2 8 8





Sample Output 20

No pair satisfies the condition, so you should print 0.





Sample Input 332
3 1 4 1 5 9 2 6 5 3 5 8 9 7 9 3 2 3 8 4 6 2 6 4 3 3 8 3 2 7 9 5





Sample Output 322


",This Message Will Self-Destruct in 5s,"Array, Set / Map, Hashing, Counting, Constructive, Arithmetic",0.315,348,109
101,"
Score: 100 points


Problem Statement
Takahashi the Jumbo will practice golf.
His objective is to get a carry distance that is a multiple of K, while he can only make a carry distance of between A and B (inclusive).
If he can achieve the objective, print OK; if he cannot, print NG.




Constraints

All values in input are integers.
1 \leq A \leq B \leq 1000
1 \leq K \leq 1000







Input
Input is given from Standard Input in the following format:
K
A B





Output
If he can achieve the objective, print OK; if he cannot, print NG.






Sample Input 17
500 600





Sample Output 1OK

Among the multiples of 7, for example, 567 lies between 500 and 600.





Sample Input 24
5 7





Sample Output 2NG

No multiple of 4 lies between 5 and 7.





Sample Input 31
11 11





Sample Output 3OK


",We Love Golf,"Bruteforcing, Arithmetic, Implementation",0.674,819,438
102,"
Score : 200 points


Problem Statement
Takahashi has a deposit of 100 yen (the currency of Japan) in AtCoder Bank.
The bank pays an annual interest rate of 1 % compounded annually. (A fraction of less than one yen is discarded.)
Assuming that nothing other than the interest affects Takahashi's balance, in how many years does the balance reach X yen or above for the first time?




Constraints

 101 \le X \le 10^{18} 
All values in input are integers.







Input
Input is given from Standard Input in the following format:
X





Output
Print the number of years it takes for Takahashi's balance to reach X yen or above for the first time.






Sample Input 1103





Sample Output 13


The balance after one year is 101 yen.
The balance after two years is 102 yen.
The balance after three years is 103 yen.

Thus, it takes three years for the balance to reach 103 yen or above.





Sample Input 21000000000000000000





Sample Output 23760






Sample Input 31333333333





Sample Output 31706


",1%,"Bruteforcing, Arithmetic, Simulation",0.68,696,367
103,"
Score : 100 points


Problem StatementThere are S sheep and W wolves.
If the number of wolves is greater than or equal to that of sheep, the wolves will attack the sheep.
If the wolves will attack the sheep, print unsafe; otherwise, print safe.




Constraints
1 \leq S \leq 100
1 \leq W \leq 100







InputInput is given from Standard Input in the following format:
S W





OutputIf the wolves will attack the sheep, print unsafe; otherwise, print safe.






Sample Input 14 5





Sample Output 1unsafe

There are four sheep and five wolves. The number of wolves is not less than that of sheep, so they will attack them.





Sample Input 2100 2





Sample Output 2safe

Many a sheep drive away two wolves.





Sample Input 310 10





Sample Output 3unsafe


",Sheep and Wolves,"Implementation, Arithmetic",0.774,734,483
104,"
Score : 200 points


Problem StatementTakahashi and Aoki will have a battle using their monsters.
The health and strength of Takahashi's monster are A and B, respectively, and those of Aoki's monster are C and D, respectively.
The two monsters will take turns attacking, in the order Takahashi's, Aoki's, Takahashi's, Aoki's, ...
Here, an attack decreases the opponent's health by the value equal to the attacker's strength.
The monsters keep attacking until the health of one monster becomes 0 or below. The person with the monster whose health becomes 0 or below loses, and the other person wins.
If Takahashi will win, print Yes; if he will lose, print No.




Constraints
1 \leq A,B,C,D \leq 100
All values in input are integers.







InputInput is given from Standard Input in the following format:
A B C D





OutputIf Takahashi will win, print Yes; if he will lose, print No.






Sample Input 110 9 10 10





Sample Output 1No

First, Takahashi's monster attacks Aoki's monster, whose health is now 10-9=1.
Next, Aoki's monster attacks Takahashi's monster, whose health is now 10-10=0.
Takahashi's monster is the first to have 0 or less health, so Takahashi loses.





Sample Input 246 4 40 5





Sample Output 2Yes


",Battle,"Simulation, Implementation, Dynamic Programming",0.691,763,443
105,"
Score : 300 points


Problem StatementYou drew lottery N times. In the i-th draw, you got an item of the kind represented by a string S_i.
How many kinds of items did you get?




Constraints
1 \leq N \leq 2\times 10^5
S_i consists of lowercase English letters and has a length between 1 and 10 (inclusive).







InputInput is given from Standard Input in the following format:
N
S_1
:
S_N





OutputPrint the number of kinds of items you got.






Sample Input 13
apple
orange
apple





Sample Output 12

You got two kinds of items: apple and orange.





Sample Input 25
grape
grape
grape
grape
grape





Sample Output 21






Sample Input 34
aaaa
a
aaa
aa





Sample Output 34


",gacha,"Bruteforcing, Set / Map, Sorting, String",0.746,691,416
106,"
Score : 100 points


Problem StatementPrint the circumference of a circle of radius R.




Constraints
1 \leq R \leq 100
All values in input are integers.







InputInput is given from Standard Input in the following format:
R





OutputPrint the circumference of the circle.
Your output is considered correct if and only if its absolute or relative error from our answer is at most 10^{-2}.






Sample Input 11





Sample Output 16.28318530717958623200

Since we accept an absolute or relative error of at most 10^{-2}, 6.28 is also an acceptable output, but 6 is not.





Sample Input 273





Sample Output 2458.67252742410977361942


",Circle Pond,"Arithmetic, Mathematics",0.784,927,675
107,"
Score : 200 points


Problem StatementTakahashi has N days of summer vacation.
His teacher gave him M summer assignments. It will take A_i days for him to do the i-th assignment.
He cannot do multiple assignments on the same day, or hang out on a day he does an assignment.
What is the maximum number of days Takahashi can hang out during the vacation if he finishes all the assignments during this vacation?
If Takahashi cannot finish all the assignments during the vacation, print -1 instead.




Constraints
1 \leq N \leq 10^6
1 \leq M \leq 10^4
1 \leq A_i \leq 10^4







InputInput is given from Standard Input in the following format:
N M
A_1 ... A_M





OutputPrint the maximum number of days Takahashi can hang out during the vacation, or -1.






Sample Input 141 2
5 6





Sample Output 130

For example, he can do the first assignment on the first 5 days, hang out on the next 30 days, and do the second assignment on the last 6 days of the vacation. In this way, he can safely spend 30 days hanging out.





Sample Input 210 2
5 6





Sample Output 2-1

He cannot finish his assignments.





Sample Input 311 2
5 6





Sample Output 30

He can finish his assignments, but he will have no time to hang out.





Sample Input 4314 15
9 26 5 35 8 9 79 3 23 8 46 2 6 43 3





Sample Output 49


",Homework,"Array, Implementation, Arithmetic",0.791,622,462
108,"
Score : 300 points


Problem StatementA company has N members, who are assigned ID numbers 1, ..., N.
Every member, except the member numbered 1, has exactly one immediate boss with a smaller ID number.
When a person X is the immediate boss of a person Y, the person Y is said to be an immediate subordinate of the person X.
You are given the information that the immediate boss of the member numbered i is the member numbered A_i. For each member, find how many immediate subordinates it has.




Constraints
2 \leq N \leq 2 \times 10^5
1 \leq A_i < i







InputInput is given from Standard Input in the following format:
N
A_2 ... A_N





OutputFor each of the members numbered 1, 2, ..., N, print the number of immediate subordinates it has, in its own line.






Sample Input 15
1 1 2 2





Sample Output 12
2
0
0
0

The member numbered 1 has two immediate subordinates: the members numbered 2 and 3.
The member numbered 2 has two immediate subordinates: the members numbered 4 and 5.
The members numbered 3, 4, and 5 do not have immediate subordinates.





Sample Input 210
1 1 1 1 1 1 1 1 1





Sample Output 29
0
0
0
0
0
0
0
0
0






Sample Input 37
1 2 3 4 5 6





Sample Output 31
1
1
1
1
1
0


",management,"Array, Bruteforcing, Counting",0.769,591,383
109,"
Score : 100 points


Problem StatementGiven is a three-digit integer N. Does N contain the digit 7?
If so, print Yes; otherwise, print No.




Constraints
100 \leq N \leq 999







InputInput is given from Standard Input in the following format:
N





OutputIf N contains the digit 7, print Yes; otherwise, print No.






Sample Input 1117





Sample Output 1Yes

117 contains 7 as its last digit.





Sample Input 2123





Sample Output 2No

123 does not contain the digit 7.





Sample Input 3777





Sample Output 3Yes


",Lucky 7,"String, Arithmetic, Implementation, Bruteforcing",0.72,754,459
110,"
Score : 200 points


Problem StatementLet us define the FizzBuzz sequence a_1,a_2,... as follows:

If both 3 and 5 divides i, a_i=\mbox{FizzBuzz}.
If the above does not hold but 3 divides i, a_i=\mbox{Fizz}.
If none of the above holds but 5 divides i, a_i=\mbox{Buzz}.
If none of the above holds, a_i=i.

Find the sum of all numbers among the first N terms of the FizzBuzz sequence.




Constraints
1 \leq N \leq 10^6







InputInput is given from Standard Input in the following format:
N





OutputPrint the sum of all numbers among the first N terms of the FizzBuzz sequence.






Sample Input 115





Sample Output 160

The first 15 terms of the FizzBuzz sequence are:
1,2,\mbox{Fizz},4,\mbox{Buzz},\mbox{Fizz},7,8,\mbox{Fizz},\mbox{Buzz},11,\mbox{Fizz},13,14,\mbox{FizzBuzz}
Among them, numbers are 1,2,4,7,8,11,13,14, and the sum of them is 60.





Sample Input 21000000





Sample Output 2266666333332

Watch out for overflow.

",FizzBuzz Sum,"Bruteforcing, Implementation, Arithmetic, Inclusion And Exclusion",0.687,682,418
111,"
Score : 300 points


Problem StatementFind \displaystyle{\sum_{a=1}^{K}\sum_{b=1}^{K}\sum_{c=1}^{K} \gcd(a,b,c)}.
Here \gcd(a,b,c) denotes the greatest common divisor of a, b, and c.




Constraints
1 \leq K \leq 200
K is an integer.







InputInput is given from Standard Input in the following format:
K





OutputPrint the value of \displaystyle{\sum_{a=1}^{K}\sum_{b=1}^{K}\sum_{c=1}^{K} \gcd(a,b,c)}.






Sample Input 12





Sample Output 19

\gcd(1,1,1)+\gcd(1,1,2)+\gcd(1,2,1)+\gcd(1,2,2)
+\gcd(2,1,1)+\gcd(2,1,2)+\gcd(2,2,1)+\gcd(2,2,2)
=1+1+1+1+1+1+1+2=9
Thus, the answer is 9.





Sample Input 2200





Sample Output 210813692


",Sum of gcd of Tuples (Easy),"Bruteforcing, Euclidean Algorithm, Arithmetic, Prefix sum",0.83,437,338
112,"
Score : 400 points


Problem StatementWe have a string S of length N consisting of R, G, and B.
Find the number of triples (i,~j,~k)~(1 \leq i < j < k \leq N) that satisfy both of the following conditions:

S_i \neq S_j, S_i \neq S_k, and S_j \neq S_k.
j - i \neq k - j.





Constraints
1 \leq N \leq 4000
S is a string of length N consisting of R, G, and B.







InputInput is given from Standard Input in the following format:
N
S





OutputPrint the number of triplets in question.






Sample Input 14
RRGB





Sample Output 11

Only the triplet (1,~3,~4) satisfies both conditions. The triplet (2,~3,~4) satisfies the first condition but not the second, so it does not count.





Sample Input 239
RBRBGRBGGBBRRGBBRRRBGGBRBGBRBGBRBBBGBBB





Sample Output 21800


",RGB Triplets,"Combinatorics, Bruteforcing, Arithmetic, Implementation, Binary Search",0.22,782,167
113,"
Score : 100 points


Problem Statement
We have three boxes A, B, and C, each of which contains an integer.
Currently, the boxes A, B, and C contain the integers X, Y, and Z, respectively.
We will now do the operations below in order. Find the content of each box afterward.  

Swap the contents of the boxes A and B
Swap the contents of the boxes A and C





Constraints

1 \leq X,Y,Z \leq 100
All values in input are integers.







Input
Input is given from Standard Input in the following format:
X Y Z





Output
Print the integers contained in the boxes A, B, and C, in this order, with space in between.






Sample Input 11 2 3





Sample Output 13 1 2

After the contents of the boxes A and B are swapped, A, B, and C contain 2, 1, and 3, respectively.
Then, after the contents of A and C are swapped, A, B, and C contain 3, 1, and 2, respectively.  





Sample Input 2100 100 100





Sample Output 2100 100 100






Sample Input 341 59 31





Sample Output 331 41 59


",ABC Swap,"Arithmetic, Greedy Algorithm, Implementation",0.774,669,436
114,"
Score : 200 points


Problem StatementWe have held a popularity poll for N items on sale. Item i received A_i votes.
From these N items, we will select M as popular items. However, we cannot select an item with less than \dfrac{1}{4M} of the total number of votes.
If M popular items can be selected, print Yes; otherwise, print No.




Constraints
1 \leq M \leq N \leq 100
1 \leq A_i \leq 1000
A_i are distinct.
All values in input are integers.







InputInput is given from Standard Input in the following format:
N M
A_1 ... A_N





OutputIf M popular items can be selected, print Yes; otherwise, print No.






Sample Input 14 1
5 4 2 1





Sample Output 1Yes

There were 12 votes in total. The most popular item received 5 votes, and we can select it.





Sample Input 23 2
380 19 1





Sample Output 2No

There were 400 votes in total. The second and third most popular items received less than \dfrac{1}{4\times 2} of the total number of votes, so we cannot select them. Thus, we cannot select two popular items.





Sample Input 312 3
4 56 78 901 2 345 67 890 123 45 6 789





Sample Output 3Yes


",Popular Vote,"Bruteforcing, Arithmetic, Implementation, Counting",0.251,1317,330
115,"
Score : 300 points


Problem StatementGiven any integer x, Aoki can do the operation below.
Operation: Replace x with the absolute difference of x and K.
You are given the initial value of an integer N. Find the minimum possible value taken by N after Aoki does the operation zero or more times.




Constraints
0 ≤ N ≤ 10^{18}
1 ≤ K ≤ 10^{18}
All values in input are integers.







InputInput is given from Standard Input in the following format:
N K





OutputPrint the minimum possible value taken by N after Aoki does the operation zero or more times.






Sample Input 17 4





Sample Output 11

Initially, N=7.
After one operation, N becomes |7-4| = 3.
After two operations, N becomes |3-4| = 1, which is the minimum value taken by N.





Sample Input 22 6





Sample Output 22

N=2 after zero operations is the minimum.





Sample Input 31000000000000000000 1





Sample Output 30


",Replacing Integer,"Arithmetic, Mathematics",0.452,721,286
116,"
Score : 100 points


Problem StatementAn uppercase or lowercase English letter \alpha will be given as input.
If \alpha is uppercase, print A; if it is lowercase, print a.




Constraints
\alpha is an uppercase (A - Z) or lowercase (a - z) English letter.







InputInput is given from Standard Input in the following format:
α





OutputIf \alpha is uppercase, print A; if it is lowercase, print a.






Sample Input 1B





Sample Output 1A

B is uppercase, so we should print A.





Sample Input 2a





Sample Output 2a

a is lowercase, so we should print a.

",αlphabet,"String, Implementation",0.803,833,549
117,"
Score : 200 points


Problem StatementA shop sells N kinds of fruits, Fruit 1, \ldots, N, at prices of p_1, \ldots, p_N yen per item, respectively. (Yen is the currency of Japan.)
Here, we will choose K kinds of fruits and buy one of each chosen kind. Find the minimum possible total price of those fruits.




Constraints
1 \leq K \leq N \leq 1000
1 \leq p_i \leq 1000
All values in input are integers.







InputInput is given from Standard Input in the following format:
N K
p_1 p_2 \ldots p_N





OutputPrint an integer representing the minimum possible total price of fruits.






Sample Input 15 3
50 100 80 120 80





Sample Output 1210

This shop sells Fruit 1, 2, 3, 4, and 5 for 50 yen, 100 yen, 80 yen, 120 yen, and 80 yen, respectively.
The minimum total price for three kinds of fruits is 50 + 80 + 80 = 210 yen when choosing Fruit 1, 3, and 5.





Sample Input 21 1
1000





Sample Output 21000


",Mix Juice,"Sorting, Array, Greedy Algorithm, Bruteforcing",0.896,669,566
118,"
Score : 300 points


Problem Statement1000000000000001 dogs suddenly appeared under the roof of Roger's house, all of which he decided to keep. The dogs had been numbered 1 through 1000000000000001, but he gave them new names, as follows:

the dogs numbered 1,2,\cdots,26 were respectively given the names a, b, ..., z;
the dogs numbered 27,28,29,\cdots,701,702  were respectively given the names aa, ab, ac, ..., zy, zz;
the dogs numbered 703,704,705,\cdots,18277,18278  were respectively given the names aaa, aab, aac, ..., zzy, zzz;
the dogs numbered 18279,18280,18281,\cdots,475253,475254  were respectively given the names aaaa, aaab, aaac, ..., zzzy, zzzz;
the dogs numbered 475255,475256,\cdots  were respectively given the names aaaaa, aaaab, ...;
and so on.

To sum it up, the dogs numbered 1, 2, \cdots were respectively given the following names:
a, b, ..., z, aa, ab, ..., az, ba, bb, ..., bz, ..., za, zb, ..., zz, aaa, aab, ..., aaz, aba, abb, ..., abz, ..., zzz, aaaa, ...
Now, Roger asks you:
""What is the name for the dog numbered N?""




Constraints
N is an integer.
 1 \leq N \leq 1000000000000001







InputInput is given from Standard Input in the following format:
N





OutputPrint the answer to Roger's question as a string consisting of lowercase English letters.






Sample Input 12





Sample Output 1b






Sample Input 227





Sample Output 2aa






Sample Input 3123456789





Sample Output 3jjddja


",One Quadrillion and One Dalmatians,"Mathematics, Arithmetic, Bruteforcing, String",0.256,1091,319
119,"
Score : 400 points


Problem StatementYou have a sequence A composed of N positive integers: A_{1}, A_{2}, \cdots, A_{N}.
You will now successively do the following Q operations:

In the i-th operation, you replace every element whose value is B_{i} with C_{i}.

For each i (1 \leq i \leq Q), find S_{i}: the sum of all elements in A just after the i-th operation.




Constraints
All values in input are integers.
 1 \leq N, Q, A_{i}, B_{i}, C_{i} \leq 10^{5} 
 B_{i} \neq C_{i} 







InputInput is given from Standard Input in the following format:
N
A_{1} A_{2} \cdots A_{N}
Q
B_{1} C_{1}
B_{2} C_{2}
\vdots
B_{Q} C_{Q}





OutputPrint Q integers S_{i} to Standard Output in the following format:
S_{1}
S_{2}
\vdots
S_{Q}

Note that S_{i} may not fit into a 32-bit integer.






Sample Input 14
1 2 3 4
3
1 2
3 4
2 4





Sample Output 111
12
16

Initially, the sequence A is 1,2,3,4.
After each operation, it becomes the following:

2, 2, 3, 4
2, 2, 4, 4
4, 4, 4, 4






Sample Input 24
1 1 1 1
3
1 2
2 1
3 5





Sample Output 28
4
4

Note that the sequence A may not contain an element whose value is B_{i}.





Sample Input 32
1 2
3
1 100
2 100
100 1000





Sample Output 3102
200
2000


",Replacing,"Counting, Arithmetic, Bruteforcing, Array",0.356,752,271
120,"
Score : 100 points


Problem StatementA string of length 6 consisting of lowercase English letters is said to be coffee-like if and only if its 3-rd and 4-th characters are equal and its 5-th and 6-th characters are also equal.
Given a string S, determine whether it is coffee-like.




Constraints
S is a string of length 6 consisting of lowercase English letters.







InputInput is given from Standard Input in the following format:
S





OutputIf S is coffee-like, print Yes; otherwise, print No.






Sample Input 1sippuu





Sample Output 1Yes

In sippuu, the 3-rd and 4-th characters are equal, and the 5-th and 6-th characters are also equal.





Sample Input 2iphone





Sample Output 2No






Sample Input 3coffee





Sample Output 3Yes


",Coffee,"String, Implementation",0.718,769,445
121,"
Score : 200 points


Problem StatementTakahashi loves gold coins. He gains 1000 happiness points for each 500-yen coin he has and gains 5 happiness points for each 5-yen coin he has. (Yen is the currency of Japan.)
Takahashi has X yen. If he exchanges his money so that he will gain the most happiness points, how many happiness points will he earn?
(We assume that there are six kinds of coins available: 500-yen, 100-yen, 50-yen, 10-yen, 5-yen, and 1-yen coins.)




Constraints
0 \leq X \leq 10^9
X is an integer.







InputInput is given from Standard Input in the following format:
X





OutputPrint the maximum number of happiness points that can be earned.






Sample Input 11024





Sample Output 12020

By exchanging his money so that he gets two 500-yen coins and four 5-yen coins, he gains 2020 happiness points, which is the maximum number of happiness points that can be earned.





Sample Input 20





Sample Output 20

He is penniless - or yenless.





Sample Input 31000000000





Sample Output 32000000000

He is a billionaire - in yen.

",Golden Coins,"Arithmetic, Greedy Algorithm",0.871,530,437
122,"
Score : 300 points


Problem StatementThere is a circular pond with a perimeter of K meters, and N houses around them.
The i-th house is built at a distance of A_i meters from the northmost point of the pond, measured clockwise around the pond.
When traveling between these houses, you can only go around the pond.
Find the minimum distance that needs to be traveled when you start at one of the houses and visit all the N houses.




Constraints
2 \leq K \leq 10^6
2 \leq N \leq 2 \times 10^5
0 \leq A_1 < ... < A_N < K
All values in input are integers.







InputInput is given from Standard Input in the following format:
K N
A_1 A_2 ... A_N





OutputPrint the minimum distance that needs to be traveled when you start at one of the houses and visit all the N houses.






Sample Input 120 3
5 10 15





Sample Output 110

If you start at the 1-st house and go to the 2-nd and 3-rd houses in this order, the total distance traveled will be 10.





Sample Input 220 3
0 5 15





Sample Output 210

If you start at the 2-nd house and go to the 1-st and 3-rd houses in this order, the total distance traveled will be 10.

",Traveling Salesman around Lake,"Sorting, Bruteforcing, Array, Mathematics",0.617,624,315
123,"
Score : 400 points


Problem Statement
We have an undirected graph G with N vertices numbered 1 to N and N edges as follows:

For each i=1,2,...,N-1, there is an edge between Vertex i and Vertex i+1.
There is an edge between Vertex X and Vertex Y.

For each k=1,2,...,N-1, solve the problem below:

Find the number of pairs of integers (i,j) (1 \leq i < j \leq N) such that the shortest distance between Vertex i and Vertex j in G is k.





Constraints

3 \leq N \leq 2 \times 10^3
1 \leq X,Y \leq N
X+1 < Y
All values in input are integers.







Input
Input is given from Standard Input in the following format:
N X Y





Output
For each k=1, 2, ..., N-1 in this order, print a line containing the answer to the problem.






Sample Input 15 2 4





Sample Output 15
4
1
0

The graph in this input is as follows:





There are five pairs (i,j) (1 \leq i < j \leq N) such that the shortest distance between Vertex i and Vertex j is 1: (1,2)\,,(2,3)\,,(2,4)\,,(3,4)\,,(4,5).

There are four pairs (i,j) (1 \leq i < j \leq N) such that the shortest distance between Vertex i and Vertex j is 2: (1,3)\,,(1,4)\,,(2,5)\,,(3,5).

There is one pair (i,j) (1 \leq i < j \leq N) such that the shortest distance between Vertex i and Vertex j is 3: (1,5).

There are no pairs (i,j) (1 \leq i < j \leq N) such that the shortest distance between Vertex i and Vertex j is 4.





Sample Input 23 1 3





Sample Output 23
0

The graph in this input is as follows:










Sample Input 37 3 7





Sample Output 37
8
4
2
0
0






Sample Input 410 4 8





Sample Output 410
12
10
8
4
1
0
0
0


",Line++,"Bruteforcing, Shortest Path, Graph Theory, Array, Mathematics",0.616,249,146
124,"
Score : 500 points


Problem StatementYou are going to eat X red apples and Y green apples.
You have A red apples of deliciousness p_1,p_2, \dots, p_A, B green apples of deliciousness q_1,q_2, \dots, q_B, and C colorless apples of deliciousness r_1,r_2, \dots, r_C.
Before eating a colorless apple, you can paint it red or green, and it will count as a red or green apple, respectively.
From the apples above, you will choose the apples to eat while making the sum of the deliciousness of the eaten apples as large as possible.
Find the maximum possible sum of the deliciousness of the eaten apples that can be achieved when optimally coloring zero or more colorless apples.




Constraints
1 \leq X \leq A \leq 10^5
1 \leq Y \leq B \leq 10^5
1 \leq C \leq 10^5
1 \leq p_i \leq 10^9
1 \leq q_i \leq 10^9
1 \leq r_i \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
X Y A B C
p_1 p_2 ... p_A
q_1 q_2 ... q_B
r_1 r_2 ... r_C





OutputPrint the maximum possible sum of the deliciousness of the eaten apples.






Sample Input 11 2 2 2 1
2 4
5 1
3





Sample Output 112

The maximum possible sum of the deliciousness of the eaten apples can be achieved as follows:

Eat the 2-nd red apple.
Eat the 1-st green apple.
Paint the 1-st colorless apple green and eat it.






Sample Input 22 2 2 2 2
8 6
9 1
2 1





Sample Output 225






Sample Input 32 2 4 4 4
11 12 13 14
21 22 23 24
1 2 3 4





Sample Output 374


",Red and Green Apples,"Sorting, Greedy Algorithm, Two-pointer, Array, Priority Queue",0.392,301,117
125,"
Score : 100 points


Problem Statement
We have N+M balls, each of which has an integer written on it.
It is known that:  

The numbers written on N of the balls are even.
The numbers written on M of the balls are odd.

Find the number of ways to choose two of the N+M balls (disregarding order) so that the sum of the numbers written on them is even.
It can be shown that this count does not depend on the actual values written on the balls.




Constraints

0 \leq N,M \leq 100
2 \leq N+M
All values in input are integers.







Input
Input is given from Standard Input in the following format:
N M





Output
Print the answer.






Sample Input 12 1





Sample Output 11

For example, let us assume that the numbers written on the three balls are 1,2,4.

If we choose the two balls with 1 and 2, the sum is odd;
If we choose the two balls with 1 and 4, the sum is odd;
If we choose the two balls with 2 and 4, the sum is even.

Thus, the answer is 1.





Sample Input 24 3





Sample Output 29






Sample Input 31 1





Sample Output 30






Sample Input 413 3





Sample Output 481






Sample Input 50 3





Sample Output 53


",The Number of Even Pairs,"Combinatorics, Arithmetic, Mathematics",0.782,469,331
126,"
Score : 200 points


Problem StatementA string S of an odd length is said to be a strong palindrome if and only if all of the following conditions are satisfied:

S is a palindrome.
Let N be the length of S. The string formed by the 1-st through ((N-1)/2)-th characters of S is a palindrome.
The string consisting of the (N+3)/2-st through N-th characters of S is a palindrome.

Determine whether S is a strong palindrome.




Constraints
S consists of lowercase English letters.
The length of S is an odd number between 3 and 99 (inclusive).







InputInput is given from Standard Input in the following format:
S





OutputIf S is a strong palindrome, print Yes;
otherwise, print No.






Sample Input 1akasaka





Sample Output 1Yes


S is akasaka.
The string formed by the 1-st through the 3-rd characters is aka.
The string formed by the 5-th through the 7-th characters is aka.
All of these are palindromes, so S is a strong palindrome.






Sample Input 2level





Sample Output 2No






Sample Input 3atcoder





Sample Output 3No


",String Palindrome,"Two-pointer, String, Boolean Operations On Geometric Objects",0.608,551,273
127,"
Score : 300 points


Problem StatementGiven is a positive integer L.
Find the maximum possible volume of a rectangular cuboid whose sum of the dimensions (not necessarily integers) is L.




Constraints
1 ≤ L ≤ 1000
L is an integer.







InputInput is given from Standard Input in the following format:
L





OutputPrint the maximum possible volume of a rectangular cuboid whose sum of the dimensions (not necessarily integers) is L.
Your output is considered correct if its absolute or relative error from our answer is at most 10^{-6}.






Sample Input 13





Sample Output 11.000000000000

For example, a rectangular cuboid whose dimensions are 0.8, 1, and 1.2 has a volume of 0.96.
On the other hand, if the dimensions are 1, 1, and 1, the volume of the rectangular cuboid is 1, which is greater.





Sample Input 2999





Sample Output 236926037.000000000000


",Maximum Volume,"Mathematics, Arithmetic",0.639,512,293
128,"
Score : 400 points


Problem Statement
We have N balls. The i-th ball has an integer A_i written on it.
For each k=1, 2, ..., N, solve the following problem and print the answer.  

Find the number of ways to choose two distinct balls (disregarding order) from the N-1 balls other than the k-th ball so that the integers written on them are equal.





Constraints

3 \leq N \leq 2 \times 10^5
1 \leq A_i \leq N
All values in input are integers.







Input
Input is given from Standard Input in the following format:
N
A_1 A_2 ... A_N





Output
For each k=1,2,...,N, print a line containing the answer.






Sample Input 15
1 1 2 1 2





Sample Output 12
2
3
2
3

Consider the case k=1 for example. The numbers written on the remaining balls are 1,2,1,2.
From these balls, there are two ways to choose two distinct balls so that the integers written on them are equal.
Thus, the answer for k=1 is 2.





Sample Input 24
1 2 3 4





Sample Output 20
0
0
0

No two balls have equal numbers written on them.





Sample Input 35
3 3 3 3 3





Sample Output 36
6
6
6
6

Any two balls have equal numbers written on them.





Sample Input 48
1 2 1 4 2 1 4 1





Sample Output 45
7
5
7
7
5
7
5


",Banned K,"Counting, Combinatorics, Arithmetic, Bruteforcing",0.253,582,180
129,"
Score : 400 points


Problem StatementTakahashi has a string S consisting of lowercase English letters.
Starting with this string, he will produce a new one in the procedure given as follows.
The procedure consists of Q operations. In Operation i (1 \leq i \leq Q), an integer T_i is provided, which means the following:


If T_i = 1: reverse the string S.


If T_i = 2: An integer F_i and a lowercase English letter C_i are additionally provided.

If F_i = 1 : Add C_i to the beginning of the string S.
If F_i = 2 : Add C_i to the end of the string S.



Help Takahashi by finding the final string that results from the procedure.




Constraints
1 \leq |S| \leq 10^5
S consists of lowercase English letters.
1 \leq Q \leq 2 \times 10^5
T_i = 1 or 2.
F_i = 1 or 2, if provided.
C_i is a lowercase English letter, if provided.







InputInput is given from Standard Input in the following format:
S
Q
Query_1
:
Query_Q

In the 3-rd through the (Q+2)-th lines, Query_i is one of the following:
1

which means T_i = 1, and:
2 F_i C_i

which means T_i = 2.




OutputPrint the resulting string.






Sample Input 1a
4
2 1 p
1
2 2 c
1





Sample Output 1cpa

There will be Q = 4 operations. Initially, S is a.


Operation 1: Add p at the beginning of S. S becomes pa.


Operation 2: Reverse S. S becomes ap.


Operation 3: Add c at the end of S. S becomes apc.


Operation 4: Reverse S. S becomes cpa.


Thus, the resulting string is cpa.





Sample Input 2a
6
2 2 a
2 1 b
1
2 2 c
1
1





Sample Output 2aabc

There will be Q = 6 operations. Initially, S is a.


Operation 1: S becomes aa.


Operation 2: S becomes baa.


Operation 3: S becomes aab.


Operation 4: S becomes aabc.


Operation 5: S becomes cbaa.


Operation 6: S becomes aabc.


Thus, the resulting string is aabc.





Sample Input 3y
1
2 1 x





Sample Output 3xy


",String Formation,"Bitmask, Two-pointer, String, Dynamic Programming",0.167,659,122
130,"
Score : 300 points


ProblemTakahashi, who is a novice in competitive programming, wants to learn M algorithms.
Initially, his understanding level of each of the M algorithms is 0.
Takahashi is visiting a bookstore, where he finds N books on algorithms.
The i-th book (1\leq i\leq N) is sold for C_i yen (the currency of Japan). If he buys and reads it, his understanding level of the j-th algorithm will increase by A_{i,j} for each j (1\leq j\leq M).
There is no other way to increase the understanding levels of the algorithms.
Takahashi's objective is to make his understanding levels of all the M algorithms X or higher. Determine whether this objective is achievable. If it is achievable, find the minimum amount of money needed to achieve it.




Constraints
All values in input are integers.
1\leq N, M\leq 12
1\leq X\leq 10^5
1\leq C_i \leq 10^5
0\leq A_{i, j} \leq 10^5







InputInput is given from Standard Input in the following format:
N M X
C_1 A_{1,1} A_{1,2} \cdots A_{1,M}
C_2 A_{2,1} A_{2,2} \cdots A_{2,M}
\vdots
C_N A_{N,1} A_{N,2} \cdots A_{N,M}





OutputIf the objective is not achievable, print -1; otherwise, print the minimum amount of money needed to achieve it.






Sample Input 13 3 10
60 2 2 4
70 8 7 9
50 2 3 9





Sample Output 1120

Buying the second and third books makes his understanding levels of all the algorithms 10 or higher, at the minimum cost possible.





Sample Input 23 3 10
100 3 1 4
100 1 5 9
100 2 6 5





Sample Output 2-1

Buying all the books is still not enough to make his understanding levels of all the algorithms 10 or higher.





Sample Input 38 5 22
100 3 7 5 3 1
164 4 5 2 7 8
334 7 2 7 2 9
234 4 7 2 8 2
541 5 4 3 3 6
235 4 8 6 9 7
394 3 6 1 6 2
872 8 4 3 7 2





Sample Output 31067


",Skill Up,"Bitmask, Bruteforcing, Array, Implementation, Data Structure",0.621,453,228
131,"
Score: 400 points


Problem Statement
The Kingdom of Takahashi has N towns, numbered 1 through N.
There is one teleporter in each town. The teleporter in Town i (1 \leq i \leq N) sends you to Town A_i.
Takahashi, the king, loves the positive integer K. The selfish king wonders what town he will be in if he starts at Town 1 and uses a teleporter exactly K times from there.
Help the king by writing a program that answers this question.




Constraints

2 \leq N \leq 2 \times 10^5
1 \leq A_i \leq N
1 \leq K \leq 10^{18}







Input
Input is given from Standard Input in the following format:
N K
A_1 A_2 \dots A_N





Output
Print the integer representing the town the king will be in if he starts at Town 1 and uses a teleporter exactly K times from there.






Sample Input 14 5
3 2 4 1





Sample Output 14

If we start at Town 1 and use the teleporter 5 times, our travel will be as follows: 1 \to 3 \to 4 \to 1 \to 3 \to 4.





Sample Input 26 727202214173249351
6 5 2 5 3 2





Sample Output 22


",Teleporter,"Graph Theory, Array, Arithmetic, Simulation, Boolean Operations On Geometric Objects",0.286,751,179
132,"
Score : 100 points


Problem StatementYou planned a trip using trains and buses.
The train fare will be A yen (the currency of Japan) if you buy ordinary tickets along the way, and B yen if you buy an unlimited ticket.
Similarly, the bus fare will be C yen if you buy ordinary tickets along the way, and D yen if you buy an unlimited ticket.
Find the minimum total fare when the optimal choices are made for trains and buses.




Constraints
1 \leq A \leq 1 000
1 \leq B \leq 1 000
1 \leq C \leq 1 000
1 \leq D \leq 1 000
All input values are integers.







InputInput is given from Standard Input in the following format:
A
B
C
D





OutputPrint the minimum total fare.






Sample Input 1600
300
220
420





Sample Output 1520

The train fare will be 600 yen if you buy ordinary tickets, and 300 yen if you buy an unlimited ticket.
Thus, the optimal choice for trains is to buy an unlimited ticket for 300 yen.
On the other hand, the optimal choice for buses is to buy ordinary tickets for 220 yen.
Therefore, the minimum total fare is 300 + 220 = 520 yen.





Sample Input 2555
555
400
200





Sample Output 2755






Sample Input 3549
817
715
603





Sample Output 31152


",Traveling Budget,"Implementation, Greedy Algorithm, Arithmetic",0.85,184,138
133,"
Score : 200 points


Problem StatementSome number of chocolate pieces were prepared for a training camp.
The camp had N participants and lasted for D days.
The i-th participant (1 \leq i \leq N) ate one chocolate piece on each of the following days in the camp: the 1-st day, the (A_i + 1)-th day, the (2A_i + 1)-th day, and so on.
As a result, there were X chocolate pieces remaining at the end of the camp. During the camp, nobody except the participants ate chocolate pieces.
Find the number of chocolate pieces prepared at the beginning of the camp.




Constraints
1 \leq N \leq 100
1 \leq D \leq 100
1 \leq X \leq 100
1 \leq A_i \leq 100 (1 \leq i \leq N)
All input values are integers.







InputInput is given from Standard Input in the following format:
N
D X
A_1
A_2
:
A_N





OutputFind the number of chocolate pieces prepared at the beginning of the camp.






Sample Input 13
7 1
2
5
10





Sample Output 18

The camp has 3 participants and lasts for 7 days.
Each participant eats chocolate pieces as follows:

The first participant eats one chocolate piece on Day 1, 3, 5 and 7, for a total of four.
The second participant eats one chocolate piece on Day 1 and 6, for a total of two.
The third participant eats one chocolate piece only on Day 1, for a total of one.

Since the number of pieces remaining at the end of the camp is one, the number of pieces prepared at the beginning of the camp is 1 + 4 + 2 + 1 = 8.





Sample Input 22
8 20
1
10





Sample Output 229






Sample Input 35
30 44
26
18
81
18
6





Sample Output 356


",Chocolate,"Bruteforcing, Arithmetic",0.856,174,140
134,"
Score : 300 points


Problem StatementThere are N sightseeing spots on the x-axis, numbered 1, 2, ..., N.
Spot i is at the point with coordinate A_i.
It costs |a - b| yen (the currency of Japan) to travel from a point with coordinate a to another point with coordinate b along the axis.
You planned a trip along the axis.
In this plan, you first depart from the point with coordinate 0, then visit the N spots in the order they are numbered, and finally return to the point with coordinate 0.
However, something came up just before the trip, and you no longer have enough time to visit all the N spots, so you decided to choose some i and cancel the visit to Spot i.
You will visit the remaining spots as planned in the order they are numbered.
You will also depart from and return to the point with coordinate 0 at the beginning and the end, as planned.
For each i = 1, 2, ..., N, find the total cost of travel during the trip when the visit to Spot i is canceled.




Constraints
2 \leq N \leq 10^5
-5000 \leq A_i \leq 5000 (1 \leq i \leq N)
All input values are integers.







InputInput is given from Standard Input in the following format:
N
A_1 A_2 ... A_N





OutputPrint N lines.
In the i-th line, print the total cost of travel during the trip when the visit to Spot i is canceled.






Sample Input 13
3 5 -1





Sample Output 112
8
10

Spot 1, 2 and 3 are at the points with coordinates 3, 5 and -1, respectively.
For each i, the course of the trip and the total cost of travel when the visit to Spot i is canceled, are as follows:

For i = 1, the course of the trip is 0 \rightarrow 5 \rightarrow -1 \rightarrow 0 and the total cost of travel is 5 + 6 + 1 = 12 yen.
For i = 2, the course of the trip is 0 \rightarrow 3 \rightarrow -1 \rightarrow 0 and the total cost of travel is 3 + 4 + 1 = 8 yen.
For i = 3, the course of the trip is 0 \rightarrow 3 \rightarrow 5 \rightarrow 0 and the total cost of travel is 3 + 2 + 5 = 10 yen.






Sample Input 25
1 1 1 2 0





Sample Output 24
4
4
2
4






Sample Input 36
-679 -2409 -3258 3095 -3291 -4462





Sample Output 321630
21630
19932
8924
21630
19288


",Traveling Plan,"Prefix sum, Array, Arithmetic, Bruteforcing, Mathematics",0.438,167,71
135,"
Score : 100 points


Problem StatementOn the Planet AtCoder, there are four types of bases: A, C, G and T. A bonds with T, and C bonds with G.
You are given a letter b as input, which is A, C, G or T. Write a program that prints the letter representing the base that bonds with the base b.




Constraints
b is one of the letters A, C, G and T.







InputInput is given from Standard Input in the following format:
b





OutputPrint the letter representing the base that bonds with the base b.






Sample Input 1A





Sample Output 1T






Sample Input 2G





Sample Output 2C


",Double Helix,"Implementation, String, Array",0.759,295,191
136,"
Score : 200 points


Problem StatementYou are given a string S consisting of uppercase English letters. Find the length of the longest ACGT string that is a substring (see Notes) of S.
Here, a ACGT string is a string that contains no characters other than A, C, G and T.




NotesA substring of a string T is a string obtained by removing zero or more characters from the beginning and the end of T.
For example, the substrings of ATCODER include TCO, AT, CODER, ATCODER and  (the empty string), but not AC.




Constraints
S is a string of length between 1 and 10 (inclusive).
Each character in S is an uppercase English letter.







InputInput is given from Standard Input in the following format:
S





OutputPrint the length of the longest ACGT string that is a substring of S.






Sample Input 1ATCODER





Sample Output 13

Among the ACGT strings that are substrings of ATCODER, the longest one is ATC.





Sample Input 2HATAGAYA





Sample Output 25

Among the ACGT strings that are substrings of HATAGAYA, the longest one is ATAGA.





Sample Input 3SHINJUKU





Sample Output 30

Among the ACGT strings that are substrings of SHINJUKU, the longest one is  (the empty string).

",ATCoder,"String, Implementation, Sliding Window, Data Structure",0.436,464,224
137,"
Score : 500 points


Problem Statement""Teishi-zushi"", a Japanese restaurant, is a plain restaurant with only one round counter. The outer circumference of the counter is C meters. Customers cannot go inside the counter.
Nakahashi entered Teishi-zushi, and he was guided to the counter. Now, there are N pieces of sushi (vinegared rice with seafood and so on) on the counter. The distance measured clockwise from the point where Nakahashi is standing to the point where the i-th sushi is placed, is x_i meters. Also, the i-th sushi has a nutritive value of v_i kilocalories.
Nakahashi can freely walk around the circumference of the counter. When he reach a point where a sushi is placed, he can eat that sushi and take in its nutrition (naturally, the sushi disappears). However, while walking, he consumes 1 kilocalories per meter.
Whenever he is satisfied, he can leave the restaurant from any place (he does not have to return to the initial place). On balance, at most how much nutrition can he take in before he leaves? That is, what is the maximum possible value of the total nutrition taken in minus the total energy consumed? Assume that there are no other customers, and no new sushi will be added to the counter. Also, since Nakahashi has plenty of nutrition in his body, assume that no matter how much he walks and consumes energy, he never dies from hunger.




Constraints
1 ≤ N ≤ 10^5
2 ≤ C ≤ 10^{14}
1 ≤ x_1 < x_2 < ... < x_N < C
1 ≤ v_i ≤ 10^9
All values in input are integers.





Subscores
300 points will be awarded for passing the test set satisfying N ≤ 100.







InputInput is given from Standard Input in the following format:
N C
x_1 v_1
x_2 v_2
:
x_N v_N





OutputIf Nakahashi can take in at most c kilocalories on balance before he leaves the restaurant, print c.






Sample Input 13 20
2 80
9 120
16 1





Sample Output 1191

There are three sushi on the counter with a circumference of 20 meters. If he walks two meters clockwise from the initial place, he can eat a sushi of 80 kilocalories. If he walks seven more meters clockwise, he can eat a sushi of 120 kilocalories. If he leaves now, the total nutrition taken in is 200 kilocalories, and the total energy consumed is 9 kilocalories, thus he can take in 191 kilocalories on balance, which is the largest possible value.





Sample Input 23 20
2 80
9 1
16 120





Sample Output 2192

The second and third sushi have been swapped. Again, if he walks two meters clockwise from the initial place, he can eat a sushi of 80 kilocalories. If he walks six more meters counterclockwise this time, he can eat a sushi of 120 kilocalories. If he leaves now, the total nutrition taken in is 200 kilocalories, and the total energy consumed is 8 kilocalories, thus he can take in 192 kilocalories on balance, which is the largest possible value.





Sample Input 31 100000000000000
50000000000000 1





Sample Output 30

Even though the only sushi is so far that it does not fit into a 32-bit integer, its nutritive value is low, thus he should immediately leave without doing anything.





Sample Input 415 10000000000
400000000 1000000000
800000000 1000000000
1900000000 1000000000
2400000000 1000000000
2900000000 1000000000
3300000000 1000000000
3700000000 1000000000
3800000000 1000000000
4000000000 1000000000
4100000000 1000000000
5200000000 1000000000
6600000000 1000000000
8000000000 1000000000
9300000000 1000000000
9700000000 1000000000





Sample Output 46500000000

All these sample inputs above are included in the test set for the partial score.

",Static Sushi,"Prefix sum, Dyanmic Programming, Two-pointer, Arithmetic, Prefix sum, Array, Greedy Algorithm",0.179,66,16
138,"
Score : 300 points


Problem Statement""Pizza At"", a fast food chain, offers three kinds of pizza: ""A-pizza"", ""B-pizza"" and ""AB-pizza"". A-pizza and B-pizza are completely different pizzas, and AB-pizza is one half of A-pizza and one half of B-pizza combined together. The prices of one A-pizza, B-pizza and AB-pizza are A yen, B yen and C yen (yen is the currency of Japan), respectively.
Nakahashi needs to prepare X A-pizzas and Y B-pizzas for a party tonight. He can only obtain these pizzas by directly buying A-pizzas and B-pizzas, or buying two AB-pizzas and then rearrange them into one A-pizza and one B-pizza. At least how much money does he need for this? It is fine to have more pizzas than necessary by rearranging pizzas.




Constraints
1 ≤ A, B, C ≤ 5000
1 ≤ X, Y ≤ 10^5
All values in input are integers.







InputInput is given from Standard Input in the following format:
A B C X Y





OutputPrint the minimum amount of money required to prepare X A-pizzas and Y B-pizzas.






Sample Input 11500 2000 1600 3 2





Sample Output 17900

It is optimal to buy four AB-pizzas and rearrange them into two A-pizzas and two B-pizzas, then buy additional one A-pizza.





Sample Input 21500 2000 1900 3 2





Sample Output 28500

It is optimal to directly buy three A-pizzas and two B-pizzas.





Sample Input 31500 2000 500 90000 100000





Sample Output 3100000000

It is optimal to buy 200000 AB-pizzas and rearrange them into 100000 A-pizzas and 100000 B-pizzas. We will have 10000 more A-pizzas than necessary, but that is fine.

",Half and Half,"Bruteforcing, Greedy Algorithm, Mathematics, Arithmetic",0.636,274,146
139,"
Score : 100 points


Problem StatementYou have decided to give an allowance to your child depending on the outcome of the game that he will play now.
The game is played as follows:

There are three ""integer panels"", each with a digit between 1 and 9 (inclusive) printed on it, and one ""operator panel"" with a + printed on it.
The player should construct a formula of the form X + Y, by arranging the four panels from left to right. (The operator panel should not be placed at either end of the formula.)
Then, the amount of the allowance will be equal to the resulting value of the formula.

Given the values A, B and C printed on the integer panels used in the game, find the maximum possible amount of the allowance.




Constraints
All values in input are integers.
1 \leq A, B, C \leq 9







InputInput is given from Standard Input in the following format:
A B C





OutputPrint the maximum possible amount of the allowance.






Sample Input 11 5 2





Sample Output 153

The amount of the allowance will be 53 when the panels are arranged as 52+1, and this is the maximum possible amount.





Sample Input 29 9 9





Sample Output 2108






Sample Input 36 6 7





Sample Output 382


",Maximize the Formula,"Sorting, String, Arithmetic",0.772,217,154
140,"
Score : 300 points


Problem StatementYou are given strings S and T consisting of lowercase English letters.
You can perform the following operation on S any number of times:
Operation: Choose two distinct lowercase English letters c_1 and c_2, then replace every occurrence of c_1 with c_2, and every occurrence of c_2 with c_1.
Determine if S and T can be made equal by performing the operation zero or more times.




Constraints
1 \leq |S| \leq 2 \times 10^5
|S| = |T|
S and T consists of lowercase English letters.







InputInput is given from Standard Input in the following format:
S
T





OutputIf S and T can be made equal, print Yes; otherwise, print No.






Sample Input 1azzel
apple





Sample Output 1Yes

azzel can be changed to apple, as follows:

Choose e as c_1 and l as c_2. azzel becomes azzle.
Choose z as c_1 and p as c_2. azzle becomes apple.






Sample Input 2chokudai
redcoder





Sample Output 2No

No sequences of operation can change chokudai to redcoder.





Sample Input 3abcdefghijklmnopqrstuvwxyz
ibyhqfrekavclxjstdwgpzmonu





Sample Output 3Yes


",String Transformation,"Set / Map, Hashing, Mathematics, Counting, Sorting, Bruteforcing",0.384,221,81
141,"
Score : 100 points


Problem StatementThere are N students in a school.
We will divide these students into some groups, and in each group they will discuss some themes.
You think that groups consisting of two or less students cannot have an effective discussion, so you want to have as many groups consisting of three or more students as possible.
Divide the students so that the number of groups consisting of three or more students is maximized.




Constraints
1 \leq N \leq 1000
All input values are integers.







InputInput is given from Standard Input in the following format:
N





OutputIf you can form at most x groups consisting of three or more students, print x.






Sample Input 18





Sample Output 12

For example, you can form a group of three students and another of five students.





Sample Input 22





Sample Output 20

Sometimes you cannot form any group consisting of three or more students, regardless of how you divide the students.





Sample Input 39





Sample Output 33


",Grouping 2,"Arithmetic, Greedy Algorithm",0.864,178,143
142,"
Score : 200 points


Problem StatementIn Japan, people make offerings called hina arare, colorful crackers, on March 3.
We have a bag that contains N hina arare. (From here, we call them arare.)
It is known that the bag either contains arare in three colors: pink, white and green, or contains arare in four colors: pink, white, green and yellow.
We have taken out the arare in the bag one by one, and the color of the i-th arare was S_i, where colors are represented as follows - pink: P, white: W, green: G, yellow: Y.
If the number of colors of the arare in the bag was three, print Three; if the number of colors was four, print Four.




Constraints
1 \leq N \leq 100
S_i is P, W, G or Y.
There always exist i, j and k such that S_i=P, S_j=W and S_k=G.







InputInput is given from Standard Input in the following format:
N
S_1 S_2 ... S_N





OutputIf the number of colors of the arare in the bag was three, print Three; if the number of colors was four, print Four.






Sample Input 16
G W Y P Y W





Sample Output 1Four

The bag contained arare in four colors, so you should print Four.





Sample Input 29
G W W G P W P G G





Sample Output 2Three

The bag contained arare in three colors, so you should print Three.





Sample Input 38
P Y W G Y W Y Y





Sample Output 3Four


",Hina Arare,"Bruteforcing, Implementation, Set / Map",0.821,201,144
143,"
Score : 300 points


Problem StatementThere are N people. The name of the i-th person is S_i.
We would like to choose three people so that the following conditions are met:

The name of every chosen person begins with M, A, R, C or H.
There are no multiple people whose names begin with the same letter.

How many such ways are there to choose three people, disregarding order?
Note that the answer may not fit into a 32-bit integer type.




Constraints
1 \leq N \leq 10^5
S_i consists of uppercase English letters.
1 \leq |S_i| \leq 10
S_i \neq S_j (i \neq j)







InputInput is given from Standard Input in the following format:
N
S_1
:
S_N





OutputIf there are x ways to choose three people so that the given conditions are met, print x.






Sample Input 15
MASHIKE
RUMOI
OBIRA
HABORO
HOROKANAI





Sample Output 12

We can choose three people with the following names:


MASHIKE, RUMOI, HABORO


MASHIKE, RUMOI, HOROKANAI


Thus, we have two ways.





Sample Input 24
ZZ
ZZZ
Z
ZZZZZZZZZZ





Sample Output 20

Note that there may be no ways to choose three people so that the given conditions are met.





Sample Input 35
CHOKUDAI
RNG
MAKOTO
AOKI
RINGO





Sample Output 37


",March,"Counting, Backtracking, Bruteforcing, Combinatorics, Data Structures",0.294,250,97
144,"
Score : 100 points


Problem StatementWe have weather records at AtCoder Town for some consecutive three days. A string of length 3, S, represents the records - if the i-th character is S, it means it was sunny on the i-th day; if that character is R, it means it was rainy on that day.
Find the maximum number of consecutive rainy days in this period.




Constraints
|S| = 3
Each character of S is S or R.







InputInput is given from Standard Input in the following format:
S





OutputPrint the maximum number of consecutive rainy days in the period.






Sample Input 1RRS





Sample Output 12

We had rain on the 1-st and 2-nd days in the period. Here, the maximum number of consecutive rainy days is 2, so we should print 2.





Sample Input 2SSS





Sample Output 20

It was sunny throughout the period. We had no rainy days, so we should print 0.





Sample Input 3RSR





Sample Output 31

We had rain on the 1-st and 3-rd days - two ""streaks"" of one rainy day, so we should print 1.

",Rainy Season,"Bruteforcing, Implementation, String, Counting, Data Structure",0.687,792,474
145,"
Score : 100 points


Problem StatementThere are a total of A + B cats and dogs.
Among them, A are known to be cats, but the remaining B are not known to be either cats or dogs.
Determine if it is possible that there are exactly X cats among these A + B animals.




Constraints
1 \leq A \leq 100
1 \leq B \leq 100
1 \leq X \leq 200
All values in input are integers.







InputInput is given from Standard Input in the following format:
A B X





OutputIf it is possible that there are exactly X cats, print YES; if it is impossible, print NO.






Sample Input 13 5 4





Sample Output 1YES

If there are one cat and four dogs among the B = 5 animals, there are X = 4 cats in total.





Sample Input 22 2 6





Sample Output 2NO

Even if all of the B = 2 animals are cats, there are less than X = 6 cats in total.





Sample Input 35 3 2





Sample Output 3NO

Even if all of the B = 3 animals are dogs, there are more than X = 2 cats in total.

",Cats and Dogs,Implementation,0.49,338,150
146,"
Score : 100 points


Problem StatementYou will turn on the air conditioner if, and only if, the temperature of the room is 30 degrees Celsius or above.
The current temperature of the room is X degrees Celsius. Will you turn on the air conditioner?




Constraints
-40 \leq X \leq 40
X is an integer.







InputInput is given from Standard Input in the following format:
X





OutputPrint Yes if you will turn on the air conditioner; print No otherwise.






Sample Input 125





Sample Output 1No






Sample Input 230





Sample Output 2Yes


",Air Conditioner,Implementation,0.79,752,541
147,"
Score : 200 points


Problem StatementWe have N points in the two-dimensional plane. The coordinates of the i-th point are (X_i,Y_i).
Among them, we are looking for the points such that the distance from the origin is at most D. How many such points are there?
We remind you that the distance between the origin and the point (p, q) can be represented as \sqrt{p^2+q^2}.




Constraints
1 \leq N \leq 2\times 10^5
0 \leq D \leq 2\times 10^5
|X_i|,|Y_i| \leq 2\times 10^5
All values in input are integers.







InputInput is given from Standard Input in the following format:
N D
X_1 Y_1
\vdots
X_N Y_N





OutputPrint an integer representing the number of points such that the distance from the origin is at most D.






Sample Input 14 5
0 5
-2 4
3 4
4 -4





Sample Output 13

The distance between the origin and each of the given points is as follows:

\sqrt{0^2+5^2}=5
\sqrt{(-2)^2+4^2}=4.472\ldots
\sqrt{3^2+4^2}=5
\sqrt{4^2+(-4)^2}=5.656\ldots

Thus, we have three points such that the distance from the origin is at most 5.





Sample Input 212 3
1 1
1 1
1 1
1 1
1 2
1 3
2 1
2 2
2 3
3 1
3 2
3 3





Sample Output 27

Multiple points may exist at the same coordinates.





Sample Input 320 100000
14309 -32939
-56855 100340
151364 25430
103789 -113141
147404 -136977
-37006 -30929
188810 -49557
13419 70401
-88280 165170
-196399 137941
-176527 -61904
46659 115261
-153551 114185
98784 -6820
94111 -86268
-30401 61477
-55056 7872
5901 -163796
138819 -185986
-69848 -96669





Sample Output 36


",Distance,"Bruteforcing, Arithmetic, Implementation, Counting",0.73,800,519
148,"
Score : 200 points


Problem StatementTakahashi is participating in a programming contest called AXC002, and he has just submitted his code to Problem A.
The problem has N test cases.
For each test case i (1\leq i \leq N), you are given a string S_i representing the verdict for that test case. Find the numbers of test cases for which the verdict is AC, WA, TLE, and RE, respectively.
See the Output section for the output format.




Constraints
1 \leq N \leq 10^5
S_i is AC, WA, TLE, or RE.







InputInput is given from Standard Input in the following format:
N
S_1
\vdots
S_N





OutputLet C_0, C_1, C_2, and C_3 be the numbers of test cases for which the verdict is AC, WA, TLE, and RE, respectively. Print the following:
AC x C_0
WA x C_1
TLE x C_2
RE x C_3







Sample Input 16
AC
TLE
AC
AC
WA
TLE





Sample Output 1AC x 3
WA x 1
TLE x 2
RE x 0

We have 3, 1, 2, and 0 test case(s) for which the verdict is AC, WA, TLE, and RE, respectively.





Sample Input 210
AC
AC
AC
AC
AC
AC
AC
AC
AC
AC





Sample Output 2AC x 10
WA x 0
TLE x 0
RE x 0


",Judge Status Summary,"Bruteforcing, String, Implementation",0.74,901,594
149,"
Score : 100 points


Problem StatementWe will buy a product for N yen (the currency of Japan) at a shop.
If we use only 1000-yen bills to pay the price, how much change will we receive?
Assume we use the minimum number of bills required.




Constraints
1 \leq N \leq 10000
N is an integer.







InputInput is given from Standard Input in the following format:
N





OutputPrint the amount of change as an integer.






Sample Input 11900





Sample Output 1100

We will use two 1000-yen bills to pay the price and receive 100 yen in change.





Sample Input 23000





Sample Output 20

We can pay the exact price.

",Payment,"Arithmetic, Implementation",0.635,1069,614
150,"
Score : 300 points


Problem StatementWe have a grid of H rows and W columns of squares. The color of the square at the i-th row from the top and the j-th column from the left (1 \leq i \leq H, 1 \leq j \leq W) is given to you as a character c_{i,j}: the square is white if c_{i,j} is ., and black if c_{i,j} is #.
Consider doing the following operation:

Choose some number of rows (possibly zero), and some number of columns (possibly zero). Then, paint red all squares in the chosen rows and all squares in the chosen columns.

You are given a positive integer K. How many choices of rows and columns result in exactly K black squares remaining after the operation? Here, we consider two choices different when there is a row or column chosen in only one of those choices.




Constraints
1 \leq H, W \leq 6
1 \leq K \leq HW
c_{i,j} is . or #.







InputInput is given from Standard Input in the following format:
H W K
c_{1,1}c_{1,2}...c_{1,W}
c_{2,1}c_{2,2}...c_{2,W}
:
c_{H,1}c_{H,2}...c_{H,W}





OutputPrint an integer representing the number of choices of rows and columns satisfying the condition.






Sample Input 12 3 2
..#
###





Sample Output 15

Five choices below satisfy the condition.

The 1-st row and 1-st column
The 1-st row and 2-nd column
The 1-st row and 3-rd column
The 1-st and 2-nd column
The 3-rd column






Sample Input 22 3 4
..#
###





Sample Output 21

One choice, which is choosing nothing, satisfies the condition.





Sample Input 32 2 3
##
##





Sample Output 30






Sample Input 46 6 8
..##..
.#..#.
#....#
######
#....#
#....#





Sample Output 4208


",H and V,"Bitmask, Bruteforcing, Array, Counting, Simulation",0.843,301,241
151,"
Score : 100 points


Problem StatementWe have a cord whose length is a positive integer. We will perform the following condition until the length of the cord becomes at most 2:

Operation:
  Cut the rope at two positions to obtain three cords, each with a length of a positive integer.
  Among these, discard one with the longest length and one with the shortest length, and keep the remaining one.

Let f(N) be the maximum possible number of times to perform this operation, starting with a cord with the length N.
You are given a positive integer X. Find the maximum integer N such that f(N)=X.




Constraints
1 \leq X \leq 40







InputThe input is given from Standard Input in the following format:
X





OutputPrint the value of the maximum integer N such that f(N)=X.






Sample Input 12





Sample Output 114


",Trichotomy,"Mathematics, Recursion, Binary Search",0.5,14,8
152,"

				Max Score: 350 Points 

Problem Statement
					There are N buildings along the line. The i-th building from the left is colored in color i, and its height is currently a_i meters. 
					Chokudai is a mayor of the city, and he loves colorful thigs. And now he wants to see at least K buildings from the left. 

					You can increase height of buildings, but it costs 1 yens to increase 1 meters. It means you cannot make building that height is not integer. 
					You cannot decrease height of buildings. 
					Calculate the minimum cost of satisfying Chokudai's objective. 
					Note: ""Building i can see from the left"" means there are no j exists that (height of building j) ≥ (height of building i) and j < i. 





Input Format

N K
a_1 a_2 a_3 ... a_N





Output Format
						Print the minimum cost in one line. In the end put a line break.


Constraints

1 ≤ K ≤ N ≤ 15
1 ≤ a_i ≤ 10^9



Scoring
						Subtask 1 [120 points] 

N = K

						Subtask 2 [90 points] 

N ≤ 5
a_i ≤ 7

						Subtask 3 [140 points] 

There are no additional constraints.






Sample Input 1

5 5
3949 3774 3598 3469 3424



Sample Output 1

1541

					The optimal solution is (height of buildings from the left) = [3949, 3950, 3951, 3952, 3953].




Sample Input 2

5 3
7 4 2 6 4



Sample Output 2

7

					The optimal solution is (height of buildings from the left) = [7, 8, 2, 9, 4].


",Buildings are Colorful!,"Bitmask, Dynamic Programming, Greedy Algorithm, Dyanmic Programming, Arithmetic",0.455,25,10
153,"
Score : 100 points


Problem StatementThere are N stones, numbered 1, 2, \ldots, N.
For each i (1 \leq i \leq N), the height of Stone i is h_i.
There is a frog who is initially on Stone 1.
He will repeat the following action some number of times to reach Stone N:

If the frog is currently on Stone i, jump to Stone i + 1 or Stone i + 2. Here, a cost of |h_i - h_j| is incurred, where j is the stone to land on.

Find the minimum possible total cost incurred before the frog reaches Stone N.




Constraints
All values in input are integers.
2 \leq N \leq 10^5
1 \leq h_i \leq 10^4







InputInput is given from Standard Input in the following format:
N
h_1 h_2 \ldots h_N





OutputPrint the minimum possible total cost incurred.






Sample Input 14
10 30 40 20





Sample Output 130

If we follow the path 1 → 2 → 4, the total cost incurred would be |10 - 30| + |30 - 20| = 30.





Sample Input 22
10 10





Sample Output 20

If we follow the path 1 → 2, the total cost incurred would be |10 - 10| = 0.





Sample Input 36
30 10 60 10 60 50





Sample Output 340

If we follow the path 1 → 3 → 5 → 6, the total cost incurred would be |30 - 60| + |60 - 60| + |60 - 50| = 40.

",Frog 1,"Dyanmic Programming, Array, Arithmetic, Recursion",0.42,1570,645
154,"
Score : 100 points


Problem StatementThere are N stones, numbered 1, 2, \ldots, N.
For each i (1 \leq i \leq N), the height of Stone i is h_i.
There is a frog who is initially on Stone 1.
He will repeat the following action some number of times to reach Stone N:

If the frog is currently on Stone i, jump to one of the following: Stone i + 1, i + 2, \ldots, i + K. Here, a cost of |h_i - h_j| is incurred, where j is the stone to land on.

Find the minimum possible total cost incurred before the frog reaches Stone N.




Constraints
All values in input are integers.
2 \leq N \leq 10^5
1 \leq K \leq 100
1 \leq h_i \leq 10^4







InputInput is given from Standard Input in the following format:
N K
h_1 h_2 \ldots h_N





OutputPrint the minimum possible total cost incurred.






Sample Input 15 3
10 30 40 50 20





Sample Output 130

If we follow the path 1 → 2 → 5, the total cost incurred would be |10 - 30| + |30 - 20| = 30.





Sample Input 23 1
10 20 10





Sample Output 220

If we follow the path 1 → 2 → 3, the total cost incurred would be |10 - 20| + |20 - 10| = 20.





Sample Input 32 100
10 10





Sample Output 30

If we follow the path 1 → 2, the total cost incurred would be |10 - 10| = 0.





Sample Input 410 4
40 10 20 70 80 10 20 70 80 60





Sample Output 440

If we follow the path 1 → 4 → 8 → 10, the total cost incurred would be |40 - 70| + |70 - 70| + |70 - 60| = 40.

",Frog 2,"Dyanmic Programming, Dynamic Programming, Array, Arithmetic, Bruteforcing",0.745,881,585
155,"
Score : 100 points


Problem StatementTaro's summer vacation starts tomorrow, and he has decided to make plans for it now.
The vacation consists of N days.
For each i (1 \leq i \leq N), Taro will choose one of the following activities and do it on the i-th day:

A: Swim in the sea. Gain a_i points of happiness.
B: Catch bugs in the mountains. Gain b_i points of happiness.
C: Do homework at home. Gain c_i points of happiness.

As Taro gets bored easily, he cannot do the same activities for two or more consecutive days.
Find the maximum possible total points of happiness that Taro gains.




Constraints
All values in input are integers.
1 \leq N \leq 10^5
1 \leq a_i, b_i, c_i \leq 10^4







InputInput is given from Standard Input in the following format:
N
a_1 b_1 c_1
a_2 b_2 c_2
:
a_N b_N c_N





OutputPrint the maximum possible total points of happiness that Taro gains.






Sample Input 13
10 40 70
20 50 80
30 60 90





Sample Output 1210

If Taro does activities in the order C, B, C, he will gain 70 + 50 + 90 = 210 points of happiness.





Sample Input 21
100 10 1





Sample Output 2100






Sample Input 37
6 7 8
8 8 3
2 5 2
7 8 6
4 6 8
2 3 4
7 5 1





Sample Output 346

Taro should do activities in the order C, A, B, A, C, B, A.

",Vacation,"Dyanmic Programming, Array, Recursion, Greedy Algorithm",0.76,774,557
156,"
Score : 100 points


Problem StatementThere are N items, numbered 1, 2, \ldots, N.
For each i (1 \leq i \leq N), Item i has a weight of w_i and a value of v_i.
Taro has decided to choose some of the N items and carry them home in a knapsack.
The capacity of the knapsack is W, which means that the sum of the weights of items taken must be at most W.
Find the maximum possible sum of the values of items that Taro takes home.




Constraints
All values in input are integers.
1 \leq N \leq 100
1 \leq W \leq 10^5
1 \leq w_i \leq W
1 \leq v_i \leq 10^9







InputInput is given from Standard Input in the following format:
N W
w_1 v_1
w_2 v_2
:
w_N v_N





OutputPrint the maximum possible sum of the values of items that Taro takes home.






Sample Input 13 8
3 30
4 50
5 60





Sample Output 190

Items 1 and 3 should be taken.
Then, the sum of the weights is 3 + 5 = 8, and the sum of the values is 30 + 60 = 90.





Sample Input 25 5
1 1000000000
1 1000000000
1 1000000000
1 1000000000
1 1000000000





Sample Output 25000000000

The answer may not fit into a 32-bit integer type.





Sample Input 36 15
6 5
5 6
6 4
6 6
3 5
7 2





Sample Output 317

Items 2, 4 and 5 should be taken.
Then, the sum of the weights is 5 + 6 + 3 = 14, and the sum of the values is 6 + 6 + 5 = 17.

",Knapsack 1,"Knapsack, Dyanmic Programming, Implementation, Arithmetic",0.667,990,563
157,"
Score : 100 points


Problem StatementThere are N items, numbered 1, 2, \ldots, N.
For each i (1 \leq i \leq N), Item i has a weight of w_i and a value of v_i.
Taro has decided to choose some of the N items and carry them home in a knapsack.
The capacity of the knapsack is W, which means that the sum of the weights of items taken must be at most W.
Find the maximum possible sum of the values of items that Taro takes home.




Constraints
All values in input are integers.
1 \leq N \leq 100
1 \leq W \leq 10^9
1 \leq w_i \leq W
1 \leq v_i \leq 10^3







InputInput is given from Standard Input in the following format:
N W
w_1 v_1
w_2 v_2
:
w_N v_N





OutputPrint the maximum possible sum of the values of items that Taro takes home.






Sample Input 13 8
3 30
4 50
5 60





Sample Output 190

Items 1 and 3 should be taken.
Then, the sum of the weights is 3 + 5 = 8, and the sum of the values is 30 + 60 = 90.





Sample Input 21 1000000000
1000000000 10





Sample Output 210






Sample Input 36 15
6 5
5 6
6 4
6 6
3 5
7 2





Sample Output 317

Items 2, 4 and 5 should be taken.
Then, the sum of the weights is 5 + 6 + 3 = 14, and the sum of the values is 6 + 6 + 5 = 17.

",Knapsack 2,"Dyanmic Programming, Knapsack, Dynamic Programming",0.382,810,295
158,"
Score : 100 points


Problem StatementYou are given strings s and t.
Find one longest string that is a subsequence of both s and t.




NotesA subsequence of a string x is the string obtained by removing zero or more characters from x and concatenating the remaining characters without changing the order.




Constraints
s and t are strings consisting of lowercase English letters.
1 \leq |s|, |t| \leq 3000







InputInput is given from Standard Input in the following format:
s
t





OutputPrint one longest string that is a subsequence of both s and t.
If there are multiple such strings, any of them will be accepted.






Sample Input 1axyb
abyxb





Sample Output 1axb

The answer is axb or ayb; either will be accepted.





Sample Input 2aa
xayaz





Sample Output 2aa






Sample Input 3a
z





Sample Output 3

The answer is  (an empty string).





Sample Input 4abracadabra
avadakedavra





Sample Output 4aaadara


",LCS,"Dynamic Programming, Bruteforcing, Backtracking, String",0.509,814,330
159,"
Score : 100 points


Problem StatementThere is a grid with H horizontal rows and W vertical columns.
Let (i, j) denote the square at the i-th row from the top and the j-th column from the left.
For each i and j (1 \leq i \leq H, 1 \leq j \leq W), Square (i, j) is described by a character a_{i, j}.
If a_{i, j} is ., Square (i, j) is an empty square; if a_{i, j} is #, Square (i, j) is a wall square.
It is guaranteed that Squares (1, 1) and (H, W) are empty squares.
Taro will start from Square (1, 1) and reach (H, W) by repeatedly moving right or down to an adjacent empty square.
Find the number of Taro's paths from Square (1, 1) to (H, W).
As the answer can be extremely large, find the count modulo 10^9 + 7.




Constraints
H and W are integers.
2 \leq H, W \leq 1000
a_{i, j} is . or #.
Squares (1, 1) and (H, W) are empty squares.







InputInput is given from Standard Input in the following format:
H W
a_{1, 1}\ldotsa_{1, W}
:
a_{H, 1}\ldotsa_{H, W}





OutputPrint the number of Taro's paths from Square (1, 1) to (H, W), modulo 10^9 + 7.






Sample Input 13 4
...#
.#..
....





Sample Output 13

There are three paths as follows:






Sample Input 25 2
..
#.
..
.#
..





Sample Output 20

There may be no paths.





Sample Input 35 5
..#..
.....
#...#
.....
..#..





Sample Output 324






Sample Input 420 20
....................
....................
....................
....................
....................
....................
....................
....................
....................
....................
....................
....................
....................
....................
....................
....................
....................
....................
....................
....................





Sample Output 4345263555

Be sure to print the count modulo 10^9 + 7.

",Grid 1,"Dyanmic Programming, Grid Graph, Arithmetic",0.73,430,293
160,"
Score: 400 points


Problem Statement
Takahashi became a pastry chef and opened a shop La Confiserie d'ABC to celebrate AtCoder Beginner Contest 100.
The shop sells N kinds of cakes.
Each kind of cake has three parameters ""beauty"", ""tastiness"" and ""popularity"". The i-th kind of cake has the beauty of x_i, the tastiness of y_i and the popularity of z_i.
These values may be zero or negative.
Ringo has decided to have M pieces of cakes here. He will choose the set of cakes as follows:

Do not have two or more pieces of the same kind of cake.
Under the condition above, choose the set of cakes to maximize (the absolute value of the total beauty) + (the absolute value of the total tastiness)  + (the absolute value of the total popularity).

Find the maximum possible value of (the absolute value of the total beauty) + (the absolute value of the total tastiness) + (the absolute value of the total popularity) for the set of cakes that Ringo chooses.




Constraints

N is an integer between 1 and 1 \ 000 (inclusive).
M is an integer between 0 and N (inclusive).
x_i, y_i, z_i \ (1 \leq i \leq N) are integers between -10 \ 000 \ 000 \ 000 and 10 \ 000 \ 000 \ 000 (inclusive).







Input
Input is given from Standard Input in the following format:
N M
x_1 y_1 z_1
x_2 y_2 z_2
 :  :
x_N y_N z_N





Output
Print the maximum possible value of (the absolute value of the total beauty) + (the absolute value of the total tastiness) + (the absolute value of the total popularity) for the set of cakes that Ringo chooses.






Sample Input 15 3
3 1 4
1 5 9
2 6 5
3 5 8
9 7 9





Sample Output 156

Consider having the 2-nd, 4-th and 5-th kinds of cakes. The total beauty, tastiness and popularity will be as follows:

Beauty: 1 + 3 + 9 = 13
Tastiness: 5 + 5 + 7 = 17
Popularity: 9 + 8 + 9 = 26

The value (the absolute value of the total beauty) + (the absolute value of the total tastiness) + (the absolute value of the total popularity) here is 13 + 17 + 26 = 56. This is the maximum value.





Sample Input 25 3
1 -2 3
-4 5 -6
7 -8 -9
-10 11 -12
13 -14 15





Sample Output 254

Consider having the 1-st, 3-rd and 5-th kinds of cakes. The total beauty, tastiness and popularity will be as follows:

Beauty: 1 + 7 + 13 = 21
Tastiness: (-2) + (-8) + (-14) = -24
Popularity: 3 + (-9) + 15 = 9

The value (the absolute value of the total beauty) + (the absolute value of the total tastiness) + (the absolute value of the total popularity) here is 21 + 24 + 9 = 54. This is the maximum value.





Sample Input 310 5
10 -80 21
23 8 38
-94 28 11
-26 -2 18
-69 72 79
-26 -86 -54
-72 -50 59
21 65 -32
40 -94 87
-62 18 82





Sample Output 3638

If we have the 3-rd, 4-th, 5-th, 7-th and 10-th kinds of cakes, the total beauty, tastiness and popularity will be -323, 66 and 249, respectively.
The value (the absolute value of the total beauty) + (the absolute value of the total tastiness) + (the absolute value of the total popularity) here is 323 + 66 + 249 = 638. This is the maximum value.





Sample Input 43 2
2000000000 -9000000000 4000000000
7000000000 -5000000000 3000000000
6000000000 -1000000000 8000000000





Sample Output 430000000000

The values of the beauty, tastiness and popularity of the cakes and the value to be printed may not fit into 32-bit integers.

",Patisserie ABC,"Bitmask, Sorting, Greedy Algorithm, Array",0.603,117,60
161,"
Score : 500 points


Problem StatementSnuke, who loves animals, built a zoo.
There are N animals in this zoo. They are conveniently numbered 1 through N, and arranged in a circle.
The animal numbered i (2≤i≤N-1) is adjacent to the animals numbered i-1 and i+1. Also, the animal numbered 1 is adjacent to the animals numbered 2 and N, and the animal numbered N is adjacent to the animals numbered N-1 and 1.
There are two kinds of animals in this zoo: honest sheep that only speak the truth, and lying wolves that only tell lies.
Snuke cannot tell the difference between these two species, and asked each animal the following question: ""Are your neighbors of the same species?"" The animal numbered i answered s_i. Here, if s_i is o, the animal said that the two neighboring animals are of the same species, and if s_i is x, the animal said that the two neighboring animals are of different species.
More formally, a sheep answered o if the two neighboring animals are both sheep or both wolves, and answered x otherwise.
Similarly, a wolf answered x if the two neighboring animals are both sheep or both wolves, and answered o otherwise.
Snuke is wondering whether there is a valid assignment of species to the animals that is consistent with these responses. If there is such an assignment, show one such assignment. Otherwise, print -1.




Constraints
3 ≤ N ≤ 10^{5}
s is a string of length N consisting of o and x.







InputThe input is given from Standard Input in the following format:
N
s





OutputIf there does not exist an valid assignment that is consistent with s, print -1.
Otherwise, print an string t in the following format. The output is considered correct if the assignment described by t is consistent with s.

t is a string of length N consisting of S and W.
If t_i is S, it indicates that the animal numbered i is a sheep. If t_i is W, it indicates that the animal numbered i is a wolf.







Sample Input 16
ooxoox





Sample Output 1SSSWWS

For example, if the animals numbered 1, 2, 3, 4, 5 and 6 are respectively a sheep, sheep, sheep, wolf, wolf, and sheep, it is consistent with their responses. Besides, there is another valid assignment of species: a wolf, sheep, wolf, sheep, wolf and wolf.
Let us remind you: if the neiboring animals are of the same species, a sheep answers o and a wolf answers x. If the neiboring animals are of different species, a sheep answers x and a wolf answers o.








Sample Input 23
oox





Sample Output 2-1

Print -1 if there is no valid assignment of species.





Sample Input 310
oxooxoxoox





Sample Output 3SSWWSSSWWS


",Menagerie,"Bruteforcing, Boolean Operations On Geometric Objects, Arithmetic, Dynamic Programming, 2-sat",0.417,47,22
162,"
Score : 500 points


Problem StatementThere are N integers, A_1, A_2, ..., A_N, written on a blackboard.
We will repeat the following operation N-1 times so that we have only one integer on the blackboard.

Choose two integers x and y on the blackboard and erase these two integers. Then, write a new integer x-y.

Find the maximum possible value of the final integer on the blackboard and a sequence of operations that maximizes the final integer.




Constraints
2 \leq N \leq 10^5
-10^4 \leq A_i \leq 10^4
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
A_1 A_2 ... A_N





OutputPrint the maximum possible value M of the final integer on the blackboard, and a sequence of operations x_i, y_i that maximizes the final integer, in the format below.
Here x_i and y_i represent the integers x and y chosen in the i-th operation, respectively.
If there are multiple sequences of operations that maximize the final integer, any of them will be accepted.
M
x_1 y_1
:
x_{N-1} y_{N-1}







Sample Input 13
1 -1 2





Sample Output 14
-1 1
2 -2

If we choose x = -1 and y = 1 in the first operation, the set of integers written on the blackboard becomes (-2, 2).
Then, if we choose x = 2 and y = -2 in the second operation, the set of integers written on the blackboard becomes (4).
In this case, we have 4 as the final integer. We cannot end with a greater integer, so the answer is 4.





Sample Input 23
1 1 1





Sample Output 21
1 1
1 0


",Successive Subtraction,"Sorting, Greedy Algorithm, Two-pointer, Simulation, Bitmask",0.206,95,17
163,"
Score : 500 points


Problem StatementAlice and Brown loves games. Today, they will play the following game.
In this game, there are two piles initially consisting of X and Y stones, respectively.
Alice and Bob alternately perform the following operation, starting from Alice:

Take 2i stones from one of the piles. Then, throw away i of them, and put the remaining i in the other pile. Here, the integer i (1≤i) can be freely chosen as long as there is a sufficient number of stones in the pile.

The player who becomes unable to perform the operation, loses the game.
Given X and Y, determine the winner of the game, assuming that both players play optimally.




Constraints
0 ≤ X, Y ≤ 10^{18}







InputInput is given from Standard Input in the following format:
X Y





OutputPrint the winner: either Alice or Brown.






Sample Input 12 1





Sample Output 1Brown

Alice can do nothing but taking two stones from the pile containing two stones. As a result, the piles consist of zero and two stones, respectively. Then, Brown will take the two stones, and the piles will consist of one and zero stones, respectively. Alice will be unable to perform the operation anymore, which means Brown's victory.





Sample Input 25 0





Sample Output 2Alice






Sample Input 30 0





Sample Output 3Brown






Sample Input 44 8





Sample Output 4Alice


",Alice&Brown,"Game Theory, Mathematics, Arithmetic, Boolean Operations On Geometric Objects",0.643,21,14
164,"
Score : 500 points


Problem StatementIn CODE FESTIVAL XXXX, there are N+1 participants from all over the world, including Takahashi.
Takahashi checked and found that the time gap (defined below) between the local times in his city and the i-th person's city was D_i hours.
The time gap between two cities is defined as follows. For two cities A and B, if the local time in city B is d o'clock at the moment when the local time in city A is 0 o'clock, then the time gap between these two cities is defined to be min(d,24-d) hours.
Here, we are using 24-hour notation.
That is, the local time in the i-th person's city is either d o'clock or 24-d o'clock at the moment when the local time in Takahashi's city is 0 o'clock, for example.
Then, for each pair of two people chosen from the N+1 people, he wrote out the time gap between their cities. Let the smallest time gap among them be s hours.
Find the maximum possible value of s.




Constraints
1 \leq N \leq 50
0 \leq D_i \leq 12
All input values are integers.







InputInput is given from Standard Input in the following format:
N
D_1 D_2 ... D_N





OutputPrint the maximum possible value of s.






Sample Input 13
7 12 8





Sample Output 14

For example, consider the situation where it is 7, 12 and 16 o'clock in each person's city at the moment when it is 0 o'clock in Takahashi's city. In this case, the time gap between the second and third persons' cities is 4 hours.





Sample Input 22
11 11





Sample Output 22






Sample Input 31
0





Sample Output 30

Note that Takahashi himself is also a participant.

",Time Gap,"Bitmask, Sorting, Arithmetic, Backtracking",0.625,19,8
165,"
Score : 300 points


Problem StatementHow many integer sequences A_1,A_2,\ldots,A_N of length N satisfy all of the following conditions?

0 \leq A_i \leq 9
There exists some i such that A_i=0 holds.
There exists some i such that A_i=9 holds.

The answer can be very large, so output it modulo 10^9 + 7.




Constraints
1 \leq N \leq 10^6
N is an integer.







InputInput is given from Standard Input in the following format:
N





OutputPrint the answer modulo 10^9 + 7.






Sample Input 12





Sample Output 12

Two sequences \{0,9\} and \{9,0\} satisfy all conditions.





Sample Input 21





Sample Output 20






Sample Input 3869121





Sample Output 32511445


",Ubiquity,"Arithmetic, Inclusion And Exclusion, Exponentiation By Squaring, Combinatorics",0.508,562,239
166,"
Score : 400 points


Problem StatementGiven is an integer S.
Find how many sequences there are whose terms are all integers greater than or equal to 3, and whose sum is equal to S.
The answer can be very large, so output it modulo 10^9 + 7.




Constraints
1 \leq S \leq 2000
All values in input are integers.







InputInput is given from Standard Input in the following format:
S





OutputPrint the answer.






Sample Input 17





Sample Output 13

3 sequences satisfy the condition: \{3,4\}, \{4,3\} and \{7\}.





Sample Input 22





Sample Output 20

There are no sequences that satisfy the condition.





Sample Input 31729





Sample Output 3294867501


",Redistribution,"Dyanmic Programming, Combinatorics, Mathematics, Arithmetic, Bruteforcing",0.82,228,182
167,"
Score : 500 points


Problem StatementYou are given a positive integer L in base two.
How many pairs of non-negative integers (a, b) satisfy the following conditions?

a + b \leq L
a + b = a \mbox{ XOR } b

Since there can be extremely many such pairs, print the count modulo 10^9 + 7.
 What is XOR?
The XOR of integers A and B, A \mbox{ XOR } B, is defined as follows:

When A \mbox{ XOR } B is written in base two, the digit in the 2^k's place (k \geq 0) is 1 if either A or B, but not both, has 1 in the 2^k's place, and 0 otherwise.

For example, 3 \mbox{ XOR } 5 = 6. (In base two: 011 \mbox{ XOR } 101 = 110.)
",Sum Equals Xor,"Boolean Operations On Geometric Objects, Dyanmic Programming, Arithmetic",0.44,50,20
168,"
Score : 200 points


Problem StatementToday is August 24, one of the five Product Days in a year.
A date m-d (m is the month, d is the date) is called a Product Day when d is a two-digit number, and all of the following conditions are satisfied (here d_{10} is the tens digit of the day and d_1 is the ones digit of the day):

d_1 \geq 2
d_{10} \geq 2
d_1 \times d_{10} = m

Takahashi wants more Product Days, and he made a new calendar called Takahashi Calendar where a year consists of M month from Month 1 to Month M, and each month consists of D days from Day 1 to Day D.
In Takahashi Calendar, how many Product Days does a year have?




Constraints
All values in input are integers.
1 \leq M \leq 100
1 \leq D \leq 99







InputInput is given from Standard Input in the following format:
M D





OutputPrint the number of Product Days in a year in Takahashi Calender.






Sample Input 115 40





Sample Output 110

There are 10 Product Days in a year, as follows (m-d denotes Month m, Day d):

4-22
6-23
6-32
8-24
9-33
10-25
12-26
12-34
14-27
15-35






Sample Input 212 31





Sample Output 25






Sample Input 31 1





Sample Output 30


",Takahashi Calendar,"Bruteforcing, Arithmetic, Implementation, Counting",0.744,146,84
169,"
Score: 600 points


Problem Statement
AtCoder's head office consists of N rooms numbered 1 to N. For any two rooms, there is a direct passage connecting these rooms.
For security reasons, Takahashi the president asked you to set a level for every passage, which is a positive integer and must satisfy the following condition:

For each room i\ (1 \leq i \leq N), if we leave Room i, pass through some passages whose levels are all equal and get back to Room i, the number of times we pass through a passage is always even.

Your task is to set levels to the passages so that the highest level of a passage is minimized.




Constraints

N is an integer between 2 and 500 (inclusive).







Input
Input is given from Standard Input in the following format:
N





Output
Print one way to set levels to the passages so that the objective is achieved, as follows:
a_{1,2} a_{1,3} ... a_{1,N}
a_{2,3} ... a_{2,N}
.
.
.
a_{N-1,N}

Here a_{i,j} is the level of the passage connecting Room i and Room j.
If there are multiple solutions, any of them will be accepted.






Sample Input 13





Sample Output 11 2
1

The following image describes this output:

For example, if we leave Room 2, traverse the path 2 \to 3 \to 2 \to 3 \to 2 \to 1 \to 2 while only passing passages of level 1 and get back to Room 2, we pass through a passage six times.

",Classified,"Bipartite Graph, Graph Theory, Bitmask, Number Theory, Bruteforcing",0.5,9,4
170,"
Score : 700 points


Problem StatementThere are N stones arranged in a row. The i-th stone from the left is painted in the color C_i.
Snuke will perform the following operation zero or more times:

Choose two stones painted in the same color. Repaint all the stones between them, with the color of the chosen stones.

Find the number of possible final sequences of colors of the stones, modulo 10^9+7.




Constraints
1 \leq N \leq 2\times 10^5
1 \leq C_i \leq 2\times 10^5(1\leq i\leq N)
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
C_1
:
C_N





OutputPrint the number of possible final sequences of colors of the stones, modulo 10^9+7.






Sample Input 15
1
2
1
2
2





Sample Output 13

We can make three sequences of colors of stones, as follows:

(1,2,1,2,2), by doing nothing.
(1,1,1,2,2), by choosing the first and third stones to perform the operation.
(1,2,2,2,2), by choosing the second and fourth stones to perform the operation.






Sample Input 26
4
2
5
4
2
4





Sample Output 25






Sample Input 37
1
3
1
2
3
3
2





Sample Output 35


",Reversi,"Dyanmic Programming, Array, Arithmetic, Prefix sum, Hashing",0.516,55,26
171,"
Score : 500 points


Problem StatementWe have a deck consisting of N cards. Each card has an integer written on it. The integer on the i-th card from the top is a_i.
Two people X and Y will play a game using this deck. Initially, X has a card with Z written on it in his hand, and Y has a card with W written on it in his hand. Then, starting from X, they will alternately perform the following action:

Draw some number of cards from the top of the deck. Then, discard the card in his hand and keep the last drawn card instead. Here, at least one card must be drawn.

The game ends when there is no more card in the deck. The score of the game is the absolute difference of the integers written on the cards in the two players' hand.
X will play the game so that the score will be maximized, and Y will play the game so that the score will be minimized. What will be the score of the game?




Constraints
All input values are integers.
1 \leq N \leq 2000
1 \leq Z, W, a_i \leq 10^9







InputInput is given from Standard Input in the following format:
N Z W
a_1 a_2 ... a_N





OutputPrint the score.






Sample Input 13 100 100
10 1000 100





Sample Output 1900

If X draws two cards first, Y will draw the last card, and the score will be |1000 - 100| = 900.





Sample Input 23 100 1000
10 100 100





Sample Output 2900

If X draws all the cards first, the score will be |1000 - 100| = 900.





Sample Input 35 1 1
1 1 1 1 1





Sample Output 30






Sample Input 41 1 1
1000000000





Sample Output 4999999999


",ABS,"Game Theory, Greedy Algorithm, Mathematics, Boolean Operations On Geometric Objects",0.345,77,19
172,"
Score : 600 points


Problem StatementWe have a sequence of length N consisting of non-negative integers. Consider performing the following operation on this sequence until the largest element in this sequence becomes N-1 or smaller.

Determine the largest element in the sequence (if there is more than one, choose one). Decrease the value of this element by N, and increase each of the other elements by 1.

It can be proved that the largest element in the sequence becomes N-1 or smaller after a finite number of operations.
You are given an integer K. Find an integer sequence a_i such that the number of times we will perform the above operation is exactly K. It can be shown that there is always such a sequence under the constraints on input and output in this problem.




Constraints
0 ≤ K ≤ 50 \times 10^{16}







InputInput is given from Standard Input in the following format:
K





OutputPrint a solution in the following format:
N
a_1 a_2 ... a_N

Here, 2 ≤ N ≤ 50 and 0 ≤ a_i ≤ 10^{16} + 1000 must hold.






Sample Input 10





Sample Output 14
3 3 3 3






Sample Input 21





Sample Output 23
1 0 3






Sample Input 32





Sample Output 32
2 2

The operation will be performed twice: [2, 2] -> [0, 3] -> [1, 1].





Sample Input 43





Sample Output 47
27 0 0 0 0 0 0






Sample Input 51234567894848





Sample Output 510
1000 193 256 777 0 1 1192 1234567891011 48 425


",Decrease (Contestant ver.),"Arithmetic, Constructive, Mathematics, Array",0.25,43,14
173,"
Score : 400 points


Problem StatementTakahashi will play a game using a piece on an array of squares numbered 1, 2, \cdots, N. Square i has an integer C_i written on it. Also, he is given a permutation of 1, 2, \cdots, N: P_1, P_2, \cdots, P_N.
Now, he will choose one square and place the piece on that square. Then, he will make the following move some number of times between 1 and K (inclusive):

In one move, if the piece is now on Square i (1 \leq i \leq N), move it to Square P_i. Here, his score increases by C_{P_i}.

Help him by finding the maximum possible score at the end of the game. (The score is 0 at the beginning of the game.)




Constraints
2 \leq N \leq 5000
1 \leq K \leq 10^9
1 \leq P_i \leq N
P_i \neq i
P_1, P_2, \cdots, P_N are all different.
-10^9 \leq C_i \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N K
P_1 P_2 \cdots P_N
C_1 C_2 \cdots C_N





OutputPrint the maximum possible score at the end of the game.






Sample Input 15 2
2 4 5 1 3
3 4 -10 -8 8





Sample Output 18

When we start at some square of our choice and make at most two moves, we have the following options:

If we start at Square 1, making one move sends the piece to Square 2, after which the score is 4. Making another move sends the piece to Square 4, after which the score is 4 + (-8) = -4.
If we start at Square 2, making one move sends the piece to Square 4, after which the score is -8. Making another move sends the piece to Square 1, after which the score is -8 + 3 = -5.
If we start at Square 3, making one move sends the piece to Square 5, after which the score is 8. Making another move sends the piece to Square 3, after which the score is 8 + (-10) = -2.
If we start at Square 4, making one move sends the piece to Square 1, after which the score is 3. Making another move sends the piece to Square 2, after which the score is 3 + 4 = 7.
If we start at Square 5, making one move sends the piece to Square 3, after which the score is -10. Making another move sends the piece to Square 5, after which the score is -10 + 8 = -2.

The maximum score achieved is 8.





Sample Input 22 3
2 1
10 -7





Sample Output 213






Sample Input 33 3
3 1 2
-1000 -2000 -3000





Sample Output 3-1000

We have to make at least one move.





Sample Input 410 58
9 1 6 7 8 4 3 2 10 5
695279662 988782657 -119067776 382975538 -151885171 -177220596 -169777795 37619092 389386780 980092719





Sample Output 429507023469

The absolute value of the answer may be enormous.

",Moving Piece,"Permutation Cycle Decomposition, Graph Traversal, Prefix sum, Arithmetic, Mathematics, Bruteforcing",0.179,520,89
174,"
Score : 400 points


Problem StatementThere are N cities. There are also K roads and L railways, extending between the cities.
The i-th road bidirectionally connects the p_i-th and q_i-th cities, and the i-th railway bidirectionally connects the r_i-th and s_i-th cities.
No two roads connect the same pair of cities. Similarly, no two railways connect the same pair of cities.
We will say city A and B are connected by roads if city B is reachable from city A by traversing some number of roads. Here, any city is considered to be connected to itself by roads.
We will also define connectivity by railways similarly.
For each city, find the number of the cities connected to that city by both roads and railways.




Constraints
2 ≦ N ≦ 2*10^5
1 ≦ K, L≦ 10^5
1 ≦ p_i, q_i, r_i, s_i ≦ N
p_i < q_i
r_i < s_i
When i ≠ j, (p_i, q_i) ≠ (p_j, q_j)
When i ≠ j, (r_i, s_i) ≠ (r_j, s_j)







InputThe input is given from Standard Input in the following format:
N K L
p_1 q_1
:
p_K q_K
r_1 s_1
:
r_L s_L





OutputPrint N integers. The i-th of them should represent the number of the cities connected to the i-th city by both roads and railways.






Sample Input 14 3 1
1 2
2 3
3 4
2 3





Sample Output 11 2 2 1

All the four cities are connected to each other by roads.
By railways, only the second and third cities are connected. Thus, the answers for the cities are 1, 2, 2 and 1, respectively.





Sample Input 24 2 2
1 2
2 3
1 4
2 3





Sample Output 21 2 2 1






Sample Input 37 4 4
1 2
2 3
2 5
6 7
3 5
4 5
3 4
6 7





Sample Output 31 1 2 1 2 2 2


",Connectivity,"Disjoint Set, Graph Theory, Graph Traversal, Set / Map, Hashing, Implementation",0.19,69,19
175,"
Score : 100 points


Problem StatementPrint the K-th element of the following sequence of length 32:
1, 1, 1, 2, 1, 2, 1, 5, 2, 2, 1, 5, 1, 2, 1, 14, 1, 5, 1, 5, 2, 2, 1, 15, 2, 2, 5, 4, 1, 4, 1, 51





Constraints
1 \leq K \leq 32
All values in input are integers.







InputInput is given from Standard Input in the following format:
K





OutputPrint the K-th element.






Sample Input 16





Sample Output 12

The 6-th element is 2.





Sample Input 227





Sample Output 25

The 27-th element is 5.

",Kth Term,"Array, Implementation",0.815,272,179
176,"
Score : 400 points


Problem StatementIn this problem, we only consider strings consisting of lowercase English letters.
Strings s and t are said to be isomorphic when the following conditions are satisfied:

|s| = |t| holds.
For every pair i, j, one of the following holds:
s_i = s_j and t_i = t_j.
s_i \neq s_j and t_i \neq t_j.



For example, abcac and zyxzx are isomorphic, while abcac and ppppp are not.
A string s is said to be in normal form when the following condition is satisfied:

For every string t that is isomorphic to s, s \leq t holds. Here \leq denotes lexicographic comparison.

For example, abcac is in normal form, but zyxzx is not since it is isomorphic to abcac, which is lexicographically smaller than zyxzx.
You are given an integer N.
Print all strings of length N that are in normal form, in lexicographically ascending order.




Constraints
1 \leq N \leq 10
All values in input are integers.







InputInput is given from Standard Input in the following format:
N





OutputAssume that there are K strings of length N that are in normal form: w_1, \ldots, w_K in lexicographical order.
Output should be in the following format:
w_1
:
w_K







Sample Input 11





Sample Output 1a






Sample Input 22





Sample Output 2aa
ab


",String Equivalence,"Backtracking, Sorting, Enumeration, String, Recursion",0.4,110,47
177,"
Score : 600 points


Problem StatementWe have a sequence of length N consisting of non-negative integers. Consider performing the following operation on this sequence until the largest element in this sequence becomes N-1 or smaller. (The operation is the same as the one in Problem D.)

Determine the largest element in the sequence (if there is more than one, choose one). Decrease the value of this element by N, and increase each of the other elements by 1.

It can be proved that the largest element in the sequence becomes N-1 or smaller after a finite number of operations.
You are given the sequence a_i. Find the number of times we will perform the above operation.




Constraints
2 ≤ N ≤ 50
0 ≤ a_i ≤ 10^{16} + 1000







InputInput is given from Standard Input in the following format:
N
a_1 a_2 ... a_N





OutputPrint the number of times the operation will be performed.






Sample Input 14
3 3 3 3





Sample Output 10






Sample Input 23
1 0 3





Sample Output 21






Sample Input 32
2 2





Sample Output 32






Sample Input 47
27 0 0 0 0 0 0





Sample Output 43






Sample Input 510
1000 193 256 777 0 1 1192 1234567891011 48 425





Sample Output 51234567894848


",Decrease (Judge ver.),"Sorting, Arithmetic, Bruteforcing, Greedy Algorithm",0.714,31,19
178,"
Score : 400 points


Problem StatementThere are N cells arranged in a row, numbered 1, 2, \ldots, N from left to right.
Tak lives in these cells and is currently on Cell 1. He is trying to reach Cell N by using the procedure described below.
You are given an integer K that is less than or equal to 10, and K non-intersecting segments [L_1, R_1], [L_2, R_2], \ldots, [L_K, R_K].
Let S be the union of these K segments.
Here, the segment [l, r] denotes the set consisting of all integers i that satisfy l \leq i \leq r.

When you are on Cell i, pick an integer d from S and move to Cell i + d. You cannot move out of the cells.

To help Tak, find the number of ways to go to Cell N, modulo 998244353.




Constraints
2 \leq N \leq 2 \times 10^5
1 \leq K \leq \min(N, 10)
1 \leq L_i \leq R_i \leq N
[L_i, R_i] and [L_j, R_j] do not intersect (i \neq j) 
All values in input are integers.







InputInput is given from Standard Input in the following format:
N K
L_1 R_1
L_2 R_2
:
L_K R_K





OutputPrint the number of ways for Tak to go from Cell 1 to Cell N, modulo 998244353.






Sample Input 15 2
1 1
3 4





Sample Output 14

The set S is the union of the segment [1, 1] and the segment [3, 4], therefore S = \{ 1, 3, 4 \} holds.
There are 4 possible ways to get to Cell 5:

1 \to 2 \to 3 \to 4 \to 5,
1 \to 2 \to 5,
1 \to 4 \to 5 and
1 \to 5.






Sample Input 25 2
3 3
5 5





Sample Output 20

Because S = \{ 3, 5 \} holds, you cannot reach to Cell 5.
Print 0.





Sample Input 35 1
1 2





Sample Output 35






Sample Input 460 3
5 8
1 3
10 15





Sample Output 4221823067

Note that you have to print the answer modulo 998244353.

",Leaping Tak,"Dyanmic Programming, Prefix sum, Arithmetic, Recursion, Greedy Algorithm",0.341,262,92
179,"
Score : 500 points


Problem StatementLet us denote by f(x, m) the remainder of the Euclidean division of x by m.
Let A be the sequence that is defined by the initial value A_1=X and the recurrence relation A_{n+1} = f(A_n^2, M).
Find \displaystyle{\sum_{i=1}^N A_i}.




Constraints
1 \leq N \leq 10^{10}
0 \leq X < M \leq 10^5
All values in input are integers.







InputInput is given from Standard Input in the following format:
N X M





OutputPrint \displaystyle{\sum_{i=1}^N A_i}.






Sample Input 16 2 1001





Sample Output 11369

The sequence A begins 2,4,16,256,471,620,\ldots Therefore, the answer is 2+4+16+256+471+620=1369.





Sample Input 21000 2 16





Sample Output 26

The sequence A begins 2,4,0,0,\ldots Therefore, the answer is 6.





Sample Input 310000000000 10 99959





Sample Output 3492443256176507


",Sequence Sum,"Arithmetic, Graph Theory, Prefix sum, Mathematics",0.402,219,86
180,"Score : 300 pointsProblem StatementThere are N cities on a 2D plane. The coordinate of the i-th city is (x_i, y_i). Here (x_1, x_2, \dots, x_N) and (y_1, y_2, \dots, y_N) are both permuations of (1, 2, \dots, N).For each k = 1,2,\dots,N, find the answer to the following question:Rng is in City k.
Rng can perform the following move arbitrarily many times:move to another city that has a smaller x-coordinate and a smaller y-coordinate, or a larger x-coordinate and a larger y-coordinate, than the city he is currently in.How many cities (including City k) are reachable from City k?Constraints1 \leq N \leq 200,000(x_1, x_2, \dots, x_N) is a permutation of (1, 2, \dots, N).(y_1, y_2, \dots, y_N) is a permutation of (1, 2, \dots, N).All values in input are integers.InputInput is given from Standard Input in the following format:N
x_1 y_1
x_2 y_2
:
x_N y_N
OutputPrint N lines. In i-th line print the answer to the question when k = i.Sample Input 14
1 4
2 3
3 1
4 2
Sample Output 11
1
2
2
Rng can reach City 4 from City 3, or conversely City 3 from City 4.Sample Input 27
6 4
4 3
3 5
7 1
2 7
5 2
1 6
Sample Output 23
3
1
1
2
3
2
",Reachable Towns,"Sorting, Disjoint Set, Binary Search Tree, Set / Map, Graph Theory",0.077,131,25
181,"
Score : 600 points


Problem StatementGiven is an integer N.
Find the minimum possible positive integer k such that (1+2+\cdots+k) is a multiple of N.
It can be proved that such a positive integer k always exists.




Constraints
1 \leq N \leq 10^{15}
All values in input are integers.







InputInput is given from Standard Input in the following format:
N





OutputPrint the answer in a line.






Sample Input 111





Sample Output 110

1+2+\cdots+10=55 holds and 55 is indeed a multple of N=11.
There are no positive integers k \leq 9 that satisfy the condition, so the answer is k = 10.





Sample Input 220200920





Sample Output 21100144


",Sum is Multiple,"Prime Factorization, Bitmask, Arithmetic, Mathematics, Number Theory",0.258,80,27
182,"
Score : 600 points


Problem StatementWe have N points numbered 1 to N arranged in a line in this order.
Takahashi decides to make an undirected graph, using these points as the vertices.
In the beginning, the graph has no edge. Takahashi will do M operations to add edges in this graph.
The i-th operation is as follows:

The operation uses integers L_i and R_i between 1 and N (inclusive), and a positive integer C_i. For every pair of integers (s, t) such that L_i \leq s < t \leq R_i, add an edge of length C_i between Vertex s and Vertex t.

The integers L_1, ..., L_M, R_1, ..., R_M, C_1, ..., C_M are all given as input.
Takahashi wants to solve the shortest path problem in the final graph obtained. Find the length of the shortest path from Vertex 1 to Vertex N in the final graph.




Constraints
2 \leq N \leq 10^5
1 \leq M \leq 10^5
1 \leq L_i < R_i \leq N
1 \leq C_i \leq 10^9







InputInput is given from Standard Input in the following format:
N M
L_1 R_1 C_1
:
L_M R_M C_M





OutputPrint the length of the shortest path from Vertex 1 to Vertex N in the final graph.
If there is no shortest path, print -1 instead.






Sample Input 14 3
1 3 2
2 4 3
1 4 6





Sample Output 15

We have an edge of length 2 between Vertex 1 and Vertex 2, and an edge of length 3 between Vertex 2 and Vertex 4, so there is a path of length 5 between Vertex 1 and Vertex 4.





Sample Input 24 2
1 2 1
3 4 2





Sample Output 2-1






Sample Input 310 7
1 5 18
3 4 8
1 3 5
4 7 10
5 9 8
6 10 5
8 10 3





Sample Output 328


",Shortest Path on a Line,"Dyanmic Programming, Sorting, Segment Tree With Lazy Propagation, Shortest Path, Difference Array, Greedy Algorithm, Priority Queue",0.417,47,10
183,"
Score : 100 points


Problem StatementHow many ways are there to choose two distinct positive integers totaling N, disregarding the order?




Constraints
1 \leq N \leq 10^6
N is an integer.







InputInput is given from Standard Input in the following format:
N





OutputPrint the answer.






Sample Input 14





Sample Output 11

There is only one way to choose two distinct integers totaling 4: to choose 1 and 3. (Choosing 3 and 1 is not considered different from this.)





Sample Input 2999999





Sample Output 2499999


",Sum of Two Integers,"Arithmetic, Mathematics, Counting, Bruteforcing",0.753,122,72
184,"
Score : 400 points


Problem StatementJoisino is planning to record N TV programs with recorders.
The TV can receive C channels numbered 1 through C.
The i-th program that she wants to record will be broadcast from time s_i to time t_i (including time s_i but not t_i) on Channel c_i.
Here, there will never be more than one program that are broadcast on the same channel at the same time.
When the recorder is recording a channel from time S to time T (including time S but not T), it cannot record other channels from time S-0.5 to time T (including time S-0.5 but not T).
Find the minimum number of recorders required to record the channels so that all the N programs are completely recorded.




Constraints
1≤N≤10^5
1≤C≤30
1≤s_i<t_i≤10^5
1≤c_i≤C
If c_i=c_j and i≠j, either t_i≤s_j or s_i≥t_j.
All input values are integers.







InputInput is given from Standard Input in the following format:
N C
s_1 t_1 c_1
:
s_N t_N c_N





OutputWhen the minimum required number of recorders is x, print the value of x.






Sample Input 13 2
1 7 2
7 8 1
8 12 1





Sample Output 12

Two recorders can record all the programs, for example, as follows:

With the first recorder, record Channel 2 from time 1 to time 7. The first program will be recorded. Note that this recorder will be unable to record other channels from time 0.5 to time 7.
With the second recorder, record Channel 1 from time 7 to time 12. The second and third programs will be recorded. Note that this recorder will be unable to record other channels from time 6.5 to time 12.






Sample Input 23 4
1 3 2
3 4 4
1 4 3





Sample Output 23

There may be a channel where there is no program to record.





Sample Input 39 4
56 60 4
33 37 2
89 90 3
32 43 1
67 68 3
49 51 3
31 32 3
70 71 1
11 12 3





Sample Output 32


",Recording,"Greedy Algorithm, Value / Coordinate Compression, Prefix sum, Bruteforcing, Sorting",0.321,97,34
185,"
Score : 500 points


Problem StatementWe have a grid of squares with N rows and M columns. Let (i, j) denote the square at the i-th row from the top and j-th column from the left. We will choose K of the squares and put a piece on each of them.
If we place the K pieces on squares (x_1, y_1), (x_2, y_2), ..., and (x_K, y_K), the cost of this arrangement is computed as:
\sum_{i=1}^{K-1} \sum_{j=i+1}^K (|x_i - x_j| + |y_i - y_j|)
Find the sum of the costs of all possible arrangements of the pieces. Since this value can be tremendous, print it modulo 10^9+7.
We consider two arrangements of the pieces different if and only if there is a square that contains a piece in one of the arrangements but not in the other.




Constraints
2 \leq N \times M \leq 2 \times 10^5
2 \leq K \leq N \times M
All values in input are integers.







InputInput is given from Standard Input in the following format:
N M K





OutputPrint the sum of the costs of all possible arrangements of the pieces, modulo 10^9+7.






Sample Input 12 2 2





Sample Output 18

There are six possible arrangements of the pieces, as follows:

((1,1),(1,2)), with the cost |1-1|+|1-2| = 1
((1,1),(2,1)), with the cost |1-2|+|1-1| = 1
((1,1),(2,2)), with the cost |1-2|+|1-2| = 2
((1,2),(2,1)), with the cost |1-2|+|2-1| = 2
((1,2),(2,2)), with the cost |1-2|+|2-2| = 1
((2,1),(2,2)), with the cost |2-2|+|1-2| = 1

The sum of these costs is 8.





Sample Input 24 5 4





Sample Output 287210






Sample Input 3100 100 5000





Sample Output 3817260251

Be sure to print the sum modulo 10^9+7.

",Cell Distance,"Combinatorics, Arithmetic, Precomputation, Geometry; 3d, Counting",0.357,40,15
186,"
Score : 300 points


Problem StatementThere are N cities numbered 1 through N, and M bidirectional roads numbered 1 through M.
Road i connects City A_i and City B_i.
Snuke can perform the following operation zero or more times:

Choose two distinct cities that are not directly connected by a road, and build a new road between the two cities.

After he finishes the operations, it must be possible to travel from any city to any other cities by following roads (possibly multiple times).
What is the minimum number of roads he must build to achieve the goal?




Constraints
2 \leq N \leq 100,000
1 \leq M \leq 100,000
1 \leq A_i < B_i \leq N
No two roads connect the same pair of cities.
All values in input are integers.







InputInput is given from Standard Input in the following format:
N M
A_1 B_1
:
A_M B_M





OutputPrint the answer.






Sample Input 13 1
1 2





Sample Output 11

Initially, there are three cities, and there is a road between City 1 and City 2.
Snuke can achieve the goal by building one new road, for example, between City 1 and City 3.
After that,

We can travel between 1 and 2 directly.
We can travel between 1 and 3 directly.
We can travel between 2 and 3 by following both roads (2 - 1 - 3).


",Connect Cities,"Graph Theory, Disjoint Set, Graph Traversal",0.504,257,108
187,"
Score : 400 points


Problem StatementYou are given a sequence A_1, A_2, ..., A_N and an integer K.
Print the maximum possible length of a sequence B that satisfies the following conditions:

B is a (not necessarily continuous) subsequence of A.
For each pair of adjacents elements of B, the absolute difference of the elements is at most K.





Constraints
1 \leq N \leq 300,000
0 \leq A_i \leq 300,000
0 \leq K \leq 300,000
All values in input are integers.







InputInput is given from Standard Input in the following format:
N K
A_1
A_2
:
A_N





OutputPrint the answer.






Sample Input 110 3
1
5
4
3
8
6
9
7
2
4





Sample Output 17

For example, B = (1, 4, 3, 6, 9, 7, 4) satisfies the conditions.

It is a subsequence of A = (1, 5, 4, 3, 8, 6, 9, 7, 2, 4).
All of the absolute differences between two adjacent elements (|1-4|, |4-3|, |3-6|, |6-9|, |9-7|, |7-4|) are at most K = 3.


",Flat Subsequence,"Dyanmic Programming, Segment Tree, Array, Sliding Window",0.357,194,61
188,"
Score : 400 points


Problem StatementYou are given positive integers N and M.
How many sequences a of length N consisting of positive integers satisfy a_1 \times a_2 \times ... \times a_N = M? Find the count modulo 10^9+7.
Here, two sequences a' and a'' are considered different when there exists some i such that a_i' \neq a_i''.




Constraints
All values in input are integers.
1 \leq N \leq 10^5
1 \leq M \leq 10^9







InputInput is given from Standard Input in the following format:
N M





OutputPrint the number of the sequences consisting of positive integers that satisfy the condition, modulo 10^9 + 7.






Sample Input 12 6





Sample Output 14

Four sequences satisfy the condition: \{a_1, a_2\} = \{1, 6\}, \{2, 3\}, \{3, 2\} and \{6, 1\}.





Sample Input 23 12





Sample Output 218






Sample Input 3100000 1000000000





Sample Output 3957870001


",Factorization,"Prime Factorization, Combinatorics, Arithmetic, Precomputation",0.5,50,20
189,"
Score : 100 points


Problem Statement
Takahashi is participating in a programming contest, AXC001. He has just submitted his code to Problem A.
The problem has N test cases, all of which must be passed to get an AC verdict.
Takahashi's submission has passed M cases out of the N test cases.
Determine whether Takahashi's submission gets an AC.




Constraints

1 \leq N \leq 100
0 \leq M \leq N
All values in input are integers.







Input
Input is given from Standard Input in the following format:
N M





Output
If Takahashi's submission gets an AC, print Yes; otherwise, print No.






Sample Input 13 3





Sample Output 1Yes

All three test cases have been passed, so his submission gets an AC.





Sample Input 23 2





Sample Output 2No

Only two out of the three test cases have been passed, so his submission does not get an AC.





Sample Input 31 1





Sample Output 3Yes


",AC or WA,Implementation,0.781,389,250
190,"
Score : 200 points


Problem StatementGiven are 1-digit positive integers a and b. Consider these two strings: the concatenation of b copies of the digit a, and the concatenation of a copies of the digit b. Which of these is lexicographically smaller?




Constraints
1 \leq a \leq 9
1 \leq b \leq 9
a and b are integers.







InputInput is given from Standard Input in the following format:
a b





OutputPrint the lexicographically smaller of the two strings. (If the two strings are equal, print one of them.)






Sample Input 14 3





Sample Output 13333

We have two strings 444 and 3333. Between them, 3333 is the lexicographically smaller.





Sample Input 27 7





Sample Output 27777777


",Comparing Strings,"String, Boolean Operations On Geometric Objects, Bruteforcing",0.759,329,230
191,"
Score : 300 points


Problem Statement
Given is a permutation P_1, \ldots, P_N of 1, \ldots, N.
Find the number of integers i (1 \leq i \leq N) that satisfy the following condition:  

For any integer j (1 \leq j \leq i), P_i \leq P_j.





Constraints

1 \leq N \leq 2 \times 10^5
P_1, \ldots, P_N is a permutation of 1, \ldots, N.  
All values in input are integers.







Input
Input is given from Standard Input in the following format:
N
P_1 ... P_N





Output
Print the number of integers i that satisfy the condition.






Sample Input 15
4 2 5 1 3





Sample Output 13

i=1, 2, and 4 satisfy the condition, but i=3 does not - for example, P_i > P_j holds for j = 1.
Similarly, i=5 does not satisfy the condition, either. Thus, there are three integers that satisfy the condition.





Sample Input 24
4 3 2 1





Sample Output 24

All integers i (1 \leq i \leq N) satisfy the condition.





Sample Input 36
1 2 3 4 5 6





Sample Output 31

Only i=1 satisfies the condition.





Sample Input 48
5 7 4 2 6 8 1 3





Sample Output 44






Sample Input 51
1





Sample Output 51


",Low Elements,"Greedy Algorithm, Bruteforcing, Array, Boolean Operations On Geometric Objects",0.541,418,188
192,"
Score : 400 points


Problem Statement
Given is a positive integer N.
Find the number of pairs (A, B) of positive integers not greater than N that satisfy the following condition:

When A and B are written in base ten without leading zeros, the last digit of A is equal to the first digit of B, and the first digit of A is equal to the last digit of B.





Constraints

1 \leq N \leq 2 \times 10^5
All values in input are integers.







Input
Input is given from Standard Input in the following format:
N





Output
Print the answer.






Sample Input 125





Sample Output 117

The following 17 pairs satisfy the condition: (1,1), (1,11), (2,2), (2,22), (3,3), (4,4), (5,5), (6,6), (7,7), (8,8), (9,9), (11,1), (11,11), (12,21), (21,12), (22,2), and (22,22).





Sample Input 21





Sample Output 21






Sample Input 3100





Sample Output 3108






Sample Input 42020





Sample Output 440812






Sample Input 5200000





Sample Output 5400000008


",Handstand 2,"Counting, Bruteforcing, String, Mathematics",0.675,107,70
193,"
Score : 500 points


Problem StatementGiven are N positive integers A_1,...,A_N.
Consider positive integers B_1, ..., B_N that satisfy the following condition.
Condition: For any i, j such that 1 \leq i < j \leq N, A_i B_i = A_j B_j holds.
Find the minimum possible value of B_1 + ... + B_N for such B_1,...,B_N.
Since the answer can be enormous, print the sum modulo (10^9 +7).




Constraints
1 \leq N \leq 10^4
1 \leq A_i \leq 10^6
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
A_1 ... A_N





OutputPrint the minimum possible value of B_1 + ... + B_N for B_1,...,B_N that satisfy the condition, modulo (10^9 +7).






Sample Input 13
2 3 4





Sample Output 113

Let B_1=6, B_2=4, and B_3=3, and the condition will be satisfied.





Sample Input 25
12 12 12 12 12





Sample Output 25

We can let all B_i be 1.





Sample Input 33
1000000 999999 999998





Sample Output 3996989508

Print the sum modulo (10^9+7).

",Flatten,"Prime Factorization, Mathematics, Arithmetic, Euclidean Algorithm, Set / Map, Hashing, Bruteforcing, Exponentiation By Squaring",0.176,264,42
194,"
Score : 400 points


Problem StatementCaracal is fighting with a monster.
The health of the monster is H.
Caracal can attack by choosing one monster. When a monster is attacked, depending on that monster's health, the following happens:

If the monster's health is 1, it drops to 0.
If the monster's health, X, is greater than 1, that monster disappears. Then, two new monsters appear, each with the health of \lfloor X/2 \rfloor.

(\lfloor r \rfloor denotes the greatest integer not exceeding r.)
Caracal wins when the healths of all existing monsters become 0 or below.
Find the minimum number of attacks Caracal needs to make before winning.




Constraints
1 \leq H \leq 10^{12}
All values in input are integers.







InputInput is given from Standard Input in the following format:
H





OutputFind the minimum number of attacks Caracal needs to make before winning.






Sample Input 12





Sample Output 13

When Caracal attacks the initial monster, it disappears, and two monsters appear, each with the health of 1.
Then, Caracal can attack each of these new monsters once and win with a total of three attacks.





Sample Input 24





Sample Output 27






Sample Input 31000000000000





Sample Output 31099511627775


",Caracal vs Monster,"Recursion, Mathematics, Bruteforcing, Boolean Operations On Geometric Objects, Arithmetic",0.781,327,234
195,"
Score : 100 points


Problem Statement
We have A balls with the string S written on each of them and B balls with the string T written on each of them.
From these balls, Takahashi chooses one with the string U written on it and throws it away.
Find the number of balls with the string S and balls with the string T that we have now.




Constraints

S, T, and U are strings consisting of lowercase English letters.
The lengths of S and T are each between 1 and 10 (inclusive).
S \not= T
S=U or T=U.
1 \leq A,B \leq 10
A and B are integers.







Input
Input is given from Standard Input in the following format:
S T
A B
U





Output
Print the answer, with space in between.






Sample Input 1red blue
3 4
red





Sample Output 12 4

Takahashi chose a ball with red written on it and threw it away.
Now we have two balls with the string S and four balls with the string T.





Sample Input 2red blue
5 5
blue





Sample Output 25 4

Takahashi chose a ball with blue written on it and threw it away.
Now we have five balls with the string S and four balls with the string T.

",Remaining Balls,"String, Implementation",0.751,431,265
196,"
Score : 200 points


Problem Statement
Given is a string S. Replace every character in S with x and print the result.




Constraints

S is a string consisting of lowercase English letters.
The length of S is between 1 and 100 (inclusive).







Input
Input is given from Standard Input in the following format:
S





Output
Replace every character in S with x and print the result.






Sample Input 1sardine





Sample Output 1xxxxxxx

Replacing every character in S with x results in xxxxxxx.





Sample Input 2xxxx





Sample Output 2xxxx






Sample Input 3gone





Sample Output 3xxxx


",I miss you...,"Bruteforcing, String",0.853,357,280
197,"
Score : 300 points


Problem StatementGiven is a sequence of integers A_1, A_2, ..., A_N.
If its elements are pairwise distinct, print YES; otherwise, print NO.




Constraints
2 ≤ N ≤ 200000
1 ≤ A_i ≤ 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
A_1 ... A_N





OutputIf the elements of the sequence are pairwise distinct, print YES; otherwise, print NO.






Sample Input 15
2 6 1 4 5





Sample Output 1YES

The elements are pairwise distinct.





Sample Input 26
4 1 3 1 6 2





Sample Output 2NO

The second and fourth elements are identical.





Sample Input 32
10000000 10000000





Sample Output 3NO


",Distinct or Not,"Set / Map, Hashing, Sorting, Greedy Algorithm",0.553,637,269
198,"
Score : 400 points


Problem StatementWe have N dice arranged in a line from left to right. The i-th die from the left shows p_i numbers from 1 to p_i with equal probability when thrown.
We will choose K adjacent dice, throw each of them independently, and compute the sum of the numbers shown. Find the maximum possible value of the expected value of this sum.




Constraints
1 ≤ K ≤ N ≤ 200000
1 ≤ p_i ≤ 1000
All values in input are integers.







InputInput is given from Standard Input in the following format:
N K
p_1 ... p_N





OutputPrint the maximum possible value of the expected value of the sum of the numbers shown.
Your output will be considered correct when its absolute or relative error from our answer is at most 10^{-6}.






Sample Input 15 3
1 2 2 4 5





Sample Output 17.000000000000

When we throw the third, fourth, and fifth dice from the left, the expected value of the sum of the numbers shown is 7. This is the maximum value we can achieve.





Sample Input 24 1
6 6 6 6





Sample Output 23.500000000000

Regardless of which die we choose, the expected value of the number shown is 3.5.





Sample Input 310 4
17 13 13 12 15 20 10 13 17 11





Sample Output 332.000000000000


",Dice in Line,"Probability Theory, Sliding Window, Prefix sum, Array",0.426,403,145
199,"
Score : 500 points


Problem StatementFind the number of integers between 1 and N (inclusive) that contains exactly K non-zero digits when written in base ten.




Constraints
1 \leq N < 10^{100}
1 \leq K \leq 3







InputInput is given from Standard Input in the following format:
N
K





OutputPrint the count.






Sample Input 1100
1





Sample Output 119

The following 19 integers satisfy the condition:

1,2,3,4,5,6,7,8,9,10,20,30,40,50,60,70,80,90,100






Sample Input 225
2





Sample Output 214

The following 14 integers satisfy the condition:

11,12,13,14,15,16,17,18,19,21,22,23,24,25






Sample Input 3314159
2





Sample Output 3937






Sample Input 49999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
3





Sample Output 4117879300


",Almost Everywhere Zero,"Digit Dp, Backtracking, Combinatorics, Divide And Conquer, Counting, Arithmetic",0.458,112,40
200,"
Score: 300 points


Problem Statement
We have N voting papers. The i-th vote (1 \leq i \leq N) has the string S_i written on it.
Print all strings that are written on the most number of votes, in lexicographical order.




Constraints

1 \leq N \leq 2 \times 10^5
S_i (1 \leq i \leq N) are strings consisting of lowercase English letters.
The length of S_i (1 \leq i \leq N) is between 1 and 10 (inclusive).







Input
Input is given from Standard Input in the following format:
N
S_1
:
S_N





Output
Print all strings in question in lexicographical order.






Sample Input 17
beat
vet
beet
bed
vet
bet
beet





Sample Output 1beet
vet

beet and vet are written on two sheets each, while beat, bed, and bet are written on one vote each. Thus, we should print the strings beet and vet.





Sample Input 28
buffalo
buffalo
buffalo
buffalo
buffalo
buffalo
buffalo
buffalo





Sample Output 2buffalo






Sample Input 37
bass
bass
kick
kick
bass
kick
kick





Sample Output 3kick






Sample Input 44
ushi
tapu
nichia
kun





Sample Output 4kun
nichia
tapu
ushi


",Poll,"Set / Map, Hashing, Tree, Bruteforcing, Greedy Algorithm, Sorting, Array",0.641,378,203
201,"
Score : 100 points


Problem StatementTakahashi is a member of a programming competition site, ButCoder.
Each member of ButCoder is assigned two values: Inner Rating and Displayed Rating.
The Displayed Rating of a member is equal to their Inner Rating if the member has participated in 10 or more contests. Otherwise, the Displayed Rating will be their Inner Rating minus 100 \times (10 - K) when the member has participated in K contests.
Takahashi has participated in N contests, and his Displayed Rating is R. Find his Inner Rating.




Constraints
All values in input are integers.
1 \leq N \leq 100
0 \leq R \leq 4111







InputInput is given from Standard Input in the following format:
N R





OutputPrint his Inner Rating.






Sample Input 12 2919





Sample Output 13719

Takahashi has participated in 2 contests, which is less than 10, so his Displayed Rating is his Inner Rating minus 100 \times (10 - 2) = 800.
Thus, Takahashi's Inner Rating is 2919 + 800 = 3719.





Sample Input 222 3051





Sample Output 23051


",Beginner,"Implementation, Arithmetic",0.777,378,264
202,"
Score : 300 points


Problem StatementThere are N people living on a number line.
The i-th person lives at coordinate X_i.
You are going to hold a meeting that all N people have to attend.
The meeting can be held at any integer coordinate. If you choose to hold the meeting at coordinate P, the i-th person will spend (X_i - P)^2 points of stamina to attend the meeting.
Find the minimum total points of stamina the N people have to spend.




Constraints
All values in input are integers.
1 \leq N \leq 100
1 \leq X_i \leq 100







InputInput is given from Standard Input in the following format:
N
X_1 X_2 ... X_N





OutputPrint the minimum total stamina the N people have to spend.






Sample Input 12
1 4





Sample Output 15

Assume the meeting is held at coordinate 2. In this case, the first person will spend (1 - 2)^2 points of stamina, and the second person will spend (4 - 2)^2 = 4 points of stamina, for a total of 5 points of stamina. This is the minimum total stamina that the 2 people have to spend.
Note that you can hold the meeting only at an integer coordinate.





Sample Input 27
14 14 2 13 56 2 37





Sample Output 22354


",Rally,"Bruteforcing, Arithmetic, Mathematics",0.721,406,238
203,"
Score : 400 points


Problem StatementAn SNS has N users - User 1, User 2, \cdots, User N.
Between these N users, there are some relationships - M friendships and K blockships.
For each i = 1, 2, \cdots, M, there is a bidirectional friendship between User A_i and User B_i.
For each i = 1, 2, \cdots, K, there is a bidirectional blockship between User C_i and User D_i.
We define User a to be a friend candidate for User b when all of the following four conditions are satisfied:

a \neq b.
There is not a friendship between User a and User b.
There is not a blockship between User a and User b.
There exists a sequence c_0, c_1, c_2, \cdots, c_L consisting of integers between 1 and N (inclusive) such that c_0 = a, c_L = b, and there is a friendship between User c_i and c_{i+1} for each i = 0, 1, \cdots, L - 1.

For each user i = 1, 2, ... N, how many friend candidates does it have?




Constraints
All values in input are integers.
2 ≤ N ≤ 10^5
0 \leq M \leq 10^5
0 \leq K \leq 10^5
1 \leq A_i, B_i \leq N
A_i \neq B_i
1 \leq C_i, D_i \leq N
C_i \neq D_i
(A_i, B_i) \neq (A_j, B_j) (i \neq j)
(A_i, B_i) \neq (B_j, A_j)
(C_i, D_i) \neq (C_j, D_j) (i \neq j)
(C_i, D_i) \neq (D_j, C_j)
(A_i, B_i) \neq (C_j, D_j)
(A_i, B_i) \neq (D_j, C_j)







InputInput is given from Standard Input in the following format:
N M K
A_1 B_1
\vdots
A_M B_M
C_1 D_1
\vdots
C_K D_K





OutputPrint the answers in order, with space in between.






Sample Input 14 4 1
2 1
1 3
3 2
3 4
4 1





Sample Output 10 1 0 1

There is a friendship between User 2 and 3, and between 3 and 4. Also, there is no friendship or blockship between User 2 and 4. Thus, User 4 is a friend candidate for User 2.
However, neither User 1 or 3 is a friend candidate for User 2, so User 2 has one friend candidate.





Sample Input 25 10 0
1 2
1 3
1 4
1 5
3 2
2 4
2 5
4 3
5 3
4 5





Sample Output 20 0 0 0 0

Everyone is a friend of everyone else and has no friend candidate.





Sample Input 310 9 3
10 1
6 7
8 2
2 5
8 4
7 3
10 9
6 4
5 8
2 6
7 5
3 1





Sample Output 31 3 5 4 3 3 3 3 1 0


",Friend Suggestions,"Graph Theory, Disjoint Set, Depth-first Search, Set / Map",0.438,219,70
204,"
Score : 300 points


Problem StatementA sequence a_1,a_2,... ,a_n is said to be /\/\/\/ when the following conditions are satisfied:

For each i = 1,2,..., n-2, a_i = a_{i+2}.
Exactly two different numbers appear in the sequence.

You are given a sequence v_1,v_2,...,v_n whose length is even.
We would like to make this sequence /\/\/\/ by replacing some of its elements.
Find the minimum number of elements that needs to be replaced.




Constraints
2 \leq n \leq 10^5
n is even.
1 \leq v_i \leq 10^5
v_i is an integer.







InputInput is given from Standard Input in the following format:
n
v_1 v_2 ... v_n





OutputPrint the minimum number of elements that needs to be replaced.






Sample Input 14
3 1 3 2





Sample Output 11

The sequence 3,1,3,2 is not /\/\/\/, but we can make it /\/\/\/ by replacing one of its elements: for example, replace the fourth element to make it 3,1,3,1.





Sample Input 26
105 119 105 119 105 119





Sample Output 20

The sequence 105,119,105,119,105,119 is /\/\/\/.





Sample Input 34
1 1 1 1





Sample Output 32

The elements of the sequence 1,1,1,1 are all the same, so it is not /\/\/\/.

",/\/\/\/,"Counting, Sorting, Greedy Algorithm, Boolean Operations On Geometric Objects, Array",0.204,115,32
205,"
Score : 300 points


Problem StatementYou are given integers N and K. Find the number of triples (a,b,c) of positive integers not greater than N such that a+b,b+c and c+a are all multiples of K.
The order of a,b,c does matter, and some of them can be the same.




Constraints
1 \leq N,K \leq 2\times 10^5
N and K are integers.







InputInput is given from Standard Input in the following format:
N K





OutputPrint the number of triples (a,b,c) of positive integers not greater than N such that a+b,b+c and c+a are all multiples of K.






Sample Input 13 2





Sample Output 19

(1,1,1),(1,1,3),(1,3,1),(1,3,3),(2,2,2),(3,1,1),(3,1,3),(3,3,1) and (3,3,3) satisfy the condition.





Sample Input 25 3





Sample Output 21






Sample Input 331415 9265





Sample Output 327






Sample Input 435897 932





Sample Output 4114191


",Triangular Relationship,"Arithmetic, Mathematics, Combinatorics",0.429,61,27
206,"
Score : 100 points


Problem StatementTakahashi loves takoyaki - a ball-shaped snack.
With a takoyaki machine, he can make at most X pieces of takoyaki at a time, taking T minutes regardless of the number of pieces to make.
How long does it take to make N takoyaki?




Constraints
1 \leq N,X,T \leq 1000
All values in input are integers.







InputInput is given from Standard Input in the following format:
N X T





OutputPrint an integer representing the minimum number of minutes needed to make N pieces of takoyaki.






Sample Input 120 12 6





Sample Output 112

He can make 12 pieces of takoyaki in the first 6 minutes and 8 more in the next 6 minutes, so he can make 20 in a total of 12 minutes.
Note that being able to make 12 in 6 minutes does not mean he can make 2 in 1 minute.





Sample Input 21000 1 1000





Sample Output 21000000

It seems to take a long time to make this kind of takoyaki.

",Takoyaki,"Arithmetic, Implementation",0.796,715,493
207,"
Score : 100 points


Problem StatementGiven an integer a as input, print the value a + a^2 + a^3.




Constraints
1 \leq a \leq 10
a is an integer.







InputInput is given from Standard Input in the following format:
a





OutputPrint the value a + a^2 + a^3 as an integer.






Sample Input 12





Sample Output 114

When a = 2, we have a + a^2 + a^3 = 2 + 2^2 + 2^3 = 2 + 4 + 8 = 14.
Print the answer as an input. Outputs such as 14.0 will be judged as incorrect.





Sample Input 210





Sample Output 21110


",Calc,Arithmetic,0.828,783,572
208,"
Score : 100 points


Problem StatementCompute A \times B.




Constraints
1 \leq A \leq 100
1 \leq B \leq 100
All values in input are integers.







InputInput is given from Standard Input in the following format:
A B





OutputPrint the value A \times B as an integer.






Sample Input 12 5





Sample Output 110

We have 2 \times 5 = 10.





Sample Input 2100 100





Sample Output 210000


",Multiplication 1,"Implementation, Arithmetic",0.853,776,562
209,"
Score: 100 points


Problem Statement
The cat Snuke wants to play a popular Japanese game called ÅtCoder, so Iroha has decided to teach him Japanese.
When counting pencils in Japanese, the counter word ""本"" follows the number. The pronunciation of this word varies depending on the number. Specifically, the pronunciation of ""本"" in the phrase ""N 本"" for a positive integer N not exceeding 999 is as follows:

hon when the digit in the one's place of N is 2, 4, 5, 7, or 9;
pon when the digit in the one's place of N is 0, 1, 6 or 8;
bon when the digit in the one's place of N is 3.

Given N, print the pronunciation of ""本"" in the phrase ""N 本"".




Constraints

N is a positive integer not exceeding 999.







Input
Input is given from Standard Input in the following format:
N





Output
Print the answer.






Sample Input 116





Sample Output 1pon

The digit in the one's place of 16 is 6, so the ""本"" in ""16 本"" is pronounced pon.





Sample Input 22





Sample Output 2hon






Sample Input 3183





Sample Output 3bon


",∴ (Therefore),"Arithmetic, String, Implementation",0.749,873,557
210,"
Score : 100 points


Problem StatementTakahashi has K 500-yen coins. (Yen is the currency of Japan.)
If these coins add up to X yen or more, print Yes; otherwise, print No.




Constraints
1 \leq K \leq 100
1 \leq X \leq 10^5







InputInput is given from Standard Input in the following format:
K X





OutputIf the coins add up to X yen or more, print Yes; otherwise, print No.






Sample Input 12 900





Sample Output 1Yes

Two 500-yen coins add up to 1000 yen, which is not less than X = 900 yen.





Sample Input 21 501





Sample Output 2No

One 500-yen coin is worth 500 yen, which is less than X = 501 yen.





Sample Input 34 2000





Sample Output 3Yes

Four 500-yen coins add up to 2000 yen, which is not less than X = 2000 yen.

",500 Yen Coins,"Arithmetic, Implementation",0.778,315,213
211,"
Score : 100 points


Problem StatementGiven are two strings S and T consisting of lowercase English letters. Concatenate T and S in this order, without space in between, and print the resulting string.




Constraints
S and T are strings consisting of lowercase English letters.
The lengths of S and T are between 1 and 100 (inclusive).







InputInput is given from Standard Input in the following format:
S T





OutputPrint the resulting string.






Sample Input 1oder atc





Sample Output 1atcoder

When S =  oder and T =  atc, concatenating T and S in this order results in atcoder.





Sample Input 2humu humu





Sample Output 2humuhumu


",Strings,"String, Implementation",0.703,399,208
212,"
Score: 100 points


Problem Statement
Takahashi is solving quizzes. He has easily solved all but the last one.
The last quiz has three choices: 1, 2, and 3.
With his supernatural power, Takahashi has found out that the choices A and B are both wrong.
Print the correct choice for this problem.




Constraints

Each of the numbers A and B is 1, 2, or 3.
A and B are different.







Input
Input is given from Standard Input in the following format:
A
B





Output
Print the correct choice.






Sample Input 13
1





Sample Output 12

When we know 3 and 1 are both wrong, the correct choice is 2.





Sample Input 21
2





Sample Output 23


",Round One,"Set / Map, Boolean Operations On Geometric Objects, Implementation",0.794,339,248
213,"
Score : 100 points


Problem StatementGiven are three integers A_1, A_2, and A_3.
If A_1+A_2+A_3 is greater than or equal to 22, print bust; otherwise, print win.




Constraints
1 \leq A_i \leq 13 \ \ (i=1,2,3)
All values in input are integers.







InputInput is given from Standard Input in the following format:
A_1 A_2 A_3





OutputIf A_1+A_2+A_3 is greater than or equal to 22, print bust; otherwise, print win.






Sample Input 15 7 9





Sample Output 1win

5+7+9=21, so print win.





Sample Input 213 7 2





Sample Output 2bust

13+7+2=22, so print bust.

",Blackjack,"Implementation, Arithmetic",0.812,360,258
214,"
Score : 100 points


Problem StatementGiven is a string S representing the day of the week today.
S is SUN, MON, TUE, WED, THU, FRI, or SAT, for Sunday, Monday, Tuesday, Wednesday, Thursday, Friday, and Saturday, respectively.
After how many days is the next Sunday (tomorrow or later)?




Constraints
S is SUN, MON, TUE, WED, THU, FRI, or SAT.







InputInput is given from Standard Input in the following format:
S





OutputPrint the number of days before the next Sunday.






Sample Input 1SAT





Sample Output 11

It is Saturday today, and tomorrow will be Sunday.





Sample Input 2SUN





Sample Output 27

It is Sunday today, and seven days later, it will be Sunday again.

",Can't Wait for Holiday,"Set / Map, String, Graph Theory",0.748,385,262
215,"
Score : 100 points


Problem StatementGiven is an integer r.
How many times is the area of a circle of radius r larger than the area of a circle of radius 1?
It can be proved that the answer is always an integer under the constraints given.




Constraints
1 \leq r \leq 100
All values in input are integers.







InputInput is given from Standard Input in the following format:
r





OutputPrint the area of a circle of radius r, divided by the area of a circle of radius 1, as an integer.






Sample Input 12





Sample Output 14

The area of a circle of radius 2 is 4 times larger than the area of a circle of radius 1.
Note that output must be an integer - for example, 4.0 will not be accepted.





Sample Input 2100





Sample Output 210000


",Circle,"Arithmetic, Implementation",0.771,402,277
216,"
Score : 100 points


Problem StatementHaving learned the multiplication table, Takahashi can multiply two integers between 1 and 9 (inclusive) together. He cannot do any other calculation.
Given are two integers A and B.
If Takahashi can calculate A \times B, print the result; if he cannot, print -1 instead.




Constraints
1 \leq A \leq 20
1 \leq B \leq 20
All values in input are integers.







InputInput is given from Standard Input in the following format:
A B





OutputIf Takahashi can calculate A \times B, print the result; if he cannot, print -1.






Sample Input 12 5





Sample Output 110

2 \times 5 = 10.





Sample Input 25 10





Sample Output 2-1

5\times 10 = 50, but Takahashi cannot do this calculation, so print -1 instead.





Sample Input 39 9





Sample Output 381


",9x9,"Implementation, Arithmetic",0.776,458,311
217,"
Score : 200 points


Problem StatementGiven are strings S and T. Consider changing S to T by repeating the operation below. Find the minimum number of operations required to do so.
Operation: Choose one character of S and replace it with a different character.




Constraints
S and T have lengths between 1 and 2\times 10^5 (inclusive).
S and T consists of lowercase English letters.
S and T have equal lengths.







InputInput is given from Standard Input in the following format:
S
T





OutputPrint the answer.






Sample Input 1cupofcoffee
cupofhottea





Sample Output 14

We can achieve the objective in four operations, such as the following:

First, replace the sixth character c with h.
Second, replace the eighth character f with t.
Third, replace the ninth character f with t.
Fourth, replace the eleventh character e with a.






Sample Input 2abcde
bcdea





Sample Output 25






Sample Input 3apple
apple





Sample Output 30

No operations may be needed to achieve the objective.

",Minor Change,"String, Counting, Bruteforcing",0.893,686,572
218,"
Score : 300 points


Problem StatementThere are N cubes stacked vertically on a desk.
You are given a string S of length N. The color of the i-th cube from the bottom is red if the i-th character in S is 0, and blue if that character is 1.
You can perform the following operation any number of times: choose a red cube and a blue cube that are adjacent, and remove them. Here, the cubes that were stacked on the removed cubes will fall down onto the object below them.
At most how many cubes can be removed?




Constraints
1 \leq N \leq 10^5
|S| = N
Each character in S is 0 or 1.







InputInput is given from Standard Input in the following format:
S





OutputPrint the maximum number of cubes that can be removed.






Sample Input 10011





Sample Output 14

All four cubes can be removed, by performing the operation as follows:

Remove the second and third cubes from the bottom. Then, the fourth cube drops onto the first cube.
Remove the first and second cubes from the bottom.






Sample Input 211011010001011





Sample Output 212






Sample Input 30





Sample Output 30


",Unification,"Counting, Greedy Algorithm, Bruteforcing",0.494,357,166
219,"
Score : 100 points


Problem StatementA biscuit making machine produces B biscuits at the following moments: A seconds, 2A seconds, 3A seconds and each subsequent multiple of A seconds after activation.
Find the total number of biscuits produced within T + 0.5 seconds after activation.




Constraints
All values in input are integers.
1 \leq A, B, T \leq 20







InputInput is given from Standard Input in the following format:
A B T





OutputPrint the total number of biscuits produced within T + 0.5 seconds after activation.






Sample Input 13 5 7





Sample Output 110


Five biscuits will be produced three seconds after activation.
Another five biscuits will be produced six seconds after activation.
Thus, a total of ten biscuits will be produced within 7.5 seconds after activation.






Sample Input 23 2 9





Sample Output 26






Sample Input 320 20 19





Sample Output 30


",Biscuit Generator,"Arithmetic, Implementation",0.775,432,262
220,"
Score: 200 points


Problem Statement
Today, the memorable AtCoder Beginner Contest 100 takes place. On this occasion, Takahashi would like to give an integer to Ringo.
As the name of the contest is AtCoder Beginner Contest 100, Ringo would be happy if he is given a positive integer that can be divided by 100 exactly D times.
Find the N-th smallest integer that would make Ringo happy.




Constraints

D is 0, 1 or 2.
N is an integer between 1 and 100 (inclusive).







Input
Input is given from Standard Input in the following format:
D N





Output
Print the N-th smallest integer that can be divided by 100 exactly D times.






Sample Input 10 5





Sample Output 15

The integers that can be divided by 100 exactly 0 times (that is, not divisible by 100) are as follows: 1, 2, 3, 4, 5, 6, 7, ...
Thus, the 5-th smallest integer that would make Ringo happy is 5.  





Sample Input 21 11





Sample Output 21100

The integers that can be divided by 100 exactly once are as follows: 100, 200, 300, 400, 500, 600, 700, 800, 900, 1 \ 000, 1 \ 100, ...
Thus, the integer we are seeking is 1 \ 100.





Sample Input 32 85





Sample Output 3850000

The integers that can be divided by 100 exactly twice are as follows: 10 \ 000, 20 \ 000, 30 \ 000, ...
Thus, the integer we are seeking is 850 \ 000.

",Ringo's Favorite Numbers,"Arithmetic, Boolean Operations On Geometric Objects, Exponentiation By Squaring",0.066,772,192
221,"
Score : 600 points


Problem StatementGiven is an integer sequence A_1, ..., A_N of length N.
We will choose exactly \left\lfloor \frac{N}{2} \right\rfloor elements from this sequence so that no two adjacent elements are chosen.
Find the maximum possible sum of the chosen elements.
Here \lfloor x \rfloor denotes the greatest integer not greater than x.




Constraints
2 \leq N \leq 2\times 10^5
|A_i|\leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
A_1 ... A_N





OutputPrint the maximum possible sum of the chosen elements.






Sample Input 16
1 2 3 4 5 6





Sample Output 112

Choosing 2, 4, and 6 makes the sum 12, which is the maximum possible value.





Sample Input 25
-1000 -100 -10 0 10





Sample Output 20

Choosing -10 and 10 makes the sum 0, which is the maximum possible value.





Sample Input 310
1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000





Sample Output 35000000000

Watch out for overflow.





Sample Input 427
18 -28 18 28 -45 90 -45 23 -53 60 28 -74 -71 35 -26 -62 49 -77 57 24 -70 -93 69 -99 59 57 -49





Sample Output 4295


",Select Half,"Dyanmic Programming, Mathematics, Arithmetic",0.273,92,23
222,"
Score : 400 points


Problem Statement
A positive integer X is said to be a lunlun number if and only if the following condition is satisfied:

In the base ten representation of X (without leading zeros), for every pair of two adjacent digits, the absolute difference of those digits is at most 1.

For example, 1234, 1, and 334 are lunlun numbers, while none of 31415, 119, or 13579 is.
You are given a positive integer K. Find the K-th smallest lunlun number.




Constraints

1 \leq K \leq 10^5
All values in input are integers.







Input
Input is given from Standard Input in the following format:
K





Output
Print the answer.






Sample Input 115





Sample Output 123

We will list the 15 smallest lunlun numbers in ascending order:
1,
2,
3,
4,
5,
6,
7,
8,
9,
10,
11,
12,
21,
22,
23.
Thus, the answer is 23.





Sample Input 21





Sample Output 21






Sample Input 313





Sample Output 321






Sample Input 4100000





Sample Output 43234566667

Note that the answer may not fit into the 32-bit signed integer type.

",Lunlun Number,"Breadth-first Search, Queue, Dyanmic Programming, Digit Dp, Arithmetic",0.603,219,129
223,"
Score : 500 points


Problem StatementThere are K items placed on a grid of squares with R rows and C columns. Let (i, j) denote the square at the i-th row (1 \leq i \leq R) and the j-th column (1 \leq j \leq C). The i-th item is at (r_i, c_i) and has the value v_i.
Takahashi will begin at (1, 1), the start, and get to (R, C), the goal. When he is at (i, j), he can move to (i + 1, j) or (i, j + 1) (but cannot move to a non-existent square).
He can pick up items on the squares he visits, including the start and the goal, but at most three for each row. It is allowed to ignore the item on a square he visits.
Find the maximum possible sum of the values of items he picks up.




Constraints
1 \leq R, C \leq 3000
1 \leq K \leq \min(2 \times 10^5, R \times C)
1 \leq r_i \leq R
1 \leq c_i \leq C
(r_i, c_i) \neq (r_j, c_j) (i \neq j)
1 \leq v_i \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
R C K
r_1 c_1 v_1
r_2 c_2 v_2
:
r_K c_K v_K





OutputPrint the maximum possible sum of the values of items Takahashi picks up.






Sample Input 12 2 3
1 1 3
2 1 4
1 2 5





Sample Output 18

He has two ways to get to the goal:

Visit (1, 1), (1, 2), and (2, 2), in this order. In this case, the total value of the items he can pick up is 3 + 5 = 8.
Visit (1, 1), (2, 1), and (2, 2), in this order. In this case, the total value of the items he can pick up is 3 + 4 = 7.

Thus, the maximum possible sum of the values of items he picks up is 8.





Sample Input 22 5 5
1 1 3
2 4 20
1 2 1
1 3 4
1 4 2





Sample Output 229

We have four items in the 1-st row. The optimal choices are as follows:

Visit (1, 1) (1, 2), (1, 3), (1, 4), (2, 4), and (2, 5), in this order, and pick up all items except the one on (1, 2). Then, the total value of the items he picks up will be 3 + 4 + 2 + 20 = 29.






Sample Input 34 5 10
2 5 12
1 5 12
2 3 15
1 2 20
1 1 28
2 4 26
3 2 27
4 5 21
3 5 10
1 3 10





Sample Output 3142


",Picking Goods,"Dyanmic Programming, Grid Graph, Mathematics, Array",0.46,192,78
224,"
Score : 600 points


Problem StatementWe have N strings of lowercase English letters: S_1, S_2, \cdots, S_N.
Takahashi wants to make a string that is a palindrome by choosing one or more of these strings - the same string can be chosen more than once - and concatenating them in some order of his choice.
The cost of using the string S_i once is C_i, and the cost of using it multiple times is C_i multiplied by that number of times.
Find the minimum total cost needed to choose strings so that Takahashi can make a palindrome.
If there is no choice of strings in which he can make a palindrome, print -1.




Constraints
1 \leq N \leq 50
1 \leq |S_i| \leq 20
S_i consists of lowercase English letters.
1 \leq C_i \leq 10^9







InputInput is given from Standard Input in the following format:
N
S_1 C_1
S_2 C_2
:
S_N C_N





OutputPrint the minimum total cost needed to choose strings so that Takahashi can make a palindrome, or -1 if there is no such choice.






Sample Input 13
ba 3
abc 4
cbaa 5





Sample Output 17

We have ba, abc, and cbaa.
For example, we can use ba once and abc once for a cost of 7, then concatenate them in the order abc, ba to make a palindrome.
Also, we can use abc once and cbaa once for a cost of 9, then concatenate them in the order cbaa, abc to make a palindrome.
We cannot make a palindrome for a cost less than 7, so we should print 7.





Sample Input 22
abcab 5
cba 3





Sample Output 211

We can choose abcab once and cba twice, then concatenate them in the order abcab, cba, cba to make a palindrome for a cost of 11.





Sample Input 34
ab 5
cba 3
a 12
ab 10





Sample Output 38

We can choose a once, which is already a palindrome, but it is cheaper to concatenate ab and cba.





Sample Input 42
abc 1
ab 2





Sample Output 4-1

We cannot make a palindrome, so we should print -1.

",Making Palindrome,"Graph Traversal, Dijkstra's, String, Memoization, Two-pointer",0.214,56,12
225,"
Score : 500 points


Problem StatementWe have a two-dimensional grid with H \times W squares. There are M targets to destroy in this grid - the position of the i-th target is \left(h_i, w_i \right).
Takahashi will choose one square in this grid, place a bomb there, and ignite it. The bomb will destroy all targets that are in the row or the column where the bomb is placed. It is possible to place the bomb at a square with a target.
Takahashi is trying to maximize the number of targets to destroy. Find the maximum number of targets that can be destroyed.




Constraints
All values in input are integers.
1 \leq H, W \leq 3 \times 10^5
1 \leq M \leq \min\left(H\times W, 3 \times 10^5\right)
1 \leq h_i \leq H
1 \leq w_i \leq W
\left(h_i, w_i\right) \neq \left(h_j, w_j\right) \left(i \neq j\right)







InputInput is given from Standard Input in the following format:
H W M
h_1 w_1
\vdots
h_M w_M





OutputPrint the answer.






Sample Input 12 3 3
2 2
1 1
1 3





Sample Output 13

We can destroy all the targets by placing the bomb at \left(1, 2\right).





Sample Input 23 3 4
3 3
3 1
1 1
1 2





Sample Output 23






Sample Input 35 5 10
2 5
4 3
2 3
5 5
2 2
5 4
5 3
5 1
3 5
1 4





Sample Output 36


",Bomber,"Counting, Arithmetic, Set / Map, Bruteforcing, Boolean Operations On Geometric Objects",0.231,568,140
226,"
Score : 500 points


Problem StatementTakahashi has a string S of length N consisting of digits from 0 through 9.
He loves the prime number P. He wants to know how many non-empty (contiguous) substrings of S - there are N \times (N + 1) / 2 of them - are divisible by P when regarded as integers written in base ten.
Here substrings starting with a 0 also count, and substrings originated from different positions in S are distinguished, even if they are equal as strings or integers.
Compute this count to help Takahashi.




Constraints
1 \leq N \leq 2 \times 10^5
S consists of digits.
|S| = N
2 \leq P \leq 10000
P is a prime number.







InputInput is given from Standard Input in the following format:
N P
S





OutputPrint the number of non-empty (contiguous) substrings of S that are divisible by P when regarded as an integer written in base ten.






Sample Input 14 3
3543





Sample Output 16

Here S = 3543. There are ten non-empty (contiguous) substrings of S:


3: divisible by 3.


35: not divisible by 3.


354: divisible by 3.


3543: divisible by 3.


5: not divisible by 3.


54: divisible by 3.


543: divisible by 3.


4: not divisible by 3.


43: not divisible by 3.


3: divisible by 3.


Six of these are divisible by 3, so print 6.





Sample Input 24 2
2020





Sample Output 210

Here S = 2020. There are ten non-empty (contiguous) substrings of S, all of which are divisible by 2, so print 10.
Note that substrings beginning with a 0 also count.





Sample Input 320 11
33883322005544116655





Sample Output 368


",Divisible Substring,"Arithmetic, Prefix sum, Hashing, Combinatorics, Exponentiation By Squaring",0.167,148,29
227,"
Score : 500 points


Problem StatementWe have N integers. The i-th number is A_i.
\{A_i\} is said to be pairwise coprime when GCD(A_i,A_j)=1 holds for every pair (i, j) such that 1\leq i < j \leq N.
\{A_i\} is said to be setwise coprime when \{A_i\} is not pairwise coprime but GCD(A_1,\ldots,A_N)=1.
Determine if \{A_i\} is pairwise coprime, setwise coprime, or neither.
Here, GCD(\ldots) denotes greatest common divisor.




Constraints
2 \leq N \leq 10^6
1 \leq A_i\leq 10^6







InputInput is given from Standard Input in the following format:
N
A_1 \ldots A_N





OutputIf \{A_i\} is pairwise coprime, print pairwise coprime; if \{A_i\} is setwise coprime, print setwise coprime; if neither, print not coprime.






Sample Input 13
3 4 5





Sample Output 1pairwise coprime

GCD(3,4)=GCD(3,5)=GCD(4,5)=1, so they are pairwise coprime.





Sample Input 23
6 10 15





Sample Output 2setwise coprime

Since GCD(6,10)=2, they are not pairwise coprime. However, since GCD(6,10,15)=1, they are setwise coprime.





Sample Input 33
6 10 16





Sample Output 3not coprime

GCD(6,10,16)=2, so they are neither pairwise coprime nor setwise coprime.

",Coprime,"Euclidean Algorithm, Prime Factorization, Sieve Of Eratosthenes, Hashing, Bruteforcing, Implementation",0.328,637,161
228,"
Score : 600 points


Problem StatementThere is a grid of squares with H+1 horizontal rows and W vertical columns.
You will start at one of the squares in the top row and repeat moving one square right or down. However, for each integer i from 1 through H, you cannot move down from the A_i-th, (A_i + 1)-th, \ldots, B_i-th squares from the left in the i-th row from the top.
For each integer k from 1 through H, find the minimum number of moves needed to reach one of the squares in the (k+1)-th row from the top. (The starting square can be chosen individually for each case.) If, starting from any square in the top row, none of the squares in the (k+1)-th row can be reached, print -1 instead.




Constraints
1 \leq H,W \leq 2\times 10^5
1 \leq A_i \leq B_i \leq W







InputInput is given from Standard Input in the following format:
H W
A_1 B_1
A_2 B_2
:
A_H B_H





OutputPrint H lines. The i-th line should contain the answer for the case k=i.






Sample Input 14 4
2 4
1 1
2 3
2 4





Sample Output 11
3
6
-1

Let (i,j) denote the square at the i-th row from the top and j-th column from the left.
For k=1, we need one move such as (1,1) → (2,1).
For k=2, we need three moves such as (1,1) → (2,1) → (2,2) → (3,2).
For k=3, we need six moves such as (1,1) → (2,1) → (2,2) → (3,2) → (3,3) → (3,4) → (4,4).
For k=4, it is impossible to reach any square in the fifth row from the top.

",I hate Shortest Path Problem,"Array, Dyanmic Programming, Binary Search Tree, Greedy Algorithm, Segment Tree, Data Structures",0.122,144,27
229,"
Score : 600 points


Problem StatementWe have 3N cards arranged in a row from left to right, where each card has an integer between 1 and N (inclusive) written on it. The integer written on the i-th card from the left is A_i.
You will do the following operation N-1 times:

Rearrange the five leftmost cards in any order you like, then remove the three leftmost cards. If the integers written on those three cards are all equal, you gain 1 point.

After these N-1 operations, if the integers written on the remaining three cards are all equal, you will gain 1 additional point.
Find the maximum number of points you can gain.




Constraints
1 \leq N \leq 2000
1 \leq A_i \leq N







InputInput is given from Standard Input in the following format:
N
A_1 A_2 \cdots A_{3N}





OutputPrint the maximum number of points you can gain.






Sample Input 12
1 2 1 2 2 1





Sample Output 12

Let us rearrange the five leftmost cards so that the integers written on the six cards will be 2\ 2\ 2\ 1\ 1\ 1 from left to right.
Then, remove the three leftmost cards, all of which have the same integer 2, gaining 1 point.
Now, the integers written on the remaining cards are 1\ 1\ 1.
Since these three cards have the same integer 1, we gain 1 more point.
In this way, we can gain 2 points - which is the maximum possible.





Sample Input 23
1 1 2 2 3 3 3 2 1





Sample Output 21






Sample Input 33
1 1 2 2 2 3 3 3 1





Sample Output 33


",Brave CHAIN,"Dyanmic Programming, Bitmask, Combinatorics, Constructive, Mathematics, Implementation",0.182,27,6
230,"
Score : 600 points


Problem StatementGiven are two sequences A and B, both of length N.
A and B are each sorted in the ascending order.
Check if it is possible to reorder the terms of B so that for each i (1 \leq i \leq N) A_i \neq B_i holds, and if it is possible, output any of the reorderings that achieve it.




Constraints
1\leq N \leq 2 \times 10^5
1\leq A_i,B_i \leq N
A and B are each sorted in the ascending order.
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
A_1 A_2 \cdots A_N
B_1 B_2 \cdots B_N





OutputIf there exist no reorderings that satisfy the condition, print No.
If there exists a reordering that satisfies the condition, print Yes on the first line.
After that, print a reordering of B on the second line, separating terms with a whitespace.
If there are multiple reorderings that satisfy the condition, you can print any of them.






Sample Input 16
1 1 1 2 2 3
1 1 1 2 2 3





Sample Output 1Yes
2 2 3 1 1 1






Sample Input 23
1 1 2
1 1 3





Sample Output 2No






Sample Input 34
1 1 2 3
1 2 3 3





Sample Output 3Yes
3 3 1 2


",Contrast,"Counting, Prefix sum, Arithmetic, Array, Greedy Algorithm, Sorting",0.108,336,49
231,"
Score : 500 points


Problem StatementYou have a string S of length N.
Initially, all characters in S are 1s.
You will perform queries Q times.
In the i-th query, you are given two integers L_i, R_i and a character D_i (which is a digit).
Then, you must replace all characters from the L_i-th to the R_i-th (inclusive) with D_i.
After each query, read the string S as a decimal integer, and print its value modulo 998,244,353.




Constraints
1 \leq N, Q \leq 200,000
1 \leq L_i \leq R_i \leq N
1 \leq D_i \leq 9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N Q
L_1 R_1 D_1
:
L_Q R_Q D_Q





OutputPrint Q lines.
In the i-th line print the value of S after the i-th query, modulo 998,244,353.






Sample Input 18 5
3 6 2
1 4 7
3 8 3
2 2 2
4 5 1





Sample Output 111222211
77772211
77333333
72333333
72311333






Sample Input 2200000 1
123 456 7





Sample Output 2641437905

Don't forget to take the modulo.

",Replace Digits,"Segment Tree, Arithmetic, Precomputation, Segment Tree With Lazy Propagation, Mathematics, Tree",0.212,116,41
232,"
Score : 300 points


Problem StatementTakahashi loves the number 7 and multiples of K.
Where is the first occurrence of a multiple of K in the sequence 7,77,777,\ldots? (Also see Output and Sample Input/Output below.)
If the sequence contains no multiples of K, print -1 instead.




Constraints
1 \leq K \leq 10^6
K is an integer.







InputInput is given from Standard Input in the following format:
K





OutputPrint an integer representing the position of the first occurrence of a multiple of K. (For example, if the first occurrence is the fourth element of the sequence, print 4.)






Sample Input 1101





Sample Output 14

None of 7, 77, and 777 is a multiple of 101, but 7777 is.





Sample Input 22





Sample Output 2-1

All elements in the sequence are odd numbers; there are no multiples of 2.





Sample Input 3999983





Sample Output 3999982


",Repsept,"Arithmetic, Graph Theory, Recursion, Bruteforcing",0.48,595,259
233,"
Score: 200 points


Problem Statement
We have a string S consisting of lowercase English letters.
If the length of S is at most K, print S without change.
If the length of S exceeds K, extract the first K characters in S, append ... to the end of them, and print the result.




Constraints

K is an integer between 1 and 100 (inclusive).
S is a string consisting of lowercase English letters.
The length of S is between 1 and 100 (inclusive).







Input
Input is given from Standard Input in the following format:
K
S





Output
Print a string as stated in Problem Statement.






Sample Input 17
nikoandsolstice





Sample Output 1nikoand...

nikoandsolstice has a length of 15, which exceeds K=7.
We should extract the first 7 characters in this string, append ... to the end of them, and print the result nikoand....





Sample Input 240
ferelibenterhominesidquodvoluntcredunt





Sample Output 2ferelibenterhominesidquodvoluntcredunt

The famous quote from Gaius Julius Caesar.

",... (Triple Dots),"Implementation, String",0.754,789,522
234,"
Score : 200 points


Problem StatementGiven N integers A_1, ..., A_N, compute A_1 \times ... \times A_N.
However, if the result exceeds 10^{18}, print -1 instead.




Constraints
2 \leq N \leq 10^5
0 \leq A_i \leq 10^{18}
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
A_1 ... A_N





OutputPrint the value A_1 \times ... \times A_N as an integer, or -1 if the value exceeds 10^{18}.






Sample Input 12
1000000000 1000000000





Sample Output 11000000000000000000

We have 1000000000 \times 1000000000 = 1000000000000000000.





Sample Input 23
101 9901 999999000001





Sample Output 2-1

We have 101 \times 9901 \times 999999000001 = 1000000000000000001, which exceeds 10^{18}, so we should print -1 instead.





Sample Input 331
4 1 5 9 2 6 5 3 5 8 9 7 9 3 2 3 8 4 6 2 6 4 3 3 8 3 2 7 9 5 0





Sample Output 30


",Multiplication 2,"Bruteforcing, Arithmetic, Implementation",0.127,2410,351
235,"
Score : 300 points


Problem StatementCompute A \times B, truncate its fractional part, and print the result as an integer.




Constraints
0 \leq A \leq 10^{15}
0 \leq B < 10
A is an integer.
B is a number with two digits after the decimal point.







InputInput is given from Standard Input in the following format:
A B





OutputPrint the answer as an integer.






Sample Input 1198 1.10





Sample Output 1217

We have 198 \times 1.10 = 217.8. After truncating the fractional part, we have the answer: 217.





Sample Input 21 0.01





Sample Output 20






Sample Input 31000000000000000 9.99





Sample Output 39990000000000000


",Multiplication 3,Arithmetic,0.169,1548,333
236,"
Score : 200 points


Problem StatementWe have sticks numbered 1, \cdots, N. The length of Stick i (1 \leq i \leq N) is L_i.
In how many ways can we choose three of the sticks with different lengths that can form a triangle?
That is, find the number of triples of integers (i, j, k) (1 \leq i < j < k \leq N) that satisfy both of the following conditions:

L_i, L_j, and L_k are all different.
There exists a triangle whose sides have lengths L_i, L_j, and L_k.





Constraints
1 \leq N \leq 100
1 \leq L_i \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
L_1 L_2 \cdots L_N





OutputPrint the number of ways to choose three of the sticks with different lengths that can form a triangle.






Sample Input 15
4 4 9 7 5





Sample Output 15

The following five triples (i, j, k) satisfy the conditions: (1, 3, 4), (1, 4, 5), (2, 3, 4), (2, 4, 5), and (3, 4, 5).





Sample Input 26
4 5 4 3 3 5





Sample Output 28

We have two sticks for each of the lengths 3, 4, and 5. To satisfy the first condition, we have to choose one from each length.
There is a triangle whose sides have lengths 3, 4, and 5, so we have 2 ^ 3 = 8 triples (i, j, k) that satisfy the conditions.





Sample Input 310
9 4 6 1 9 6 10 6 6 8





Sample Output 339






Sample Input 42
1 1





Sample Output 40

No triple (i, j, k) satisfies 1 \leq i < j < k \leq N, so we should print 0.

",Making Triangle,"Bruteforcing, Implementation, Mathematics, Sorting",0.825,534,375
237,"
Score : 300 points


Problem StatementTakahashi, who lives on the number line, is now at coordinate X. He will make exactly K moves of distance D in the positive or negative direction.
More specifically, in one move, he can go from coordinate x to x + D or x - D.
He wants to make K moves so that the absolute value of the coordinate of the destination will be the smallest possible.
Find the minimum possible absolute value of the coordinate of the destination.




Constraints
-10^{15} \leq X \leq 10^{15}
1 \leq K \leq 10^{15}
1 \leq D \leq 10^{15}
All values in input are integers.







InputInput is given from Standard Input in the following format:
X K D





OutputPrint the minimum possible absolute value of the coordinate of the destination.






Sample Input 16 2 4





Sample Output 12

Takahashi is now at coordinate 6. It is optimal to make the following moves:

Move from coordinate 6 to (6 - 4 =) 2.
Move from coordinate 2 to (2 - 4 =) -2.

Here, the absolute value of the coordinate of the destination is 2, and we cannot make it smaller.





Sample Input 27 4 3





Sample Output 21

Takahashi is now at coordinate 7. It is optimal to make, for example, the following moves:

Move from coordinate 7 to 4.
Move from coordinate 4 to 7.
Move from coordinate 7 to 4.
Move from coordinate 4 to 1.

Here, the absolute value of the coordinate of the destination is 1, and we cannot make it smaller.





Sample Input 310 1 2





Sample Output 38






Sample Input 41000000000000000 1000000000000000 1000000000000000





Sample Output 41000000000000000

The answer can be enormous.

",Walking Takahashi,"Arithmetic, Greedy Algorithm, Parity, Mathematics",0.305,1035,292
238,"
Score : 600 points


Problem Statement
We have a tree with N vertices numbered 1 to N.
The i-th edge in this tree connects Vertex a_i and Vertex b_i.
Consider painting each of these edges white or black. There are 2^{N-1} such ways to paint the edges. Among them, how many satisfy all of the following M restrictions?  

The i-th (1 \leq i \leq M) restriction is represented by two integers u_i and v_i, which mean that the path connecting Vertex u_i and Vertex v_i must contain at least one edge painted black.





Constraints

2 \leq N \leq 50
1 \leq a_i,b_i \leq N
The graph given in input is a tree.
1 \leq M \leq \min(20,\frac{N(N-1)}{2})
1 \leq u_i < v_i \leq N
If i \not= j, either u_i \not=u_j or v_i\not=v_j
All values in input are integers.







Input
Input is given from Standard Input in the following format:
N
a_1 b_1
:
a_{N-1} b_{N-1}
M
u_1 v_1
:
u_M v_M





Output
Print the number of ways to paint the edges that satisfy all of the M conditions.






Sample Input 13
1 2
2 3
1
1 3





Sample Output 13

The tree in this input is shown below:





All of the M restrictions will be satisfied if Edge 1 and 2 are respectively painted (white, black), (black, white), or (black, black), so the answer is 3.





Sample Input 22
1 2
1
1 2





Sample Output 21

The tree in this input is shown below:





All of the M restrictions will be satisfied only if Edge 1 is painted black, so the answer is 1.





Sample Input 35
1 2
3 2
3 4
5 3
3
1 3
2 4
2 5





Sample Output 39

The tree in this input is shown below:










Sample Input 48
1 2
2 3
4 3
2 5
6 3
6 7
8 6
5
2 7
3 5
1 6
2 8
7 8





Sample Output 462

The tree in this input is shown below:






",Tree and Constraints,"Graph Theory, Depth-first Search, Bitmask, Inclusion And Exclusion, Boolean Operations On Geometric Objects, Combinatorics",0.556,17,10
239,"
Score : 500 points


Problem StatementIbis is fighting with a monster.
The health of the monster is H.
Ibis can cast N kinds of spells. Casting the i-th spell decreases the monster's health by A_i, at the cost of B_i Magic Points.
The same spell can be cast multiple times. There is no way other than spells to decrease the monster's health.
Ibis wins when the health of the monster becomes 0 or below.
Find the minimum total Magic Points that have to be consumed before winning.




Constraints
1 \leq H \leq 10^4
1 \leq N \leq 10^3
1 \leq A_i \leq 10^4
1 \leq B_i \leq 10^4
All values in input are integers.







InputInput is given from Standard Input in the following format:
H N
A_1 B_1
:
A_N B_N





OutputPrint the minimum total Magic Points that have to be consumed before winning.






Sample Input 19 3
8 3
4 2
2 1





Sample Output 14

First, let us cast the first spell to decrease the monster's health by 8, at the cost of 3 Magic Points. The monster's health is now 1.
Then, cast the third spell to decrease the monster's health by 2, at the cost of 1 Magic Point. The monster's health is now -1.
In this way, we can win at the total cost of 4 Magic Points.





Sample Input 2100 6
1 1
2 3
3 9
4 27
5 81
6 243





Sample Output 2100

It is optimal to cast the first spell 100 times.





Sample Input 39999 10
540 7550
691 9680
700 9790
510 7150
415 5818
551 7712
587 8227
619 8671
588 8228
176 2461





Sample Output 3139815


",Crested Ibis vs Monster,"Knapsack, Dyanmic Programming, Recursion, Dynamic Programming, Implementation",0.548,226,104
240,"
Score : 600 points


Problem StatementSilver Fox is fighting with N monsters.
The monsters are standing in a row, and we can assume them to be standing on a number line. The i-th monster, standing at the coordinate X_i, has the health of H_i.
Silver Fox can use bombs to attack the monsters.
Using a bomb at the coordinate x decreases the healths of all monsters between the coordinates x-D and x+D (inclusive) by A.
There is no way other than bombs to decrease the monster's health.
Silver Fox wins when all the monsters' healths become 0 or below.
Find the minimum number of bombs needed to win.




Constraints
1 \leq N \leq 2 \times 10^5
0 \leq D \leq 10^9
1 \leq A \leq 10^9
0 \leq X_i \leq 10^9
1 \leq H_i \leq 10^9
X_i are distinct.
All values in input are integers.







InputInput is given from Standard Input in the following format:
N D A
X_1 H_1
:
X_N H_N





OutputPrint the minimum number of bombs needed to win.






Sample Input 13 3 2
1 2
5 4
9 2





Sample Output 12

First, let us use a bomb at the coordinate 4 to decrease the first and second monsters' health by 2.
Then, use a bomb at the coordinate 6 to decrease the second and third monsters' health by 2.
Now, all the monsters' healths are 0.
We cannot make all the monsters' health drop to 0 or below with just one bomb.





Sample Input 29 4 1
1 5
2 4
3 3
4 2
5 1
6 2
7 3
8 4
9 5





Sample Output 25

We should use five bombs at the coordinate 5.





Sample Input 33 0 1
300000000 1000000000
100000000 1000000000
200000000 1000000000





Sample Output 33000000000

Watch out for overflow.

",Silver Fox vs Monster,"Sorting, Greedy Algorithm, Binary Search, Two-pointer, Segment Tree With Lazy Propagation, Difference Array, Segment Tree, Priority Queue, Arithmetic",0.306,147,36
241,"
Score : 600 points


Problem StatementSnuke is standing on a two-dimensional plane. In one operation, he can move by 1 in the positive x-direction, or move by 1 in the positive y-direction.
Let us define a function f(r, c) as follows:

f(r,c) :=  (The number of paths from the point (0, 0) to the point (r, c) that Snuke can trace by repeating the operation above)

Given are integers r_1, r_2, c_1, and c_2.
Find the sum of f(i, j) over all pair of integers (i, j) such that r_1 ≤ i ≤ r_2 and c_1 ≤ j ≤ c_2, and compute this value modulo (10^9+7).




Constraints
1 ≤ r_1 ≤ r_2 ≤ 10^6
1 ≤ c_1 ≤ c_2 ≤ 10^6
All values in input are integers.







InputInput is given from Standard Input in the following format:
r_1 c_1 r_2 c_2





OutputPrint the sum of f(i, j) modulo (10^9+7).






Sample Input 11 1 2 2





Sample Output 114

For example, there are two paths from the point (0, 0) to the point (1, 1): (0,0) → (0,1) → (1,1) and (0,0) → (1,0) → (1,1), so f(1,1)=2.
Similarly, f(1,2)=3, f(2,1)=3, and f(2,2)=6. Thus, the sum is 14.





Sample Input 2314 159 2653 589





Sample Output 2602215194


",Many Many Paths,"Combinatorics, Arithmetic, Modular Multiplicative Inverse",0.125,31,12
242,"
Score: 400 points


Problem Statement
We have N integers A_1, A_2, ..., A_N.
There are \frac{N(N-1)}{2} ways to choose two of them and form a pair. If we compute the product of each of those pairs and sort the results in ascending order, what will be the K-th number in that list?




Constraints

All values in input are integers.
2 \leq N \leq 2 \times 10^5
1 \leq K \leq \frac{N(N-1)}{2}
-10^9 \leq A_i \leq 10^9\ (1 \leq i \leq N)







Input
Input is given from Standard Input in the following format:
N K
A_1 A_2 \dots A_N





Output
Print the answer.






Sample Input 14 3
3 3 -4 -2





Sample Output 1-6

There are six ways to form a pair. The products of those pairs are 9, -12, -6, -12, -6, 8.
Sorting those numbers in ascending order, we have -12, -12, -6, -6, 8, 9. The third number in this list is -6.





Sample Input 210 40
5 4 3 2 -1 0 0 0 0 0





Sample Output 26






Sample Input 330 413
-170202098 -268409015 537203564 983211703 21608710 -443999067 -937727165 -97596546 -372334013 398994917 -972141167 798607104 -949068442 -959948616 37909651 0 886627544 -20098238 0 -948955241 0 -214720580 277222296 -18897162 834475626 0 -425610555 110117526 663621752 0





Sample Output 3448283280358331064


",Pairs,"Sorting, Binary Search, Two-pointer, Counting, Arithmetic",0.071,198,26
243,"
Score: 500 points


Problem Statement
In the Kingdom of AtCoder, only banknotes are used as currency. There are 10^{100}+1 kinds of banknotes, with the values of 1, 10, 10^2, 10^3, \dots, 10^{(10^{100})}. You have come shopping at a mall and are now buying a takoyaki machine with a value of N. (Takoyaki is the name of a Japanese snack.)
To make the payment, you will choose some amount of money which is at least N and give it to the clerk. Then, the clerk gives you back the change, which is the amount of money you give minus N.
What will be the minimum possible number of total banknotes used by you and the clerk, when both choose the combination of banknotes to minimize this count?
Assume that you have sufficient numbers of banknotes, and so does the clerk.




Constraints

N is an integer between 1 and 10^{1,000,000} (inclusive).







Input
Input is given from Standard Input in the following format:
N





Output
Print the minimum possible number of total banknotes used by you and the clerk.






Sample Input 136





Sample Output 18

If you give four banknotes of value 10 each, and the clerk gives you back four banknotes of value 1 each, a total of eight banknotes are used.
The payment cannot be made with less than eight banknotes in total, so the answer is 8.





Sample Input 291





Sample Output 23

If you give two banknotes of value 100, 1, and the clerk gives you back one banknote of value 10, a total of three banknotes are used.





Sample Input 3314159265358979323846264338327950288419716939937551058209749445923078164062862089986280348253421170





Sample Output 3243


",Payment,"Greedy Algorithm, Digit Dp, Arithmetic, Heuristics",0.241,59,22
244,"
Score: 600 points


Problem Statement
After being invaded by the Kingdom of AlDebaran, bombs are planted throughout our country, AtCoder Kingdom.
Fortunately, our military team called ABC has managed to obtain a device that is a part of the system controlling the bombs.
There are N bombs, numbered 1 to N, planted in our country. Bomb i is planted at the coordinate A_i. It is currently activated if B_i=1, and deactivated if B_i=0.
The device has M cords numbered 1 to M. If we cut Cord j, the states of all the bombs planted between the coordinates L_j and R_j (inclusive) will be switched - from activated to deactivated, and vice versa.
Determine whether it is possible to deactivate all the bombs at the same time. If the answer is yes, output a set of cords that should be cut.




Constraints

All values in input are integers.
1 \leq N \leq 10^5
1 \leq A_i \leq 10^9\ (1 \leq i \leq N)
A_i are pairwise distinct.
B_i is 0 or 1. (1 \leq i \leq N)
1 \leq M \leq 2 \times 10^5
1 \leq L_j \leq R_j \leq 10^9\ (1 \leq j \leq M)







Input
Input is given from Standard Input in the following format:
N M
A_1 B_1
:
A_N B_N
L_1 R_1
:
L_M R_M





Output
If it is impossible to deactivate all the bombs at the same time, print -1. If it is possible to do so, print a set of cords that should be cut, as follows:
k
c_1 c_2 \dots c_k

Here, k is the number of cords (possibly 0), and c_1, c_2, \dots, c_k represent the cords that should be cut. 1 \leq c_1 < c_2 < \dots < c_k \leq M must hold.






Sample Input 13 4
5 1
10 1
8 0
1 10
4 5
6 7
8 9





Sample Output 12
1 4

There are two activated bombs at the coordinates 5, 10, and one deactivated bomb at the coordinate 8.
Cutting Cord 1 switches the states of all the bombs planted between the coordinates 1 and 10, that is, all of the three bombs.
Cutting Cord 4 switches the states of all the bombs planted between the coordinates 8 and 9, that is, Bomb 3.
Thus, we can deactivate all the bombs by cutting Cord 1 and Cord 4.





Sample Input 24 2
2 0
3 1
5 1
7 0
1 4
4 7





Sample Output 2-1

Cutting any set of cords will not deactivate all the bombs at the same time.





Sample Input 33 2
5 0
10 0
8 0
6 9
66 99





Sample Output 30


All the bombs are already deactivated, so we do not need to cut any cord.





Sample Input 412 20
536130100 1
150049660 1
79245447 1
132551741 0
89484841 1
328129089 0
623467741 0
248785745 0
421631475 0
498966877 0
43768791 1
112237273 0
21499042 142460201
58176487 384985131
88563042 144788076
120198276 497115965
134867387 563350571
211946499 458996604
233934566 297258009
335674184 555985828
414601661 520203502
101135608 501051309
90972258 300372385
255474956 630621190
436210625 517850028
145652401 192476406
377607297 520655694
244404406 304034433
112237273 359737255
392593015 463983307
150586788 504362212
54772353 83124235





Sample Output 45
1 7 8 9 11

If there are multiple sets of cords that deactivate all the bombs when cut, any of them can be printed.

",Perils in Parallel,"Sorting, Binary Search, Value / Coordinate Compression, Difference Array, Graph Theory, Depth-first Search, Bitmask",0.667,12,6
245,"
Score : 400 points


Problem StatementAkari has n kinds of flowers, one of each kind.
She is going to choose one or more of these flowers to make a bouquet.
However, she hates two numbers a and b, so the number of flowers in the bouquet cannot be a or b.
How many different bouquets are there that Akari can make?
Find the count modulo (10^9 + 7).
Here, two bouquets are considered different when there is a flower that is used in one of the bouquets but not in the other bouquet.




Constraints
All values in input are integers.
2 \leq n \leq 10^9
1 \leq a < b \leq \textrm{min}(n, 2 \times 10^5)







InputInput is given from Standard Input in the following format:
n a b





OutputPrint the number of bouquets that Akari can make, modulo (10^9 + 7). (If there are no such bouquets, print 0.)






Sample Input 14 1 3





Sample Output 17

In this case, Akari can choose 2 or 4 flowers to make the bouquet.
There are 6 ways to choose 2 out of the 4 flowers, and 1 way to choose 4, so there are a total of 7 different bouquets that Akari can make.





Sample Input 21000000000 141421 173205





Sample Output 234076506

Print the count modulo (10^9 + 7).

",Bouquet,"Arithmetic, Exponentiation By Squaring, Modular Multiplicative Inverse, Combinatorics",0.438,162,62
246,"
Score : 500 points


Problem StatementThere is a building with n rooms, numbered 1 to n.
We can move from any room to any other room in the building.
Let us call the following event a move: a person in some room i goes to another room j~ (i \neq j).
Initially, there was one person in each room in the building.
After that, we know that there were exactly k moves happened up to now.
We are interested in the number of people in each of the n rooms now. How many combinations of numbers of people in the n rooms are possible?
Find the count modulo (10^9 + 7).




Constraints
All values in input are integers.
3 \leq n \leq 2 \times 10^5
2 \leq k \leq 10^9







InputInput is given from Standard Input in the following format:
n k





OutputPrint the number of possible combinations of numbers of people in the n rooms now, modulo (10^9 + 7).






Sample Input 13 2





Sample Output 110

Let c_1, c_2, and c_3 be the number of people in Room 1, 2, and 3 now, respectively. There are 10 possible combination of (c_1, c_2, c_3):

(0, 0, 3)
(0, 1, 2)
(0, 2, 1)
(0, 3, 0)
(1, 0, 2)
(1, 1, 1)
(1, 2, 0)
(2, 0, 1)
(2, 1, 0)
(3, 0, 0)

For example, (c_1, c_2, c_3) will be (0, 1, 2) if the person in Room 1 goes to Room 2 and then one of the persons in Room 2 goes to Room 3.





Sample Input 2200000 1000000000





Sample Output 2607923868

Print the count modulo (10^9 + 7).





Sample Input 315 6





Sample Output 322583772


",Roaming,"Arithmetic, Combinatorics, Precomputation, Boolean Operations On Geometric Objects, Implementation",0.533,30,16
247,"
Score : 600 points


Problem StatementWe have a sequence of k numbers: d_0,d_1,...,d_{k - 1}.
Process the following q queries in order:

The i-th query contains three integers n_i, x_i, and m_i.
Let a_0,a_1,...,a_{n_i - 1} be the following sequence of n_i numbers: \begin{eqnarray} a_j =  \begin{cases}    x_i & ( j = 0 ) \\    a_{j - 1} + d_{(j - 1)~\textrm{mod}~k} & ( 0 < j \leq n_i - 1 )  \end{cases}\end{eqnarray}
Print the number of j~(0 \leq j < n_i - 1) such that (a_j~\textrm{mod}~m_i) < (a_{j + 1}~\textrm{mod}~m_i).

Here (y~\textrm{mod}~z) denotes the remainder of y divided by z, for two integers y and z~(z > 0).




Constraints
All values in input are integers.
1 \leq k, q \leq 5000
0 \leq d_i \leq 10^9
2 \leq n_i \leq 10^9
0 \leq x_i \leq 10^9
2 \leq m_i \leq 10^9







InputInput is given from Standard Input in the following format:
k q
d_0 d_1 ... d_{k - 1}
n_1 x_1 m_1
n_2 x_2 m_2
:
n_q x_q m_q





OutputPrint q lines.
The i-th line should contain the response to the i-th query.






Sample Input 13 1
3 1 4
5 3 2





Sample Output 11

For the first query, the sequence {a_j} will be 3,6,7,11,14.

(a_0~\textrm{mod}~2) > (a_1~\textrm{mod}~2)
(a_1~\textrm{mod}~2) < (a_2~\textrm{mod}~2)
(a_2~\textrm{mod}~2) = (a_3~\textrm{mod}~2)
(a_3~\textrm{mod}~2) > (a_4~\textrm{mod}~2)

Thus, the response to this query should be 1.





Sample Input 27 3
27 18 28 18 28 46 1000000000
1000000000 1 7
1000000000 2 10
1000000000 3 12





Sample Output 2224489796
214285714
559523809


",Modularness,"Arithmetic, Prefix sum, Graph Theory, Mathematics",0.5,13,7
248,"
Score : 500 points


Problem StatementYou are given a string S of length N consisting of lowercase English letters.
Process Q queries of the following two types:

Type 1: change the i_q-th character of S to c_q. (Do nothing if the i_q-th character is already c_q.)
Type 2: answer the number of different characters occurring in the substring of S between the l_q-th and r_q-th characters (inclusive).





Constraints
N, Q, i_q, l_q, and r_q are integers.
S is a string consisting of lowercase English letters.
c_q is a lowercase English letter.
1 \leq N \leq 500000
1 \leq Q \leq 20000
|S| = N
1 \leq i_q \leq N
1 \leq l_q \leq r_q \leq N
There is at least one query of type 2 in each testcase.







InputInput is given from Standard Input in the following format:
N
S
Q
Query_1
\vdots
Query_Q

Here, Query_i in the 4-th through (Q+3)-th lines is one of the following:
1 i_q c_q

2 l_q r_q





OutputFor each query of type 2, print a line containing the answer.






Sample Input 17
abcdbbd
6
2 3 6
1 5 z
2 1 1
1 4 a
1 7 d
2 1 7





Sample Output 13
1
5

In the first query, cdbb contains three kinds of letters: b , c , and d, so we print 3.
In the second query, S is modified to abcdzbd.
In the third query, a contains one kind of letter: a, so we print 1.
In the fourth query, S is modified to abcazbd.
In the fifth query, S does not change and is still abcazbd.
In the sixth query, abcazbd contains five kinds of letters: a, b, c, d, and z, so we print 5.

",Simple String Queries,"Segment Tree, Binary Indexed Tree, Bitmask, String, Bruteforcing",0.277,128,37
249,"
Score : 600 points


Problem StatementTakahashi wants to grill N pieces of meat on a grilling net, which can be seen as a two-dimensional plane. The coordinates of the i-th piece of meat are \left(x_i, y_i\right), and its hardness is c_i.
Takahashi can use one heat source to grill the meat. If he puts the heat source at coordinates \left(X, Y\right), where X and Y are real numbers, the i-th piece of meat will be ready to eat in c_i \times \sqrt{\left(X - x_i\right)^2 + \left(Y-y_i\right)^2} seconds.
Takahashi wants to eat K pieces of meat. Find the time required to have K or more pieces of meat ready if he put the heat source to minimize this time.




Constraints
All values in input are integers.
1 \leq N \leq 60
1 \leq K \leq N
-1000 \leq x_i , y_i \leq 1000
\left(x_i, y_i\right) \neq \left(x_j, y_j\right) \left(i \neq j \right)
1 \leq c_i \leq 100







InputInput is given from Standard Input in the following format:
N K
x_1 y_1 c_1
\vdots
x_N y_N c_N





OutputPrint the answer.
It will be considered correct if its absolute or relative error from our answer is at most 10^{-6}.






Sample Input 14 3
-1 0 3
0 0 3
1 0 2
1 1 40





Sample Output 12.4

If we put the heat source at \left(-0.2, 0\right), the 1-st, 2-nd, and 3-rd pieces of meat will be ready to eat within 2.4 seconds. This is the optimal place to put the heat source.





Sample Input 210 5
-879 981 26
890 -406 81
512 859 97
362 -955 25
128 553 17
-885 763 2
449 310 57
-656 -204 11
-270 76 40
184 170 16





Sample Output 27411.2252


",Yakiniku Optimization Problem,"Binary Search, Geometry; 3d, Set / Map, Enumeration, Numerical Analysis",0.667,3,2
250,"
Score : 600 points


Problem StatementThere are N robots numbered 1 to N placed on a number line. Robot i is placed at coordinate X_i. When activated, it will travel the distance of D_i in the positive direction, and then it will be removed from the number line. All the robots move at the same speed, and their sizes are ignorable.
Takahashi, who is a mischievous boy, can do the following operation any number of times (possibly zero) as long as there is a robot remaining on the number line.

Choose a robot and activate it. This operation cannot be done when there is a robot moving.

While Robot i is moving, if it touches another robot j that is remaining in the range [X_i, X_i + D_i) on the number line, Robot j also gets activated and starts moving. This process is repeated recursively.
How many possible sets of robots remaining on the number line are there after Takahashi does the operation some number of times? Compute this count modulo 998244353, since it can be enormous.




Constraints
1 \leq N \leq 2 \times 10^5
-10^9 \leq X_i \leq 10^9
1 \leq D_i \leq 10^9
X_i \neq X_j (i \neq j)
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
X_1 D_1
:
X_N D_N





OutputPrint the number of possible sets of robots remaining on the number line, modulo 998244353.






Sample Input 12
1 5
3 3





Sample Output 13

There are three possible sets of robots remaining on the number line: \{1, 2\}, \{1\}, and \{\}.
These can be achieved as follows:


If Takahashi activates nothing, the robots \{1, 2\} will remain.


If Takahashi activates Robot 1, it will activate Robot 2 while moving, after which there will be no robots on the number line. This state can also be reached by activating Robot 2 and then Robot 1.


If Takahashi activates Robot 2 and finishes doing the operation, the robot \{1\} will remain.







Sample Input 23
6 5
-1 10
3 3





Sample Output 25

There are five possible sets of robots remaining on the number line: \{1, 2, 3\}, \{1, 2\}, \{2\}, \{2, 3\}, and \{\}.





Sample Input 34
7 10
-10 3
4 3
-4 3





Sample Output 316

None of the robots influences others.





Sample Input 420
-8 1
26 4
0 5
9 1
19 4
22 20
28 27
11 8
-3 20
-25 17
10 4
-18 27
24 28
-11 19
2 27
-2 18
-1 12
-24 29
31 29
29 7





Sample Output 4110

Remember to print the count modulo 998244353.

",Removing Robots,"Sorting, Two-pointer, Array, Dyanmic Programming, Mathematics, Arithmetic",0.583,36,13
251,"
Score : 500 points


Problem StatementWe have a chocolate bar partitioned into H horizontal rows and W vertical columns of squares.
The square (i, j) at the i-th row from the top and the j-th column from the left is dark if S_{i,j} is 0, and white if S_{i,j} is 1.
We will cut the bar some number of times to divide it into some number of blocks. In each cut, we cut the whole bar by a line running along some boundaries of squares from end to end of the bar.
How many times do we need to cut the bar so that every block after the cuts has K or less white squares?




Constraints
1 \leq H \leq 10
1 \leq W \leq 1000
1 \leq K \leq H \times W
S_{i,j} is 0 or 1.







InputInput is given from Standard Input in the following format:
H W K
S_{1,1}S_{1,2}...S_{1,W}
:
S_{H,1}S_{H,2}...S_{H,W}





OutputPrint the number of minimum times the bar needs to be cut so that every block after the cuts has K or less white squares.






Sample Input 13 5 4
11100
10001
00111





Sample Output 12

For example, cutting between the 1-st and 2-nd rows and between the 3-rd and 4-th columns - as shown in the figure to the left - works.
Note that we cannot cut the bar in the ways shown in the two figures to the right.






Sample Input 23 5 8
11100
10001
00111





Sample Output 20

No cut is needed.





Sample Input 34 10 4
1110010010
1000101110
0011101001
1101000111





Sample Output 33


",Dividing Chocolate,"Bitmask, Prefix sum, Greedy Algorithm, Two-pointer, Dyanmic Programming",0.426,86,43
252,"
Score : 600 points


Problem StatementGiven are a sequence of N integers A_1, A_2, \ldots, A_N and a positive integer S.
For a pair of integers (L, R) such that 1\leq L \leq R \leq N, let us define f(L, R) as follows:

f(L, R) is the number of sequences of integers (x_1, x_2, \ldots , x_k) such that L \leq x_1 < x_2 < \cdots < x_k \leq R and A_{x_1}+A_{x_2}+\cdots +A_{x_k} = S.

Find the sum of f(L, R) over all pairs of integers (L, R) such that 1\leq L \leq R\leq N. Since this sum can be enormous, print it modulo 998244353.




Constraints
All values in input are integers.
1 \leq N \leq 3000
1 \leq S \leq 3000
1 \leq A_i \leq 3000







InputInput is given from Standard Input in the following format:
N S
A_1 A_2 ... A_N





OutputPrint the sum of f(L, R), modulo 998244353.






Sample Input 13 4
2 2 4





Sample Output 15

The value of f(L, R) for each pair is as follows, for a total of 5.

f(1,1) = 0
f(1,2) = 1 (for the sequence (1, 2))
f(1,3) = 2 (for (1, 2) and (3))
f(2,2) = 0
f(2,3) = 1 (for (3))
f(3,3) = 1 (for (3))






Sample Input 25 8
9 9 9 9 9





Sample Output 20






Sample Input 310 10
3 1 4 1 5 9 2 6 5 3





Sample Output 3152


",Knapsack for All Segments,"Dyanmic Programming, Dynamic Programming, Arithmetic, Combinatorics",0.348,45,16
253,"
Score: 300 points


Problem Statement
M-kun is a student in Aoki High School, where a year is divided into N terms.
There is an exam at the end of each term. According to the scores in those exams, a student is given a grade for each term, as follows:

For the first through (K-1)-th terms: not given.
For each of the K-th through N-th terms: the multiplication of the scores in the last K exams, including the exam in the graded term.

M-kun scored A_i in the exam at the end of the i-th term.
For each i such that K+1 \leq i \leq N, determine whether his grade for the i-th term is strictly greater than the grade for the (i-1)-th term.




Constraints

2 \leq N \leq 200000
1 \leq K \leq N-1
1 \leq A_i \leq 10^{9}
All values in input are integers.







Input
Input is given from Standard Input in the following format:
N K
A_1 A_2 A_3 \ldots A_N





Output
Print the answer in N-K lines.
The i-th line should contain Yes if the grade for the (K+i)-th term is greater than the grade for the (K+i-1)-th term, and No otherwise.






Sample Input 15 3
96 98 95 100 20





Sample Output 1Yes
No

His grade for each term is computed as follows:

3-rd term: (96 \times 98 \times 95) = 893760
4-th term: (98 \times 95 \times 100) = 931000
5-th term: (95 \times 100 \times 20) = 190000






Sample Input 23 2
1001 869120 1001





Sample Output 2No

Note that the output should be No if the grade for the 3-rd term is equal to the grade for the 2-nd term.





Sample Input 315 7
3 1 4 1 5 9 2 6 5 3 5 8 9 7 9





Sample Output 3Yes
Yes
No
Yes
Yes
No
Yes
Yes


",Marks,"Sliding Window, Bruteforcing, Arithmetic, Implementation",0.526,472,193
254,"
Score: 400 points


Problem Statement
To become a millionaire, M-kun has decided to make money by trading in the next N days. Currently, he has 1000 yen and no stocks - only one kind of stock is issued in the country where he lives.
He is famous across the country for his ability to foresee the future. He already knows that the price of one stock in the next N days will be as follows:

A_1 yen on the 1-st day, A_2 yen on the 2-nd day, ..., A_N yen on the N-th day.

In the i-th day, M-kun can make the following trade any number of times (possibly zero), within the amount of money and stocks that he has at the time.

Buy stock: Pay A_i yen and receive one stock.
Sell stock: Sell one stock for A_i yen.

What is the maximum possible amount of money that M-kun can have in the end by trading optimally?




Constraints

2 \leq N \leq 80
100 \leq A_i \leq 200
All values in input are integers.







Input
Input is given from Standard Input in the following format:
N
A_1 A_2 \cdots A_N





Output
Print the maximum possible amount of money that M-kun can have in the end, as an integer.






Sample Input 17
100 130 130 130 115 115 150





Sample Output 11685

In this sample input, M-kun has seven days of trading. One way to have 1685 yen in the end is as follows:

Initially, he has 1000 yen and no stocks.
Day 1: Buy 10 stocks for 1000 yen. Now he has 0 yen.
Day 2: Sell 7 stocks for 910 yen. Now he has 910 yen.
Day 3: Sell 3 stocks for 390 yen. Now he has 1300 yen.
Day 4: Do nothing.
Day 5: Buy 1 stock for 115 yen. Now he has 1185 yen.
Day 6: Buy 10 stocks for 1150 yen. Now he has 35 yen.
Day 7: Sell 11 stocks for 1650 yen. Now he has 1685 yen.

There is no way to have 1686 yen or more in the end, so the answer is 1685.





Sample Input 26
200 180 160 140 120 100





Sample Output 21000

In this sample input, it is optimal to do nothing throughout the six days, after which we will have 1000 yen.





Sample Input 32
157 193





Sample Output 31216

In this sample input, it is optimal to buy 6 stocks in Day 1 and sell them in Day 2, after which we will have 1216 yen.

",Road to Millionaire,"Dyanmic Programming, Bruteforcing, Arithmetic, Dynamic Programming",0.301,418,141
255,"
Score : 100 points


Problem StatementAtCoDeer the deer recently bought three paint cans.
The color of the one he bought two days ago is a, the color of the one he bought yesterday is b, and the color of the one he bought today is c.
Here, the color of each paint can is represented by an integer between 1 and 100, inclusive.
Since he is forgetful, he might have bought more than one paint can in the same color.
Count the number of different kinds of colors of these paint cans and tell him.




Constraints
1≦a,b,c≦100







InputThe input is given from Standard Input in the following format:
a b c





OutputPrint the number of different kinds of colors of the paint cans.






Sample Input 13 1 4





Sample Output 13

Three different colors: 1, 3, and 4.





Sample Input 23 3 33





Sample Output 22

Two different colors: 3 and 33.

",AtCoDeer and Paint Cans,"Set / Map, Implementation",0.659,315,166
256,"
Score : 400 points


Problem StatementAn altar enshrines N stones arranged in a row from left to right. The color of the i-th stone from the left (1 \leq i \leq N) is given to you as a character c_i; R stands for red and W stands for white.
You can do the following two kinds of operations any number of times in any order:

Choose two stones (not necessarily adjacent) and swap them.
Choose one stone and change its color (from red to white and vice versa).

According to a fortune-teller, a white stone placed to the immediate left of a red stone will bring a disaster. At least how many operations are needed to reach a situation without such a white stone?




Constraints
2 \leq N \leq 200000
c_i is R or W.







InputInput is given from Standard Input in the following format:
N
c_{1}c_{2}...c_{N}





OutputPrint an integer representing the minimum number of operations needed.






Sample Input 14
WWRR





Sample Output 12

For example, the two operations below will achieve the objective.

Swap the 1-st and 3-rd stones from the left, resulting in RWWR.
Change the color of the 4-th stone from the left, resulting in RWWW.






Sample Input 22
RR





Sample Output 20

It can be the case that no operation is needed.





Sample Input 38
WRWWRWRR





Sample Output 33


",Alter Altar,"Counting, Greedy Algorithm, Two-pointer, Implementation, Dynamic Programming",0.676,500,272
257,"
Score: 200 points


Problem Statement
The number 105 is quite special - it is odd but still it has eight divisors.
Now, your task is this: how many odd numbers with exactly eight positive divisors are there between 1 and N (inclusive)?




Constraints

N is an integer between 1 and 200 (inclusive).







Input
Input is given from Standard Input in the following format:
N





Output
Print the count.






Sample Input 1105





Sample Output 11

Among the numbers between 1 and 105, the only number that is odd and has exactly eight divisors is 105.





Sample Input 27





Sample Output 20

1 has one divisor. 3, 5 and 7 are all prime and have two divisors. Thus, there is no number that satisfies the condition.

",105,"Bruteforcing, Implementation, Number Theory, Counting",0.736,271,181
258,"
Score: 400 points


Problem Statement
AtCoder Inc. has decided to lock the door of its office with a 3-digit PIN code.
The company has an N-digit lucky number, S. Takahashi, the president, will erase N-3 digits from S and concatenate the remaining 3 digits without changing the order to set the PIN code.
How many different PIN codes can he set this way?
Both the lucky number and the PIN code may begin with a 0.




Constraints

4 \leq N \leq 30000
S is a string of length N consisting of digits.







Input
Input is given from Standard Input in the following format:
N
S





Output
Print the number of different PIN codes Takahashi can set.






Sample Input 14
0224





Sample Output 13

Takahashi has the following options:

Erase the first digit of S and set 224.
Erase the second digit of S and set 024.
Erase the third digit of S and set 024.
Erase the fourth digit of S and set 022.

Thus, he can set three different PIN codes: 022, 024, and 224.





Sample Input 26
123123





Sample Output 217






Sample Input 319
3141592653589793238





Sample Output 3329


",Lucky PIN,"Bruteforcing, String, Two-pointer",0.655,140,72
259,"
Score : 100 points


Problem StatementYou will be given a string S of length 3 representing the weather forecast for three days in the past.
The i-th character (1 \leq i \leq 3) of S represents the forecast for the i-th day. S, C, and R stand for sunny, cloudy, and rainy, respectively.
You will also be given a string T of length 3 representing the actual weather on those three days.
The i-th character (1 \leq i \leq 3) of S represents the actual weather on the i-th day. S, C, and R stand for sunny, cloudy, and rainy, respectively.
Print the number of days for which the forecast was correct.




Constraints
S and T are strings of length 3 each.
S and T consist of S, C, and R.







InputInput is given from Standard Input in the following format:
S
T





OutputPrint the number of days for which the forecast was correct.






Sample Input 1CSS
CSR





Sample Output 12


For the first day, it was forecast to be cloudy, and it was indeed cloudy.
For the second day, it was forecast to be sunny, and it was indeed sunny.
For the third day, it was forecast to be sunny, but it was rainy.

Thus, the forecast was correct for two days in this case.





Sample Input 2SSR
SSR





Sample Output 23






Sample Input 3RRR
SSS





Sample Output 30


",Tenki,"Bruteforcing, String, Implementation, Counting",0.796,411,273
260,"
Score : 100 points


Problem StatementThe window of Takahashi's room has a width of A. There are two curtains hung over the window, each of which has a horizontal length of B. (Vertically, the curtains are long enough to cover the whole window.)
We will close the window so as to minimize the total horizontal length of the uncovered part of the window.
Find the total horizontal length of the uncovered parts of the window then.




Constraints
1 \leq A \leq 100
1 \leq B \leq 100
A and B are integers.







InputInput is given from Standard Input in the following format:
A B





OutputPrint the total horizontal length of the uncovered parts of the window.






Sample Input 112 4





Sample Output 14

We have a window with a horizontal length of 12, and two curtains, each of length 4, that cover both ends of the window, for example. The uncovered part has a horizontal length of 4.





Sample Input 220 15





Sample Output 20

If the window is completely covered, print 0.





Sample Input 320 30





Sample Output 30

Each curtain may be longer than the window.

",Curtain,"Implementation, Arithmetic",0.811,357,267
261,"
Score : 100 points


Problem StatementGiven is an integer N.
Takahashi chooses an integer a from the positive integers not greater than N with equal probability.
Find the probability that a is odd.




Constraints
1 \leq N \leq 100







InputInput is given from Standard Input in the following format:
N





OutputPrint the probability that a is odd.
Your output will be considered correct when its absolute or relative error from the judge's output is at most 10^{-6}.






Sample Input 14





Sample Output 10.5000000000

There are four positive integers not greater than 4: 1, 2, 3, and 4. Among them, we have two odd numbers: 1 and 3. Thus, the answer is \frac{2}{4} = 0.5.





Sample Input 25





Sample Output 20.6000000000






Sample Input 31





Sample Output 31.0000000000


",Odds of Oddness,"Arithmetic, Boolean Operations On Geometric Objects, Numerical Analysis",0.693,460,268
262,"
Score: 100 points


Problem Statement
The weather in Takahashi's town changes day by day, in the following cycle: Sunny, Cloudy, Rainy, Sunny, Cloudy, Rainy, ...
Given is a string S representing the weather in the town today. Predict the weather tomorrow.




Constraints

S is Sunny, Cloudy, or Rainy.







Input
Input is given from Standard Input in the following format:
S





Output
Print a string representing the expected weather tomorrow, in the same format in which input is given.






Sample Input 1Sunny





Sample Output 1Cloudy

In Takahashi's town, a sunny day is followed by a cloudy day.





Sample Input 2Rainy





Sample Output 2Sunny


",Weather Prediction,"Implementation, String, Set / Map",0.764,402,275
263,"
Score : 100 points


Problem StatementTakahashi is going to set a 3-character password.
How many possible passwords are there if each of its characters must be a digit between 1 and N (inclusive)?




Constraints
1 \leq N \leq 9
N is an integer.







InputInput is given from Standard Input in the following format:
N





OutputPrint the number of possible passwords.






Sample Input 12





Sample Output 18

There are eight possible passwords: 111, 112, 121, 122, 211, 212, 221, and 222.





Sample Input 21





Sample Output 21

There is only one possible password if you can only use one kind of character.

",Password,"Arithmetic, Implementation",0.782,370,276
264,"
Score : 100 points


Problem StatementYou will be given an integer a and a string s consisting of lowercase English letters as input.
Write a program that prints s if a is not less than 3200 and prints red if a is less than 3200.




Constraints
2800 \leq a < 5000
s is a string of length between 1 and 10 (inclusive).
Each character of s is a lowercase English letter.







InputInput is given from Standard Input in the following format:
a
s





OutputIf a is not less than 3200, print s; if a is less than 3200, print red.






Sample Input 13200
pink





Sample Output 1pink

a = 3200 is not less than 3200, so we print s = pink.





Sample Input 23199
pink





Sample Output 2red

a = 3199 is less than 3200, so we print red.





Sample Input 34049
red





Sample Output 3red

a = 4049 is not less than 3200, so we print s = red.

",Red or Not,Implementation,0.734,471,260
265,"
Score : 100 points


Problem StatementWe have two integers: A and B.
Print the largest number among A + B, A - B, and A \times B.




Constraints
All values in input are integers.
-100 \leq A,\ B \leq 100







InputInput is given from Standard Input in the following format:
A B





OutputPrint the largest number among A + B, A - B, and A \times B.






Sample Input 1-13 3





Sample Output 1-10

The largest number among A + B = -10, A - B = -16, and A \times B = -39 is -10.





Sample Input 21 -33





Sample Output 234

The largest number among A + B = -32, A - B = 34, and A \times B = -33 is 34.





Sample Input 313 3





Sample Output 339

The largest number among A + B = 16, A - B = 10, and A \times B = 39 is 39.

",+-x,"Arithmetic, Boolean Operations On Geometric Objects",0.811,388,275
266,"
Score : 100 points


Problem StatementX and A are integers between 0 and 9 (inclusive).
If X is less than A, print 0; if X is not less than A, print 10.




Constraints
0 \leq X, A \leq 9
All values in input are integers.







InputInput is given from Standard Input in the following format:
X A





OutputIf X is less than A, print 0; if X is not less than A, print 10.






Sample Input 13 5





Sample Output 10

3 is less than 5, so we should print 0.





Sample Input 27 5





Sample Output 210

7 is not less than 5, so we should print 10.





Sample Input 36 6





Sample Output 310

6 is not less than 6, so we should print 10.

",Rounding,"Implementation, Arithmetic",0.836,398,277
267,"
Score : 100 points


Problem StatementWe have two bottles for holding water.
Bottle 1 can hold up to A milliliters of water, and now it contains B milliliters of water.
Bottle 2 contains C milliliters of water.
We will transfer water from Bottle 2 to Bottle 1 as much as possible.
How much amount of water will remain in Bottle 2?




Constraints
All values in input are integers.
1 \leq B \leq A \leq 20
1 \leq C \leq 20







InputInput is given from Standard Input in the following format:
A B C





OutputPrint the integer representing the amount of water, in milliliters, that will remain in Bottle 2.






Sample Input 16 4 3





Sample Output 11

We will transfer two milliliters of water from Bottle 2 to Bottle 1, and one milliliter of water will remain in Bottle 2.





Sample Input 28 3 9





Sample Output 24






Sample Input 312 3 7





Sample Output 30


",Transfer,"Implementation, Arithmetic",0.755,384,253
268,"
Score: 100 points


Problem StatementWe have two distinct integers A and B.
Print the integer K such that |A - K| = |B - K|.
If such an integer does not exist, print IMPOSSIBLE instead.




Constraints
All values in input are integers.
0 \leq A,\ B \leq 10^9
A and B are distinct.







InputInput is given from Standard Input in the following format:
A B





OutputPrint the integer K satisfying the condition.
If such an integer does not exist, print IMPOSSIBLE instead.






Sample Input 12 16





Sample Output 19

|2 - 9| = 7 and |16 - 9| = 7, so 9 satisfies the condition.





Sample Input 20 3





Sample Output 2IMPOSSIBLE

No integer satisfies the condition.





Sample Input 3998244353 99824435





Sample Output 3549034394


",Harmony,"Arithmetic, Implementation, Parity",0.702,400,224
269,"
Score : 100 points


Problem StatementIt is known that the area of a regular dodecagon inscribed in a circle of radius a is 3a^2.
Given an integer r, find the area of a regular dodecagon inscribed in a circle of radius r.




Constraints
1 \leq r \leq 100
r is an integer.







InputInput is given from Standard Input in the following format:
r





OutputPrint an integer representing the area of the regular dodecagon.






Sample Input 14





Sample Output 148

The area of the regular dodecagon is 3 \times 4^2 = 48.





Sample Input 215





Sample Output 2675






Sample Input 380





Sample Output 319200


",Dodecagon,"Arithmetic, Implementation",0.876,300,226
270,"
Score : 100 points


Problem StatementN of us are going on a trip, by train or taxi.
The train will cost each of us A yen (the currency of Japan).
The taxi will cost us a total of B yen.
How much is our minimum total travel expense?




Constraints
All values in input are integers.
1 \leq N \leq 20
1 \leq A \leq 50
1 \leq B \leq 50







InputInput is given from Standard Input in the following format:
N A B





OutputPrint an integer representing the minimum total travel expense.






Sample Input 14 2 9





Sample Output 18

The train will cost us 4 \times 2 = 8 yen, and the taxi will cost us 9 yen, so the minimum total travel expense is 8 yen.





Sample Input 24 2 7





Sample Output 27






Sample Input 34 2 8





Sample Output 38


",T or T,"Arithmetic, Implementation",0.801,381,254
271,"
Score : 100 points


Problem StatementYou are given a 4-character string S consisting of uppercase English letters.
Determine if S consists of exactly two kinds of characters which both appear twice in S.




Constraints
The length of S is 4.
S consists of uppercase English letters.







InputInput is given from Standard Input in the following format:
S





OutputIf S consists of exactly two kinds of characters which both appear twice in S, print Yes; otherwise, print No.






Sample Input 1ASSA





Sample Output 1Yes

S consists of A and S which both appear twice in S.





Sample Input 2STOP





Sample Output 2No






Sample Input 3FFEE





Sample Output 3Yes






Sample Input 4FREE





Sample Output 4No


",Fifty-Fifty,"Sorting, Array, String, Boolean Operations On Geometric Objects",0.548,393,206
272,"
Score : 100 points


Problem Statement
The door of Snuke's laboratory is locked with a security code.
The security code is a 4-digit number. We say the security code is hard to enter when it contains two consecutive digits that are the same.
You are given the current security code S. If S is hard to enter, print Bad; otherwise, print Good.




Constraints

S is a 4-character string consisting of digits.







Input
Input is given from Standard Input in the following format:
S





Output
If S is hard to enter, print Bad; otherwise, print Good.






Sample Input 13776





Sample Output 1Bad

The second and third digits are the same, so 3776 is hard to enter.





Sample Input 28080





Sample Output 2Good

There are no two consecutive digits that are the same, so 8080 is not hard to enter.





Sample Input 31333





Sample Output 3Bad






Sample Input 40024





Sample Output 4Bad


",Security,"String, Array, Bruteforcing, Implementation",0.726,400,266
273,"
Score : 100 points


Problem StatementThere are three airports A, B and C, and flights between each pair of airports in both directions.
A one-way flight between airports A and B takes P hours, a one-way flight between airports B and C takes Q hours, and a one-way flight between airports C and A takes R hours.
Consider a route where we start at one of the airports, fly to another airport and then fly to the other airport.
What is the minimum possible sum of the flight times?




Constraints
1 \leq P,Q,R \leq 100
All values in input are integers.







InputInput is given from Standard Input in the following format:
P Q R





OutputPrint the minimum possible sum of the flight times.






Sample Input 11 3 4





Sample Output 14


The sum of the flight times in the route A \rightarrow B \rightarrow C: 1 + 3 = 4 hours
The sum of the flight times in the route A \rightarrow C \rightarrow C: 4 + 3 = 7 hours
The sum of the flight times in the route B \rightarrow A \rightarrow C: 1 + 4 = 5 hours
The sum of the flight times in the route B \rightarrow C \rightarrow A: 3 + 4 = 7 hours
The sum of the flight times in the route C \rightarrow A \rightarrow B: 4 + 1 = 5 hours
The sum of the flight times in the route C \rightarrow B \rightarrow A: 3 + 1 = 4 hours

The minimum of these is 4 hours.





Sample Input 23 2 3





Sample Output 25


",Airplane,"Arithmetic, Enumeration, Greedy Algorithm, Sorting",0.754,367,235
274,"
Score : 100 points


Problem StatementWe have A apples and P pieces of apple.
We can cut an apple into three pieces of apple, and make one apple pie by simmering two pieces of apple in a pan.
Find the maximum number of apple pies we can make with what we have now.




Constraints
All values in input are integers.
0 \leq A, P \leq 100







InputInput is given from Standard Input in the following format:
A P





OutputPrint the maximum number of apple pies we can make with what we have.






Sample Input 11 3





Sample Output 13

We can first make one apple pie by simmering two of the three pieces of apple. Then, we can make two more by simmering the remaining piece and three more pieces obtained by cutting the whole apple.





Sample Input 20 1





Sample Output 20

We cannot make an apple pie in this case, unfortunately.





Sample Input 332 21





Sample Output 358


",Apple Pie,"Arithmetic, Mathematics",0.889,322,273
275,"
Score : 100 points


Problem StatementTakahashi, who is A years old, is riding a Ferris wheel.
It costs B yen (B is an even number) to ride the Ferris wheel if you are 13 years old or older, but children between 6 and 12 years old (inclusive) can ride it for half the cost, and children who are 5 years old or younger are free of charge. (Yen is the currency of Japan.)
Find the cost of the Ferris wheel for Takahashi.




Constraints
0 ≤ A ≤ 100
2 ≤ B ≤ 1000
B is an even number.







InputInput is given from Standard Input in the following format:
A B





OutputPrint the cost of the Ferris wheel for Takahashi.






Sample Input 130 100





Sample Output 1100

Takahashi is 30 years old now, and the cost of the Ferris wheel is 100 yen.





Sample Input 212 100





Sample Output 250

Takahashi is 12 years old, and the cost of the Ferris wheel is the half of 100 yen, that is, 50 yen.





Sample Input 30 100





Sample Output 30

Takahashi is 0 years old, and he can ride the Ferris wheel for free.

",Ferris Wheel,"Implementation, Arithmetic",0.775,409,277
276,"
Score : 100 points


Problem StatementYou are given a string S of length N consisting of A, B and C, and an integer K which is between 1 and N (inclusive).
Print the string S after lowercasing the K-th character in it.




Constraints
1 ≤ N ≤ 50
1 ≤ K ≤ N
S is a string of length N consisting of A, B and C.







InputInput is given from Standard Input in the following format:
N K
S





OutputPrint the string S after lowercasing the K-th character in it.






Sample Input 13 1
ABC





Sample Output 1aBC






Sample Input 24 3
CABA





Sample Output 2CAbA


",Changing a Character,String,0.8,371,261
277,"
Score : 200 points


Problem StatementTakahashi has A cookies, and Aoki has B cookies.
Takahashi will do the following action K times:

If Takahashi has one or more cookies, eat one of his cookies.
Otherwise, if Aoki has one or more cookies, eat one of Aoki's cookies.
If they both have no cookies, do nothing.

In the end, how many cookies will Takahashi and Aoki have, respectively?




Constraints
0 \leq A \leq 10^{12}
0 \leq B \leq 10^{12}
0 \leq K \leq 10^{12}
All values in input are integers.







InputInput is given from Standard Input in the following format:
A B K





OutputPrint the numbers of Takahashi's and Aoki's cookies after K actions.






Sample Input 12 3 3





Sample Output 10 2

Takahashi will do the following:

He has two cookies, so he eats one of them.
Now he has one cookie left, and he eats it.
Now he has no cookies left, but Aoki has three, so Takahashi eats one of them.

Thus, in the end, Takahashi will have 0 cookies, and Aoki will have 2.





Sample Input 2500000000000 500000000000 1000000000000





Sample Output 20 0

Watch out for overflows.

",Greedy Takahashi,"Implementation, Arithmetic, Greedy Algorithm",0.421,541,180
278,"
Score : 200 points


Problem StatementWe have a string S of length N consisting of uppercase English letters.
How many times does ABC occur in S as contiguous subsequences (see Sample Inputs and Outputs)?




Constraints
3 \leq N \leq 50
S consists of uppercase English letters.







InputInput is given from Standard Input in the following format:
N
S





OutputPrint number of occurrences of ABC in S as contiguous subsequences.






Sample Input 110
ZABCDBABCQ





Sample Output 12

Two contiguous subsequences of S are equal to ABC: the 2-nd through 4-th characters, and the 7-th through 9-th characters.





Sample Input 219
THREEONEFOURONEFIVE





Sample Output 20

No contiguous subsequences of S are equal to ABC.





Sample Input 333
ABCCABCBABCCABACBCBBABCBCBCBCABCB





Sample Output 35


",Count ABC,"Bruteforcing, String",0.579,425,221
279,"
Score : 100 points


Problem StatementHow many multiples of d are there among the integers between L and R (inclusive)?




Constraints
All values in input are integers.
1 \leq L \leq R \leq 100
1 \leq d \leq 100







InputInput is given from Standard Input in the following format:
L R d





OutputPrint the number of multiples of d among the integers between L and R (inclusive).






Sample Input 15 10 2





Sample Output 13


Among the integers between 5 and 10, there are three multiples of 2: 6, 8, and 10.






Sample Input 26 20 7





Sample Output 22


Among the integers between 6 and 20, there are two multiples of 7: 7 and 14.






Sample Input 31 100 1





Sample Output 3100


",Number of Multiples,"Implementation, Bruteforcing, Arithmetic, Mathematics",0.843,438,325
280,"
Score : 200 points


Problem StatementWe have N squares assigned the numbers 1,2,3,\ldots,N. Each square has an integer written on it, and the integer written on Square i is a_i.
How many squares i satisfy both of the following conditions?

The assigned number, i, is odd.
The written integer is odd.





Constraints
All values in input are integers.
1 \leq N, a_i \leq 100







InputInput is given from Standard Input in the following format:
N
a_1 a_2 \cdots a_N





OutputPrint the number of squares that satisfy both of the conditions.






Sample Input 15
1 3 4 5 7





Sample Output 12


Two squares, Square 1 and 5, satisfy both of the conditions.
For Square 2 and 4, the assigned numbers are not odd.
For Square 3, the written integer is not odd.






Sample Input 215
13 76 46 15 50 98 93 77 31 43 84 90 6 24 14





Sample Output 23


",An Odd Problem,"Bruteforcing, Implementation, Arithmetic, Counting",0.754,450,320
281,"
Score: 100 points


Problem Statement
M-kun is a competitor in AtCoder, whose highest rating is X.
In this site, a competitor is given a kyu (class) according to his/her highest rating. For ratings from 400 through 1999, the following kyus are given:

From 400 through 599: 8-kyu
From 600 through 799: 7-kyu
From 800 through 999: 6-kyu
From 1000 through 1199: 5-kyu
From 1200 through 1399: 4-kyu
From 1400 through 1599: 3-kyu
From 1600 through 1799: 2-kyu
From 1800 through 1999: 1-kyu

What kyu does M-kun have?




Constraints

400 \leq X \leq 1999
X is an integer.







Input
Input is given from Standard Input in the following format:
X





Output
Print the kyu M-kun has, as an integer.
For example, if he has 8-kyu, print 8.






Sample Input 1725





Sample Output 17

M-kun's highest rating is 725, which corresponds to 7-kyu.
Thus, 7 is the correct output.





Sample Input 21600





Sample Output 22

M-kun's highest rating is 1600, which corresponds to 2-kyu.
Thus, 2 is the correct output.

",Kyu in AtCoder,Implementation,0.839,347,261
282,"
Score: 200 points


Problem Statement
M-kun has the following three cards:

A red card with the integer A.
A green card with the integer B.
A blue card with the integer C.

He is a genius magician who can do the following operation at most K times:

Choose one of the three cards and multiply the written integer by 2.

His magic is successful if both of the following conditions are satisfied after the operations:

The integer on the green card is strictly greater than the integer on the red card.
The integer on the blue card is strictly greater than the integer on the green card.

Determine whether the magic can be successful.




Constraints

1 \leq A, B, C \leq 7
1 \leq K \leq 7
All values in input are integers.







Input
Input is given from Standard Input in the following format:
A B C
K





Output
If the magic can be successful, print Yes; otherwise, print No.






Sample Input 17 2 5
3





Sample Output 1Yes

The magic will be successful if, for example, he does the following operations:

First, choose the blue card. The integers on the red, green, and blue cards are now 7, 2, and 10, respectively.
Second, choose the green card. The integers on the red, green, and blue cards are now 7, 4, and 10, respectively.
Third, choose the green card. The integers on the red, green, and blue cards are now 7, 8, and 10, respectively.






Sample Input 27 4 2
3





Sample Output 2No

He has no way to succeed in the magic with at most three operations.

",Magic 2,"Greedy Algorithm, Simulation, Boolean Operations On Geometric Objects, Bruteforcing",0.626,447,240
283,"
Score : 100 points


Problem StatementIroha loves Haiku. Haiku is a short form of Japanese poetry. A Haiku consists of three phrases with 5, 7 and 5 syllables, in this order.
To create a Haiku, Iroha has come up with three different phrases. These phrases have A, B and C syllables, respectively. Determine whether she can construct a Haiku by using each of the phrases once, in some order.




Constraints
1≦A,B,C≦10







InputThe input is given from Standard Input in the following format:
A B C





OutputIf it is possible to construct a Haiku by using each of the phrases once, print YES (case-sensitive). Otherwise, print NO.






Sample Input 15 5 7





Sample Output 1YES

Using three phrases of length 5, 5 and 7, it is possible to construct a Haiku.





Sample Input 27 7 5





Sample Output 2NO


",Iroha and Haiku (ABC Edition),"Counting, Implementation, Arithmetic",0.636,613,328
284,"
Score : 300 points


Problem StatementThere is a sequence of length N: A_1, A_2, ..., A_N. Initially, this sequence is a permutation of 1, 2, ..., N.
On this sequence, Snuke can perform the following operation:

Choose K consecutive elements in the sequence. Then, replace the value of each chosen element with the minimum value among the chosen elements.

Snuke would like to make all the elements in this sequence equal by repeating the operation above some number of times.
Find the minimum number of operations required.
It can be proved that, Under the constraints of this problem, this objective is always achievable.




Constraints
2 \leq K \leq N \leq 100000
A_1, A_2, ..., A_N is a permutation of 1, 2, ..., N.







InputInput is given from Standard Input in the following format:
N K
A_1 A_2 ... A_N





OutputPrint the minimum number of operations required.






Sample Input 14 3
2 3 1 4





Sample Output 12

One optimal strategy is as follows:


In the first operation, choose the first, second and third elements. The sequence A becomes 1, 1, 1, 4.


In the second operation, choose the second, third and fourth elements. The sequence A becomes 1, 1, 1, 1.







Sample Input 23 3
1 2 3





Sample Output 21






Sample Input 38 3
7 3 1 8 4 6 2 5





Sample Output 34


",Minimization,"Greedy Algorithm, Mathematics, Arithmetic",0.418,355,114
285,"
Score : 300 points


Problem StatementWe have two desks: A and B. Desk A has a vertical stack of N books on it, and Desk B similarly has M books on it.
It takes us A_i minutes to read the i-th book from the top on Desk A (1 \leq i \leq N), and B_i minutes to read the i-th book from the top on Desk B (1 \leq i \leq M).
Consider the following action:

Choose a desk with a book remaining, read the topmost book on that desk, and remove it from the desk.

How many books can we read at most by repeating this action so that it takes us at most K minutes in total? We ignore the time it takes to do anything other than reading.




Constraints
1 \leq N, M \leq 200000
1 \leq K \leq 10^9
1 \leq A_i, B_i \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N M K
A_1 A_2 \ldots A_N
B_1 B_2 \ldots B_M





OutputPrint an integer representing the maximum number of books that can be read.






Sample Input 13 4 240
60 90 120
80 150 80 150





Sample Output 13

In this case, it takes us 60, 90, 120 minutes to read the 1-st, 2-nd, 3-rd books from the top on Desk A, and 80, 150, 80, 150 minutes to read the 1-st, 2-nd, 3-rd, 4-th books from the top on Desk B, respectively.
We can read three books in 230 minutes, as shown below, and this is the maximum number of books we can read within 240 minutes.

Read the topmost book on Desk A in 60 minutes, and remove that book from the desk.
Read the topmost book on Desk B in 80 minutes, and remove that book from the desk.
Read the topmost book on Desk A in 90 minutes, and remove that book from the desk.






Sample Input 23 4 730
60 90 120
80 150 80 150





Sample Output 27






Sample Input 35 4 1
1000000000 1000000000 1000000000 1000000000 1000000000
1000000000 1000000000 1000000000 1000000000





Sample Output 30

Watch out for integer overflows.

",Tsundoku,"Prefix sum, Two-pointer, Greedy Algorithm, Bruteforcing",0.092,1717,232
286,"
Score : 400 points


Problem StatementGiven are integers A, B, and N.
Find the maximum possible value of floor(Ax/B) - A × floor(x/B) for a non-negative integer x not greater than N.
Here floor(t) denotes the greatest integer not greater than the real number t.




Constraints
1 ≤ A ≤ 10^{6}
1 ≤ B ≤ 10^{12}
1 ≤ N ≤ 10^{12}
All values in input are integers.







InputInput is given from Standard Input in the following format:
A B N





OutputPrint the maximum possible value of floor(Ax/B) - A × floor(x/B) for a non-negative integer x not greater than N, as an integer.






Sample Input 15 7 4





Sample Output 12

When x=3, floor(Ax/B)-A×floor(x/B) = floor(15/7) - 5×floor(3/7) = 2. This is the maximum value possible.





Sample Input 211 10 9





Sample Output 29


",Floor Function,"Arithmetic, Mathematics, Greedy Algorithm",0.264,813,146
287,"
Score : 200 points


Problem StatementTakahashi went to an all-you-can-eat buffet with N kinds of dishes and ate all of them (Dish 1, Dish 2, \ldots, Dish N) once.
The i-th dish (1 \leq i \leq N) he ate was Dish A_i.
When he eats Dish i (1 \leq i \leq N), he gains B_i satisfaction points.
Additionally, when he eats Dish i+1 just after eating Dish i (1 \leq i \leq N - 1), he gains C_i more satisfaction points.
Find the sum of the satisfaction points he gained.




Constraints
All values in input are integers.
2 \leq N \leq 20
1 \leq A_i \leq N
A_1, A_2, ..., A_N are all different.
1 \leq B_i \leq 50
1 \leq C_i \leq 50







InputInput is given from Standard Input in the following format:
N
A_1 A_2 ... A_N
B_1 B_2 ... B_N
C_1 C_2 ... C_{N-1}





OutputPrint the sum of the satisfaction points Takahashi gained, as an integer.






Sample Input 13
3 1 2
2 5 4
3 6





Sample Output 114

Takahashi gained 14 satisfaction points in total, as follows:

First, he ate Dish 3 and gained 4 satisfaction points.
Next, he ate Dish 1 and gained 2 satisfaction points.
Lastly, he ate Dish 2 and gained 5 + 3 = 8 satisfaction points.






Sample Input 24
2 3 4 1
13 5 8 24
45 9 15





Sample Output 274






Sample Input 32
1 2
50 50
50





Sample Output 3150


",Buffet,"Array, Boolean Operations On Geometric Objects, Arithmetic",0.848,333,249
288,"
Score : 200 points


Problem StatementGiven are strings s and t of length N each, both consisting of lowercase English letters.
Let us form a new string by alternating the characters of S and the characters of T, as follows: the first character of S, the first character of T, the second character of S, the second character of T, ..., the N-th character of S, the N-th character of T. Print this new string.




Constraints
1 \leq N \leq 100
|S| = |T| = N
S and T are strings consisting of lowercase English letters.







InputInput is given from Standard Input in the following format:
N
S T





OutputPrint the string formed.






Sample Input 12
ip cc





Sample Output 1icpc






Sample Input 28
hmhmnknk uuuuuuuu





Sample Output 2humuhumunukunuku






Sample Input 35
aaaaa aaaaa





Sample Output 3aaaaaaaaaa


",Strings with the Same Length,"Bruteforcing, String",0.827,328,235
289,"
Score : 300 points


Problem StatementLet f(n) be the number of triples of integers (x,y,z) that satisfy both of the following conditions:

1 \leq x,y,z
x^2 + y^2 + z^2 + xy + yz + zx = n

Given an integer N, find each of f(1),f(2),f(3),\ldots,f(N).




Constraints
All values in input are integers.
1 \leq N \leq 10^4







InputInput is given from Standard Input in the following format:
N





OutputPrint N lines. The i-th line should contain the value f(i).






Sample Input 120





Sample Output 10
0
0
0
0
1
0
0
0
0
3
0
0
0
0
0
3
3
0
0


For n=6, only (1,1,1) satisfies both of the conditions. Thus, f(6) = 1.
For n=11, three triples, (1,1,2), (1,2,1), and (2,1,1), satisfy both of the conditions. Thus, f(6) = 3.
For n=17, three triples, (1,2,2), (2,1,2), and (2,2,1), satisfy both of the conditions. Thus, f(17) = 3.
For n=18, three triples, (1,1,3), (1,3,1), and (3,1,1), satisfy both of the conditions. Thus, f(18) = 3.


",XYZ Triplets,"Bruteforcing, Arithmetic, Counting, Binary Search",0.494,734,238
290,"
Score : 100 points


Problem StatementWhen you asked some guy in your class his name, he called himself S, where S is a string of length between 3 and 20 (inclusive) consisting of lowercase English letters.
You have decided to choose some three consecutive characters from S and make it his nickname. Print a string that is a valid nickname for him.




Constraints
3 \leq |S| \leq 20
S consists of lowercase English letters.







InputInput is given from Standard Input in the following format:
S





OutputPrint your answer.






Sample Input 1takahashi





Sample Output 1tak






Sample Input 2naohiro





Sample Output 2nao


",Nickname,String,0.872,224,147
291,"
Score : 200 points


Problem StatementTwo children are playing tag on a number line. (In the game of tag, the child called ""it"" tries to catch the other child.) The child who is ""it"" is now at coordinate A, and he can travel the distance of V per second.
The other child is now at coordinate B, and she can travel the distance of W per second.
He can catch her when his coordinate is the same as hers.
Determine whether he can catch her within T seconds (including exactly T seconds later).
We assume that both children move optimally.




Constraints
-10^9 \leq A,B \leq 10^9
1 \leq V,W \leq 10^9
1 \leq  T \leq 10^9
A \neq B
All values in input are integers.







InputInput is given from Standard Input in the following format:
A V
B W
T





OutputIf ""it"" can catch the other child, print YES; otherwise, print NO.






Sample Input 11 2
3 1
3





Sample Output 1YES






Sample Input 21 2
3 2
3





Sample Output 2NO






Sample Input 31 2
3 3
3





Sample Output 3NO


",Tag,"Arithmetic, Implementation, Greedy Algorithm, Mathematics",0.163,885,128
292,"
Score: 300 points


Problem Statement
Consider an analog clock whose hour and minute hands are A and B centimeters long, respectively.
An endpoint of the hour hand and an endpoint of the minute hand are fixed at the same point, around which each hand rotates clockwise at constant angular velocity. It takes the hour and minute hands 12 hours and 1 hour to make one full rotation, respectively.
At 0 o'clock, the two hands overlap each other. H hours and M minutes later, what is the distance in centimeters between the unfixed endpoints of the hands?




Constraints

All values in input are integers.
1 \leq A, B \leq 1000
0 \leq H \leq 11
0 \leq M \leq 59







Input
Input is given from Standard Input in the following format:
A B H M





Output
Print the answer without units. Your output will be accepted when its absolute or relative error from the correct value is at most 10^{-9}.






Sample Input 13 4 9 0





Sample Output 15.00000000000000000000

The two hands will be in the positions shown in the figure below, so the answer is 5 centimeters.






Sample Input 23 4 10 40





Sample Output 24.56425719433005567605

The two hands will be in the positions shown in the figure below. Note that each hand always rotates at constant angular velocity.


",: (Colon),"Mathematics, Arithmetic",0.549,806,343
293,"
Score : 100 points


Problem StatementYou are given a string S as input. This represents a valid date in the year 2019 in the yyyy/mm/dd format. (For example, April 30, 2019 is represented as 2019/04/30.)
Write a program that prints Heisei if the date represented by S is not later than April 30, 2019, and prints TBD otherwise.




Constraints
S is a string that represents a valid date in the year 2019 in the yyyy/mm/dd format.







InputInput is given from Standard Input in the following format:
S





OutputPrint Heisei if the date represented by S is not later than April 30, 2019, and print TBD otherwise.






Sample Input 12019/04/30





Sample Output 1Heisei






Sample Input 22019/11/01





Sample Output 2TBD


",Still TBD,"Parsing, Bitmask, Implementation, Sorting",0.716,276,152
294,"
Score : 100 points


Problem StatementTakahashi likes the sound when he buys a drink from a vending machine.
That sound can be heard by spending A yen (the currency of Japan) each time.
Takahashi has B yen. He will hear the sound as many times as he can with that money, but at most C times, as he would be satisfied at that time.
How many times will he hear the sound?




Constraints
All values in input are integers.
1 \leq A, B, C \leq 100







InputInput is given from Standard Input in the following format:
A B C





OutputPrint the number of times Takahashi will hear his favorite sound.






Sample Input 12 11 4





Sample Output 14

Since he has not less than 8 yen, he will hear the sound four times and be satisfied.





Sample Input 23 9 5





Sample Output 23

He may not be able to be satisfied.





Sample Input 3100 1 10





Sample Output 30


",Favorite Sound,"Arithmetic, Boolean Operations On Geometric Objects",0.794,273,193
295,"
Score : 100 points


Problem StatementThere is a right triangle ABC with ∠ABC=90°.
Given the lengths of the three sides, |AB|,|BC| and |CA|, find the area of the right triangle ABC.
It is guaranteed that the area of the triangle ABC is an integer.




Constraints
1 \leq |AB|,|BC|,|CA| \leq 100
All values in input are integers.
The area of the triangle ABC is an integer.







InputInput is given from Standard Input in the following format:
|AB| |BC| |CA|





OutputPrint the area of the triangle ABC.






Sample Input 13 4 5





Sample Output 16


This triangle has an area of 6.





Sample Input 25 12 13





Sample Output 230

This triangle has an area of 30.





Sample Input 345 28 53





Sample Output 3630

This triangle has an area of 630.

",Right Triangle,"Sorting, Arithmetic, Boolean Operations On Geometric Objects",0.816,206,147
296,"
Score : 100 points


Problem StatementIn order to pass the entrance examination tomorrow, Taro has to study for T more hours.
Fortunately, he can leap to World B where time passes X times as fast as it does in our world (World A).
While (X \times t) hours pass in World B, t hours pass in World A.
How many hours will pass in World A while Taro studies for T hours in World B?




Constraints
All values in input are integers.
1 \leq T \leq 100
1 \leq X \leq 100







InputInput is given from Standard Input in the following format:
T X





OutputPrint the number of hours that will pass in World A.
The output will be regarded as correct when its absolute or relative error from the judge's output is at most 10^{-3}.






Sample Input 18 3





Sample Output 12.6666666667

While Taro studies for eight hours in World B where time passes three times as fast, 2.6666... hours will pass in World A.
Note that an absolute or relative error of at most 10^{-3} is allowed.





Sample Input 299 1





Sample Output 299.0000000000






Sample Input 31 100





Sample Output 30.0100000000


",Entrance Examination,"Arithmetic, Implementation",0.839,201,156
297,"
Score : 100 points


Problem StatementYou are given positive integers A and B.
If A is a divisor of B, print A + B; otherwise, print B - A.




Constraints
All values in input are integers.
1 \leq A \leq B \leq 20







InputInput is given from Standard Input in the following format:
A B





OutputIf A is a divisor of B, print A + B; otherwise, print B - A.






Sample Input 14 12





Sample Output 116

As 4 is a divisor of 12, 4 + 12 = 16 should be printed.





Sample Input 28 20





Sample Output 212






Sample Input 31 1





Sample Output 32

1 is a divisor of 1.

",B +/- A,"Arithmetic, Implementation",0.815,243,160
298,"
Score : 100 points


Problem StatementThere are H rows and W columns of white square cells.
You will choose h of the rows and w of the columns, and paint all of the cells contained in those rows or columns.
How many white cells will remain?
It can be proved that this count does not depend on what rows and columns are chosen.




Constraints
All values in input are integers.
1 \leq H, W \leq 20
1 \leq h \leq H
1 \leq w \leq W







InputInput is given from Standard Input in the following format:
H W
h w





OutputPrint the number of white cells that will remain.






Sample Input 13 2
2 1





Sample Output 11

There are 3 rows and 2 columns of cells. When two rows and one column are chosen and painted in black, there is always one white cell that remains.





Sample Input 25 5
2 3





Sample Output 26






Sample Input 32 4
2 4





Sample Output 30


",White Cells,"Arithmetic, Inclusion And Exclusion, Mathematics",0.794,291,208
299,"
﻿Score: 100 points


Problem Statement
In AtCoder city, there are five antennas standing in a straight line. They are called Antenna A, B, C, D and E from west to east, and their coordinates are a, b, c, d and e, respectively.
Two antennas can communicate directly if the distance between them is k or less, and they cannot if the distance is greater than k.
Determine if there exists a pair of antennas that cannot communicate directly.
Here, assume that the distance between two antennas at coordinates p and q (p < q) is q - p.  




Constraints

a, b, c, d, e and k are integers between 0 and 123 (inclusive).
a < b < c < d < e







Input
Input is given from Standard Input in the following format:
a
b
c
d
e
k





Output
Print :( if there exists a pair of antennas that cannot communicate directly, and print Yay! if there is no such pair.






Sample Input 11
2
4
8
9
15





Sample Output 1Yay!

In this case, there is no pair of antennas that cannot communicate directly, because:

the distance between A and B is 2 - 1 = 1
the distance between A and C is 4 - 1 = 3
the distance between A and D is 8 - 1 = 7
the distance between A and E is 9 - 1 = 8
the distance between B and C is 4 - 2 = 2
the distance between B and D is 8 - 2 = 6
the distance between B and E is 9 - 2 = 7
the distance between C and D is 8 - 4 = 4
the distance between C and E is 9 - 4 = 5
the distance between D and E is 9 - 8 = 1

and none of them is greater than 15. Thus, the correct output is Yay!.





Sample Input 215
18
26
35
36
18





Sample Output 2:(

In this case, the distance between antennas A and D is 35 - 15 = 20 and exceeds 18, so they cannot communicate directly.
Thus, the correct output is :(.

",Five Antennas,"Arithmetic, Implementation, Array",0.665,405,221
300,"
Score : 100 points


Problem StatementThere are two buttons, one of size A and one of size B.
When you press a button of size X, you get X coins and the size of that button decreases by 1.
You will press a button twice. Here, you can press the same button twice, or press both buttons once.
At most how many coins can you get?




Constraints
All values in input are integers.
3 \leq A, B \leq 20







InputInput is given from Standard Input in the following format:
A B





OutputPrint the maximum number of coins you can get.






Sample Input 15 3





Sample Output 19

You can get 5 + 4 = 9 coins by pressing the button of size 5 twice, and this is the maximum result.





Sample Input 23 4





Sample Output 27






Sample Input 36 6





Sample Output 312


",Buttons,"Implementation, Arithmetic, Mathematics",0.749,408,258
301,"
Score: 300 points


Problem Statement
As AtCoder Beginner Contest 100 is taking place, the office of AtCoder, Inc. is decorated with a sequence of length N, a = {a_1, a_2, a_3, ..., a_N}.
Snuke, an employee, would like to play with this sequence.
Specifically, he would like to repeat the following operation as many times as possible:
For every i satisfying 1 \leq i \leq N, perform one of the following: ""divide a_i by 2"" and ""multiply a_i by 3"".  
Here, choosing ""multiply a_i by 3"" for every i is not allowed, and the value of a_i after the operation must be an integer.

At most how many operations can be performed?




Constraints

N is an integer between 1 and 10 \ 000 (inclusive).
a_i is an integer between 1 and 1 \ 000 \ 000 \ 000 (inclusive).







Input
Input is given from Standard Input in the following format:
N
a_1 a_2 a_3 ... a_N





Output
Print the maximum number of operations that Snuke can perform.






Sample Input 13
5 2 4





Sample Output 13

The sequence is initially {5, 2, 4}. Three operations can be performed as follows:

First, multiply a_1 by 3, multiply a_2 by 3 and divide a_3 by 2. The sequence is now {15, 6, 2}.
Next, multiply a_1 by 3, divide a_2 by 2 and multiply a_3 by 3. The sequence is now {45, 3, 6}.
Finally, multiply a_1 by 3, multiply a_2 by 3 and divide a_3 by 2. The sequence is now {135, 9, 3}.






Sample Input 24
631 577 243 199





Sample Output 20

No operation can be performed since all the elements are odd. Thus, the answer is 0.





Sample Input 310
2184 2126 1721 1800 1024 2528 3360 1945 1280 1776





Sample Output 339


",*3 or /2,"Bruteforcing, Prime Factorization, Greedy Algorithm",0.817,219,161
302,"
Score : 100 points


Problem StatementThere is always an integer in Takahashi's mind.
Initially, the integer in Takahashi's mind is 0. Takahashi is now going to eat four symbols, each of which is + or -. When he eats +, the integer in his mind increases by 1; when he eats -, the integer in his mind decreases by 1.
The symbols Takahashi is going to eat are given to you as a string S. The i-th character in S is the i-th symbol for him to eat.
Find the integer in Takahashi's mind after he eats all the symbols.




Constraints
The length of S is 4.
Each character in S is + or -.







InputInput is given from Standard Input in the following format:
S





OutputPrint the integer in Takahashi's mind after he eats all the symbols.






Sample Input 1+-++





Sample Output 12


Initially, the integer in Takahashi's mind is 0.
The first integer for him to eat is +. After eating it, the integer in his mind becomes 1.
The second integer to eat is -. After eating it, the integer in his mind becomes 0.
The third integer to eat is +. After eating it, the integer in his mind becomes 1.
The fourth integer to eat is +. After eating it, the integer in his mind becomes 2.

Thus, the integer in Takahashi's mind after he eats all the symbols is 2.





Sample Input 2-+--





Sample Output 2-2






Sample Input 3----





Sample Output 3-4


",Eating Symbols Easy,"Bruteforcing, Implementation, String, Arithmetic",0.856,301,203
303,"
Score : 200 points


Problem StatementLet S(n) denote the sum of the digits in the decimal notation of n.
For example, S(101) = 1 + 0 + 1 = 2.
Given an integer N, determine if S(N) divides N.




Constraints
1 \leq N \leq 10^9







InputInput is given from Standard Input in the following format:
N





OutputIf S(N) divides N, print Yes; if it does not, print No.






Sample Input 112





Sample Output 1Yes

In this input, N=12.
As S(12) = 1 + 2 = 3, S(N) divides N.





Sample Input 2101





Sample Output 2No

As S(101) = 1 + 0 + 1 = 2, S(N) does not divide N.





Sample Input 3999999999





Sample Output 3Yes


",Digit Sums,"Arithmetic, String, Bruteforcing, Implementation",0.829,268,201
304,"
Score : 500 points


Problem StatementLet S(n) denote the sum of the digits in the decimal notation of n.
For example, S(123) = 1 + 2 + 3 = 6.
We will call an integer n a Snuke number when, for all positive integers m such that m > n, \frac{n}{S(n)} \leq \frac{m}{S(m)} holds.
Given an integer K, list the K smallest Snuke numbers.




Constraints
1 \leq K
The K-th smallest Snuke number is not greater than 10^{15}.







InputInput is given from Standard Input in the following format:
K





OutputPrint K lines. The i-th line should contain the i-th smallest Snuke number.






Sample Input 110





Sample Output 11
2
3
4
5
6
7
8
9
19


",Snuke Numbers,"Greedy Algorithm, Mathematics, Bruteforcing, Arithmetic",0.111,94,8
305,"
Score : 100 points


Problem StatementYou are given a positive integer N.
Find the minimum positive integer divisible by both 2 and N.




Constraints
1 \leq N \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N





OutputPrint the minimum positive integer divisible by both 2 and N.






Sample Input 13





Sample Output 16

6 is divisible by both 2 and 3.
Also, there is no positive integer less than 6 that is divisible by both 2 and 3.
Thus, the answer is 6.





Sample Input 210





Sample Output 210






Sample Input 3999999999





Sample Output 31999999998


",Multiple of 2 and N,"Arithmetic, Implementation",0.782,280,173
306,"
Score : 300 points


Problem StatementSnuke has an integer sequence A of length N.
He will freely choose an integer b.
Here, he will get sad if A_i and b+i are far from each other.
More specifically, the sadness of Snuke is calculated as follows:

abs(A_1 - (b+1)) + abs(A_2 - (b+2)) + ... + abs(A_N - (b+N))

Here, abs(x) is a function that returns the absolute value of x.
Find the minimum possible sadness of Snuke.




Constraints
1 \leq N \leq 2 \times 10^5
1 \leq A_i \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
A_1 A_2 ... A_N





OutputPrint the minimum possible sadness of Snuke.






Sample Input 15
2 2 3 5 5





Sample Output 12

If we choose b=0, the sadness of Snuke would be abs(2-(0+1))+abs(2-(0+2))+abs(3-(0+3))+abs(5-(0+4))+abs(5-(0+5))=2.
Any choice of b does not make the sadness of Snuke less than 2, so the answer is 2.





Sample Input 29
1 2 3 4 5 6 7 8 9





Sample Output 20






Sample Input 36
6 5 4 3 2 1





Sample Output 318






Sample Input 47
1 1 1 1 2 3 4





Sample Output 46


",Linear Approximation,"Array, Sorting, Arithmetic",0.125,375,68
307,"
Score : 600 points


Problem StatementSnuke has an integer sequence A of length N.
He will make three cuts in A and divide it into four (non-empty) contiguous subsequences B, C, D and E.
The positions of the cuts can be freely chosen.
Let P,Q,R,S be the sums of the elements in B,C,D,E, respectively.
Snuke is happier when the absolute difference of the maximum and the minimum among P,Q,R,S is smaller.
Find the minimum possible absolute difference of the maximum and the minimum among P,Q,R,S.




Constraints
4 \leq N \leq 2 \times 10^5
1 \leq A_i \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
A_1 A_2 ... A_N





OutputFind the minimum possible absolute difference of the maximum and the minimum among P,Q,R,S.






Sample Input 15
3 2 4 1 2





Sample Output 12

If we divide A as B,C,D,E=(3),(2),(4),(1,2), then P=3,Q=2,R=4,S=1+2=3.
Here, the maximum and the minimum among P,Q,R,S are 4 and 2, with the absolute difference of 2.
We cannot make the absolute difference of the maximum and the minimum less than 2, so the answer is 2.





Sample Input 210
10 71 84 33 6 47 23 25 52 64





Sample Output 236






Sample Input 37
1 2 3 1000000000 4 5 6





Sample Output 3999999994


",Equal Cut,"Prefix sum, Two-pointer, Sliding Window, Sorting",0.278,56,16
308,"
Score : 100 points


Problem StatementYou have three tasks, all of which need to be completed.
First, you can complete any one task at cost 0.
Then, just after completing the i-th task, you can complete the j-th task at cost |A_j - A_i|.
Here, |x| denotes the absolute value of x.
Find the minimum total cost required to complete all the task.




Constraints
All values in input are integers.
1 \leq A_1, A_2, A_3 \leq 100







InputInput is given from Standard Input in the following format:
A_1 A_2 A_3





OutputPrint the minimum total cost required to complete all the task.






Sample Input 11 6 3





Sample Output 15

When the tasks are completed in the following order, the total cost will be 5, which is the minimum:

Complete the first task at cost 0.
Complete the third task at cost 2.
Complete the second task at cost 3.






Sample Input 211 5 5





Sample Output 26






Sample Input 3100 100 100





Sample Output 30


",Task Scheduling Problem,"Sorting, Arithmetic, Greedy Algorithm",0.781,243,177
309,"
Score : 200 points


Problem StatementYou are given string S and T consisting of lowercase English letters.
Determine if S equals T after rotation.
That is, determine if S equals T after the following operation is performed some number of times:
Operation: Let S = S_1 S_2 ... S_{|S|}. Change S to S_{|S|} S_1 S_2 ... S_{|S|-1}.
Here, |X| denotes the length of the string X.




Constraints
2 \leq |S| \leq 100
|S| = |T|
S and T consist of lowercase English letters.







InputInput is given from Standard Input in the following format:
S
T





OutputIf S equals T after rotation, print Yes; if it does not, print No.






Sample Input 1kyoto
tokyo





Sample Output 1Yes


In the first operation, kyoto becomes okyot.
In the second operation, okyot becomes tokyo.






Sample Input 2abc
arc





Sample Output 2No

abc does not equal arc after any number of operations.





Sample Input 3aaaaaaaaaaaaaaab
aaaaaaaaaaaaaaab





Sample Output 3Yes


",String Rotation,"String, Bruteforcing",0.712,253,160
310,"
Score : 300 points


Problem StatementYou are given N positive integers a_1, a_2, ..., a_N.
For a non-negative integer m, let f(m) = (m\ mod\ a_1) + (m\ mod\ a_2) + ... + (m\ mod\ a_N).
Here, X\ mod\ Y denotes the remainder of the division of X by Y.
Find the maximum value of f.




Constraints
All values in input are integers.
2 \leq N \leq 3000
2 \leq a_i \leq 10^5







InputInput is given from Standard Input in the following format:
N
a_1 a_2 ... a_N





OutputPrint the maximum value of f.






Sample Input 13
3 4 6





Sample Output 110

f(11) = (11\ mod\ 3) + (11\ mod\ 4) + (11\ mod\ 6) = 10 is the maximum value of f.





Sample Input 25
7 46 11 20 11





Sample Output 290






Sample Input 37
994 518 941 851 647 2 581





Sample Output 34527


",Modulo Summation,"Arithmetic, Mathematics, Greedy Algorithm",0.703,227,136
311,"
Score : 400 points


Problem StatementThere are N islands lining up from west to east, connected by N-1 bridges.
The i-th bridge connects the i-th island from the west and the (i+1)-th island from the west.
One day, disputes took place between some islands, and there were M requests from the inhabitants of the islands:
Request i: A dispute took place between the a_i-th island from the west and the b_i-th island from the west. Please make traveling between these islands with bridges impossible.
You decided to remove some bridges to meet all these M requests.
Find the minimum number of bridges that must be removed.




Constraints
All values in input are integers.
2 \leq N \leq 10^5
1 \leq M \leq 10^5
1 \leq a_i < b_i \leq N
All pairs (a_i, b_i) are distinct.







InputInput is given from Standard Input in the following format:
N M
a_1 b_1
a_2 b_2
:
a_M b_M





OutputPrint the minimum number of bridges that must be removed.






Sample Input 15 2
1 4
2 5





Sample Output 11

The requests can be met by removing the bridge connecting the second and third islands from the west.





Sample Input 29 5
1 8
2 7
3 5
4 6
7 9





Sample Output 22






Sample Input 35 10
1 2
1 3
1 4
1 5
2 3
2 4
2 5
3 4
3 5
4 5





Sample Output 34


",Islands War,"Greedy Algorithm, Sorting, Bruteforcing",0.468,140,65
312,"
Score : 100 points


Problem StatementA programming competition site AtCode regularly holds programming contests.
The next contest on AtCode is called ABC, which is rated for contestants with ratings less than 1200.
The contest after the ABC is called ARC, which is rated for contestants with ratings less than 2800.
The contest after the ARC is called AGC, which is rated for all contestants.
Takahashi's rating on AtCode is R. What is the next contest rated for him?




Constraints
0 ≤ R ≤ 4208
R is an integer.







InputInput is given from Standard Input in the following format:
R





OutputPrint the name of the next contest rated for Takahashi (ABC, ARC or AGC).






Sample Input 11199





Sample Output 1ABC

1199 is less than 1200, so ABC will be rated.





Sample Input 21200





Sample Output 2ARC

1200 is not less than 1200 and ABC will be unrated, but it is less than 2800 and ARC will be rated.





Sample Input 34208





Sample Output 3AGC


",Rated for Me,"Implementation, Segment Tree",0.817,219,166
313,"
Score : 200 points


Problem StatementYou are given a string S. Each character of S is uppercase or lowercase English letter.
Determine if S satisfies all of the following conditions:

The initial character of S is an uppercase A.
There is exactly one occurrence of C between the third character from the beginning and the second to last character (inclusive).
All letters except the A and C mentioned above are lowercase.





Constraints
4 ≤ |S| ≤ 10 (|S| is the length of the string S.)
Each character of S is uppercase or lowercase English letter.







InputInput is given from Standard Input in the following format:
S





OutputIf S satisfies all of the conditions in the problem statement, print AC; otherwise, print WA.






Sample Input 1AtCoder





Sample Output 1AC

The first letter is A, the third letter is C and the remaining letters are all lowercase, so all the conditions are satisfied.





Sample Input 2ACoder





Sample Output 2WA

The second letter should not be C.





Sample Input 3AcycliC





Sample Output 3WA

The last letter should not be C, either.





Sample Input 4AtCoCo





Sample Output 4WA

There should not be two or more occurrences of C.





Sample Input 5Atcoder





Sample Output 5WA

The number of C should not be zero, either.

",AcCepted,"String, Implementation, Counting",0.5,265,125
314,"
Score : 100 points


Problem StatementIn some other world, today is December D-th.
Write a program that prints Christmas if D = 25, Christmas Eve if D = 24, Christmas Eve Eve if D = 23 and Christmas Eve Eve Eve if D = 22.




Constraints
22 \leq D \leq 25
D is an integer.







InputInput is given from Standard Input in the following format:
D





OutputPrint the specified string (case-sensitive).






Sample Input 125





Sample Output 1Christmas






Sample Input 222





Sample Output 2Christmas Eve Eve Eve

Be sure to print spaces between the words.

",Christmas Eve Eve Eve,"Bruteforcing, String, Arithmetic",0.712,233,153
315,"
Score : 200 points


Problem StatementIn some other world, today is the day before Christmas Eve.
Mr. Takaha is buying N items at a department store. The regular price of the i-th item (1 \leq i \leq N) is p_i yen (the currency of Japan).
He has a discount coupon, and can buy one item with the highest price for half the regular price. The remaining N-1 items cost their regular prices. What is the total amount he will pay?




Constraints
2 \leq N \leq 10
100 \leq p_i \leq 10000
p_i is an even number.







InputInput is given from Standard Input in the following format:
N
p_1
p_2
:
p_N





OutputPrint the total amount Mr. Takaha will pay.






Sample Input 13
4980
7980
6980





Sample Output 115950

The 7980-yen item gets the discount and the total is 4980 + 7980 / 2 + 6980 = 15950 yen.
Note that outputs such as 15950.0 will be judged as Wrong Answer.





Sample Input 24
4320
4320
4320
4320





Sample Output 215120

Only one of the four items gets the discount and the total is 4320 / 2 + 4320 + 4320 + 4320 = 15120 yen.

",Christmas Eve Eve,"Sorting, Array, Arithmetic, Bruteforcing",0.854,191,150
316,"
Score : 300 points


Problem StatementIn some other world, today is Christmas Eve.
There are N trees planted in Mr. Takaha's garden. The height of the i-th tree (1 \leq i \leq N) is h_i meters.
He decides to choose K trees from these trees and decorate them with electric lights. To make the scenery more beautiful, the heights of the decorated trees should be as close to each other as possible.
More specifically, let the height of the tallest decorated tree be h_{max} meters, and the height of the shortest decorated tree be h_{min} meters. The smaller the value h_{max} - h_{min} is, the better. What is the minimum possible value of h_{max} - h_{min}?




Constraints
2 \leq K < N \leq 10^5
1 \leq h_i \leq 10^9
h_i is an integer.







InputInput is given from Standard Input in the following format:
N K
h_1
h_2
:
h_N





OutputPrint the minimum possible value of h_{max} - h_{min}.






Sample Input 15 3
10
15
11
14
12





Sample Output 12

If we decorate the first, third and fifth trees, h_{max} = 12, h_{min} = 10 so h_{max} - h_{min} = 2. This is optimal.





Sample Input 25 3
5
7
5
7
7





Sample Output 20

If we decorate the second, fourth and fifth trees, h_{max} = 7, h_{min} = 7 so h_{max} - h_{min} = 0. This is optimal.
There are not too many trees in these sample inputs, but note that there can be at most one hundred thousand trees (we just can't put a sample with a hundred thousand lines here).

",Christmas Eve,"Sorting, Sliding Window, Array, Arithmetic",0.708,212,139
317,"
Score : 400 points


Problem StatementIn some other world, today is Christmas.
Mr. Takaha decides to make a multi-dimensional burger in his party. A level-L burger (L is an integer greater than or equal to 0) is the following thing:

A level-0 burger is a patty.
A level-L burger (L \geq 1) is a bun, a level-(L-1) burger, a patty, another level-(L-1) burger and another bun, stacked vertically in this order from the bottom.

For example, a level-1 burger and a level-2 burger look like BPPPB and BBPPPBPBPPPBB (rotated 90 degrees), where B and P stands for a bun and a patty.
The burger Mr. Takaha will make is a level-N burger. Lunlun the Dachshund will eat X layers from the bottom of this burger (a layer is a patty or a bun). How many patties will she eat?




Constraints
1 \leq N \leq 50
1 \leq X \leq ( the total number of layers in a level-N burger )
N and X are integers.







InputInput is given from Standard Input in the following format:
N X





OutputPrint the number of patties in the bottom-most X layers from the bottom of a level-N burger.






Sample Input 12 7





Sample Output 14

There are 4 patties in the bottom-most 7 layers of a level-2 burger (BBPPPBPBPPPBB).





Sample Input 21 1





Sample Output 20

The bottom-most layer of a level-1 burger is a bun.





Sample Input 350 4321098765432109





Sample Output 32160549382716056

A level-50 burger is rather thick, to the extent that the number of its layers does not fit into a 32-bit integer.

",Christmas,"Recursion, Dyanmic Programming, Divide And Conquer, Binary Search, Arithmetic",0.45,130,55
318,"
Score : 300 points


Problem StatementA programming competition site AtCode provides algorithmic problems.
Each problem is allocated a score based on its difficulty.
Currently, for each integer i between 1 and D (inclusive), there are p_i problems with a score of 100i points.
These p_1 + … + p_D problems are all of the problems available on AtCode.
A user of AtCode has a value called total score.
The total score of a user is the sum of the following two elements:

Base score: the sum of the scores of all problems solved by the user.
Perfect bonuses: when a user solves all problems with a score of 100i points, he/she earns the perfect bonus of c_i points, aside from the base score (1 ≤ i ≤ D).

Takahashi, who is the new user of AtCode, has not solved any problem.
His objective is to have a total score of G or more points.
At least how many problems does he need to solve for this objective?




Constraints
1 ≤ D ≤ 10
1 ≤ p_i ≤ 100
100 ≤ c_i ≤ 10^6
100 ≤ G
All values in input are integers.
c_i and G are all multiples of 100.
It is possible to have a total score of G or more points.







InputInput is given from Standard Input in the following format:
D G
p_1 c_1
:
p_D c_D





OutputPrint the minimum number of problems that needs to be solved in order to have a total score of G or more points. Note that this objective is always achievable (see Constraints).






Sample Input 12 700
3 500
5 800





Sample Output 13

In this case, there are three problems each with 100 points and five problems each with 200 points. The perfect bonus for solving all the 100-point problems is 500 points, and the perfect bonus for solving all the 200-point problems is 800 points. Takahashi's objective is to have a total score of 700 points or more.
One way to achieve this objective is to solve four 200-point problems and earn a base score of 800 points. However, if we solve three 100-point problems, we can earn the perfect bonus of 500 points in addition to the base score of 300 points, for a total score of 800 points, and we can achieve the objective with fewer problems.





Sample Input 22 2000
3 500
5 800





Sample Output 27

This case is similar to Sample Input 1, but the Takahashi's objective this time is 2000 points or more. In this case, we inevitably need to solve all five 200-point problems, and by solving two 100-point problems additionally we have the total score of 2000 points.





Sample Input 32 400
3 500
5 800





Sample Output 32

This case is again similar to Sample Input 1, but the Takahashi's objective this time is 400 points or more. In this case, we only need to solve two 200-point problems to achieve the objective.





Sample Input 45 25000
20 1000
40 1000
50 1000
30 1000
1 1000





Sample Output 466

There is only one 500-point problem, but the perfect bonus can be earned even in such a case. 

",All Green,"Bitmask, Greedy Algorithm, Bruteforcing, Arithmetic",0.466,149,59
319,"
Score : 100 points


Problem StatementTakahashi has decided to distribute N AtCoder Crackers to K users of as evenly as possible.
When all the crackers are distributed, find the minimum possible (absolute) difference between the largest number of crackers received by a user and the smallest number received by a user.




Constraints
1 \leq N,K \leq 100
All values in input are integers.







InputInput is given from Standard Input in the following format:
N K





OutputPrint the minimum possible (absolute) difference between the largest number of crackers received by a user and the smallest number received by a user.






Sample Input 17 3





Sample Output 11

When the users receive two, two and three crackers, respectively, the (absolute) difference between the largest number of crackers received by a user and the smallest number received by a user, is 1.





Sample Input 2100 10





Sample Output 20

The crackers can be distributed evenly.





Sample Input 31 1





Sample Output 30


",AtCoder Crackers,"Arithmetic, Implementation",0.601,249,130
320,"
Score : 300 points


Problem StatementGiven an integer N, find the base -2 representation of N.
Here, S is the base -2 representation of N when the following are all satisfied:

S is a string consisting of 0 and 1.
Unless S = 0, the initial character of S is 1.
Let S = S_k S_{k-1} ... S_0, then S_0 \times (-2)^0 + S_1 \times (-2)^1 + ... + S_k \times (-2)^k = N.

It can be proved that, for any integer M, the base -2 representation of M is uniquely determined.




Constraints
Every value in input is integer.
-10^9 \leq N \leq 10^9







InputInput is given from Standard Input in the following format:
N





OutputPrint the base -2 representation of N.






Sample Input 1-9





Sample Output 11011

As (-2)^0 + (-2)^1 + (-2)^3 = 1 + (-2) + (-8) = -9, 1011 is the base -2 representation of -9.





Sample Input 2123456789





Sample Output 211000101011001101110100010101






Sample Input 30





Sample Output 30


",Base -2 Number,"Arithmetic, Bruteforcing, String",0.561,112,61
321,"
Score : 400 points


Problem StatementThere are N boxes arranged in a row from left to right. The i-th box from the left contains A_i candies.
You will take out the candies from some consecutive boxes and distribute them evenly to M children.
Such being the case, find the number of the pairs (l, r) that satisfy the following:

l and r are both integers and satisfy 1 \leq l \leq r \leq N.
A_l + A_{l+1} + ... + A_r is a multiple of M.





Constraints
All values in input are integers.
1 \leq N \leq 10^5
2 \leq M \leq 10^9
1 \leq A_i \leq 10^9







InputInput is given from Standard Input in the following format:
N M
A_1 A_2 ... A_N





OutputPrint the number of the pairs (l, r) that satisfy the conditions.
Note that the number may not fit into a 32-bit integer type.






Sample Input 13 2
4 1 5





Sample Output 13

The sum A_l + A_{l+1} + ... + A_r for each pair (l, r) is as follows:

Sum for (1, 1): 4
Sum for (1, 2): 5
Sum for (1, 3): 10
Sum for (2, 2): 1
Sum for (2, 3): 6
Sum for (3, 3): 5

Among these, three are multiples of 2.





Sample Input 213 17
29 7 5 7 9 51 7 13 8 55 42 9 81





Sample Output 26






Sample Input 310 400000000
1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000





Sample Output 325


",Candy Distribution,"Prefix sum, Arithmetic, Set / Map, Hashing, Combinatorics",0.293,152,37
322,"
Score : 200 points


Problem StatementPrint all the integers that satisfies the following in ascending order:

Among the integers between A and B (inclusive), it is either within the K smallest integers or within the K largest integers.





Constraints
1 \leq A \leq B \leq 10^9
1 \leq K \leq 100
All values in input are integers.







InputInput is given from Standard Input in the following format:
A B K





OutputPrint all the integers that satisfies the condition above in ascending order.






Sample Input 13 8 2





Sample Output 13
4
7
8


3 is the first smallest integer among the integers between 3 and 8.
4 is the second smallest integer among the integers between 3 and 8.
7 is the second largest integer among the integers between 3 and 8.
8 is the first largest integer among the integers between 3 and 8.






Sample Input 24 8 3





Sample Output 24
5
6
7
8






Sample Input 32 9 100





Sample Output 32
3
4
5
6
7
8
9


",Small and Large Integers,"Bruteforcing, Boolean Operations On Geometric Objects, Set / Map, Sorting, Array",0.529,273,126
323,"
Score : 100 points


Problem StatementYou are given a string S of length 3 consisting of a, b and c. Determine if S can be obtained by permuting abc.




Constraints
|S|=3
S consists of a, b and c.







InputInput is given from Standard Input in the following format:
S





OutputIf S can be obtained by permuting abc, print Yes; otherwise, print No.






Sample Input 1bac





Sample Output 1Yes

Swapping the first and second characters in bac results in abc.





Sample Input 2bab





Sample Output 2No






Sample Input 3abc





Sample Output 3Yes






Sample Input 4aaa





Sample Output 4No


",abc of ABC,"Counting, Implementation, String",0.752,213,134
324,"
﻿Score: 100 points


Problem Statement
There is a farm whose length and width are A yard and B yard, respectively. A farmer, John, made a vertical road and a horizontal road inside the farm from one border to another, as shown below: (The gray part represents the roads.)

What is the area of this yard excluding the roads? Find it.




Note
It can be proved that the positions of the roads do not affect the area.




Constraints

A is an integer between 2 and 100 (inclusive).
B is an integer between 2 and 100 (inclusive).







Input
Input is given from Standard Input in the following format:
A B





Output
Print the area of this yard excluding the roads (in square yards).






Sample Input 12 2





Sample Output 11

In this case, the area is 1 square yard.





Sample Input 25 7





Sample Output 224

In this case, the area is 24 square yards. 

",Garden,"Arithmetic, Inclusion And Exclusion",0.885,203,162
325,"
﻿Score: 300 points


Problem Statement
Mr. Infinity has a string S consisting of digits from 1 to 9. Each time the date changes, this string changes as follows:

Each occurrence of 2 in S is replaced with 22. Similarly, each 3 becomes 333, 4 becomes 4444, 5 becomes 55555, 6 becomes 666666, 7 becomes 7777777, 8 becomes 88888888 and 9 becomes 999999999. 1 remains as 1.

For example, if S is 1324, it becomes 1333224444 the next day, and it becomes 133333333322224444444444444444 the day after next.
You are interested in what the string looks like after 5 \times 10^{15} days. What is the K-th character from the left in the string after 5 \times 10^{15} days?




Constraints

S is a string of length between 1 and 100 (inclusive).
K is an integer between 1 and 10^{18} (inclusive).
The length of the string after 5 \times 10^{15} days is at least K.







Input
Input is given from Standard Input in the following format:
S
K





Output
Print the K-th character from the left in Mr. Infinity's string after 5 \times 10^{15} days.






Sample Input 11214
4





Sample Output 12

The string S changes as follows:  

Now: 1214
After one day: 12214444
After two days: 1222214444444444444444
After three days: 12222222214444444444444444444444444444444444444444444444444444444444444444

The first five characters in the string after 5 \times 10^{15} days is 12222. As K=4, we should print the fourth character, 2.





Sample Input 23
157





Sample Output 23

The initial string is 3. The string after 5 \times 10^{15} days consists only of 3.





Sample Input 3299792458
9460730472580800





Sample Output 32


",To Infinity,"String, Mathematics, Greedy Algorithm, Constructive",0.333,320,111
326,"
Score : 200 points


Problem StatementThe development of algae in a pond is as follows.
Let the total weight of the algae at the beginning of the year i be x_i gram. For i≥2000, the following formula holds:

x_{i+1} = rx_i - D

You are given r, D and x_{2000}. Calculate x_{2001}, ..., x_{2010} and print them in order.




Constraints
2 ≤ r ≤ 5
1 ≤ D ≤ 100
D < x_{2000} ≤ 200
All values in input are integers.







InputInput is given from Standard Input in the following format:
r D x_{2000}





OutputPrint 10 lines. The i-th line (1 ≤ i ≤ 10) should contain x_{2000+i} as an integer.






Sample Input 12 10 20





Sample Output 130
50
90
170
330
650
1290
2570
5130
10250

For example, x_{2001} = rx_{2000} - D = 2 \times 20 - 10 = 30 and x_{2002} = rx_{2001} - D = 2 \times 30 - 10 = 50.





Sample Input 24 40 60





Sample Output 2200
760
3000
11960
47800
191160
764600
3058360
12233400
48933560


",Algae,"Bruteforcing, Mathematics, Arithmetic, Implementation",0.908,314,274
327,"
Score: 100 points


Problem Statement
In this problem, a date is written as Y-M-D. For example, 2019-11-30 means November 30, 2019.
Integers M_1, D_1, M_2, and D_2 will be given as input.
It is known that the date 2019-M_2-D_2 follows 2019-M_1-D_1.
Determine whether the date 2019-M_1-D_1 is the last day of a month.




Constraints

Both 2019-M_1-D_1 and 2019-M_2-D_2 are valid dates in the Gregorian calendar.
The date 2019-M_2-D_2 follows 2019-M_1-D_1.







Input
Input is given from Standard Input in the following format:
M_1 D_1
M_2 D_2





Output
If the date 2019-M_1-D_1 is the last day of a month, print 1; otherwise, print 0.






Sample Input 111 16
11 17





Sample Output 10

November 16 is not the last day of a month.





Sample Input 211 30
12 1





Sample Output 21

November 30 is the last day of November.

",November 30,"Implementation, Arithmetic, Array",0.879,136,108
328,"
Score: 200 points


Problem Statement
Takahashi bought a piece of apple pie at ABC Confiserie. According to his memory, he paid N yen (the currency of Japan) for it.
The consumption tax rate for foods in this shop is 8 percent. That is, to buy an apple pie priced at X yen before tax, you have to pay X \times 1.08 yen (rounded down to the nearest integer).
Takahashi forgot the price of his apple pie before tax, X, and wants to know it again. Write a program that takes N as input and finds X. We assume X is an integer.
If there are multiple possible values for X, find any one of them. Also, Takahashi's memory of N, the amount he paid, may be incorrect. If no value could be X, report that fact.




Constraints

1 \leq N \leq 50000
N is an integer.







Input
Input is given from Standard Input in the following format:
N





Output
If there are values that could be X, the price of the apple pie before tax, print any one of them.
If there are multiple such values, printing any one of them will be accepted.
If no value could be X, print :(.






Sample Input 1432





Sample Output 1400

If the apple pie is priced at 400 yen before tax, you have to pay 400 \times 1.08 = 432 yen to buy one.
Otherwise, the amount you have to pay will not be 432 yen.





Sample Input 21079





Sample Output 2:(

There is no possible price before tax for which you have to pay 1079 yen with tax.





Sample Input 31001





Sample Output 3927

If the apple pie is priced 927 yen before tax, by rounding down 927 \times 1.08 = 1001.16, you have to pay 1001 yen.

",Tax Rate,"Bruteforcing, Arithmetic, Mathematics, Implementation",0.543,297,123
329,"
Score : 200 points


Problem StatementYou have a digit sequence S of length 4. You are wondering which of the following formats S is in:

YYMM format: the last two digits of the year and the two-digit representation of the month (example: 01 for January), concatenated in this order
MMYY format: the two-digit representation of the month and the last two digits of the year, concatenated in this order

If S is valid in only YYMM format, print YYMM; if S is valid in only MMYY format, print MMYY; if S is valid in both formats, print AMBIGUOUS; if S is valid in neither format, print NA.




Constraints
S is a digit sequence of length 4.







InputInput is given from Standard Input in the following format:
S





OutputPrint the specified string: YYMM, MMYY, AMBIGUOUS or NA.






Sample Input 11905





Sample Output 1YYMM

May XX19 is a valid date, but 19 is not valid as a month. Thus, this string is only valid in YYMM format.





Sample Input 20112





Sample Output 2AMBIGUOUS

Both December XX01 and January XX12 are valid dates. Thus, this string is valid in both formats.





Sample Input 31700





Sample Output 3NA

Neither 0 nor 17 is valid as a month. Thus, this string is valid in neither format.

",YYMM or MMYY,"String, Parsing, Boolean Operations On Geometric Objects, Implementation",0.593,474,225
330,"
Score : 300 points


Problem StatementSnuke has a fair N-sided die that shows the integers from 1 to N with equal probability and a fair coin. He will play the following game with them:

Throw the die. The current score is the result of the die.
As long as the score is between 1 and K-1 (inclusive), keep flipping the coin. The score is doubled each time the coin lands heads up, and the score becomes 0 if the coin lands tails up.
The game ends when the score becomes 0 or becomes K or above. Snuke wins if the score is K or above, and loses if the score is 0.

You are given N and K. Find the probability that Snuke wins the game.




Constraints
1 ≤ N ≤ 10^5
1 ≤ K ≤ 10^5
All values in input are integers.







InputInput is given from Standard Input in the following format:
N K





OutputPrint the probability that Snuke wins the game. The output is considered correct when the absolute or relative error is at most 10^{-9}.






Sample Input 13 10





Sample Output 10.145833333333


If the die shows 1, Snuke needs to get four consecutive heads from four coin flips to obtain a score of 10 or above. The probability of this happening is \frac{1}{3} \times (\frac{1}{2})^4 = \frac{1}{48}.
If the die shows 2, Snuke needs to get three consecutive heads from three coin flips to obtain a score of 10 or above. The probability of this happening is \frac{1}{3} \times (\frac{1}{2})^3 = \frac{1}{24}.
If the die shows 3, Snuke needs to get two consecutive heads from two coin flips to obtain a score of 10 or above. The probability of this happening is \frac{1}{3} \times (\frac{1}{2})^2 = \frac{1}{12}.

Thus, the probability that Snuke wins is \frac{1}{48} + \frac{1}{24} + \frac{1}{12} = \frac{7}{48} \simeq 0.1458333333.





Sample Input 2100000 5





Sample Output 20.999973749998


",Dice and Coin,"Bruteforcing, Mathematics, Exponentiation By Squaring, Probability Theory, Arithmetic",0.667,313,179
331,"
Score : 200 points


Problem StatementWe have N weights indexed 1 to N. The mass of the weight indexed i is W_i.
We will divide these weights into two groups: the weights with indices not greater than T, and those with indices greater than T, for some integer 1 \leq T < N. Let S_1 be the sum of the masses of the weights in the former group, and S_2 be the sum of the masses of the weights in the latter group.
Consider all possible such divisions and find the minimum possible absolute difference of S_1 and S_2.




Constraints
2 \leq N \leq 100
1 \leq W_i \leq 100
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
W_1 W_2 ... W_{N-1} W_N





OutputPrint the minimum possible absolute difference of S_1 and S_2.






Sample Input 13
1 2 3





Sample Output 10

If T = 2, S_1 = 1 + 2 = 3 and S_2 = 3, with the absolute difference of 0.





Sample Input 24
1 3 1 1





Sample Output 22

If T = 2, S_1 = 1 + 3 = 4 and S_2 = 1 + 1 = 2, with the absolute difference of 2. We cannot have a smaller absolute difference.





Sample Input 38
27 23 76 2 3 5 62 52





Sample Output 32


",Balance,"Prefix sum, Bruteforcing, Arithmetic, Greedy Algorithm",0.804,301,209
332,"
Score : 300 points


Problem StatementThere is a staircase with N steps. Takahashi is now standing at the foot of the stairs, that is, on the 0-th step.
He can climb up one or two steps at a time.
However, the treads of the a_1-th, a_2-th, a_3-th, \ldots, a_M-th steps are broken, so it is dangerous to set foot on those steps.
How many are there to climb up to the top step, that is, the N-th step, without setting foot on the broken steps?
Find the count modulo 1\ 000\ 000\ 007.




Constraints
1 \leq N \leq 10^5
0 \leq M \leq N-1
1 \leq a_1 < a_2 <  ...  < a_M \leq N-1







InputInput is given from Standard Input in the following format:
N M
a_1
a_2
 .
 .
 .
a_M





OutputPrint the number of ways to climb up the stairs under the condition, modulo 1\ 000\ 000\ 007.






Sample Input 16 1
3





Sample Output 14

There are four ways to climb up the stairs, as follows:

0 \to 1 \to 2 \to 4 \to 5 \to 6
0 \to 1 \to 2 \to 4 \to 6
0 \to 2 \to 4 \to 5 \to 6
0 \to 2 \to 4 \to 6






Sample Input 210 2
4
5





Sample Output 20

There may be no way to climb up the stairs without setting foot on the broken steps.





Sample Input 3100 5
1
23
45
67
89





Sample Output 3608200469

Be sure to print the count modulo 1\ 000\ 000\ 007.

",Typical Stairs,"Dyanmic Programming, Arithmetic, Array, Recursion",0.401,382,114
333,"
Score : 200 points


Problem StatementWe have a board with H horizontal rows and W vertical columns of squares.
There is a bishop at the top-left square on this board.
How many squares can this bishop reach by zero or more movements?
Here the bishop can only move diagonally.
More formally, the bishop can move from the square at the r_1-th row (from the top) and the c_1-th column (from the left) to the square at the r_2-th row and the c_2-th column if and only if exactly one of the following holds:

r_1 + c_1 = r_2 + c_2
r_1 - c_1 = r_2 - c_2

For example, in the following figure, the bishop can move to any of the red squares in one move:





Constraints
1 \leq H, W \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
H \ W





OutputPrint the number of squares the bishop can reach.






Sample Input 14 5





Sample Output 110

The bishop can reach the cyan squares in the following figure:






Sample Input 27 3





Sample Output 211

The bishop can reach the cyan squares in the following figure:






Sample Input 31000000000 1000000000





Sample Output 3500000000000000000


",Bishop,"Arithmetic, Mathematics, Implementation",0.058,649,154
334,"
Score : 300 points


Problem StatementDoes \sqrt{a} + \sqrt{b} < \sqrt{c} hold?




Constraints
1 \leq a, b, c \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
a \ b \ c





OutputIf \sqrt{a} + \sqrt{b} < \sqrt{c}, print Yes; otherwise, print No.






Sample Input 12 3 9





Sample Output 1No

\sqrt{2} + \sqrt{3} < \sqrt{9} does not hold.





Sample Input 22 3 10





Sample Output 2Yes

\sqrt{2} + \sqrt{3} < \sqrt{10} holds.

",Sqrt Inequality,"Mathematics, Numerical Analysis, Implementation, Arithmetic",0.07,815,106
335,"
Score : 400 points


Problem StatementWe have N bricks arranged in a row from left to right.
The i-th brick from the left (1 \leq i \leq N) has an integer a_i written on it.
Among them, you can break at most N-1 bricks of your choice.
Let us say there are K bricks remaining. Snuke will be satisfied if, for each integer i (1 \leq i \leq K), the i-th of those brick from the left has the integer i written on it.
Find the minimum number of bricks you need to break to satisfy Snuke's desire. If his desire is unsatisfiable, print -1 instead.




Constraints
All values in input are integers.
1 \leq N \leq 200000
1 \leq a_i \leq N







InputInput is given from Standard Input in the following format:
N
a_1 a_2 ... a_N





OutputPrint the minimum number of bricks that need to be broken to satisfy Snuke's desire, or print -1 if his desire is unsatisfiable.






Sample Input 13
2 1 2





Sample Output 11

If we break the leftmost brick, the remaining bricks have integers 1 and 2 written on them from left to right, in which case Snuke will be satisfied.





Sample Input 23
2 2 2





Sample Output 2-1

In this case, there is no way to break some of the bricks to satisfy Snuke's desire.





Sample Input 310
3 1 4 1 5 9 2 6 5 3





Sample Output 37






Sample Input 41
1





Sample Output 40

There may be no need to break the bricks at all.

",Brick Break,"Greedy Algorithm, Array, Dynamic Programming, Counting",0.785,238,161
336,"
Score : 100 points


Problem StatementShichi-Go-San (literally ""Seven-Five-Three"") is a traditional event in a certain country to celebrate the growth of seven-, five- and three-year-old children.
Takahashi is now X years old. Will his growth be celebrated in Shichi-Go-San this time?




Constraints
1 ≤ X ≤ 9
X is an integer.







InputInput is given from Standard Input in the following format:
X





OutputIf Takahashi's growth will be celebrated, print YES; if it will not, print NO.






Sample Input 15





Sample Output 1YES

The growth of a five-year-old child will be celebrated.





Sample Input 26





Sample Output 2NO

See you next year.

",753,Implementation,0.766,202,139
337,"
Score: 200 points


Problem Statement
The restaurant AtCoder serves the following five dishes:

ABC Don (rice bowl): takes A minutes to serve.
ARC Curry: takes B minutes to serve.
AGC Pasta: takes C minutes to serve.
APC Ramen: takes D minutes to serve.
ATC Hanbagu (hamburger patty): takes E minutes to serve.

Here, the time to serve a dish is the time between when an order is placed and when the dish is delivered.
This restaurant has the following rules on orders:

An order can only be placed at a time that is a multiple of 10 (time 0, 10, 20, ...).
Only one dish can be ordered at a time.
No new order can be placed when an order is already placed and the dish is still not delivered, but a new order can be placed at the exact time when the dish is delivered.

E869120 arrives at this restaurant at time 0. He will order all five dishes. Find the earliest possible time for the last dish to be delivered.
Here, he can order the dishes in any order he likes, and he can place an order already at time 0.




Constraints

A, B, C, D and E are integers between 1 and 123 (inclusive).







Input
Input is given from Standard Input in the following format:
A
B
C
D
E





Output
Print the earliest possible time for the last dish to be delivered, as an integer.






Sample Input 129
20
7
35
120





Sample Output 1215

If we decide to order the dishes in the order ABC Don, ARC Curry, AGC Pasta, ATC Hanbagu, APC Ramen, the earliest possible time for each order is as follows:

Order ABC Don at time 0, which will be delivered at time 29.
Order ARC Curry at time 30, which will be delivered at time 50.
Order AGC Pasta at time 50, which will be delivered at time 57.
Order ATC Hanbagu at time 60, which will be delivered at time 180.
Order APC Ramen at time 180, which will be delivered at time 215.

There is no way to order the dishes in which the last dish will be delivered earlier than this.





Sample Input 2101
86
119
108
57





Sample Output 2481

If we decide to order the dishes in the order AGC Pasta, ARC Curry, ATC Hanbagu, APC Ramen, ABC Don, the earliest possible time for each order is as follows:

Order AGC Pasta at time 0, which will be delivered at time 119.
Order ARC Curry at time 120, which will be delivered at time 206.
Order ATC Hanbagu at time 210, which will be delivered at time 267.
Order APC Ramen at time 270, which will be delivered at time 378.
Order ABC Don at time 380, which will be delivered at time 481.

There is no way to order the dishes in which the last dish will be delivered earlier than this.





Sample Input 3123
123
123
123
123





Sample Output 3643

This is the largest valid case.

",Five Dishes,"Arithmetic, Greedy Algorithm, Bruteforcing, Mathematics",0.582,280,163
338,"
Score : 200 points


Problem StatementWe have a sequence p = {p_1,\ p_2,\ ...,\ p_N} which is a permutation of {1,\ 2,\ ...,\ N}.
You can perform the following operation at most once: choose integers i and j (1 \leq i < j \leq N), and swap p_i and p_j. Note that you can also choose not to perform it.
Print YES if you can sort p in ascending order in this way, and NO otherwise.




Constraints
All values in input are integers.
2 \leq N \leq 50
p is a permutation of {1,\ 2,\ ...,\ N}.







InputInput is given from Standard Input in the following format:
N
p_1 p_2 ... p_N





OutputPrint YES if you can sort p in ascending order in the way stated in the problem statement, and NO otherwise.






Sample Input 15
5 2 3 4 1





Sample Output 1YES

You can sort p in ascending order by swapping p_1 and p_5.





Sample Input 25
2 4 3 5 1





Sample Output 2NO

In this case, swapping any two elements does not sort p in ascending order.





Sample Input 37
1 2 3 4 5 6 7





Sample Output 3YES

p is already sorted in ascending order, so no operation is needed.

",0 or 1 Swap,"Sorting, Array, Counting, Boolean Operations On Geometric Objects",0.685,382,205
339,"
Score : 200 points


Problem StatementYou have N apples, called Apple 1, Apple 2, Apple 3, ..., Apple N. The flavor of Apple i is L+i-1, which can be negative.
You can make an apple pie using one or more of the apples. The flavor of the apple pie will be the sum of the flavors of the apples used.
You planned to make an apple pie using all of the apples, but being hungry tempts you to eat one of them, which can no longer be used to make the apple pie.
You want to make an apple pie that is as similar as possible to the one that you planned to make. Thus, you will choose the apple to eat so that the flavor of the apple pie made of the remaining N-1 apples will have the smallest possible absolute difference from the flavor of the apple pie made of all the N apples.
Find the flavor of the apple pie made of the remaining N-1 apples when you choose the apple to eat as above.
We can prove that this value is uniquely determined.




Constraints
2 \leq N \leq 200
-100 \leq L \leq 100
All values in input are integers.







InputInput is given from Standard Input in the following format:
N L





OutputFind the flavor of the apple pie made of the remaining N-1 apples when you optimally choose the apple to eat.






Sample Input 15 2





Sample Output 118

The flavors of Apple 1, 2, 3, 4, and 5 are 2, 3, 4, 5, and 6, respectively. The optimal choice is to eat Apple 1, so the answer is 3+4+5+6=18.





Sample Input 23 -1





Sample Output 20

The flavors of Apple 1, 2, and 3 are -1, 0, and 1, respectively. The optimal choice is to eat Apple 2, so the answer is (-1)+1=0.





Sample Input 330 -50





Sample Output 3-1044


",Bite Eating,"Arithmetic, Bruteforcing, Greedy Algorithm",0.728,350,221
340,"
Score : 300 points


Problem StatementWe have N ID cards, and there are M gates.
We can pass the i-th gate if we have one of the following ID cards: the L_i-th, (L_i+1)-th, ..., and R_i-th ID cards.
How many of the ID cards allow us to pass all the gates alone?




Constraints
All values in input are integers.
1 \leq N \leq 10^5
1 \leq M \leq 10^5
1 \leq L_i \leq R_i \leq N







InputInput is given from Standard Input in the following format:
N M
L_1 R_1
L_2 R_2
\vdots
L_M R_M





OutputPrint the number of ID cards that allow us to pass all the gates alone.






Sample Input 14 2
1 3
2 4





Sample Output 12

Two ID cards allow us to pass all the gates alone, as follows:

The first ID card does not allow us to pass the second gate.
The second ID card allows us to pass all the gates.
The third ID card allows us to pass all the gates.
The fourth ID card does not allow us to pass the first gate.






Sample Input 210 3
3 6
5 7
6 9





Sample Output 21






Sample Input 3100000 1
1 100000





Sample Output 3100000


",Prison,"Greedy Algorithm, Bruteforcing, Geometry; 3d, Boolean Operations On Geometric Objects",0.352,517,206
341,"
Score : 100 points


Problem StatementYou are parking at a parking lot. You can choose from the following two fee plans:

Plan 1: The fee will be A×T yen (the currency of Japan) when you park for T hours.
Plan 2: The fee will be B yen, regardless of the duration.

Find the minimum fee when you park for N hours.




Constraints
1≤N≤20
1≤A≤100
1≤B≤2000
All input values are integers.







InputInput is given from Standard Input in the following format:
N A B





OutputWhen the minimum fee is x yen, print the value of x.






Sample Input 17 17 120





Sample Output 1119


If you choose Plan 1, the fee will be 7×17=119 yen.
If you choose Plan 2, the fee will be 120 yen.

Thus, the minimum fee is 119 yen.





Sample Input 25 20 100





Sample Output 2100

The fee might be the same in the two plans.





Sample Input 36 18 100





Sample Output 3100


",Parking,"Arithmetic, Implementation",0.85,196,150
342,"
Score : 100 points


Problem StatementHow many hours do we have until New Year at M o'clock (24-hour notation) on 30th, December?




Constraints
1≤M≤23
M is an integer.







InputInput is given from Standard Input in the following format:
M





OutputIf we have x hours until New Year at M o'clock on 30th, December, print x.






Sample Input 121





Sample Output 127

We have 27 hours until New Year at 21 o'clock on 30th, December.





Sample Input 212





Sample Output 236


",New Year,"Arithmetic, Implementation",0.864,167,135
343,"
Score : 100 points


Problem StatementYou are given two positive integers a and b.
Let x be the average of a and b.
Print x rounded up to the nearest integer.




Constraints
a and b are integers.
1 \leq a, b \leq 100







InputInput is given from Standard Input in the following format:
a b





OutputPrint x rounded up to the nearest integer.






Sample Input 11 3





Sample Output 12

The average of 1 and 3 is 2.0, and it will be rounded up to the nearest integer, 2.





Sample Input 27 4





Sample Output 26

The average of 7 and 4 is 5.5, and it will be rounded up to the nearest integer, 6.





Sample Input 35 5





Sample Output 35


",Round Up the Mean,"Arithmetic, Mathematics",0.717,303,171
344,"
Score : 200 points


Problem StatementThere are N pieces of source code. The characteristics of the i-th code is represented by M integers A_{i1}, A_{i2}, ..., A_{iM}.
Additionally, you are given integers B_1, B_2, ..., B_M and C.
The i-th code correctly solves this problem if and only if A_{i1} B_1 + A_{i2} B_2 + ... + A_{iM} B_M + C > 0.
Among the N codes, find the number of codes that correctly solve this problem.




Constraints
All values in input are integers.
1 \leq N, M \leq 20
-100 \leq A_{ij} \leq 100
-100 \leq B_i \leq 100
-100 \leq C \leq 100







InputInput is given from Standard Input in the following format:
N M C
B_1 B_2 ... B_M
A_{11} A_{12} ... A_{1M}
A_{21} A_{22} ... A_{2M}
\vdots
A_{N1} A_{N2} ... A_{NM}





OutputPrint the number of codes among the given N codes that correctly solve this problem.






Sample Input 12 3 -10
1 2 3
3 2 1
1 2 2





Sample Output 11

Only the second code correctly solves this problem, as follows:

Since 3 \times 1 + 2 \times 2 + 1 \times 3 + (-10) = 0 \leq 0, the first code does not solve this problem.
1 \times 1 + 2 \times 2 + 2 \times 3 + (-10) = 1 > 0, the second code solves this problem.






Sample Input 25 2 -4
-2 5
100 41
100 40
-3 0
-6 -2
18 -13





Sample Output 22






Sample Input 33 3 0
100 -100 0
0 100 100
100 100 100
-100 100 100





Sample Output 30

All of them are Wrong Answer. Except yours.

",Can you solve this?,"Bruteforcing, Array, Arithmetic, Implementation",0.837,257,204
345,"
Score : 200 points


Problem StatementYou are given positive integers A and B.
Find the K-th largest positive integer that divides both A and B.
The input guarantees that there exists such a number.




Constraints
All values in input are integers.
1 \leq A, B \leq 100
The K-th largest positive integer that divides both A and B exists.
K \geq 1







InputInput is given from Standard Input in the following format:
A B K





OutputPrint the K-th largest positive integer that divides both A and B.






Sample Input 18 12 2





Sample Output 12

Three positive integers divides both 8 and 12: 1, 2 and 4.
Among them, the second largest is 2.





Sample Input 2100 50 4





Sample Output 25






Sample Input 31 1 1





Sample Output 31


",K-th Common Divisor,"Bruteforcing, Implementation, Counting, Mathematics, Greedy Algorithm",0.563,350,193
346,"
Score : 300 points


Problem StatementYou are given four integers A, B, C, and D. Find the number of integers between A and B (inclusive) that can be evenly divided by neither C nor D.




Constraints
1\leq A\leq B\leq 10^{18}
1\leq C,D\leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
A B C D





OutputPrint the number of integers between A and B (inclusive) that can be evenly divided by neither C nor D.






Sample Input 14 9 2 3





Sample Output 12

5 and 7 satisfy the condition.





Sample Input 210 40 6 8





Sample Output 223






Sample Input 3314159265358979323 846264338327950288 419716939 937510582





Sample Output 3532105071133627368


",Anti-Division,"Inclusion And Exclusion, Euclidean Algorithm, Mathematics, Arithmetic, Prefix sum",0.453,404,146
347,"
Score : 200 points


Problem StatementTakahashi received otoshidama (New Year's money gifts) from N of his relatives.
You are given N values x_1, x_2, ..., x_N and N strings u_1, u_2, ..., u_N as input. Each string u_i is either JPY or BTC, and x_i and u_i represent the content of the otoshidama from the i-th relative.
For example, if x_1 = 10000 and u_1 = JPY, the otoshidama from the first relative is 10000 Japanese yen; if x_2 = 0.10000000 and u_2 = BTC, the otoshidama from the second relative is 0.1 bitcoins.
If we convert the bitcoins into yen at the rate of 380000.0 JPY per 1.0 BTC, how much are the gifts worth in total?




Constraints
2 \leq N \leq 10
u_i = JPY or BTC.
If u_i = JPY, x_i is an integer such that 1 \leq x_i \leq 10^8.
If u_i = BTC, x_i is a decimal with 8 decimal digits, such that 0.00000001 \leq x_i \leq 100.00000000.







InputInput is given from Standard Input in the following format:
N
x_1 u_1
x_2 u_2
:
x_N u_N





OutputIf the gifts are worth Y yen in total, print the value Y (not necessarily an integer).
Output will be judged correct when the absolute or relative error from the judge's output is at most 10^{-5}.






Sample Input 12
10000 JPY
0.10000000 BTC





Sample Output 148000.0

The otoshidama from the first relative is 10000 yen. The otoshidama from the second relative is 0.1 bitcoins, which is worth 38000.0 yen if converted at the rate of 380000.0 JPY per 1.0 BTC. The sum of these is 48000.0 yen.
Outputs such as 48000 and 48000.1 will also be judged correct.





Sample Input 23
100000000 JPY
100.00000000 BTC
0.00000001 BTC





Sample Output 2138000000.0038

In this case, outputs such as 138001000 and 1.38e8 will also be judged correct.

",Digital Gifts,"Bruteforcing, Implementation, Arithmetic, Prefix sum",0.825,200,149
348,"
Score : 300 points


Problem StatementThere are N squares arranged in a row from left to right. The height of the i-th square from the left is H_i.
For each square, you will perform either of the following operations once:

Decrease the height of the square by 1.
Do nothing.

Determine if it is possible to perform the operations so that the heights of the squares are non-decreasing from left to right.




Constraints
All values in input are integers.
1 \leq N \leq 10^5
1 \leq H_i \leq 10^9







InputInput is given from Standard Input in the following format:
N
H_1 H_2 ... H_N





OutputIf it is possible to perform the operations so that the heights of the squares are non-decreasing from left to right, print Yes; otherwise, print No.






Sample Input 15
1 2 1 1 3





Sample Output 1Yes

You can achieve the objective by decreasing the height of only the second square from the left by 1.





Sample Input 24
1 3 2 1





Sample Output 2No






Sample Input 35
1 2 3 4 5





Sample Output 3Yes






Sample Input 41
1000000000





Sample Output 4Yes


",Build Stairs,"Greedy Algorithm, Array, Boolean Operations On Geometric Objects",0.425,548,180
349,"
Score : 300 points


Problem StatementThere are N+1 towns. The i-th town is being attacked by A_i monsters.
We have N heroes. The i-th hero can defeat monsters attacking the i-th or (i+1)-th town, for a total of at most B_i monsters.
What is the maximum total number of monsters the heroes can cooperate to defeat?




Constraints
All values in input are integers.
1 \leq N \leq 10^5
1 \leq A_i \leq 10^9
1 \leq B_i \leq 10^9







InputInput is given from Standard Input in the following format:
N
A_1 A_2 ... A_{N+1}
B_1 B_2 ... B_N





OutputPrint the maximum total number of monsters the heroes can defeat.






Sample Input 12
3 5 2
4 5





Sample Output 19

If the heroes choose the monsters to defeat as follows, they can defeat nine monsters in total, which is the maximum result.

The first hero defeats two monsters attacking the first town and two monsters attacking the second town.
The second hero defeats three monsters attacking the second town and two monsters attacking the third town.






Sample Input 23
5 6 3 8
5 100 8





Sample Output 222






Sample Input 32
100 1 1
1 100





Sample Output 33


",City Savers,"Greedy Algorithm, Array, Bruteforcing, Arithmetic",0.278,532,163
350,"
Score : 300 points


Problem StatementWe have two permutations P and Q of size N (that is, P and Q are both rearrangements of (1,~2,~...,~N)).
There are N! possible permutations of size N. Among them, let P and Q be the a-th and b-th lexicographically smallest permutations, respectively. Find |a - b|.




NotesFor two sequences X and Y, X is said to be lexicographically smaller than Y if and only if there exists an integer k such that X_i = Y_i~(1 \leq i < k) and X_k < Y_k.




Constraints
2 \leq N \leq 8
P and Q are permutations of size N.







InputInput is given from Standard Input in the following format:
N
P_1 P_2 ... P_N
Q_1 Q_2 ... Q_N





OutputPrint |a - b|.






Sample Input 13
1 3 2
3 1 2





Sample Output 13

There are 6 permutations of size 3: (1,~2,~3), (1,~3,~2), (2,~1,~3), (2,~3,~1), (3,~1,~2), and (3,~2,~1). Among them, (1,~3,~2) and (3,~1,~2) come 2-nd and 5-th in lexicographical order, so the answer is |2 - 5| = 3.





Sample Input 28
7 3 5 4 2 1 6 8
3 8 2 5 4 6 7 1





Sample Output 217517






Sample Input 33
1 2 3
1 2 3





Sample Output 30


",Count Order,"Arithmetic, Sorting, Permutation Cycle Decomposition, Combinatorics, Bruteforcing, Array",0.706,145,102
351,"
Score : 200 points


Problem StatementYou have decided to write a book introducing good restaurants.
There are N restaurants that you want to introduce: Restaurant 1, Restaurant 2, ..., Restaurant N. Restaurant i is in city S_i, and your assessment score of that restaurant on a 100-point scale is P_i.
No two restaurants have the same score.
You want to introduce the restaurants in the following order:

The restaurants are arranged in lexicographical order of the names of their cities.
If there are multiple restaurants in the same city, they are arranged in descending order of score.

Print the identification numbers of the restaurants in the order they are introduced in the book.




Constraints
1 ≤ N ≤ 100
S is a string of length between 1 and 10 (inclusive) consisting of lowercase English letters.
0 ≤ P_i ≤ 100
P_i is an integer.
P_i ≠ P_j (1 ≤ i < j ≤ N)







InputInput is given from Standard Input in the following format:
N
S_1 P_1
:
S_N P_N





OutputPrint N lines. The i-th line (1 ≤ i ≤ N) should contain the identification number of the restaurant that is introduced i-th in the book.






Sample Input 16
khabarovsk 20
moscow 10
kazan 50
kazan 35
moscow 60
khabarovsk 40





Sample Output 13
4
6
1
5
2

The lexicographical order of the names of the three cities is kazan < khabarovsk < moscow. For each of these cities, the restaurants in it are introduced in descending order of score. Thus, the restaurants are introduced in the order 3,4,6,1,5,2.





Sample Input 210
yakutsk 10
yakutsk 20
yakutsk 30
yakutsk 40
yakutsk 50
yakutsk 60
yakutsk 70
yakutsk 80
yakutsk 90
yakutsk 100





Sample Output 210
9
8
7
6
5
4
3
2
1


",Guidebook,"Sorting, Data Structures, String, Bruteforcing",0.733,293,190
352,"
Score: 400 points


Problem Statement
There is a cave.
The cave has N rooms and M passages. The rooms are numbered 1 to N, and the passages are numbered 1 to M. Passage i connects Room A_i and Room B_i bidirectionally. One can travel between any two rooms by traversing passages. Room 1 is a special room with an entrance from the outside.
It is dark in the cave, so we have decided to place a signpost in each room except Room 1. The signpost in each room will point to one of the rooms directly connected to that room with a passage.
Since it is dangerous in the cave, our objective is to satisfy the condition below for each room except Room 1.

If you start in that room and repeatedly move to the room indicated by the signpost in the room you are in, you will reach Room 1 after traversing the minimum number of passages possible.

Determine whether there is a way to place signposts satisfying our objective, and print one such way if it exists.




Constraints

All values in input are integers.
2 \leq N \leq 10^5
1 \leq M \leq 2 \times 10^5
1 \leq A_i, B_i \leq N\ (1 \leq i \leq M)
A_i \neq B_i\ (1 \leq i \leq M)
One can travel between any two rooms by traversing passages.







Input
Input is given from Standard Input in the following format:
N M
A_1 B_1
:
A_M B_M





Output
If there is no way to place signposts satisfying the objective, print No.
Otherwise, print N lines. The first line should contain Yes, and the i-th line (2 \leq i \leq N) should contain the integer representing the room indicated by the signpost in Room i.






Sample Input 14 4
1 2
2 3
3 4
4 2





Sample Output 1Yes
1
2
2

If we place the signposts as described in the sample output, the following happens:

Starting in Room 2, you will reach Room 1 after traversing one passage: (2) \to 1. This is the minimum number of passages possible.
Starting in Room 3, you will reach Room 1 after traversing two passages: (3) \to 2 \to 1. This is the minimum number of passages possible.
Starting in Room 4, you will reach Room 1 after traversing two passages: (4) \to 2 \to 1. This is the minimum number of passages possible.

Thus, the objective is satisfied.





Sample Input 26 9
3 4
6 1
2 4
5 3
4 6
1 5
6 2
4 5
5 6





Sample Output 2Yes
6
5
5
1
1

If there are multiple solutions, any of them will be accepted.

",.. (Double Dots),"Graph Theory, Breadth-first Search, Graph Traversal",0.402,439,181
353,"
Score : 200 points


Problem StatementFor a string S consisting of the uppercase English letters P and D, let the doctoral and postdoctoral quotient of S be the total number of occurrences of D and PD in S as contiguous substrings. For example, if S = PPDDP, it contains two occurrences of D and one occurrence of PD as contiguous substrings, so the doctoral and postdoctoral quotient of S is 3.
We have a string T consisting of P, D, and ?.
Among the strings that can be obtained by replacing each ? in T with P or D, find one with the maximum possible doctoral and postdoctoral quotient.




Constraints
1 \leq |T| \leq 2 \times 10^5
T consists of P, D, and ?.







InputInput is given from Standard Input in the following format:
T





OutputPrint one string with the maximum possible doctoral and postdoctoral quotient among the strings that can be obtained by replacing each ? in T with P or D.
If there are multiple such strings, you may print any of them.






Sample Input 1PD?D??P





Sample Output 1PDPDPDP

This string contains three occurrences of D and three occurrences of PD as contiguous substrings, so its doctoral and postdoctoral quotient is 6, which is the maximum doctoral and postdoctoral quotient of a string obtained by replacing each ? in T with P or D.





Sample Input 2P?P?





Sample Output 2PDPD


",Postdocs,"Greedy Algorithm, String, Bruteforcing",0.58,279,140
354,"
Score : 500 points


Problem StatementThere are N Snuke Cats numbered 1, 2, \ldots, N, where N is even.
Each Snuke Cat wears a red scarf, on which his favorite non-negative integer is written.
Recently, they learned the operation called xor (exclusive OR).

What is xor?

For n non-negative integers x_1, x_2, \ldots, x_n, their xor, x_1~\textrm{xor}~x_2~\textrm{xor}~\ldots~\textrm{xor}~x_n is defined as follows:

 When x_1~\textrm{xor}~x_2~\textrm{xor}~\ldots~\textrm{xor}~x_n is written in base two, the digit in the 2^k's place (k \geq 0) is 1 if the number of integers among x_1, x_2, \ldots, x_n whose binary representations have 1 in the 2^k's place is odd, and 0 if that count is even. 

For example, 3~\textrm{xor}~5 = 6.


They wanted to use this operation quickly, so each of them calculated the xor of the integers written on their scarfs except his scarf.
We know that the xor calculated by Snuke Cat i, that is, the xor of the integers written on the scarfs except the scarf of Snuke Cat i is a_i.
Using this information, restore the integer written on the scarf of each Snuke Cat.




Constraints
All values in input are integers.
2 \leq N \leq 200000
N is even.
0 \leq a_i \leq 10^9
There exists a combination of integers on the scarfs that is consistent with the given information.







InputInput is given from Standard Input in the following format:
N
a_1 a_2 \ldots a_N





OutputPrint a line containing N integers separated with space.
The i-th of the integers from the left should represent the integer written on the scarf of Snuke Cat i.
If there are multiple possible solutions, you may print any of them.






Sample Input 14
20 11 9 24





Sample Output 126 5 7 22


5~\textrm{xor}~7~\textrm{xor}~22 = 20
26~\textrm{xor}~7~\textrm{xor}~22 = 11
26~\textrm{xor}~5~\textrm{xor}~22 = 9
26~\textrm{xor}~5~\textrm{xor}~7 = 24

Thus, this output is consistent with the given information.

",Red Scarf,"Bitmask, Array, Bruteforcing, Xor Basis (gf(2))",0.833,234,184
355,"
Score : 400 points


Problem StatementFor a positive integer X, let f(X) be the number of positive divisors of X.
Given a positive integer N, find \sum_{K=1}^N K\times f(K).




Constraints
1 \leq N \leq 10^7







InputInput is given from Standard Input in the following format:
N





OutputPrint the value \sum_{K=1}^N K\times f(K).






Sample Input 14





Sample Output 123

We have f(1)=1, f(2)=2, f(3)=2, and f(4)=3, so the answer is 1\times 1 + 2\times 2 + 3\times 2 + 4\times 3 =23.





Sample Input 2100





Sample Output 226879






Sample Input 310000000





Sample Output 3838627288460105

Watch out for overflows.

",Sum of Divisors,"Number Theory, Bruteforcing, Arithmetic",0.517,364,181
356,"
Score: 400 points


Problem Statement
Quickly after finishing the tutorial of the online game ATChat, you have decided to visit a particular place with N-1 players who happen to be there. These N players, including you, are numbered 1 through N, and the friendliness of Player i is A_i.
The N players will arrive at the place one by one in some order. To make sure nobody gets lost, you have set the following rule: players who have already arrived there should form a circle, and a player who has just arrived there should cut into the circle somewhere.
When each player, except the first one to arrive, arrives at the place, the player gets comfort equal to the smaller of the friendliness of the clockwise adjacent player and that of the counter-clockwise adjacent player. The first player to arrive there gets the comfort of 0.
What is the maximum total comfort the N players can get by optimally choosing the order of arrivals and the positions in the circle to cut into?




Constraints

All values in input are integers.
2 \leq N \leq 2 \times 10^5
1 \leq A_i \leq 10^9







Input
Input is given from Standard Input in the following format:
N
A_1 A_2 \dots A_N





Output
Print the maximum total comfort the N players can get.






Sample Input 14
2 2 1 3





Sample Output 17

By arriving at the place in the order Player 4, 2, 1, 3, and cutting into the circle as shown in the figure, they can get the total comfort of 7.

They cannot get the total comfort greater than 7, so the answer is 7.





Sample Input 27
1 1 1 1 1 1 1





Sample Output 26


",Chat in a Circle,"Sorting, Greedy Algorithm, Queue, Simulation, Arithmetic",0.266,663,212
357,"
Score : 300 points


Problem Statement
Takahashi is organizing a party.
At the party, each guest will receive one or more snack pieces.
Takahashi predicts that the number of guests at this party will be A or B.
Find the minimum number of pieces that can be evenly distributed to the guests in both of the cases predicted.
We assume that a piece cannot be divided and distributed to multiple guests.




Constraints

1 \leq A, B \leq 10^5
A \neq B
All values in input are integers.







Input
Input is given from Standard Input in the following format:
A B





Output
Print the minimum number of pieces that can be evenly distributed to the guests in both of the cases with A guests and B guests.






Sample Input 12 3





Sample Output 16

When we have six snack pieces, each guest can take three pieces if we have two guests, and each guest can take two if we have three guests.





Sample Input 2123 456





Sample Output 218696






Sample Input 3100000 99999





Sample Output 39999900000


",Snack,"Euclidean Algorithm, Arithmetic, Mathematics, Implementation",0.566,385,206
358,"
Score : 300 points


Problem StatementN tiles are arranged in a row from left to right. The initial color of each tile is represented by a string S of length N.
The i-th tile from the left is painted black if the i-th character of S is 0, and painted white if that character is 1.
You want to repaint some of the tiles black or white, so that any two adjacent tiles have different colors.
At least how many tiles need to be repainted to satisfy the condition?




Constraints
1 \leq |S| \leq 10^5
S_i is 0 or 1.







InputInput is given from Standard Input in the following format:
S





OutputPrint the minimum number of tiles that need to be repainted to satisfy the condition.






Sample Input 1000





Sample Output 11

The condition can be satisfied by repainting the middle tile white.





Sample Input 210010010





Sample Output 23






Sample Input 30





Sample Output 30


",Coloring Colorfully,"Greedy Algorithm, String, Bruteforcing, Boolean Operations On Geometric Objects",0.801,289,213
359,"
Score : 300 points


Problem StatementSitting in a station waiting room, Joisino is gazing at her train ticket.
The ticket is numbered with four digits A, B, C and D in this order, each between 0 and 9 (inclusive).
In the formula A op1 B op2 C op3 D = 7, replace each of the symbols op1, op2 and op3 with + or - so that the formula holds.
The given input guarantees that there is a solution. If there are multiple solutions, any of them will be accepted.




Constraints
0≤A,B,C,D≤9
All input values are integers.
It is guaranteed that there is a solution.







InputInput is given from Standard Input in the following format:
ABCD





OutputPrint the formula you made, including the part =7.
Use the signs + and -.
Do not print a space between a digit and a sign.






Sample Input 11222





Sample Output 11+2+2+2=7

This is the only valid solution.





Sample Input 20290





Sample Output 20-2+9+0=7

0 - 2 + 9 - 0 = 7 is also a valid solution.





Sample Input 33242





Sample Output 33+2+4-2=7


",Train Ticket,"Bitmask, Bruteforcing, String, Boolean Operations On Geometric Objects",0.637,305,192
360,"
Score : 300 points


Problem StatementTakahashi made N problems for competitive programming.
The problems are numbered 1 to N, and the difficulty of Problem i is represented as an integer d_i (the higher, the harder).
He is dividing the problems into two categories by choosing an integer K, as follows:

A problem with difficulty K or higher will be for ARCs.
A problem with difficulty lower than K will be for ABCs.

How many choices of the integer K make the number of problems for ARCs and the number of problems for ABCs the same?




Problem Statement
2 \leq N \leq 10^5
N is an even number.
1 \leq d_i \leq 10^5
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
d_1 d_2 ... d_N





OutputPrint the number of choices of the integer K that make the number of problems for ARCs and the number of problems for ABCs the same.






Sample Input 16
9 1 4 4 6 7





Sample Output 12

If we choose K=5 or 6, Problem 1, 5, and 6 will be for ARCs, Problem 2, 3, and 4 will be for ABCs, and the objective is achieved.
Thus, the answer is 2.





Sample Input 28
9 1 14 5 5 4 4 14





Sample Output 20

There may be no choice of the integer K that make the number of problems for ARCs and the number of problems for ABCs the same.





Sample Input 314
99592 10342 29105 78532 83018 11639 92015 77204 30914 21912 34519 80835 100000 1





Sample Output 342685


",Divide the Problems,"Sorting, Array, Mathematics",0.845,279,213
361,"
Score : 200 points


Problem StatementThere are N apple trees in a row. People say that one of them will bear golden apples.
We want to deploy some number of inspectors so that each of these trees will be inspected.
Each inspector will be deployed under one of the trees. For convenience, we will assign numbers from 1 through N to the trees. An inspector deployed under the i-th tree (1 \leq i \leq N) will inspect the trees with numbers between i-D and i+D (inclusive).
Find the minimum number of inspectors that we need to deploy to achieve the objective.




Constraints
All values in input are integers.
1 \leq N \leq 20
1 \leq D \leq 20







InputInput is given from Standard Input in the following format:
N D





OutputPrint the minimum number of inspectors that we need to deploy to achieve the objective.






Sample Input 16 2





Sample Output 12

We can achieve the objective by, for example, placing an inspector under Tree 3 and Tree 4.





Sample Input 214 3





Sample Output 22






Sample Input 320 4





Sample Output 33


",Golden Apple,"Arithmetic, Mathematics, Greedy Algorithm",0.786,331,210
362,"
Score : 300 points


Problem StatementYou are given three integers A, B and C. Find the minimum number of operations required to make A, B and C all equal by repeatedly performing the following two kinds of operations in any order:

Choose two among A, B and C, then increase both by 1.
Choose one among A, B and C, then increase it by 2.

It can be proved that we can always make A, B and C all equal by repeatedly performing these operations.




Constraints
0 \leq A,B,C \leq 50
All values in input are integers.







InputInput is given from Standard Input in the following format:
A B C





OutputPrint the minimum number of operations required to make A, B and C all equal.






Sample Input 12 5 4





Sample Output 12

We can make A, B and C all equal by the following operations:

Increase A and C by 1. Now, A, B, C are 3, 5, 5, respectively.
Increase A by 2. Now, A, B, C are 5, 5, 5, respectively.






Sample Input 22 6 3





Sample Output 25






Sample Input 331 41 5





Sample Output 323


",Same Integers,"Sorting, Greedy Algorithm, Arithmetic, Boolean Operations On Geometric Objects",0.738,162,114
363,"
Score : 200 points


Problem StatementWe have a permutation p = {p_1,\ p_2,\ ...,\ p_n} of {1,\ 2,\ ...,\ n}.
Print the number of elements p_i (1 < i < n) that satisfy the following condition:

p_i is the second smallest number among the three numbers p_{i - 1}, p_i, and p_{i + 1}.





Constraints
All values in input are integers.
3 \leq n \leq 20
p is a permutation of {1,\ 2,\ ...,\ n}.







InputInput is given from Standard Input in the following format:
n
p_1 p_2 ... p_n





OutputPrint the number of elements p_i (1 < i < n) that satisfy the condition.






Sample Input 15
1 3 5 4 2





Sample Output 12

p_2 = 3 is the second smallest number among p_1 = 1, p_2 = 3, and p_3 = 5. Also, p_4 = 4 is the second smallest number among p_3 = 5, p_4 = 4, and p_5 = 2. These two elements satisfy the condition.





Sample Input 29
9 6 3 2 5 8 7 4 1





Sample Output 25


",Ordinary Number,"Array, Sliding Window, Arithmetic, Boolean Operations On Geometric Objects",0.867,243,198
364,"
Score : 200 points


Problem StatementA ball will bounce along a number line, making N + 1 bounces. It will make the first bounce at coordinate D_1 = 0, and the i-th bounce (2 \leq i \leq N+1) at coordinate D_i = D_{i-1} + L_{i-1}.
How many times will the ball make a bounce where the coordinate is at most X?




Constraints
1 \leq N \leq 100
1 \leq L_i \leq 100
1 \leq X \leq 10000
All values in input are integers.







InputInput is given from Standard Input in the following format:
N X
L_1 L_2 ... L_{N-1} L_N





OutputPrint the number of times the ball will make a bounce where the coordinate is at most X.






Sample Input 13 6
3 4 5





Sample Output 12

The ball will make a bounce at the coordinates 0, 3, 7 and 12, among which two are less than or equal to 6.





Sample Input 24 9
3 3 3 3





Sample Output 24

The ball will make a bounce at the coordinates 0, 3, 6, 9 and 12, among which four are less than or equal to 9.

",Bounding,"Prefix sum, Bruteforcing, Counting",0.553,540,246
365,"
Score : 300 points


Problem StatementYou are given a sequence of length N: A_1, A_2, ..., A_N.
For each integer i between 1 and N (inclusive), answer the following question:

Find the maximum value among the N-1 elements other than A_i in the sequence.





Constraints
2 \leq N \leq 200000
1 \leq A_i \leq 200000
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
A_1
:
A_N





OutputPrint N lines. The i-th line (1 \leq i \leq N) should contain the maximum value among the N-1 elements other than A_i in the sequence.






Sample Input 13
1
4
3





Sample Output 14
3
4


The maximum value among the two elements other than A_1, that is, A_2 = 4 and A_3 = 3, is 4.
The maximum value among the two elements other than A_2, that is, A_1 = 1 and A_3 = 3, is 3.
The maximum value among the two elements other than A_3, that is, A_1 = 1 and A_2 = 4, is 4.






Sample Input 22
5
5





Sample Output 25
5


",Exception Handling,"Greedy Algorithm, Array, Boolean Operations On Geometric Objects",0.563,408,209
366,"
Score : 300 points


Problem StatementThere are N monsters, numbered 1, 2, ..., N.
Initially, the health of Monster i is A_i.
Below, a monster with at least 1 health is called alive.
Until there is only one alive monster, the following is repeated:

A random alive monster attacks another random alive monster.
As a result, the health of the monster attacked is reduced by the amount equal to the current health of the monster attacking.

Find the minimum possible final health of the last monster alive.




Constraints
All values in input are integers.
2 \leq N \leq 10^5
1 \leq A_i \leq 10^9







InputInput is given from Standard Input in the following format:
N
A_1 A_2 ... A_N





OutputPrint the minimum possible final health of the last monster alive.






Sample Input 14
2 10 8 40





Sample Output 12

When only the first monster keeps on attacking, the final health of the last monster will be 2, which is minimum.





Sample Input 24
5 13 8 1000000000





Sample Output 21






Sample Input 33
1000000000 1000000000 1000000000





Sample Output 31000000000


",Monsters Battle Royale,"Euclidean Algorithm, Bruteforcing, Mathematics",0.597,224,109
367,"
Score : 300 points


Problem StatementWe have a sequence of N integers A~=~A_0,~A_1,~...,~A_{N - 1}.
Let B be a sequence of K \times N integers obtained by concatenating K copies of A. For example, if A~=~1,~3,~2 and K~=~2, B~=~1,~3,~2,~1,~3,~2.
Find the inversion number of B, modulo 10^9 + 7.
Here the inversion number of B is defined as the number of ordered pairs of integers (i,~j)~(0 \leq i < j \leq K \times N - 1) such that  B_i > B_j.




Constraints
All values in input are integers.
1 \leq N \leq 2000
1 \leq K \leq 10^9
1 \leq A_i \leq 2000







InputInput is given from Standard Input in the following format:
N K
A_0 A_1 ... A_{N - 1}





OutputPrint the inversion number of B, modulo 10^9 + 7.






Sample Input 12 2
2 1





Sample Output 13

In this case, B~=~2,~1,~2,~1. We have:

B_0 > B_1
B_0 > B_3
B_2 > B_3

Thus, the inversion number of B is 3.





Sample Input 23 5
1 1 1





Sample Output 20

A may contain multiple occurrences of the same number.





Sample Input 310 998244353
10 9 8 7 5 6 3 4 2 1





Sample Output 3185297239

Be sure to print the output modulo 10^9 + 7.

",Kleene Inversion,"Bruteforcing, Counting, Prefix sum, Arithmetic, Sorting",0.317,148,41
368,"
Score : 400 points


Problem StatementWe have N+1 integers: 10^{100}, 10^{100}+1, ..., 10^{100}+N.
We will choose K or more of these integers. Find the number of possible values of the sum of the chosen numbers, modulo (10^9+7).




Constraints
1 \leq N \leq 2\times 10^5
1 \leq K \leq N+1
All values in input are integers.







InputInput is given from Standard Input in the following format:
N K





OutputPrint the number of possible values of the sum, modulo (10^9+7).






Sample Input 13 2





Sample Output 110

The sum can take 10 values, as follows:

(10^{100})+(10^{100}+1)=2\times 10^{100}+1
(10^{100})+(10^{100}+2)=2\times 10^{100}+2
(10^{100})+(10^{100}+3)=(10^{100}+1)+(10^{100}+2)=2\times 10^{100}+3
(10^{100}+1)+(10^{100}+3)=2\times 10^{100}+4
(10^{100}+2)+(10^{100}+3)=2\times 10^{100}+5
(10^{100})+(10^{100}+1)+(10^{100}+2)=3\times 10^{100}+3
(10^{100})+(10^{100}+1)+(10^{100}+3)=3\times 10^{100}+4
(10^{100})+(10^{100}+2)+(10^{100}+3)=3\times 10^{100}+5
(10^{100}+1)+(10^{100}+2)+(10^{100}+3)=3\times 10^{100}+6
(10^{100})+(10^{100}+1)+(10^{100}+2)+(10^{100}+3)=4\times 10^{100}+6






Sample Input 2200000 200001





Sample Output 21

We must choose all of the integers, so the sum can take just 1 value.





Sample Input 3141421 35623





Sample Output 3220280457


",Sum of Large Numbers,"Arithmetic, Combinatorics, Bruteforcing, Mathematics",0.681,210,122
369,"
Score : 500 points


Problem StatementFor an integer n not less than 0, let us define f(n) as follows:

f(n) = 1 (if n < 2)
f(n) = n f(n-2) (if n \geq 2)

Given is an integer N. Find the number of trailing zeros in the decimal notation of f(N).




Constraints
0 \leq N \leq 10^{18}







InputInput is given from Standard Input in the following format:
N





OutputPrint the number of trailing zeros in the decimal notation of f(N).






Sample Input 112





Sample Output 11

f(12) = 12 × 10 × 8 × 6 × 4 × 2 = 46080, which has one trailing zero.





Sample Input 25





Sample Output 20

f(5) = 5 × 3 × 1 = 15, which has no trailing zeros.





Sample Input 31000000000000000000





Sample Output 3124999999999999995


",Double Factorial,"Number Theory, Mathematics, Bruteforcing, Implementation",0.406,179,75
370,"
Score : 400 points


Problem StatementTakahashi has a maze, which is a grid of H \times W squares with H horizontal rows and W vertical columns.
The square at the i-th row from the top and the j-th column is a ""wall"" square if S_{ij} is #, and a ""road"" square if S_{ij} is ..
From a road square, you can move to a horizontally or vertically adjacent road square.
You cannot move out of the maze, move to a wall square, or move diagonally.
Takahashi will choose a starting square and a goal square, which can be any road squares, and give the maze to Aoki.
Aoki will then travel from the starting square to the goal square, in the minimum number of moves required.
In this situation, find the maximum possible number of moves Aoki has to make.




Constraints
1 \leq H,W \leq 20
S_{ij} is . or #.
S contains at least two occurrences of ..
Any road square can be reached from any road square in zero or more moves.







InputInput is given from Standard Input in the following format:
H W
S_{11}...S_{1W}
:
S_{H1}...S_{HW}





OutputPrint the maximum possible number of moves Aoki has to make.






Sample Input 13 3
...
...
...





Sample Output 14

If Takahashi chooses the top-left square as the starting square and the bottom-right square as the goal square, Aoki has to make four moves.





Sample Input 23 5
...#.
.#.#.
.#...





Sample Output 210

If Takahashi chooses the bottom-left square as the starting square and the top-right square as the goal square, Aoki has to make ten moves.

",Maze Master,"Graph Traversal, Breadth-first Search, Grid Graph, Shortest Path, Bruteforcing, Array",0.507,136,61
371,"
Score : 700 points


Problem StatementTonight, in your favourite cinema they are giving the movie Joker and all seats are occupied. In the cinema there are N rows with N seats each, forming an N\times N square. We denote with 1, 2,\dots, N the viewers in the first row (from left to right); with N+1, \dots, 2N the viewers in the second row (from left to right); and so on until the last row, whose viewers are denoted by N^2-N+1,\dots, N^2.
At the end of the movie, the viewers go out of the cinema in a certain order: the i-th viewer leaving her seat is the one denoted by the number P_i. The viewer P_{i+1} waits until viewer P_i has left the cinema before leaving her seat.
To exit from the cinema, a viewer must move from seat to seat until she exits the square of seats (any side of the square is a valid exit). A viewer can move from a seat to one of its 4 adjacent seats (same row or same column).
While leaving the cinema, it might be that a certain viewer x goes through a seat currently occupied by viewer y; in that case viewer y will hate viewer x forever. Each viewer chooses the way that minimizes the number of viewers that will hate her forever.
Compute the number of pairs of viewers (x, y) such that y will hate x forever.




Constraints
2 \le N \le 500
The sequence P_1, P_2, \dots, P_{N^2} is a permutation of \{1, 2, \dots, N^2\}.







InputThe input is given from Standard Input in the format
N
P_1 P_2 \cdots P_{N^2}





OutputIf ans is the number of pairs of viewers described in the statement, you should print on Standard Output
ans







Sample Input 13
1 3 7 9 5 4 8 6 2





Sample Output 11

Before the end of the movie, the viewers are arranged in the cinema as follows:
1 2 3
4 5 6
7 8 9

The first four viewers leaving the cinema (1, 3, 7, 9) can leave the cinema without going through any seat, so they will not be hated by anybody.
Then, viewer 5 must go through one of the seats where viewers 2, 4, 6, 8 are currently seated while leaving the cinema; hence he will be hated by at least one of those viewers.
Finally the remaining viewers can leave the cinema (in the order 4, 8, 6, 2) without going through any occupied seat (actually, they can leave the cinema without going through any seat at all).





Sample Input 24
6 7 1 4 13 16 10 9 5 11 12 14 15 2 3 8





Sample Output 23






Sample Input 36
11 21 35 22 7 36 27 34 8 20 15 13 16 1 24 3 2 17 26 9 18 32 31 23 19 14 4 25 10 29 28 33 12 6 5 30





Sample Output 311


",Joker,"Grid Graph, Precomputation, Permutation Cycle Decomposition, Shortest Path, Breadth-first Search, Dynamic Programming, Queue",0.364,68,16
372,"
Score : 400 points


Problem StatementYou have N cards. On the i-th card, an integer A_i is written.
For each j = 1, 2, ..., M in this order, you will perform the following operation once:
Operation: Choose at most B_j cards (possibly zero). Replace the integer written on each chosen card with C_j.
Find the maximum possible sum of the integers written on the N cards after the M operations.




Constraints
All values in input are integers.
1 \leq N \leq 10^5
1 \leq M \leq 10^5
1 \leq A_i, C_i \leq 10^9
1 \leq B_i \leq N







InputInput is given from Standard Input in the following format:
N M
A_1 A_2 ... A_N
B_1 C_1
B_2 C_2
\vdots
B_M C_M





OutputPrint the maximum possible sum of the integers written on the N cards after the M operations.






Sample Input 13 2
5 1 4
2 3
1 5





Sample Output 114

By replacing the integer on the second card with 5, the sum of the integers written on the three cards becomes 5 + 5 + 4 = 14, which is the maximum result.





Sample Input 210 3
1 8 5 7 100 4 52 33 13 5
3 10
4 30
1 4





Sample Output 2338






Sample Input 33 2
100 100 100
3 99
3 99





Sample Output 3300






Sample Input 411 3
1 1 1 1 1 1 1 1 1 1 1
3 1000000000
4 1000000000
3 1000000000





Sample Output 410000000001

The output may not fit into a 32-bit integer type.

",Integer Cards,"Sorting, Greedy Algorithm, Two-pointer, Array, Arithmetic",0.228,478,86
373,"
Score : 400 points


Problem StatementGiven are three integers N, K, and S.
Find a sequence A_1, A_2, ..., A_N of N integers between 1 and 10^9 (inclusive) that satisfies the condition below.
We can prove that, under the conditions in Constraints, such a sequence always exists.

There are exactly K pairs (l, r) of integers such that 1 \leq l \leq r \leq N and A_l + A_{l + 1} + \cdots + A_r = S.





Constraints
1 \leq N \leq 10^5
0 \leq K \leq N
1 \leq S \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N K S





OutputPrint a sequence satisfying the condition, in the following format:
A_1 A_2 ... A_N







Sample Input 14 2 3





Sample Output 11 2 3 4

Two pairs (l, r) = (1, 2) and (3, 3) satisfy the condition in the statement.





Sample Input 25 3 100





Sample Output 250 50 50 30 70


",Subarray Sum,"Greedy Algorithm, Constructive, Array, Mathematics",0.566,96,49
374,"
Score : 300 points


Problem StatementThere is a rectangle in a coordinate plane. The coordinates of the four vertices are (0,0), (W,0), (W,H), and (0,H).
You are given a point (x,y) which is within the rectangle or on its border. We will draw a straight line passing through (x,y) to cut the rectangle into two parts. Find the maximum possible area of the part whose area is not larger than that of the other. Additionally, determine if there are multiple ways to cut the rectangle and achieve that maximum.




Constraints
1 \leq W,H \leq 10^9
0\leq x\leq W
0\leq y\leq H
All values in input are integers.







InputInput is given from Standard Input in the following format:
W H x y





OutputPrint the maximum possible area of the part whose area is not larger than that of the other, followed by 1 if there are multiple ways to cut the rectangle and achieve that maximum, and 0 otherwise.
The area printed will be judged correct when its absolute or relative error is at most 10^{-9}.






Sample Input 12 3 1 2





Sample Output 13.000000 0

The line x=1 gives the optimal cut, and no other line does.





Sample Input 22 2 1 1





Sample Output 22.000000 1


",Rectangle Cutting,"Geometry; 3d, Mathematics, Boolean Operations On Geometric Objects, Arithmetic",0.265,601,151
375,"
Score : 300 points


Problem StatementWe have N switches with ""on"" and ""off"" state, and M bulbs. The switches are numbered 1 to N, and the bulbs are numbered 1 to M.
Bulb i is connected to k_i switches: Switch s_{i1}, s_{i2}, ..., and s_{ik_i}. It is lighted when the number of switches that are ""on"" among these switches is congruent to p_i modulo 2.
How many combinations of ""on"" and ""off"" states of the switches light all the bulbs?




Constraints
1 \leq N, M \leq 10
1 \leq k_i \leq N
1 \leq s_{ij} \leq N
s_{ia} \neq s_{ib} (a \neq b)
p_i is 0 or 1.
All values in input are integers.







InputInput is given from Standard Input in the following format:
N M
k_1 s_{11} s_{12} ... s_{1k_1}
:
k_M s_{M1} s_{M2} ... s_{Mk_M}
p_1 p_2 ... p_M





OutputPrint the number of combinations of ""on"" and ""off"" states of the switches that light all the bulbs.






Sample Input 12 2
2 1 2
1 2
0 1





Sample Output 11


Bulb 1 is lighted when there is an even number of switches that are ""on"" among the following: Switch 1 and 2.
Bulb 2 is lighted when there is an odd number of switches that are ""on"" among the following: Switch 2.

There are four possible combinations of states of (Switch 1, Switch 2): (on, on), (on, off), (off, on) and (off, off). Among them, only (on, on) lights all the bulbs, so we should print 1.





Sample Input 22 3
2 1 2
1 1
1 2
0 0 1





Sample Output 20


Bulb 1 is lighted when there is an even number of switches that are ""on"" among the following: Switch 1 and 2.
Bulb 2 is lighted when there is an even number of switches that are ""on"" among the following: Switch 1.
Bulb 3 is lighted when there is an odd number of switches that are ""on"" among the following: Switch 2.

Switch 1 has to be ""off"" to light Bulb 2 and Switch 2 has to be ""on"" to light Bulb 3, but then Bulb 1 will not be lighted. Thus, there are no combinations of states of the switches that light all the bulbs, so we should print 0.





Sample Input 35 2
3 1 2 5
2 2 3
1 0





Sample Output 38


",Switches,"Bitmask, Enumeration, Arithmetic, Bruteforcing, Bit Set",0.758,157,117
376,"
Score : 400 points


Problem StatementThere is a grid with H horizontal rows and W vertical columns, and there are obstacles on some of the squares.
Snuke is going to choose one of the squares not occupied by an obstacle and place a lamp on it.
The lamp placed on the square will emit straight beams of light in four cardinal directions: up, down, left, and right.
In each direction, the beam will continue traveling until it hits a square occupied by an obstacle or it hits the border of the grid. It will light all the squares on the way, including the square on which the lamp is placed, but not the square occupied by an obstacle.
Snuke wants to maximize the number of squares lighted by the lamp.
You are given H strings S_i (1 \leq i \leq H), each of length W. If the j-th character (1 \leq j \leq W) of S_i is #, there is an obstacle on the square at the i-th row from the top and the j-th column from the left; if that character is ., there is no obstacle on that square.
Find the maximum possible number of squares lighted by the lamp.




Constraints
1 \leq H \leq 2,000
1 \leq W \leq 2,000
S_i is a string of length W consisting of # and ..
. occurs at least once in one of the strings S_i (1 \leq i \leq H).







InputInput is given from Standard Input in the following format:
H W
S_1
:
S_H





OutputPrint the maximum possible number of squares lighted by the lamp.






Sample Input 14 6
#..#..
.....#
....#.
#.#...





Sample Output 18

If Snuke places the lamp on the square at the second row from the top and the second column from the left, it will light the following squares: the first through fifth squares from the left in the second row, and the first through fourth squares from the top in the second column, for a total of eight squares.





Sample Input 28 8
..#...#.
....#...
##......
..###..#
...#..#.
##....#.
#...#...
###.#..#





Sample Output 213


",Lamp,"Dyanmic Programming, Array, Prefix sum, Grid Graph, Data Structure",0.62,127,67
377,"
Score : 400 points


Problem StatementAt an arcade, Takahashi is playing a game called RPS Battle, which is played as follows:

The player plays N rounds of Rock Paper Scissors against the machine. (See Notes for the description of Rock Paper Scissors. A draw also counts as a round.)
Each time the player wins a round, depending on which hand he/she uses, he/she earns the following score (no points for a draw or a loss):
R points for winning with Rock;
S points for winning with Scissors;
P points for winning with Paper.


However, in the i-th round, the player cannot use the hand he/she used in the (i-K)-th round. (In the first K rounds, the player can use any hand.)

Before the start of the game, the machine decides the hand it will play in each round. With supernatural power, Takahashi managed to read all of those hands.
The information Takahashi obtained is given as a string T. If the i-th character of T (1 \leq i \leq N) is r, the machine will play Rock in the i-th round. Similarly, p and s stand for Paper and Scissors, respectively.
What is the maximum total score earned in the game by adequately choosing the hand to play in each round?




NotesIn this problem, Rock Paper Scissors can be thought of as a two-player game, in which each player simultaneously forms Rock, Paper, or Scissors with a hand.

If a player chooses Rock and the other chooses Scissors, the player choosing Rock wins;
if a player chooses Scissors and the other chooses Paper, the player choosing Scissors wins;
if a player chooses Paper and the other chooses Rock, the player choosing Paper wins;
if both players play the same hand, it is a draw.





Constraints
2 \leq N \leq 10^5
1 \leq K \leq N-1
1 \leq R,S,P \leq 10^4
N,K,R,S, and P are all integers.
|T| = N
T consists of r, p, and s.







InputInput is given from Standard Input in the following format:
N K
R S P
T





OutputPrint the maximum total score earned in the game.






Sample Input 15 2
8 7 6
rsrpr





Sample Output 127

The machine will play {Rock, Scissors, Rock, Paper, Rock}.
We can, for example, play {Paper, Rock, Rock, Scissors, Paper} against it to earn 27 points.
We cannot earn more points, so the answer is 27.





Sample Input 27 1
100 10 1
ssssppr





Sample Output 2211






Sample Input 330 5
325 234 123
rspsspspsrpspsppprpsprpssprpsr





Sample Output 34996


",Prediction and Restriction,"Arithmetic, Dyanmic Programming, Greedy Algorithm, String, Array",0.739,124,79
378,"
Score : 300 points


Problem StatementWe will call a string obtained by arranging the characters contained in a string a in some order, an anagram of a.
For example, greenbin is an anagram of beginner. As seen here, when the same character occurs multiple times, that character must be used that number of times.
Given are N strings s_1, s_2, \ldots, s_N. Each of these strings has a length of 10 and consists of lowercase English characters. Additionally, all of these strings are distinct. Find the number of pairs of integers i, j (1 \leq i < j \leq N) such that s_i is an anagram of s_j.




Constraints
2 \leq N \leq 10^5
s_i is a string of length 10.
Each character in s_i is a lowercase English letter.
s_1, s_2, \ldots, s_N are all distinct.







InputInput is given from Standard Input in the following format:
N
s_1
s_2
:
s_N





OutputPrint the number of pairs of integers i, j (1 \leq i < j \leq N) such that s_i is an anagram of s_j.






Sample Input 13
acornistnt
peanutbomb
constraint





Sample Output 11

s_1 = acornistnt is an anagram of s_3 = constraint. There are no other pairs i, j such that s_i is an anagram of s_j, so the answer is 1.





Sample Input 22
oneplustwo
ninemodsix





Sample Output 20

If there is no pair i, j such that s_i is an anagram of s_j, print 0.





Sample Input 35
abaaaaaaaa
oneplustwo
aaaaaaaaba
twoplusone
aaaabaaaaa





Sample Output 34

Note that the answer may not fit into a 32-bit integer type, though we cannot put such a case here.

",Green Bin,"Sorting, Set / Map, Hashing, Combinatorics",0.194,702,177
379,"
Score : 300 points


Problem StatementThere are N cities on a number line. The i-th city is located at coordinate x_i.
Your objective is to visit all these cities at least once.
In order to do so, you will first set a positive integer D.
Then, you will depart from coordinate X and perform Move 1 and Move 2 below, as many times as you like:

Move 1: travel from coordinate y to coordinate y + D.
Move 2: travel from coordinate y to coordinate y - D.

Find the maximum value of D that enables you to visit all the cities.
Here, to visit a city is to travel to the coordinate where that city is located.




Constraints
All values in input are integers.
1 \leq N \leq 10^5
1 \leq X \leq 10^9
1 \leq x_i \leq 10^9
x_i are all different.
x_1, x_2, ..., x_N \neq X







InputInput is given from Standard Input in the following format:
N X
x_1 x_2 ... x_N





OutputPrint the maximum value of D that enables you to visit all the cities.






Sample Input 13 3
1 7 11





Sample Output 12

Setting D = 2 enables you to visit all the cities as follows, and this is the maximum value of such D.

Perform Move 2 to travel to coordinate 1.
Perform Move 1 to travel to coordinate 3.
Perform Move 1 to travel to coordinate 5.
Perform Move 1 to travel to coordinate 7.
Perform Move 1 to travel to coordinate 9.
Perform Move 1 to travel to coordinate 11.






Sample Input 23 81
33 105 57





Sample Output 224






Sample Input 31 1
1000000000





Sample Output 3999999999


",Skip,"Euclidean Algorithm, Bruteforcing, Arithmetic, Mathematics",0.574,261,123
380,"
Score : 100 points


Problem StatementIn this problem, we use the 24-hour clock.
Takahashi gets up exactly at the time H_1 : M_1 and goes to bed exactly at the time H_2 : M_2. (See Sample Inputs below for clarity.)
He has decided to study for K consecutive minutes while he is up.
What is the length of the period in which he can start studying?




Constraints
0 \le H_1, H_2 \le 23
0 \le M_1, M_2 \le 59
The time H_1 : M_1 comes before the time H_2 : M_2.
K \ge 1
Takahashi is up for at least K minutes.
All values in input are integers (without leading zeros).







InputInput is given from Standard Input in the following format:
H_1 M_1 H_2 M_2 K





OutputPrint the length of the period in which he can start studying, as an integer.






Sample Input 110 0 15 0 30





Sample Output 1270

Takahashi gets up at exactly ten in the morning and goes to bed at exactly three in the afternoon.
It takes 30 minutes to do the study, so he can start it in the period between ten o'clock and half-past two. The length of this period is 270 minutes, so we should print 270.





Sample Input 210 0 12 0 120





Sample Output 20

Takahashi gets up at exactly ten in the morning and goes to bed at exactly noon. It takes 120 minutes to do the study, so he has to start it at exactly ten o'clock. Thus, we should print 0.

",Study Scheduling,"Implementation, Arithmetic, Mathematics",0.737,216,150
381,"
Score : 300 points


Problem StatementThere is a grid with infinitely many rows and columns. In this grid, there is a rectangular region with consecutive N rows and M columns, and a card is placed in each square in this region.
The front and back sides of these cards can be distinguished, and initially every card faces up.
We will perform the following operation once for each square contains a card:

For each of the following nine squares, flip the card in it if it exists: the target square itself and the eight squares that shares a corner or a side with the target square.

It can be proved that, whether each card faces up or down after all the operations does not depend on the order the operations are performed.
Find the number of cards that face down after all the operations.




Constraints
1 \leq N,M \leq 10^9
All input values are integers.







InputInput is given from Standard Input in the following format:
N M





OutputPrint the number of cards that face down after all the operations.






Sample Input 12 2





Sample Output 10

We will flip every card in any of the four operations. Thus, after all the operations, all cards face up.





Sample Input 21 7





Sample Output 25

After all the operations, all cards except at both ends face down.





Sample Input 3314 1592





Sample Output 3496080


",Flip Flip  and Flip......,"Arithmetic, Mathematics, Boolean Operations On Geometric Objects",0.206,97,34
382,"
Score : 300 points


Problem StatementWhen l is an odd number, the median of l numbers a_1, a_2, ..., a_l is the (\frac{l+1}{2})-th largest value among a_1, a_2, ..., a_l.
You are given N numbers X_1, X_2, ..., X_N, where N is an even number.
For each i = 1, 2, ..., N, let the median of X_1, X_2, ..., X_N excluding X_i, that is, the median of X_1, X_2, ..., X_{i-1}, X_{i+1}, ..., X_N be B_i.
Find B_i for each i = 1, 2, ..., N.




Constraints
2 \leq N \leq 200000
N is even.
1 \leq X_i \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
X_1 X_2 ... X_N





OutputPrint N lines.
The i-th line should contain B_i.






Sample Input 14
2 4 4 3





Sample Output 14
3
3
4


Since the median of X_2, X_3, X_4 is 4, B_1 = 4.
Since the median of X_1, X_3, X_4 is 3, B_2 = 3.
Since the median of X_1, X_2, X_4 is 3, B_3 = 3.
Since the median of X_1, X_2, X_3 is 4, B_4 = 4.






Sample Input 22
1 2





Sample Output 22
1






Sample Input 36
5 5 4 4 3 3





Sample Output 34
4
4
4
4
4


",Many Medians,"Sorting, Array, Boolean Operations On Geometric Objects",0.474,202,91
383,"
Score : 400 points


Problem StatementFor an integer N, we will choose a permutation \{P_1, P_2, ..., P_N\} of \{1, 2, ..., N\}.
Then, for each i=1,2,...,N, let M_i be the remainder when i is divided by P_i.
Find the maximum possible value of M_1 + M_2 + \cdots + M_N.




Constraints
N is an integer satisfying 1 \leq N \leq 10^9.







InputInput is given from Standard Input in the following format:
N





OutputPrint the maximum possible value of M_1 + M_2 + \cdots + M_N.






Sample Input 12





Sample Output 11

When the permutation \{P_1, P_2\} = \{2, 1\} is chosen, M_1 + M_2 = 1 + 0 = 1.





Sample Input 213





Sample Output 278






Sample Input 31





Sample Output 30


",ModSum,"Mathematics, Permutation Cycle Decomposition, Arithmetic",0.404,389,174
384,"
Score : 400 points


Problem StatementSnuke has one biscuit and zero Japanese yen (the currency) in his pocket.
He will perform the following operations exactly K times in total, in the order he likes:

Hit his pocket, which magically increases the number of biscuits by one.
Exchange A biscuits to 1 yen.
Exchange 1 yen to B biscuits.

Find the maximum possible number of biscuits in Snuke's pocket after K operations.




Constraints
1 \leq K,A,B \leq 10^9
K,A and B are integers.







InputInput is given from Standard Input in the following format:
K A B





OutputPrint the maximum possible number of biscuits in Snuke's pocket after K operations.






Sample Input 14 2 6





Sample Output 17

The number of biscuits in Snuke's pocket after K operations is maximized as follows:

Hit his pocket. Now he has 2 biscuits and 0 yen.
Exchange 2 biscuits to 1 yen. his pocket. Now he has 0 biscuits and 1 yen.
Hit his pocket. Now he has 1 biscuits and 1 yen.
Exchange 1 yen to 6 biscuits. his pocket. Now he has 7 biscuits and 0 yen.






Sample Input 27 3 4





Sample Output 28






Sample Input 3314159265 35897932 384626433





Sample Output 348518828981938099


",When I hit my pocket...,"Greedy Algorithm, Arithmetic, Boolean Operations On Geometric Objects",0.667,88,53
385,"
Score : 200 points


Problem StatementWe will call a string that can be obtained by concatenating two equal strings an even string.
For example, xyzxyz and aaaaaa are even, while ababab and xyzxy are not.
You are given an even string S consisting of lowercase English letters.
Find the length of the longest even string that can be obtained by deleting one or more characters from the end of S.
It is guaranteed that such a non-empty string exists for a given input.




Constraints
2 \leq |S| \leq 200
S is an even string consisting of lowercase English letters.
There exists a non-empty even string that can be obtained by deleting one or more characters from the end of S.







InputInput is given from Standard Input in the following format:
S





OutputPrint the length of the longest even string that can be obtained.






Sample Input 1abaababaab





Sample Output 16


abaababaab itself is even, but we need to delete at least one character.
abaababaa is not even.
abaababa is not even.
abaabab is not even.
abaaba is even. Thus, we should print its length, 6.






Sample Input 2xxxx





Sample Output 22


xxx is not even.
xx is even.






Sample Input 3abcabcabcabc





Sample Output 36

The longest even string that can be obtained is abcabc, whose length is 6.





Sample Input 4akasakaakasakasakaakas





Sample Output 414

The longest even string that can be obtained is akasakaakasaka, whose length is 14.

",ss,"String, Bruteforcing, Greedy Algorithm, Two-pointer",0.75,208,118
386,"
Score : 300 points


Problem StatementIn AtCoder, a person who has participated in a contest receives a color, which corresponds to the person's rating as follows:  

Rating 1-399 : gray
Rating 400-799 : brown
Rating 800-1199 : green
Rating 1200-1599 : cyan
Rating 1600-1999 : blue
Rating 2000-2399 : yellow
Rating 2400-2799 : orange
Rating 2800-3199 : red

Other than the above, a person whose rating is 3200 or higher can freely pick his/her color, which can be one of the eight colors above or not.
Currently, there are N users who have participated in a contest in AtCoder, and the i-th user has a rating of a_i.
Find the minimum and maximum possible numbers of different colors of the users.  




Constraints
1 ≤ N ≤ 100
1 ≤ a_i ≤ 4800
a_i is an integer.







InputInput is given from Standard Input in the following format:
N
a_1 a_2 ... a_N





OutputPrint the minimum possible number of different colors of the users, and the maximum possible number of different colors, with a space in between.  






Sample Input 14
2100 2500 2700 2700





Sample Output 12 2

The user with rating 2100 is ""yellow"", and the others are ""orange"". There are two different colors.  





Sample Input 25
1100 1900 2800 3200 3200





Sample Output 23 5

The user with rating 1100 is ""green"", the user with rating 1900 is blue and the user with rating 2800 is ""red"".
If the fourth user picks ""red"", and the fifth user picks ""blue"", there are three different colors. This is one possible scenario for the minimum number of colors.
If the fourth user picks ""purple"", and the fifth user picks ""black"", there are five different colors. This is one possible scenario for the maximum number of colors.  





Sample Input 320
800 810 820 830 840 850 860 870 880 890 900 910 920 930 940 950 960 970 980 990





Sample Output 31 1

All the users are ""green"", and thus there is one color.

",Colorful Leaderboard,"Bruteforcing, Implementation, Counting, Set / Map, Arithmetic",0.12,453,126
387,"
Score : 100 points


Problem StatementYou are given integers A and B, each between 1 and 3 (inclusive).
Determine if there is an integer C between 1 and 3 (inclusive) such that A \times B \times C is an odd number.




Constraints
All values in input are integers.
1 \leq A, B \leq 3







InputInput is given from Standard Input in the following format:
A B





OutputIf there is an integer C between 1 and 3 that satisfies the condition, print Yes; otherwise, print No.






Sample Input 13 1





Sample Output 1Yes

Let C = 3. Then, A \times B \times C = 3 \times 1 \times 3 = 9, which is an odd number.





Sample Input 21 2





Sample Output 2No






Sample Input 32 2





Sample Output 3No


",ABC333,"Bruteforcing, Arithmetic, Implementation",0.737,281,175
388,"
Score : 100 points


Problem StatementCat Snuke is learning to write characters.
Today, he practiced writing digits 1 and 9, but he did it the other way around.
You are given a three-digit integer n written by Snuke.
Print the integer obtained by replacing each digit 1 with 9 and each digit 9 with 1 in n.




Constraints
111 \leq n \leq 999
n is an integer consisting of digits 1 and 9.







InputInput is given from Standard Input in the following format:
n





OutputPrint the integer obtained by replacing each occurrence of 1 with 9 and each occurrence of 9 with 1 in n.






Sample Input 1119





Sample Output 1991

Replace the 9 in the ones place with 1, the 1 in the tens place with 9 and the 1 in the hundreds place with 9. The answer is 991.





Sample Input 2999





Sample Output 2111


",AtCoder Beginner Contest 999,"String, Bruteforcing, Implementation, Array",0.839,206,150
389,"
﻿Score: 100 points


Problem Statement
In 2020, AtCoder Inc. with an annual sales of more than one billion yen (the currency of Japan) has started a business in programming education.
One day, there was an exam where a one-year-old child must write a program that prints Hello World, and a two-year-old child must write a program that receives integers A, B and prints A+B.
Takahashi, who is taking this exam, suddenly forgets his age.
He decides to write a program that first receives his age N (1 or 2) as input, then prints Hello World if N=1, and additionally receives integers A, B and prints A+B if N=2.
Write this program for him.  




Constraints

N is 1 or 2.
A is an integer between 1 and 9 (inclusive).
B is an integer between 1 and 9 (inclusive).







Input
Input is given from Standard Input in one of the following formats:  
1

2
A
B





Output
If N=1, print Hello World; if N=2, print A+B.  






Sample Input 11





Sample Output 1Hello World

As N=1, Takahashi is one year old. Thus, we should print Hello World.





Sample Input 22
3
5





Sample Output 28

As N=2, Takahashi is two years old. Thus, we should print A+B, which is 8 since A=3 and B=5. 

",Programming Education,"Implementation, Arithmetic",0.791,283,170
390,"
Score: 100 points


Problem StatementThere is a train going from Station A to Station B that costs X yen (the currency of Japan).
Also, there is a bus going from Station B to Station C that costs Y yen.
Joisino got a special ticket. With this ticket, she can take the bus for half the fare if she travels from Station A to Station B by train and then travels from Station B to Station C by bus.
How much does it cost to travel from Station A to Station C if she uses this ticket?




Constraints
1 \leq X,Y \leq 100
Y is an even number.
All values in input are integers.







InputInput is given from Standard Input in the following format:
X Y





OutputIf it costs x yen to travel from Station A to Station C, print x.






Sample Input 181 58





Sample Output 1110


The train fare is 81 yen.
The train fare is 58 ⁄ 2=29 yen with the 50% discount.

Thus, it costs 110 yen to travel from Station A to Station C.





Sample Input 24 54





Sample Output 231


",Discount Fare,Arithmetic,0.874,237,172
391,"
Score : 300 points


Problem StatementGiven are positive integers N, M, Q, and Q quadruples of integers ( a_i , b_i , c_i , d_i ).
Consider a sequence A satisfying the following conditions:

A is a sequence of N positive integers.
1 \leq A_1 \leq A_2 \le \cdots \leq A_N \leq M.

Let us define a score of this sequence as follows:

The score is the sum of d_i over all indices i such that A_{b_i} - A_{a_i} = c_i. (If there is no such i, the score is 0.)

Find the maximum possible score of A.




Constraints
All values in input are integers.
2 ≤ N ≤ 10
1 \leq M \leq 10
1 \leq Q \leq 50
1 \leq a_i < b_i \leq N ( i = 1, 2, ..., Q )
0 \leq c_i \leq M - 1 ( i = 1, 2, ..., Q )
(a_i, b_i, c_i) \neq (a_j, b_j, c_j) (where i \neq j)
1 \leq d_i \leq 10^5 ( i = 1, 2, ..., Q )







InputInput is given from Standard Input in the following format:
N M Q
a_1 b_1 c_1 d_1
:
a_Q b_Q c_Q d_Q





OutputPrint the maximum possible score of A.






Sample Input 13 4 3
1 3 3 100
1 2 2 10
2 3 2 10





Sample Output 1110

When A = \{1, 3, 4\}, its score is 110. Under these conditions, no sequence has a score greater than 110, so the answer is 110.





Sample Input 24 6 10
2 4 1 86568
1 4 0 90629
2 3 0 90310
3 4 1 29211
3 4 3 78537
3 4 2 8580
1 2 1 96263
1 4 2 2156
1 2 0 94325
1 4 3 94328





Sample Output 2357500






Sample Input 310 10 1
1 10 9 1





Sample Output 31


",Many Requirements,"Backtracking, Combinatorics, Bruteforcing, Array, Arithmetic, Mathematics",0.548,135,69
392,"
Score : 200 points


Problem StatementDetermine if an N-sided polygon (not necessarily convex) with sides of length L_1, L_2, ..., L_N can be drawn in a two-dimensional plane.
You can use the following theorem:
Theorem: an N-sided polygon satisfying the condition can be drawn if and only if the longest side is strictly shorter than the sum of the lengths of the other N-1 sides.




Constraints
All values in input are integers.
3 \leq N \leq 10
1 \leq L_i \leq 100







InputInput is given from Standard Input in the following format:
N
L_1 L_2 ... L_N





OutputIf an N-sided polygon satisfying the condition can be drawn, print Yes; otherwise, print No.






Sample Input 14
3 8 5 1





Sample Output 1Yes

Since 8 < 9 = 3 + 5 + 1, it follows from the theorem that such a polygon can be drawn on a plane.





Sample Input 24
3 8 4 1





Sample Output 2No

Since 8 \geq 8 = 3 + 4 + 1, it follows from the theorem that such a polygon cannot be drawn on a plane.





Sample Input 310
1 8 10 5 8 12 34 100 11 3





Sample Output 3No


",Polygon,"Bruteforcing, Array, Mathematics, Arithmetic, Implementation, Sorting",0.754,278,176
393,"
Score : 200 points


Problem StatementThere are N mountains ranging from east to west, and an ocean to the west.
At the top of each mountain, there is an inn. You have decided to choose where to stay from these inns.
The height of the i-th mountain from the west is H_i.
You can certainly see the ocean from the inn at the top of the westmost mountain.
For the inn at the top of the i-th mountain from the west (i = 2, 3, ..., N), you can see the ocean if and only if H_1 \leq H_i, H_2 \leq H_i, ..., and H_{i-1} \leq H_i.
From how many of these N inns can you see the ocean?




Constraints
All values in input are integers.
1 \leq N \leq 20
1 \leq H_i \leq 100







InputInput is given from Standard Input in the following format:
N
H_1 H_2 ... H_N





OutputPrint the number of inns from which you can see the ocean.






Sample Input 14
6 5 6 8





Sample Output 13

You can see the ocean from the first, third and fourth inns from the west.





Sample Input 25
4 5 3 5 4





Sample Output 23






Sample Input 35
9 5 6 8 4





Sample Output 31


",Great Ocean View,"Bruteforcing, Implementation, Greedy Algorithm, Array",0.807,340,247
394,"
Score : 100 points


Problem StatementThere are three houses on a number line: House 1, 2 and 3, with coordinates A, B and C, respectively.
Print Yes if we pass the coordinate of House 3 on the straight way from House 1 to House 2 without making a detour, and print No otherwise.




Constraints
0\leq A,B,C\leq 100
A, B and C are distinct integers.







InputInput is given from Standard Input in the following format:
A B C





OutputPrint Yes if we pass the coordinate of House 3 on the straight way from House 1 to House 2 without making a detour, and print No otherwise.






Sample Input 13 8 5





Sample Output 1Yes

We pass the coordinate 5 on the straight way from the house at coordinate 3 to the house at coordinate 8.





Sample Input 27 3 1





Sample Output 2No






Sample Input 310 2 4





Sample Output 3Yes






Sample Input 431 41 59





Sample Output 4No


",On the Way,"Implementation, Boolean Operations On Geometric Objects",0.609,244,119
395,"
Score : 200 points


Problem StatementYou are given a string S of length N consisting of lowercase English letters, and an integer K.
Print the string obtained by replacing every character in S that differs from the K-th character of S, with *.




Constraints
1 \leq K \leq N\leq 10
S is a string of length N consisting of lowercase English letters.
N and K are integers.







InputInput is given from Standard Input in the following format:
N
S
K





OutputPrint the string obtained by replacing every character in S that differs from the K-th character of S, with *.






Sample Input 15
error
2





Sample Output 1*rr*r

The second character of S is r. When we replace every character in error that differs from r with *, we get the string *rr*r.





Sample Input 26
eleven
5





Sample Output 2e*e*e*






Sample Input 39
education
7





Sample Output 3******i**


",*e**** ********e* *e****e* ****e**,"Bruteforcing, String, Boolean Operations On Geometric Objects",0.725,166,106
396,"
Score : 300 points


Problem StatementThere are N people numbered 1 to N. Each of them is either an honest person whose testimonies are always correct or an unkind person whose testimonies may be correct or not.
Person i gives A_i testimonies. The j-th testimony by Person i is represented by two integers x_{ij} and y_{ij}. If y_{ij} = 1, the testimony says Person x_{ij} is honest; if y_{ij} = 0, it says Person x_{ij} is unkind.
How many honest persons can be among those N people at most?




Constraints
All values in input are integers.
1 \leq N \leq 15
0 \leq A_i \leq N - 1
1 \leq x_{ij} \leq N
x_{ij} \neq i
x_{ij_1} \neq x_{ij_2} (j_1 \neq j_2)
y_{ij} = 0, 1







InputInput is given from Standard Input in the following format:
N
A_1
x_{11} y_{11}
x_{12} y_{12}
:
x_{1A_1} y_{1A_1}
A_2
x_{21} y_{21}
x_{22} y_{22}
:
x_{2A_2} y_{2A_2}
:
A_N
x_{N1} y_{N1}
x_{N2} y_{N2}
:
x_{NA_N} y_{NA_N}





OutputPrint the maximum possible number of honest persons among the N people.






Sample Input 13
1
2 1
1
1 1
1
2 0





Sample Output 12

If Person 1 and Person 2 are honest and Person 3 is unkind, we have two honest persons without inconsistencies, which is the maximum possible number of honest persons.





Sample Input 23
2
2 1
3 0
2
3 1
1 0
2
1 1
2 0





Sample Output 20

Assuming that one or more of them are honest immediately leads to a contradiction.





Sample Input 32
1
2 0
1
1 0





Sample Output 31


",HonestOrUnkind2,"Bitmask, Bruteforcing, 2-sat",0.627,157,77
397,"
Score : 300 points


Problem StatementThe season for Snuke Festival has come again this year. First of all, Ringo will perform a ritual to summon Snuke. For the ritual, he needs an altar, which consists of three parts, one in each of the three categories: upper, middle and lower.
He has N parts for each of the three categories. The size of the i-th upper part is A_i, the size of the i-th middle part is B_i, and the size of the i-th lower part is C_i.
To build an altar, the size of the middle part must be strictly greater than that of the upper part, and the size of the lower part must be strictly greater than that of the middle part. On the other hand, any three parts that satisfy these conditions can be combined to form an altar.
How many different altars can Ringo build? Here, two altars are considered different when at least one of the three parts used is different.




Constraints
1 \leq N \leq 10^5
1 \leq A_i \leq 10^9(1\leq i\leq N)
1 \leq B_i \leq 10^9(1\leq i\leq N)
1 \leq C_i \leq 10^9(1\leq i\leq N)
All input values are integers.







InputInput is given from Standard Input in the following format:
N
A_1 ... A_N
B_1 ... B_N
C_1 ... C_N





OutputPrint the number of different altars that Ringo can build.






Sample Input 12
1 5
2 4
3 6





Sample Output 13

The following three altars can be built:

Upper: 1-st part, Middle: 1-st part, Lower: 1-st part
Upper: 1-st part, Middle: 1-st part, Lower: 2-nd part
Upper: 1-st part, Middle: 2-nd part, Lower: 2-nd part






Sample Input 23
1 1 1
2 2 2
3 3 3





Sample Output 227






Sample Input 36
3 14 159 2 6 53
58 9 79 323 84 6
2643 383 2 79 50 288





Sample Output 387


",Snuke Festival,"Sorting, Binary Search, Two-pointer, Combinatorics, Prefix sum",0.195,253,50
398,"
Score : 100 points


Problem StatementDecades have passed since the beginning of AtCoder Beginner Contest.
The contests are labeled as ABC001, ABC002, ... from the first round, but after the 999-th round ABC999, a problem occurred: how the future rounds should be labeled?
In the end, the labels for the rounds from the 1000-th to the 1998-th are decided: ABD001, ABD002, ..., ABD999.
You are given an integer N between 1 and 1998 (inclusive). Print the first three characters of the label of the N-th round of AtCoder Beginner Contest.




Constraints
1 \leq N \leq 1998
N is an integer.







InputInput is given from Standard Input in the following format:
N





OutputPrint the first three characters of the label of the N-th round of AtCoder Beginner Contest.






Sample Input 1999





Sample Output 1ABC

The 999-th round of AtCoder Beginner Contest is labeled as ABC999.





Sample Input 21000





Sample Output 2ABD

The 1000-th round of AtCoder Beginner Contest is labeled as ABD001.





Sample Input 31481





Sample Output 3ABD

The 1481-th round of AtCoder Beginner Contest is labeled as ABD482.

",ABD,"Implementation, Arithmetic",0.829,227,167
399,"
Score : 100 points


Problem StatementYou went shopping to buy cakes and donuts with X yen (the currency of Japan).
First, you bought one cake for A yen at a cake shop.
Then, you bought as many donuts as possible for B yen each, at a donut shop.
How much do you have left after shopping?




Constraints
1 \leq A, B \leq 1 000
A + B \leq X \leq 10 000
X, A and B are integers.







InputInput is given from Standard Input in the following format:
X
A
B





OutputPrint the amount you have left after shopping.






Sample Input 11234
150
100





Sample Output 184

You have 1234 - 150 = 1084 yen left after buying a cake.
With this amount, you can buy 10 donuts, after which you have 84 yen left.





Sample Input 21000
108
108





Sample Output 228






Sample Input 3579
123
456





Sample Output 30






Sample Input 47477
549
593





Sample Output 4405


",Buying Sweets,"Arithmetic, Greedy Algorithm",0.765,237,169
400,"
Score : 100 points


Problem StatementThis contest, AtCoder Beginner Contest, is abbreviated as ABC.
When we refer to a specific round of ABC, a three-digit number is appended after ABC. For example, ABC680 is the 680th round of ABC.
What is the abbreviation for the N-th round of ABC? Write a program to output the answer.




Constraints
100 ≤ N ≤ 999







InputInput is given from Standard Input in the following format:
N





OutputPrint the abbreviation for the N-th round of ABC.






Sample Input 1100





Sample Output 1ABC100

The 100th round of ABC is ABC100.





Sample Input 2425





Sample Output 2ABC425






Sample Input 3999





Sample Output 3ABC999


",ABCxxx,String,0.876,177,133
401,"
Score : 200 points


Problem StatementYou are given a string S consisting of lowercase English letters. Determine whether all the characters in S are different.




Constraints
2 ≤ |S| ≤ 26, where |S| denotes the length of S.
S consists of lowercase English letters.







InputInput is given from Standard Input in the following format:
S





OutputIf all the characters in S are different, print yes (case-sensitive); otherwise, print no.






Sample Input 1uncopyrightable





Sample Output 1yes






Sample Input 2different





Sample Output 2no






Sample Input 3no





Sample Output 3yes


",Varied,"Bruteforcing, Data Structures, Set / Map",0.777,180,126
402,"
Score : 200 points


Problem StatementYou have an integer variable x.
Initially, x=0.
Some person gave you a string S of length N, and using the string you performed the following operation N times.
In the i-th operation, you incremented the value of x by 1 if S_i=I, and decremented the value of x by 1 if S_i=D.
Find the maximum value taken by x during the operations (including before the first operation, and after the last operation).




Constraints
1≤N≤100
|S|=N
No characters except I and D occur in S.







InputThe input is given from Standard Input in the following format:
N
S





OutputPrint the maximum value taken by x during the operations.






Sample Input 15
IIDID





Sample Output 12

After each operation, the value of x becomes 1, 2, 1, 2 and 1, respectively. Thus, the output should be 2, the maximum value.





Sample Input 27
DDIDDII





Sample Output 20

The initial value x=0 is the maximum value taken by x, thus the output should be 0.

",Increment Decrement,"Bruteforcing, Implementation, Simulation",0.795,215,162
403,"
Score : 200 points


Problem StatementThe postal code in Atcoder Kingdom is A+B+1 characters long, its (A+1)-th character is a hyphen -, and the other characters are digits from 0 through 9.
You are given a string S. Determine whether it follows the postal code format in Atcoder Kingdom.




Constraints
1≤A,B≤5
|S|=A+B+1
S consists of - and digits from 0 through 9.







InputInput is given from Standard Input in the following format:
A B
S





OutputPrint Yes if S follows the postal code format in AtCoder Kingdom; print No otherwise.






Sample Input 13 4
269-6650





Sample Output 1Yes

The (A+1)-th character of S is -, and the other characters are digits from 0 through 9, so it follows the format.





Sample Input 21 1
---





Sample Output 2No

S contains unnecessary -s other than the (A+1)-th character, so it does not follow the format.





Sample Input 31 2
7444





Sample Output 3No


",Postal Code,"String, Implementation, Bruteforcing",0.682,209,126
404,"
Score : 200 points


Problem StatementWe ask you to select some number of positive integers, and calculate the sum of them.
It is allowed to select as many integers as you like, and as large integers as you wish.
You have to follow these, however: each selected integer needs to be a multiple of A, and you need to select at least one integer.
Your objective is to make the sum congruent to C modulo B.
Determine whether this is possible.
If the objective is achievable, print YES. Otherwise, print NO.




Constraints
1 ≤ A ≤ 100
1 ≤ B ≤ 100
0 ≤ C < B







InputInput is given from Standard Input in the following format:
A B C





OutputPrint YES or NO.






Sample Input 17 5 1





Sample Output 1YES

For example, if you select 7 and 14, the sum 21 is congruent to 1 modulo 5.





Sample Input 22 2 1





Sample Output 2NO

The sum of even numbers, no matter how many, is never odd.





Sample Input 31 100 97





Sample Output 3YES

You can select 97, since you may select multiples of 1, that is, all integers.





Sample Input 440 98 58





Sample Output 4YES






Sample Input 577 42 36





Sample Output 5NO


",Choose Integers,"Arithmetic, Bruteforcing, Mathematics",0.727,234,128
405,"
Score : 200 points


Problem StatementYou are given nonnegative integers a and b (a ≤ b), and a positive integer x.
Among the integers between a and b, inclusive, how many are divisible by x?




Constraints
0 ≤ a ≤ b ≤ 10^{18}
1 ≤ x ≤ 10^{18}







InputThe input is given from Standard Input in the following format:
a b x





OutputPrint the number of the integers between a and b, inclusive, that are divisible by x.






Sample Input 14 8 2





Sample Output 13

There are three integers between 4 and 8, inclusive, that are divisible by 2: 4, 6 and 8.





Sample Input 20 5 1





Sample Output 26

There are six integers between 0 and 5, inclusive, that are divisible by 1: 0, 1, 2, 3, 4 and 5.





Sample Input 39 9 2





Sample Output 30

There are no integer between 9 and 9, inclusive, that is divisible by 2.





Sample Input 41 1000000000000000000 3





Sample Output 4333333333333333333

Watch out for integer overflows.

",Between a and b ...,"Arithmetic, Inclusion And Exclusion, Boolean Operations On Geometric Objects",0.309,472,143
406,"
Score : 200 points


Problem StatementTakahashi wants to gain muscle, and decides to work out at AtCoder Gym.
The exercise machine at the gym has N buttons, and exactly one of the buttons is lighten up.
These buttons are numbered 1 through N.
When Button i is lighten up and you press it, the light is turned off, and then Button a_i will be lighten up. It is possible that i=a_i.
When Button i is not lighten up, nothing will happen by pressing it.
Initially, Button 1 is lighten up. Takahashi wants to quit pressing buttons when Button 2 is lighten up.
Determine whether this is possible. If the answer is positive, find the minimum number of times he needs to press buttons.




Constraints
2 ≤ N ≤ 10^5
1 ≤ a_i ≤ N







InputInput is given from Standard Input in the following format:
N
a_1
a_2
:
a_N





OutputPrint -1 if it is impossible to lighten up Button 2.
Otherwise, print the minimum number of times we need to press buttons in order to lighten up Button 2.






Sample Input 13
3
1
2





Sample Output 12

Press Button 1, then Button 3.





Sample Input 24
3
4
1
2





Sample Output 2-1

Pressing Button 1 lightens up Button 3, and vice versa, so Button 2 will never be lighten up.





Sample Input 35
3
3
4
2
4





Sample Output 33


",Trained?,"Graph Traversal, Graph Theory, Array, Simulation",0.705,191,114
407,"
Score : 300 points


Problem StatementWe have a 2 \times N grid. We will denote the square at the i-th row and j-th column (1 \leq i \leq 2, 1 \leq j \leq N) as (i, j).
You are initially in the top-left square, (1, 1).
You will travel to the bottom-right square, (2, N), by repeatedly moving right or down.
The square (i, j) contains A_{i, j} candies.
You will collect all the candies you visit during the travel.
The top-left and bottom-right squares also contain candies, and you will also collect them.
At most how many candies can you collect when you choose the best way to travel?




Constraints
1 \leq N \leq 100
1 \leq A_{i, j} \leq 100 (1 \leq i \leq 2, 1 \leq j \leq N)







InputInput is given from Standard Input in the following format:
N
A_{1, 1} A_{1, 2} ... A_{1, N}
A_{2, 1} A_{2, 2} ... A_{2, N}





OutputPrint the maximum number of candies that can be collected.






Sample Input 15
3 2 2 4 1
1 2 2 2 1





Sample Output 114

The number of collected candies will be maximized when you:

move right three times, then move down once, then move right once.






Sample Input 24
1 1 1 1
1 1 1 1





Sample Output 25

You will always collect the same number of candies, regardless of how you travel.





Sample Input 37
3 3 4 5 4 5 3
5 3 4 4 2 3 2





Sample Output 329






Sample Input 41
2
3





Sample Output 45


",Candies,"Prefix sum, Bruteforcing, Greedy Algorithm",0.789,184,135
408,"
Score : 300 points


Problem StatementThere are N people standing in a row from west to east.
Each person is facing east or west.
The directions of the people is given as a string S of length N.
The i-th person from the west is facing east if S_i = E, and west if S_i = W.
You will appoint one of the N people as the leader, then command the rest of them to face in the direction of the leader.
Here, we do not care which direction the leader is facing.
The people in the row hate to change their directions, so you would like to select the leader so that the number of people who have to change their directions is minimized.
Find the minimum number of people who have to change their directions.




Constraints
2 \leq N \leq 3 \times 10^5
|S| = N
S_i is E or W.







InputInput is given from Standard Input in the following format:
N
S





OutputPrint the minimum number of people who have to change their directions.






Sample Input 15
WEEWW





Sample Output 11

Assume that we appoint the third person from the west as the leader.
Then, the first person from the west needs to face east and has to turn around.
The other people do not need to change their directions, so the number of people who have to change their directions is 1 in this case.
It is not possible to have 0 people who have to change their directions, so the answer is 1.





Sample Input 212
WEWEWEEEWWWE





Sample Output 24






Sample Input 38
WWWWWEEE





Sample Output 33


",Attention,"Prefix sum, Bruteforcing, Array",0.435,267,87
409,"
Score : 200 points


Problem StatementYou are given a string S of length N.
Among its subsequences, count the ones such that all characters are different, modulo 10^9+7. Two subsequences are considered different if their characters come from different positions in the string, even if they are the same as strings.
Here, a subsequence of a string is a concatenation of one or more characters from the string without changing the order.




Constraints
1 \leq N \leq 100000
S consists of lowercase English letters.
|S|=N







InputInput is given from Standard Input in the following format:
N
S





OutputPrint the number of the subsequences such that all characters are different, modulo 10^9+7.






Sample Input 14
abcd





Sample Output 115

Since all characters in S itself are different, all its subsequences satisfy the condition.





Sample Input 23
baa





Sample Output 25

The answer is five: b, two occurrences of a, two occurrences of ba. Note that we do not count baa, since it contains two as.





Sample Input 35
abcab





Sample Output 317


",Colorful Subsequence,"Counting, Combinatorics, Arithmetic",0.547,131,44
410,"
Score : 100 points


Problem StatementWe have a grid with H rows and W columns, where all the squares are initially white.
You will perform some number of painting operations on the grid.
In one operation, you can do one of the following two actions:

Choose one row, then paint all the squares in that row black.
Choose one column, then paint all the squares in that column black.

At least how many operations do you need in order to have N or more black squares in the grid?
It is guaranteed that, under the conditions in Constraints, having N or more black squares is always possible by performing some number of operations.




Constraints
1 \leq H \leq 100
1 \leq W \leq 100
1 \leq N \leq H \times W
All values in input are integers.







InputInput is given from Standard Input in the following format:
H
W
N





OutputPrint the minimum number of operations needed.






Sample Input 13
7
10





Sample Output 12

You can have 14 black squares in the grid by performing the ""row"" operation twice, on different rows.





Sample Input 214
12
112





Sample Output 28






Sample Input 32
100
200





Sample Output 32


",Painting,"Arithmetic, Greedy Algorithm, Boolean Operations On Geometric Objects",0.803,106,73
411,"
Score: 100 points


Problem Statement
We held two competitions: Coding Contest and Robot Maneuver.
In each competition, the contestants taking the 3-rd, 2-nd, and 1-st places receive 100000, 200000, and 300000 yen (the currency of Japan), respectively. Furthermore, a contestant taking the first place in both competitions receives an additional 400000 yen.
DISCO-Kun took the X-th place in Coding Contest and the Y-th place in Robot Maneuver.
Find the total amount of money he earned.




Constraints

1 \leq X \leq 205
1 \leq Y \leq 205
X and Y are integers.







Input
Input is given from Standard Input in the following format:
X Y





Output
Print the amount of money DISCO-Kun earned, as an integer.






Sample Input 11 1





Sample Output 11000000

In this case, he earned 300000 yen in Coding Contest and another 300000 yen in Robot Maneuver. Furthermore, as he won both competitions, he got an additional 400000 yen.
In total, he made 300000 + 300000 + 400000 = 1000000 yen.





Sample Input 23 101





Sample Output 2100000

In this case, he earned 100000 yen in Coding Contest.





Sample Input 34 4





Sample Output 30

In this case, unfortunately, he was the highest-ranked contestant without prize money in both competitions.

",DDCC Finals,"Implementation, Arithmetic",0.857,69,60
412,"
Score : 300 points


Problem StatementThe season for Snuke Festival has come again this year. First of all, Ringo will perform a ritual to summon Snuke. For the ritual, he needs an altar, which consists of three parts, one in each of the three categories: upper, middle and lower.
He has N parts for each of the three categories. The size of the i-th upper part is A_i, the size of the i-th middle part is B_i, and the size of the i-th lower part is C_i.
To build an altar, the size of the middle part must be strictly greater than that of the upper part, and the size of the lower part must be strictly greater than that of the middle part. On the other hand, any three parts that satisfy these conditions can be combined to form an altar.
How many different altars can Ringo build? Here, two altars are considered different when at least one of the three parts used is different.




Constraints
1 \leq N \leq 10^5
1 \leq A_i \leq 10^9(1\leq i\leq N)
1 \leq B_i \leq 10^9(1\leq i\leq N)
1 \leq C_i \leq 10^9(1\leq i\leq N)
All input values are integers.







InputInput is given from Standard Input in the following format:
N
A_1 ... A_N
B_1 ... B_N
C_1 ... C_N





OutputPrint the number of different altars that Ringo can build.






Sample Input 12
1 5
2 4
3 6





Sample Output 13

The following three altars can be built:

Upper: 1-st part, Middle: 1-st part, Lower: 1-st part
Upper: 1-st part, Middle: 1-st part, Lower: 2-nd part
Upper: 1-st part, Middle: 2-nd part, Lower: 2-nd part






Sample Input 23
1 1 1
2 2 2
3 3 3





Sample Output 227






Sample Input 36
3 14 159 2 6 53
58 9 79 323 84 6
2643 383 2 79 50 288





Sample Output 387


",Snuke Festival,"Sorting, Binary Search, Bruteforcing, Mathematics",0.5,54,21
413,"
Score : 300 points


Problem StatementHearing that energy drinks increase rating in those sites, Takahashi decides to buy up M cans of energy drinks.
There are N stores that sell energy drinks. In the i-th store, he can buy at most B_i cans of energy drinks for A_i yen (the currency of Japan) each.
What is the minimum amount of money with which he can buy M cans of energy drinks?
It is guaranteed that, in the given inputs, a sufficient amount of money can always buy M cans of energy drinks.




Constraints
All values in input are integers.
1 \leq N, M \leq 10^5
1 \leq A_i \leq 10^9
1 \leq B_i \leq 10^5
B_1 + ... + B_N \geq M







InputInput is given from Standard Input in the following format:
N M
A_1 B_1
A_2 B_2
\vdots
A_N B_N





OutputPrint the minimum amount of money with which Takahashi can buy M cans of energy drinks.






Sample Input 12 5
4 9
2 4





Sample Output 112

With 12 yen, we can buy one drink at the first store and four drinks at the second store, for the total of five drinks. However, we cannot buy 5 drinks with 11 yen or less.





Sample Input 24 30
6 18
2 5
3 10
7 9





Sample Output 2130






Sample Input 31 100000
1000000000 100000





Sample Output 3100000000000000

The output may not fit into a 32-bit integer type.

",Energy Drink Collector,"Sorting, Greedy Algorithm, Bruteforcing, Arithmetic",0.408,387,112
414,"
Score : 400 points


Problem StatementGiven is a string S consisting of digits from 1 through 9.
Find the number of pairs of integers (i,j) (1 ≤ i ≤ j ≤ |S|) that satisfy the following condition:
Condition: In base ten, the i-th through j-th characters of S form an integer that is a multiple of 2019.




Constraints
1 ≤ |S| ≤ 200000
S is a string consisting of digits from 1 through 9.







InputInput is given from Standard Input in the following format:
S





OutputPrint the number of pairs of integers (i,j) (1 ≤ i ≤ j ≤ |S|) that satisfy the condition.






Sample Input 11817181712114





Sample Output 13

Three pairs - (1,5), (5,9), and (9,13) - satisfy the condition.





Sample Input 214282668646





Sample Output 22






Sample Input 32119





Sample Output 30

No pairs satisfy the condition.

",Multiple of 2019,"Arithmetic, Prefix sum, Hashing, Combinatorics, Exponentiation By Squaring, Greedy Algorithm",0.141,760,78
415,"
Score : 100 points


Problem Statement
A Hitachi string is a concatenation of one or more copies of the string hi.
For example, hi and hihi are Hitachi strings, while ha and hii are not.
Given a string S, determine whether S is a Hitachi string.




Constraints

The length of S is between 1 and 10 (inclusive).
S is a string consisting of lowercase English letters.







Input
Input is given from Standard Input in the following format:
S





Output
If S is a Hitachi string, print Yes; otherwise, print No.






Sample Input 1hihi





Sample Output 1Yes

hihi is the concatenation of two copies of hi, so it is a Hitachi string.





Sample Input 2hi





Sample Output 2Yes






Sample Input 3ha





Sample Output 3No


",Hitachi String,"Bruteforcing, String",0.49,251,94
416,"
Score: 300 points


Problem Statement
AtCoder Mart sells 1000000 of each of the six items below:

Riceballs, priced at 100 yen (the currency of Japan) each
Sandwiches, priced at 101 yen each
Cookies, priced at 102 yen each
Cakes, priced at 103 yen each
Candies, priced at 104 yen each
Computers, priced at 105 yen each

Takahashi wants to buy some of them that cost exactly X yen in total.
Determine whether this is possible.
(Ignore consumption tax.)




Constraints

1 \leq X \leq 100000
X is an integer.







Input
Input is given from Standard Input in the following format:
X





Output
If it is possible to buy some set of items that cost exactly X yen in total, print 1; otherwise, print 0.






Sample Input 1615





Sample Output 11

For example, we can buy one of each kind of item, which will cost 100+101+102+103+104+105=615 yen in total.





Sample Input 2217





Sample Output 20

No set of items costs 217 yen in total.

",100 to 105,"Bruteforcing, Arithmetic, Greedy Algorithm, Backtracking",0.544,181,75
417,"
Score : 600 points


Problem StatementThere is a game that involves three variables, denoted A, B, and C.
As the game progresses, there will be N events where you are asked to make a choice.
Each of these choices is represented by a string s_i. If s_i is AB, you must add 1 to A or B then subtract 1 from the other; if s_i is AC, you must add 1 to A or C then subtract 1 from the other; if s_i is BC, you must add 1 to B or C then subtract 1 from the other.
After each choice, none of A, B, and C should be negative.
Determine whether it is possible to make N choices under this condition. If it is possible, also give one such way to make the choices.




Constraints
1 \leq N \leq 10^5
0 \leq A,B,C \leq 10^9
N, A, B, C are integers.
s_i is AB, AC, or BC.







InputInput is given from Standard Input in the following format:
N A B C
s_1
s_2
:
s_N





OutputIf it is possible to make N choices under the condition, print Yes; otherwise, print No.
Also, in the former case, show one such way to make the choices in the subsequent N lines. The (i+1)-th line should contain the name of the variable (A, B, or C) to which you add 1 in the i-th choice.






Sample Input 12 1 3 0
AB
AC





Sample Output 1Yes
A
C

You can successfully make two choices, as follows:

In the first choice, add 1 to A and subtract 1 from B. A becomes 2, and B becomes 2.
In the second choice, add 1 to C and subtract 1 from A. C becomes 1, and A becomes 1.






Sample Input 23 1 0 0
AB
BC
AB





Sample Output 2No






Sample Input 31 0 9 0
AC





Sample Output 3No






Sample Input 48 6 9 1
AC
BC
AB
BC
AC
BC
AB
AB





Sample Output 4Yes
C
B
B
C
C
B
A
A


",Three Variables Game,"Greedy Algorithm, Heuristics, Simulation, Boolean Operations On Geometric Objects, Bruteforcing",0.143,151,29
418,"
Score : 100 points


Problem StatementWe call a 4-digit integer with three or more consecutive same digits, such as 1118, good.
You are given a 4-digit integer N. Answer the question: Is N good?




Constraints
1000 ≤ N ≤ 9999
N is an integer.







InputInput is given from Standard Input in the following format:
N





OutputIf N is good, print Yes; otherwise, print No.






Sample Input 11118





Sample Output 1Yes

N is good, since it contains three consecutive 1.





Sample Input 27777





Sample Output 2Yes

An integer is also good when all the digits are the same.





Sample Input 31234





Sample Output 3No


",Good Integer,"String, Array, Implementation",0.576,271,136
419,"
Score : 200 points


Problem StatementIn some village, there are 999 towers that are 1,(1+2),(1+2+3),...,(1+2+3+...+999) meters high from west to east, at intervals of 1 meter.
It had been snowing for a while before it finally stopped. For some two adjacent towers located 1 meter apart, we measured the lengths of the parts of those towers that are not covered with snow, and the results are a meters for the west tower, and b meters for the east tower.
Assuming that the depth of snow cover and the altitude are the same everywhere in the village, find the amount of the snow cover.
Assume also that the depth of the snow cover is always at least 1 meter.




Constraints
1 \leq a < b < 499500(=1+2+3+...+999)
All values in input are integers.
There is no input that contradicts the assumption.







InputInput is given from Standard Input in the following format:
a b





OutputIf the depth of the snow cover is x meters, print x as an integer.






Sample Input 18 13





Sample Output 12

The heights of the two towers are 10 meters and 15 meters, respectively.
Thus, we can see that the depth of the snow cover is 2 meters.





Sample Input 254 65





Sample Output 21


",Stone Monument,"Arithmetic, Mathematics",0.81,206,142
420,"
Score : 100 points


Problem StatementYou are given two integers A and B.
Find the largest value among A+B, A-B and A \times B.




Constraints
-1000 \leq A,B \leq 1000
All values in input are integers.







InputInput is given from Standard Input in the following format:
A B





OutputPrint the largest value among A+B, A-B and A \times B.






Sample Input 13 1





Sample Output 14

3+1=4, 3-1=2 and 3 \times 1=3. The largest among them is 4.





Sample Input 24 -2





Sample Output 26

The largest is 4 - (-2) = 6.





Sample Input 30 0





Sample Output 30


",Add Sub Mul,"Arithmetic, Implementation, Array",0.773,220,151
421,"
Score: 100 points


Problem Statement
E869120's and square1001's 16-th birthday is coming soon.
Takahashi from AtCoder Kingdom gave them a round cake cut into 16 equal fan-shaped pieces.
E869120 and square1001 were just about to eat A and B of those pieces, respectively,
when they found a note attached to the cake saying that ""the same person should not take two adjacent pieces of cake"".
Can both of them obey the instruction in the note and take desired numbers of pieces of cake?




Constraints

A and B are integers between 1 and 16 (inclusive).
A+B is at most 16.







Input
Input is given from Standard Input in the following format:
A B





Output
If both E869120 and square1001 can obey the instruction in the note and take desired numbers of pieces of cake, print Yay!; otherwise, print :(.






Sample Input 15 4





Sample Output 1Yay!

Both of them can take desired number of pieces as follows:






Sample Input 28 8





Sample Output 2Yay!

Both of them can take desired number of pieces as follows:






Sample Input 311 4





Sample Output 3:(

In this case, there is no way for them to take desired number of pieces, unfortunately.

",Happy Birthday!,"Mathematics, Greedy Algorithm",0.764,358,234
422,"
Score : 100 points


Problem StatementJoisino wants to evaluate the formula ""A op B"".
Here, A and B are integers, and the binary operator op is either + or -.
Your task is to evaluate the formula instead of her.




Constraints
1≦A,B≦10^9
op is either + or -.







InputThe input is given from Standard Input in the following format:
A op B





OutputEvaluate the formula and print the result.






Sample Input 11 + 2





Sample Output 13

Since 1 + 2 = 3, the output should be 3.





Sample Input 25 - 7





Sample Output 2-2


",Addition and Subtraction Easy,"Parsing, Implementation, Arithmetic",0.782,235,167
423,"
Score : 100 points


Problem StatementYou are given two integers A and B as the input. Output the value of A + B.
However, if A + B is 10 or greater, output error instead.




Constraints
A and B are integers.
1 ≤ A, B ≤ 9







InputInput is given from Standard Input in the following format:
A B





OutputIf A + B is 10 or greater, print the string error (case-sensitive); otherwise, print the value of A + B.






Sample Input 16 3





Sample Output 19






Sample Input 26 4





Sample Output 2error


",Restricted,"Implementation, Arithmetic",0.883,141,120
424,"
Score : 100 points


Problem StatementSnuke is going to open a contest named ""AtCoder s Contest"".
Here, s is a string of length 1 or greater, where the first character is an uppercase English letter, and the second and subsequent characters are lowercase English letters.
Snuke has decided to abbreviate the name of the contest as ""AxC"".
Here, x is the uppercase English letter at the beginning of s.
Given the name of the contest, print the abbreviation of the name.




Constraints
The length of s is between 1 and 100, inclusive.
The first character in s is an uppercase English letter.
The second and subsequent characters in s are lowercase English letters.







InputThe input is given from Standard Input in the following format:
AtCoder s Contest





OutputPrint the abbreviation of the name of the contest.






Sample Input 1AtCoder Beginner Contest





Sample Output 1ABC

The contest in which you are participating now.





Sample Input 2AtCoder Snuke Contest





Sample Output 2ASC

This contest does not actually exist.





Sample Input 3AtCoder X Contest





Sample Output 3AXC


",AtCoder *** Contest,String,0.704,267,158
425,"
Score : 100 points


Problem StatementBased on some criterion, Snuke divided the integers from 1 through 12 into three groups as shown in the figure below.
Given two integers x and y (1 ≤ x < y ≤ 12), determine whether they belong to the same group.







Constraints
x and y are integers.
1 ≤ x < y ≤ 12







InputInput is given from Standard Input in the following format:
x y





OutputIf x and y belong to the same group, print Yes; otherwise, print No.






Sample Input 11 3





Sample Output 1Yes






Sample Input 22 4





Sample Output 2No


",Grouping,"Array, Set / Map, Implementation",0.644,195,120
426,"
Score : 100 points


Problem StatementYou are given a grid with 2 rows and 3 columns of squares.
The color of the square at the i-th row and j-th column is represented by the character C_{ij}.
Write a program that prints YES if this grid remains the same when rotated 180 degrees, and prints NO otherwise.




Constraints
C_{i,j}(1 \leq i \leq 2, 1 \leq j \leq 3) is a lowercase English letter.







InputInput is given from Standard Input in the following format:
C_{11}C_{12}C_{13}
C_{21}C_{22}C_{23}





OutputPrint YES if this grid remains the same when rotated 180 degrees; print NO otherwise.






Sample Input 1pot
top





Sample Output 1YES

This grid remains the same when rotated 180 degrees.





Sample Input 2tab
bet





Sample Output 2NO

This grid does not remain the same when rotated 180 degrees.





Sample Input 3eye
eel





Sample Output 3NO


",Rotation,"String, Array, Boolean Operations On Geometric Objects",0.654,217,122
427,"
Score : 200 points


Problem StatementTakahashi is standing on a two-dimensional plane, facing north. Find the minimum positive integer K such that Takahashi will be at the starting position again after he does the following action K times:

Go one meter in the direction he is facing. Then, turn X degrees counter-clockwise.





Constraints
1 \leq X \leq 179
X is an integer.







InputInput is given from Standard Input in the following format:
X





OutputPrint the number of times Takahashi will do the action before he is at the starting position again.






Sample Input 190





Sample Output 14

Takahashi's path is a square.





Sample Input 21





Sample Output 2360


",Takahashikun  The Strider,"Arithmetic, Euclidean Algorithm, Mathematics, Bruteforcing",0.44,257,86
428,"
Score : 300 points


Problem StatementWe will play a one-player game using a number line and N pieces.
First, we place each of these pieces at some integer coordinate.
Here, multiple pieces can be placed at the same coordinate.
Our objective is to visit all of the M coordinates X_1, X_2, ..., X_M with these pieces, by repeating the following move:
Move: Choose a piece and let x be its coordinate. Put that piece at coordinate x+1 or x-1.
Note that the coordinates where we initially place the pieces are already regarded as visited.
Find the minimum number of moves required to achieve the objective.




Constraints
All values in input are integers.
1 \leq N \leq 10^5
1 \leq M \leq 10^5
-10^5 \leq X_i \leq 10^5
X_1, X_2, ..., X_M are all different.







InputInput is given from Standard Input in the following format:
N M
X_1 X_2 ... X_M





OutputFind the minimum number of moves required to achieve the objective.






Sample Input 12 5
10 12 1 2 14





Sample Output 15

The objective can be achieved in five moves as follows, and this is the minimum number of moves required.

Initially, put the two pieces at coordinates 1 and 10.
Move the piece at coordinate 1 to 2.
Move the piece at coordinate 10 to 11.
Move the piece at coordinate 11 to 12.
Move the piece at coordinate 12 to 13.
Move the piece at coordinate 13 to 14.






Sample Input 23 7
-10 -3 0 9 -100 2 17





Sample Output 219






Sample Input 3100 1
-100000





Sample Output 30


",Streamline,"Sorting, Array, Greedy Algorithm, Arithmetic, Boolean Operations On Geometric Objects",0.713,169,101
429,"
Score : 300 points


Problem StatementIn a flower bed, there are N flowers, numbered 1,2,......,N. Initially, the heights of all flowers are 0.
You are given a sequence h=\{h_1,h_2,h_3,......\} as input. You would like to change the height of Flower k to h_k for all k (1 \leq  k \leq N), by repeating the following ""watering"" operation:

Specify integers l and r. Increase the height of Flower x by 1 for all x such that l \leq x \leq r.

Find the minimum number of watering operations required to satisfy the condition.




Constraints
1 \leq N  \leq 100
0 \leq h_i \leq 100
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
h_1 h_2 h_3 ...... h_N





OutputPrint the minimum number of watering operations required to satisfy the condition.






Sample Input 14
1 2 2 1





Sample Output 12

The minimum number of watering operations required is 2.
One way to achieve it is:

Perform the operation with (l,r)=(1,3).
Perform the operation with (l,r)=(2,4).






Sample Input 25
3 1 2 3 1





Sample Output 25






Sample Input 38
4 23 75 0 23 96 50 100





Sample Output 3221


",Grand Garden,"Greedy Algorithm, Array, Difference Array",0.846,160,131
430,"
Score : 300 points


Problem StatementA sequence a_1,a_2,... ,a_n is said to be /\/\/\/ when the following conditions are satisfied:

For each i = 1,2,..., n-2, a_i = a_{i+2}.
Exactly two different numbers appear in the sequence.

You are given a sequence v_1,v_2,...,v_n whose length is even.
We would like to make this sequence /\/\/\/ by replacing some of its elements.
Find the minimum number of elements that needs to be replaced.




Constraints
2 \leq n \leq 10^5
n is even.
1 \leq v_i \leq 10^5
v_i is an integer.







InputInput is given from Standard Input in the following format:
n
v_1 v_2 ... v_n





OutputPrint the minimum number of elements that needs to be replaced.






Sample Input 14
3 1 3 2





Sample Output 11

The sequence 3,1,3,2 is not /\/\/\/, but we can make it /\/\/\/ by replacing one of its elements: for example, replace the fourth element to make it 3,1,3,1.





Sample Input 26
105 119 105 119 105 119





Sample Output 20

The sequence 105,119,105,119,105,119 is /\/\/\/.





Sample Input 34
1 1 1 1





Sample Output 32

The elements of the sequence 1,1,1,1 are all the same, so it is not /\/\/\/.

",/\/\/\/,"Counting, Sorting, Greedy Algorithm, Boolean Operations On Geometric Objects",0.115,297,63
431,"
Score : 300 points


Problem StatementYou are given integers N and K. Find the number of triples (a,b,c) of positive integers not greater than N such that a+b,b+c and c+a are all multiples of K.
The order of a,b,c does matter, and some of them can be the same.




Constraints
1 \leq N,K \leq 2\times 10^5
N and K are integers.







InputInput is given from Standard Input in the following format:
N K





OutputPrint the number of triples (a,b,c) of positive integers not greater than N such that a+b,b+c and c+a are all multiples of K.






Sample Input 13 2





Sample Output 19

(1,1,1),(1,1,3),(1,3,1),(1,3,3),(2,2,2),(3,1,1),(3,1,3),(3,3,1) and (3,3,3) satisfy the condition.





Sample Input 25 3





Sample Output 21






Sample Input 331415 9265





Sample Output 327






Sample Input 435897 932





Sample Output 4114191


",Triangular Relationship,"Arithmetic, Mathematics, Combinatorics",0.24,149,40
432,"
Score : 200 points


Problem StatementIn a factory, there are N robots placed on a number line.
Robot i is placed at coordinate X_i and can extend its arms of length L_i in both directions, positive and negative.
We want to remove zero or more robots so that the movable ranges of arms of no two remaining robots intersect.
Here, for each i (1 \leq i \leq N), the movable range of arms of Robot i is the part of the number line between the coordinates X_i - L_i and X_i + L_i, excluding the endpoints.
Find the maximum number of robots that we can keep.




Constraints
1 \leq N \leq 100,000
0 \leq X_i \leq 10^9 (1 \leq i \leq N)
1 \leq L_i \leq 10^9 (1 \leq i \leq N)
If i \neq j, X_i \neq X_j.
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
X_1 L_1
X_2 L_2
\vdots
X_N L_N





OutputPrint the maximum number of robots that we can keep.






Sample Input 14
2 4
4 3
9 3
100 5





Sample Output 13

By removing Robot 2, we can keep the other three robots.





Sample Input 22
8 20
1 10





Sample Output 21






Sample Input 35
10 1
2 1
4 1
6 1
8 1





Sample Output 35


",Robot Arms,"Greedy Algorithm, Sorting, Array",0.382,137,43
433,"
Score : 300 points


Problem StatementThere are N integers, A_1, A_2, ..., A_N, written on the blackboard.
You will choose one of them and replace it with an integer of your choice between 1 and 10^9 (inclusive), possibly the same as the integer originally written.
Find the maximum possible greatest common divisor of the N integers on the blackboard after your move.




Constraints
All values in input are integers.
2 \leq N \leq 10^5
1 \leq A_i \leq 10^9





OutputInput is given from Standard Input in the following format:
N
A_1 A_2 ... A_N





OutputPrint the maximum possible greatest common divisor of the N integers on the blackboard after your move.





Sample Input 13
7 6 8





Sample Output 12

If we replace 7 with 4, the greatest common divisor of the three integers on the blackboard will be 2, which is the maximum possible value.





Sample Input 23
12 15 18





Sample Output 26






Sample Input 32
1000000000 1000000000





Sample Output 31000000000

We can replace an integer with itself.

",GCD on Blackboard,"Euclidean Algorithm, Prefix sum, String, Bruteforcing, Mathematics",0.313,351,94
434,"
Score : 200 points


Problem StatementThere are N gems. The value of the i-th gem is V_i.
You will choose some of these gems, possibly all or none, and get them.
However, you need to pay a cost of C_i to get the i-th gem.
Let X be the sum of the values of the gems obtained, and Y be the sum of the costs paid.
Find the maximum possible value of X-Y.




Constraints
All values in input are integers.
1 \leq N \leq 20
1 \leq C_i, V_i \leq 50







InputInput is given from Standard Input in the following format:
N
V_1 V_2 ... V_N
C_1 C_2 ... C_N





OutputPrint the maximum possible value of X-Y.






Sample Input 13
10 2 5
6 3 4





Sample Output 15

If we choose the first and third gems, X = 10 + 5 = 15 and Y = 6 + 4 = 10.
We have X-Y = 5 here, which is the maximum possible value.





Sample Input 24
13 21 6 19
11 30 6 15





Sample Output 26






Sample Input 31
1
50





Sample Output 30


",Resale,"Greedy Algorithm, Bruteforcing, Implementation, Arithmetic",0.86,307,244
435,"
Score: 300 points


Problem Statement
In 2028 and after a continuous growth, AtCoder Inc. finally built an empire with six cities (City 1, 2, 3, 4, 5, 6)!
There are five means of transport in this empire:

Train: travels from City 1 to 2 in one minute. A train can occupy at most A people.
Bus: travels from City 2 to 3 in one minute. A bus can occupy at most B people.
Taxi: travels from City 3 to 4 in one minute. A taxi can occupy at most C people.
Airplane: travels from City 4 to 5 in one minute. An airplane can occupy at most D people.
Ship: travels from City 5 to 6 in one minute. A ship can occupy at most E people.

For each of them, one vehicle leaves the city at each integer time (time 0, 1, 2, ...).
There is a group of N people at City 1, and they all want to go to City 6.
At least how long does it take for all of them to reach there? 
You can ignore the time needed to transfer.  




Constraints

1 \leq N, A, B, C, D, E \leq 10^{15}
All values in input are integers.







Input
Input is given from Standard Input in the following format:
N
A
B
C
D
E





Output
Print the minimum time required for all of the people to reach City 6, in minutes.






Sample Input 15
3
2
4
3
5





Sample Output 17

One possible way to travel is as follows.
First, there are N = 5 people at City 1, as shown in the following image:

In the first minute, three people travels from City 1 to City 2 by train. Note that a train can only occupy at most three people.

In the second minute, the remaining two people travels from City 1 to City 2 by train, and two of the three people who were already at City 2 travels to City 3 by bus. Note that a bus can only occupy at most two people.

In the third minute, two people travels from City 2 to City 3 by train, and another two people travels from City 3 to City 4 by taxi.

From then on, if they continue traveling without stopping until they reach City 6, all of them can reach there in seven minutes.
There is no way for them to reach City 6 in 6 minutes or less.





Sample Input 210
123
123
123
123
123





Sample Output 25

All kinds of vehicles can occupy N = 10 people at a time.
Thus, if they continue traveling without stopping until they reach City 6, all of them can reach there in five minutes.  





Sample Input 310000000007
2
3
5
7
11





Sample Output 35000000008

Note that the input or output may not fit into a 32-bit integer type.

",Five Transportations,"Greedy Algorithm, Mathematics, Arithmetic, Sorting",0.331,339,119
436,"
Score : 300 points


Problem StatementYou are given a string S of length N consisting of A, C, G and T. Answer the following Q queries:

Query i (1 \leq i \leq Q): You will be given integers l_i and r_i (1 \leq l_i < r_i \leq N). Consider the substring of S starting at index l_i and ending at index r_i (both inclusive). In this string, how many times does AC occurs as a substring?





NotesA substring of a string T is a string obtained by removing zero or more characters from the beginning and the end of T.
For example, the substrings of ATCODER include TCO, AT, CODER, ATCODER and  (the empty string), but not AC.




Constraints
2 \leq N \leq 10^5
1 \leq Q \leq 10^5
S is a string of length N.
Each character in S is A, C, G or T.
1 \leq l_i < r_i \leq N







InputInput is given from Standard Input in the following format:
N Q
S
l_1 r_1
:
l_Q r_Q





OutputPrint Q lines. The i-th line should contain the answer to the i-th query.






Sample Input 18 3
ACACTACG
3 7
2 3
1 8





Sample Output 12
0
3


Query 1: the substring of S starting at index 3 and ending at index 7 is ACTAC. In this string, AC occurs twice as a substring.
Query 2: the substring of S starting at index 2 and ending at index 3 is CA. In this string, AC occurs zero times as a substring.
Query 3: the substring of S starting at index 1 and ending at index 8 is ACACTACG. In this string, AC occurs three times as a substring.


",GeT AC,"Prefix sum, String",0.333,479,139
437,"
Score : 300 points


Problem Statement2N players are running a competitive table tennis training on N tables numbered from 1 to N.
The training consists of rounds.
In each round, the players form N pairs, one pair per table.
In each pair, competitors play a match against each other.
As a result, one of them wins and the other one loses.
The winner of the match on table X plays on table X-1 in the next round,
except for the winner of the match on table 1 who stays at table 1.
Similarly, the loser of the match on table X plays on table X+1 in the next round,
except for the loser of the match on table N who stays at table N.
Two friends are playing their first round matches on distinct tables A and B.
Let's assume that the friends are strong enough to win or lose any match at will.
What is the smallest number of rounds after which the friends can get to play a match against each other?




Constraints
2 \leq N \leq 10^{18}
1 \leq A < B \leq N
All input values are integers.







InputInput is given from Standard Input in the following format:
N A B





OutputPrint the smallest number of rounds after which the friends can get to play a match against each other.






Sample Input 15 2 4





Sample Output 11

If the first friend loses their match and the second friend wins their match, they will both move to table 3 and play each other in the next round.





Sample Input 25 2 3





Sample Output 22

If both friends win two matches in a row, they will both move to table 1.

",Table Tennis Training,"Mathematics, Parity, Implementation, Greedy Algorithm",0.089,328,63
438,"
Score : 400 points


Problem StatementGiven are a sequence A= {a_1,a_2,......a_N} of N positive even numbers, and an integer M.
Let a semi-common multiple of A be a positive integer X that satisfies the following condition for every k (1 \leq k \leq N):

There exists a non-negative integer p such that X= a_k \times (p+0.5).

Find the number of semi-common multiples of A among the integers between 1 and M (inclusive).




Constraints
1 \leq N \leq 10^5
1 \leq M \leq 10^9
2 \leq a_i \leq 10^9
a_i is an even number.
All values in input are integers.







InputInput is given from Standard Input in the following format:
N M
a_1 a_2 ... a_N





OutputPrint the number of semi-common multiples of A among the integers between 1 and M (inclusive).






Sample Input 12 50
6 10





Sample Output 12


15 = 6  \times 2.5 
15 = 10 \times 1.5 
45 = 6  \times 7.5 
45 = 10 \times 4.5 

Thus, 15 and 45 are semi-common multiples of A. There are no other semi-common multiples of A between 1 and 50, so the answer is 2.





Sample Input 23 100
14 22 40





Sample Output 20

The answer can be 0.





Sample Input 35 1000000000
6 6 2 6 2





Sample Output 3166666667


",Semi Common Multiple,"Euclidean Algorithm, Mathematics, Number Theory, Arithmetic, Bruteforcing, Implementation",0.17,167,26
439,"
Score : 500 points


Problem StatementTakahashi has decided to work on K days of his choice from the N days starting with tomorrow.
You are given an integer C and a string S. Takahashi will choose his workdays as follows:

After working for a day, he will refrain from working on the subsequent C days.
If the i-th character of S is x, he will not work on Day i, where Day 1 is tomorrow, Day 2 is the day after tomorrow, and so on.

Find all days on which Takahashi is bound to work.




Constraints
1 \leq N \leq 2 \times 10^5
1 \leq K \leq N
0 \leq C \leq N
The length of S is N.
Each character of S is o or x.
Takahashi can choose his workdays so that the conditions in Problem Statement are satisfied.







InputInput is given from Standard Input in the following format:
N K C
S





OutputPrint all days on which Takahashi is bound to work in ascending order, one per line.






Sample Input 111 3 2
ooxxxoxxxoo





Sample Output 16

Takahashi is going to work on 3 days out of the 11 days. After working for a day, he will refrain from working on the subsequent 2 days.
There are four possible choices for his workdays: Day 1,6,10, Day 1,6,11, Day 2,6,10, and Day 2,6,11.
Thus, he is bound to work on Day 6.





Sample Input 25 2 3
ooxoo





Sample Output 21
5

There is only one possible choice for his workdays: Day 1,5.





Sample Input 35 1 0
ooooo





Sample Output 3
There may be no days on which he is bound to work.





Sample Input 416 4 3
ooxxoxoxxxoxoxxo





Sample Output 411
16


",Yutori,"Greedy Algorithm, Two-pointer, Array, Dynamic Programming, Set / Map",0.4,84,28
440,"
Score : 600 points


Problem StatementGiven is a positive integer N.
We will choose an integer K between 2 and N (inclusive), then we will repeat the operation below until N becomes less than K.

Operation: if K divides N, replace N with N/K; otherwise, replace N with N-K.

In how many choices of K will N become 1 in the end?




Constraints
2 \leq N \leq 10^{12}
N is an integer.







InputInput is given from Standard Input in the following format:
N





OutputPrint the number of choices of K in which N becomes 1 in the end.






Sample Input 16





Sample Output 13

There are three choices of K in which N becomes 1 in the end: 2, 5, and 6.
In each of these choices, N will change as follows:

When K=2: 6 \to 3 \to 1
When K=5: 6 \to 1
When K=6: 6 \to 1






Sample Input 23141





Sample Output 213






Sample Input 3314159265358





Sample Output 39


",Division or Subtraction,"Number Theory, Set / Map, Hashing, Bruteforcing, Mathematics, Boolean Operations On Geometric Objects, Data Structures, Arithmetic",0.282,101,34
441,"
Score : 400 points


Problem StatementWe have a tree with N vertices numbered 1 to N.
The i-th edge in the tree connects Vertex u_i and Vertex v_i, and its length is w_i.
Your objective is to paint each vertex in the tree white or black (it is fine to paint all vertices the same color) so that the following condition is satisfied:

For any two vertices painted in the same color, the distance between them is an even number.

Find a coloring of the vertices that satisfies the condition and print it. It can be proved that at least one such coloring exists under the constraints of this problem.




Constraints
All values in input are integers.
1 \leq N \leq 10^5
1 \leq u_i < v_i \leq N
1 \leq w_i \leq 10^9







InputInput is given from Standard Input in the following format:
N
u_1 v_1 w_1
u_2 v_2 w_2
.
.
.
u_{N - 1} v_{N - 1} w_{N - 1}





OutputPrint a coloring of the vertices that satisfies the condition, in N lines.
The i-th line should contain 0 if Vertex i is painted white and 1 if it is painted black.
If there are multiple colorings that satisfy the condition, any of them will be accepted.






Sample Input 13
1 2 2
2 3 1





Sample Output 10
0
1






Sample Input 25
2 5 2
2 3 10
1 3 8
3 4 2





Sample Output 21
0
1
0
1


",Even Relation,"Graph Theory, Graph Traversal, Arithmetic, Tree, Dynamic Programming",0.429,207,74
442,"
Score: 400 points


Problem Statement
Kizahashi, who was appointed as the administrator of ABC at National Problem Workshop in the Kingdom of AtCoder, got too excited and took on too many jobs.
Let the current time be time 0. Kizahashi has N jobs numbered 1 to N.
It takes A_i units of time for Kizahashi to complete Job i. The deadline for Job i is time B_i, and he must complete the job before or at this time.
Kizahashi cannot work on two or more jobs simultaneously, but when he completes a job, he can start working on another immediately.
Can Kizahashi complete all the jobs in time? If he can, print Yes; if he cannot, print No.




Constraints

All values in input are integers.
1 \leq N \leq 2 \times 10^5
1 \leq A_i, B_i \leq 10^9 (1 \leq i \leq N)







Input
Input is given from Standard Input in the following format:
N
A_1 B_1
.
.
.
A_N B_N





Output
If Kizahashi can complete all the jobs in time, print Yes; if he cannot, print No.






Sample Input 15
2 4
1 9
1 8
4 9
3 12





Sample Output 1Yes

He can complete all the jobs in time by, for example, doing them in the following order:

Do Job 2 from time 0 to 1.
Do Job 1 from time 1 to 3.
Do Job 4 from time 3 to 7.
Do Job 3 from time 7 to 8.
Do Job 5 from time 8 to 11.

Note that it is fine to complete Job 3 exactly at the deadline, time 8.





Sample Input 23
334 1000
334 1000
334 1000





Sample Output 2No

He cannot complete all the jobs in time, no matter what order he does them in.





Sample Input 330
384 8895
1725 9791
170 1024
4 11105
2 6
578 1815
702 3352
143 5141
1420 6980
24 1602
849 999
76 7586
85 5570
444 4991
719 11090
470 10708
1137 4547
455 9003
110 9901
15 8578
368 3692
104 1286
3 4
366 12143
7 6649
610 2374
152 7324
4 7042
292 11386
334 5720





Sample Output 3Yes


",Megalomania,"Sorting, Greedy Algorithm, Bruteforcing",0.664,190,116
443,"
Score : 100 points


Problem Statement
You are given three integers A, B and C.
Determine if there exists an equilateral triangle whose sides have lengths A, B and C.




Constraints
All values in input are integers.
1 \leq A,B,C \leq 100







InputInput is given from Standard Input in the following format:
A B C





OutputIf there exists an equilateral triangle whose sides have lengths A, B and C, print Yes; otherwise, print No.






Sample Input 12 2 2





Sample Output 1Yes


There exists an equilateral triangle whose sides have lengths 2, 2 and 2.






Sample Input 23 4 5





Sample Output 2No


There is no equilateral triangle whose sides have lengths 3, 4 and 5.


",Regular Triangle,Implementation,0.765,113,78
444,"
Score : 200 points


Problem Statement
There are N people numbered 1 to N. Each person wears a red hat or a blue hat.
You are given a string s representing the colors of the people. Person i wears a red hat if s_i is R, and a blue hat if s_i is B.
Determine if there are more people wearing a red hat than people wearing a blue hat.




Constraints
1 \leq N \leq 100
|s| = N
s_i is R or B.







InputInput is given from Standard Input in the following format:
N
s





OutputIf there are more people wearing a red hat than there are people wearing a blue hat, print Yes; otherwise, print No.






Sample Input 14
RRBR





Sample Output 1Yes


There are three people wearing a red hat, and one person wearing a blue hat.
Since there are more people wearing a red hat than people wearing a blue hat, the answer is Yes.






Sample Input 24
BRBR





Sample Output 2No


There are two people wearing a red hat, and two people wearing a blue hat.
Since there are as many people wearing a red hat as people wearing a blue hat, the answer is No.


",Red or Blue,"String, Bruteforcing, Implementation",0.84,92,74
445,"
Score : 300 points


Problem StatementThere are N stones arranged in a row. Every stone is painted white or black.
A string S represents the color of the stones. The i-th stone from the left is white if the i-th character of S is ., and the stone is black if the character is #.
Takahashi wants to change the colors of some stones to black or white so that there will be no white stone immediately to the right of a black stone.
Find the minimum number of stones that needs to be recolored.




Constraints
1 \leq N \leq 2\times 10^5
S is a string of length N consisting of . and #.







InputInput is given from Standard Input in the following format:
N
S





OutputPrint the minimum number of stones that needs to be recolored.






Sample Input 13
#.#





Sample Output 11

It is enough to change the color of the first stone to white.





Sample Input 25
#.##.





Sample Output 22






Sample Input 39
.........





Sample Output 30


",Stones,"Prefix sum, Greedy Algorithm, Bruteforcing, Counting",0.075,490,46
446,"
Score : 500 points


Problem Statement
There are N squares numbered 1 to N from left to right.
Each square has a character written on it, and Square i has a letter s_i. Besides, there is initially one golem on each square.
Snuke cast Q spells to move the golems.
The i-th spell consisted of two characters t_i and d_i, where d_i is L or R.
When Snuke cast this spell, for each square with the character t_i, all golems on that square moved to the square adjacent to the left if d_i is L, and moved to the square adjacent to the right if d_i is R.
However, when a golem tried to move left from Square 1 or move right from Square N, it disappeared.
Find the number of golems remaining after Snuke cast the Q spells.




Constraints
1 \leq N,Q \leq 2 \times 10^{5}
|s| = N
s_i and t_i are uppercase English letters.
d_i is L or R.







InputInput is given from Standard Input in the following format:
N Q
s
t_1 d_1
\vdots
t_{Q} d_Q





OutputPrint the answer.






Sample Input 13 4
ABC
A L
B L
B R
A R





Sample Output 12


Initially, there is one golem on each square.
In the first spell, the golem on Square 1 tries to move left and disappears.
In the second spell, the golem on Square 2 moves left.
In the third spell, no golem moves.
In the fourth spell, the golem on Square 1 moves right.
After the four spells are cast, there is one golem on Square 2 and one golem on Square 3, for a total of two golems remaining.






Sample Input 28 3
AABCBDBA
A L
B R
A R





Sample Output 25


After the three spells are cast, there is one golem on Square 2, two golems on Square 4 and two golems on Square 6, for a total of five golems remaining.
Note that a single spell may move multiple golems.






Sample Input 310 15
SNCZWRCEWB
B R
R R
E R
W R
Z L
S R
Q L
W L
B R
C L
A L
N L
E R
Z L
S L





Sample Output 33


",Snuke the Wizard,"Binary Search, Simulation, Two-pointer, Array, String",0.042,131,9
447,"
Score : 100 points


Problem StatementSnuke has N integers: 1,2,\ldots,N.
He will choose K of them and give those to Takahashi.
How many ways are there to choose K consecutive integers?




Constraints
All values in input are integers.
1 \leq K \leq N \leq 50







InputInput is given from Standard Input in the following format:
N K





OutputPrint the answer.






Sample Input 13 2





Sample Output 12

There are two ways to choose two consecutive integers: (1,2) and (2,3).





Sample Input 213 3





Sample Output 211


",Consecutive Integers,"Arithmetic, Counting, Implementation",0.821,140,100
448,"
Score : 200 points


Problem StatementSnuke has come to a store that sells boxes containing balls. The store sells the following three kinds of boxes:

Red boxes, each containing R red balls
Green boxes, each containing G green balls
Blue boxes, each containing B blue balls

Snuke wants to get a total of exactly N balls by buying r red boxes, g green boxes and b blue boxes.
How many triples of non-negative integers (r,g,b) achieve this?




Constraints
All values in input are integers.
1 \leq R,G,B,N \leq 3000







InputInput is given from Standard Input in the following format:
R G B N





OutputPrint the answer.






Sample Input 11 2 3 4





Sample Output 14

Four triples achieve the objective, as follows:

(4,0,0)
(2,1,0)
(1,0,1)
(0,2,0)






Sample Input 213 1 4 3000





Sample Output 287058


",RGB Boxes,"Bruteforcing, Arithmetic, Backtracking",0.538,195,77
449,"
Score : 400 points


Problem StatementSnuke has an empty sequence a.
He will perform N operations on this sequence.
In the i-th operation, he chooses an integer j satisfying 1 \leq j \leq i, and insert j at position j in a (the beginning is position 1).
You are given a sequence b of length N. Determine if it is possible that a is equal to b after N operations. If it is, show one possible sequence of operations that achieves it.




Constraints
All values in input are integers.
1 \leq N \leq 100
1 \leq b_i \leq N







InputInput is given from Standard Input in the following format:
N
b_1 \dots b_N





OutputIf there is no sequence of N operations after which a would be equal to b, print -1.
If there is, print N lines. In the i-th line, the integer chosen in the i-th operation should be printed. If there are multiple solutions, any of them is accepted.






Sample Input 13
1 2 1





Sample Output 11
1
2

In this sequence of operations, the sequence a changes as follows:

After the first operation: (1)
After the second operation: (1,1)
After the third operation: (1,2,1)






Sample Input 22
2 2





Sample Output 2-1

2 cannot be inserted at the beginning of the sequence, so this is impossible.





Sample Input 39
1 1 1 2 2 1 2 3 2





Sample Output 31
2
2
3
1
2
2
1
1


",Limited Insertion,"Greedy Algorithm, Simulation, Array, Bruteforcing, Implementation",0.477,82,31
450,"
Score : 200 points


Problem StatementKatsusando loves omelette rice.
Besides, he loves crème brûlée, tenderloin steak and so on, and believes that these foods are all loved by everyone.
To prove that hypothesis, he conducted a survey on M kinds of foods and asked N people whether they like these foods or not.
The i-th person answered that he/she only likes the A_{i1}-th, A_{i2}-th, ..., A_{iK_i}-th food.
Find the number of the foods liked by all the N people.




Constraints
All values in input are integers.
1 \leq N, M \leq 30
1 \leq K_i \leq M
1 \leq A_{ij} \leq M
For each i (1 \leq i \leq N), A_{i1}, A_{i2}, ..., A_{iK_i} are distinct.





ConstraintsInput is given from Standard Input in the following format:
N M
K_1 A_{11} A_{12} ... A_{1K_1}
K_2 A_{21} A_{22} ... A_{2K_2}
:
K_N A_{N1} A_{N2} ... A_{NK_N}





OutputPrint the number of the foods liked by all the N people.





Sample Input 13 4
2 1 3
3 1 2 3
2 3 2





Sample Output 11

As only the third food is liked by all the three people, 1 should be printed.





Sample Input 25 5
4 2 3 4 5
4 1 3 4 5
4 1 2 4 5
4 1 2 3 5
4 1 2 3 4





Sample Output 20

Katsusando's hypothesis turned out to be wrong.





Sample Input 31 30
3 5 10 30





Sample Output 33


",Foods Loved by Everyone,"Counting, Bruteforcing, Set / Map, Implementation",0.766,198,139
451,"
Score : 600 points


Problem StatementYou are given a string s consisting of A, B and C.
Snuke wants to perform the following operation on s as many times as possible:

Choose a contiguous substring of s that reads ABC and replace it with BCA.

Find the maximum possible number of operations.




Constraints
1 \leq |s| \leq 200000
Each character of s is A, B and C.







InputInput is given from Standard Input in the following format:
s





OutputFind the maximum possible number of operations.






Sample Input 1ABCABC





Sample Output 13

You can perform the operations three times as follows: ABCABC → BCAABC → BCABCA → BCBCAA. This is the maximum result.





Sample Input 2C





Sample Output 20






Sample Input 3ABCACCBABCBCAABCB





Sample Output 36


",ABC,"String, Prefix sum, Dyanmic Programming, Greedy Algorithm, Combinatorics",0.225,122,24
452,"
Score : 200 points


Problem StatementYou are given two integers K and S.
Three variable X, Y and Z takes integer values satisfying 0≤X,Y,Z≤K.
How many different assignments of values to X, Y and Z are there such that X + Y + Z = S?  




Constraints
2≤K≤2500 
0≤S≤3K 
K and S are integers.  







InputThe input is given from Standard Input in the following format:
K S





OutputPrint the number of the triples of X, Y and Z that satisfy the condition.






Sample Input 12 2





Sample Output 16

There are six triples of X, Y and Z that satisfy the condition:

X = 0, Y = 0, Z = 2 
X = 0, Y = 2, Z = 0 
X = 2, Y = 0, Z = 0 
X = 0, Y = 1, Z = 1 
X = 1, Y = 0, Z = 1 
X = 1, Y = 1, Z = 0






Sample Input 25 15





Sample Output 21

The maximum value of X + Y + Z is 15, achieved by one triple of X, Y and Z.

",Sum of Three Integers,"Bruteforcing, Arithmetic, Implementation, Counting",0.462,560,242
453,"
Score : 300 points


Problem StatementWe have a square grid with H rows and W columns.
Snuke wants to write 0 or 1 in each of the squares.
Here, all of the following conditions have to be satisfied:

For every row, the smaller of the following is A: the number of 0s contained in the row, and the number of 1s contained in the row. (If these two numbers are equal, “the smaller” should be read as “either”.)
For every column, the smaller of the following is B: the number of 0s contained in the column, and the number of 1s contained in the column.

Determine if these conditions can be satisfied by writing 0 or 1 in each of the squares. If the answer is yes, show one way to fill the squares so that the conditions are satisfied.




Constraints
1 \leq H,W \leq 1000
0 \leq A
2 \times A \leq W
0 \leq B
2 \times B \leq H
All values in input are integers.







InputInput is given from Standard Input in the following format:
H W A B





OutputIf the conditions cannot be satisfied by writing 0 or 1 in each of the squares, print -1.
If the conditions can be satisfied, print one way to fill the squares so that the conditions are satisfied, in the following format:
s_{11}s_{12}\cdots s_{1W}
s_{21}s_{22}\cdots s_{2W}
\vdots
s_{H1}s_{H2}\cdots s_{HW}

Here s_{ij} is the digit written in the square at the i-th row from the top and the j-th column from the left in the grid.
If multiple solutions exist, printing any of them will be accepted.






Sample Input 13 3 1 1





Sample Output 1100
010
001

Every row contains two 0s and one 1, so the first condition is satisfied.
Also, every column contains two 0s and one 1, so the second condition is satisfied.





Sample Input 21 5 2 0





Sample Output 201010


",01 Matrix,"Greedy Algorithm, Arithmetic, Bruteforcing, Mathematics",0.385,141,40
454,"


Problem StatementYou are given two integers a and b (a≤b). Determine if the product of the integers a, a+1, …, b is positive, negative or zero.




Constraints
a and b are integers.
-10^9≤a≤b≤10^9





Partial Score
In test cases worth 100 points, -10≤a≤b≤10.







InputThe input is given from Standard Input in the following format:
a b





OutputIf the product is positive, print Positive. If it is negative, print Negative. If it is zero, print Zero.






Sample Input 11 3





Sample Output 1Positive

1×2×3=6 is positive.





Sample Input 2-3 -1





Sample Output 2Negative

(-3)×(-2)×(-1)=-6 is negative.





Sample Input 3-1 1





Sample Output 3Zero

(-1)×0×1=0.

",Range Product,"Boolean Operations On Geometric Objects, Arithmetic, Mathematics",0.551,96,41
455,"
Score : 100 points


Problem StatementWe have an N \times N square grid.
We will paint each square in the grid either black or white.
If we paint exactly A squares white, how many squares will be painted black?




Constraints
1 \leq N \leq 100
0 \leq A \leq N^2







InputsInput is given from Standard Input in the following format:
N
A





OutputsPrint the number of squares that will be painted black.






Sample Input 13
4





Sample Output 15

There are nine squares in a 3 \times 3 square grid.
Four of them will be painted white, so the remaining five squares will be painted black.





Sample Input 219
100





Sample Output 2261






Sample Input 310
0





Sample Output 3100

As zero squares will be painted white, all the squares will be painted black.

",Bichrome Cells,"Arithmetic, Implementation",0.837,169,122
456,"
Score : 200 points


Problem StatementThere are N balls in the xy-plane. The coordinates of the i-th of them is (x_i, i).
Thus, we have one ball on each of the N lines y = 1, y = 2, ..., y = N.
In order to collect these balls, Snuke prepared 2N robots, N of type A and N of type B.
Then, he placed the i-th type-A robot at coordinates (0, i), and the i-th type-B robot at coordinates (K, i).
Thus, now we have one type-A robot and one type-B robot on each of the N lines y = 1, y = 2, ..., y = N.
When activated, each type of robot will operate as follows.


When a type-A robot is activated at coordinates (0, a), it will move to the position of the ball on the line y = a, collect the ball, move back to its original position (0, a) and deactivate itself. If there is no such ball, it will just deactivate itself without doing anything.


When a type-B robot is activated at coordinates (K, b), it will move to the position of the ball on the line y = b, collect the ball, move back to its original position (K, b) and deactivate itself. If there is no such ball, it will just deactivate itself without doing anything.


Snuke will activate some of the 2N robots to collect all of the balls. Find the minimum possible total distance covered by robots.




Constraints
1 \leq N \leq 100
1 \leq K \leq 100
0 < x_i < K
All input values are integers.







InputsInput is given from Standard Input in the following format:
N
K
x_1 x_2 ... x_N





OutputsPrint the minimum possible total distance covered by robots.






Sample Input 11
10
2





Sample Output 14

There are just one ball, one type-A robot and one type-B robot.
If the type-A robot is used to collect the ball, the distance from the robot to the ball is 2, and the distance from the ball to the original position of the robot is also 2, for a total distance of 4.
Similarly, if the type-B robot is used, the total distance covered will be 16.
Thus, the total distance covered will be minimized when the type-A robot is used. The output should be 4.





Sample Input 22
9
3 6





Sample Output 212

The total distance covered will be minimized when the first ball is collected by the type-A robot, and the second ball by the type-B robot.





Sample Input 35
20
11 12 9 17 12





Sample Output 374


",Collecting Balls (Easy Version),"Greedy Algorithm, Bruteforcing, Arithmetic",0.864,134,110
457,"
Score : 200 points


Problem StatementTakahashi has A untasty cookies containing antidotes, B tasty cookies containing antidotes and C tasty cookies containing poison.
Eating a cookie containing poison results in a stomachache, and eating a cookie containing poison while having a stomachache results in a death.
As he wants to live, he cannot eat one in such a situation.
Eating a cookie containing antidotes while having a stomachache cures it, and there is no other way to cure stomachaches.
Find the maximum number of tasty cookies that Takahashi can eat.




Constraints
0 \leq A,B,C \leq 10^9
A,B and C are integers.







InputInput is given from Standard Input in the following format:
A B C





OutputPrint the maximum number of tasty cookies that Takahashi can eat.






Sample Input 13 1 4





Sample Output 15

We can eat all tasty cookies, in the following order:

A tasty cookie containing poison
An untasty cookie containing antidotes
A tasty cookie containing poison
A tasty cookie containing antidotes
A tasty cookie containing poison
An untasty cookie containing antidotes
A tasty cookie containing poison






Sample Input 25 2 9





Sample Output 210






Sample Input 38 8 1





Sample Output 39


",Poisonous Cookies,"Greedy Algorithm, Mathematics, Simulation",0.765,119,79
458,"
Score : 400 points


Problem StatementGiven are positive integers A and B.
Let us choose some number of positive common divisors of A and B.
Here, any two of the chosen divisors must be coprime.
At most, how many divisors can we choose?
Definition of common divisor
An integer d is said to be a common divisor of integers x and y when d divides both x and y.

Definition of being coprime
Integers x and y are said to be coprime when x and y have no positive common divisors other than 1.

Definition of dividing
An integer x is said to divide another integer y when there exists an integer \alpha such that y = \alpha x.





Constraints
All values in input are integers.
1 \leq A, B \leq 10^{12}







InputInput is given from Standard Input in the following format:
A B





OutputPrint the maximum number of divisors that can be chosen to satisfy the condition.






Sample Input 112 18





Sample Output 13

12 and 18 have the following positive common divisors: 1, 2, 3, and 6.
1 and 2 are coprime, 2 and 3 are coprime, and 3 and 1 are coprime, so we can choose 1, 2, and 3, which achieve the maximum result.





Sample Input 2420 660





Sample Output 24






Sample Input 31 2019





Sample Output 31

1 and 2019 have no positive common divisors other than 1.

",Disjoint Set of Common Divisors,"Euclidean Algorithm, Prime Factorization, Set / Map, Mathematics",0.146,626,101
459,"
Score : 400 points


Problem StatementTakahashi has N sticks that are distinguishable from each other. The length of the i-th stick is L_i.
He is going to form a triangle using three of these sticks. Let a, b, and c be the lengths of the three sticks used. Here, all of the following conditions must be satisfied:

a < b + c
b < c + a
c < a + b

How many different triangles can be formed? Two triangles are considered different when there is a stick used in only one of them.




Constraints
All values in input are integers.
3 \leq N \leq 2 \times 10^3
1 \leq L_i \leq 10^3







InputInput is given from Standard Input in the following format:
N
L_1 L_2 ... L_N





ConstraintsPrint the number of different triangles that can be formed.






Sample Input 14
3 4 2 1





Sample Output 11

Only one triangle can be formed: the triangle formed by the first, second, and third sticks.





Sample Input 23
1 1000 1





Sample Output 20

No triangles can be formed.





Sample Input 37
218 786 704 233 645 728 389





Sample Output 323


",Triangles,"Sorting, Bruteforcing, Mathematics, Binary Search, Two-pointer",0.337,430,158
460,"
Score: 200 points


Problem Statement
Takahashi, who works at DISCO, is standing before an iron bar.
The bar has N-1 notches, which divide the bar into N sections. The i-th section from the left has a length of A_i millimeters.
Takahashi wanted to choose a notch and cut the bar at that point into two parts with the same length.
However, this may not be possible as is, so he will do the following operations some number of times before he does the cut:

Choose one section and expand it, increasing its length by 1 millimeter. Doing this operation once costs 1 yen (the currency of Japan).
Choose one section of length at least 2 millimeters and shrink it, decreasing its length by 1 millimeter. Doing this operation once costs 1 yen.

Find the minimum amount of money needed before cutting the bar into two parts with the same length.




Constraints

2 \leq N \leq 200000
1 \leq A_i \leq 2020202020
All values in input are integers.







Input
Input is given from Standard Input in the following format:
N
A_1 A_2 A_3 ... A_N





Output
Print an integer representing the minimum amount of money needed before cutting the bar into two parts with the same length.






Sample Input 13
2 4 3





Sample Output 13

The initial lengths of the sections are [2, 4, 3] (in millimeters). Takahashi can cut the bar equally after doing the following operations for 3 yen:

Shrink the second section from the left. The lengths of the sections are now [2, 3, 3].
Shrink the first section from the left. The lengths of the sections are now [1, 3, 3].
Shrink the second section from the left. The lengths of the sections are now [1, 2, 3], and we can cut the bar at the second notch from the left into two parts of length 3 each.






Sample Input 212
100 104 102 105 103 103 101 105 104 102 104 101





Sample Output 20


",Iron Bar Cutting,"Prefix sum, Bruteforcing, Mathematics, Greedy Algorithm",0.471,128,48
461,"
Score : 600 points


Problem StatementGiven is an integer sequence of length N+1: A_0, A_1, A_2, \ldots, A_N. Is there a binary tree of depth N such that, for each d = 0, 1, \ldots, N, there are exactly A_d leaves at depth d? If such a tree exists, print the maximum possible number of vertices in such a tree; otherwise, print -1.




Notes
A binary tree is a rooted tree such that each vertex has at most two direct children.
A leaf in a binary tree is a vertex with zero children.
The depth of a vertex v in a binary tree is the distance from the tree's root to v. (The root has the depth of 0.)
The depth of a binary tree is the maximum depth of a vertex in the tree.





Constraints
0 \leq N \leq 10^5
0 \leq A_i \leq 10^{8} (0 \leq i \leq N)
A_N \geq 1
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
A_0 A_1 A_2 \cdots A_N





OutputPrint the answer as an integer.






Sample Input 13
0 1 1 2





Sample Output 17

Below is the tree with the maximum possible number of vertices. It has seven vertices, so we should print 7.








Sample Input 24
0 0 1 0 2





Sample Output 210






Sample Input 32
0 3 1





Sample Output 3-1






Sample Input 41
1 1





Sample Output 4-1






Sample Input 510
0 0 1 1 2 3 5 8 13 21 34





Sample Output 5264


",Folia,"Greedy Algorithm, Prefix sum, Mathematics, Recursion, Implementation",0.156,190,34
462,"
Score : 200 points


Problem Statement
You are visiting a large electronics store to buy a refrigerator and a microwave.
The store sells A kinds of refrigerators and B kinds of microwaves. The i-th refrigerator ( 1 \le i \le A ) is sold at a_i yen (the currency of Japan), and the j-th microwave ( 1 \le j \le B ) is sold at b_j yen.
You have M discount tickets. With the i-th ticket ( 1 \le i \le M ), you can get a discount of c_i yen from the total price when buying the x_i-th refrigerator and the y_i-th microwave together. Only one ticket can be used at a time.
You are planning to buy one refrigerator and one microwave. Find the minimum amount of money required.




Constraints

All values in input are integers.
 1 \le A \le 10^5 
 1 \le B \le 10^5 
 1 \le M \le 10^5 
 1 \le a_i , b_i , c_i \le 10^5 
 1 \le x_i \le A 
 1 \le y_i \le B 
 c_i \le a_{x_i} + b_{y_i} 







Input
Input is given from Standard Input in the following format:
A B M
a_1 a_2 ... a_A
b_1 b_2 ... b_B
x_1 y_1 c_1
\vdots
x_M y_M c_M





Output
Print the answer.






Sample Input 12 3 1
3 3
3 3 3
1 2 1





Sample Output 15

With the ticket, you can get the 1-st refrigerator and the 2-nd microwave for 3+3-1=5 yen.





Sample Input 21 1 2
10
10
1 1 5
1 1 10





Sample Output 210

Note that you cannot use more than one ticket at a time.





Sample Input 32 2 1
3 5
3 5
2 2 2





Sample Output 36

You can get the 1-st refrigerator and the 1-st microwave for 6 yen, which is the minimum amount to pay in this case.
Note that using a ticket is optional.

",Nice Shopping,"Bruteforcing, Data Structure, Arithmetic, Boolean Operations On Geometric Objects",0.657,168,91
463,"
Score : 300 points


Problem StatementYou are given an undirected unweighted graph with N vertices and M edges that contains neither self-loops nor double edges.
Here, a self-loop is an edge where a_i = b_i (1≤i≤M), and double edges are two edges where (a_i,b_i)=(a_j,b_j) or (a_i,b_i)=(b_j,a_j) (1≤i<j≤M).
How many different paths start from vertex 1 and visit all the vertices exactly once?
Here, the endpoints of a path are considered visited.  
For example, let us assume that the following undirected graph shown in Figure 1 is given.


Figure 1: an example of an undirected graph

The following path shown in Figure 2 satisfies the condition.


Figure 2: an example of a path that satisfies the condition

However, the following path shown in Figure 3 does not satisfy the condition, because it does not visit all the vertices.


Figure 3: an example of a path that does not satisfy the condition

Neither the following path shown in Figure 4, because it does not start from vertex 1.


Figure 4: another example of a path that does not satisfy the condition





Constraints
2≦N≦8 
0≦M≦N(N-1)/2 
1≦a_i<b_i≦N 
The given graph contains neither self-loops nor double edges.







InputThe input is given from Standard Input in the following format:
N M  
a_1 b_1  
a_2 b_2
:  
a_M b_M  





OutputPrint the number of the different paths that start from vertex 1 and visit all the vertices exactly once.






Sample Input 13 3
1 2
1 3
2 3





Sample Output 12

The given graph is shown in the following figure:



The following two paths satisfy the condition:








Sample Input 27 7
1 3
2 7
3 4
4 5
4 6
5 6
6 7





Sample Output 21

This test case is the same as the one described in the problem statement.

",One-stroke Path,"Graph Theory, Depth-first Search, Backtracking, Implementation",0.732,119,76
464,"
Score : 300 points


Problem StatementE869120 found a chest which is likely to contain treasure.
However, the chest is locked. In order to open it, he needs to enter a string S consisting of lowercase English letters.
He also found a string S', which turns out to be the string S with some of its letters (possibly all or none) replaced with ?.  
One more thing he found is a sheet of paper with the following facts written on it:  

Condition 1: The string S contains a string T as a contiguous substring.
Condition 2: S is the lexicographically smallest string among the ones that satisfy Condition 1.

Print the string S.
If such a string does not exist, print UNRESTORABLE.  




Constraints
1 \leq |S'|, |T| \leq 50
S' consists of lowercase English letters and ?.
T consists of lowercase English letters.







InputInput is given from Standard Input in the following format:
S
T'





OutputPrint the string S.
If such a string does not exist, print UNRESTORABLE instead.  






Sample Input 1?tc????
coder





Sample Output 1atcoder

There are 26 strings that satisfy Condition 1: atcoder, btcoder, ctcoder,..., ztcoder.
Among them, the lexicographically smallest is atcoder, so we can say S = atcoder.





Sample Input 2??p??d??
abc





Sample Output 2UNRESTORABLE

There is no string that satisfies Condition 1, so the string S does not exist.

",Dubious Document 2,"Greedy Algorithm, String, Bruteforcing",0.366,235,82
465,"
Score : 400 points


Problem StatementConsider a grid with H rows and W columns of squares. Let (r, c) denote the square at the r-th row from the top and the c-th column from the left.
Each square is painted black or white.
The grid is said to be good if and only if the following condition is satisfied:

From (1, 1), we can reach (H, W) by moving one square right or down repeatedly, while always being on a white square.

Note that (1, 1) and (H, W) must be white if the grid is good.
Your task is to make the grid good by repeating the operation below. Find the minimum number of operations needed to complete the task. It can be proved that you can always complete the task in a finite number of operations.

Choose four integers r_0, c_0, r_1, c_1(1 \leq r_0 \leq r_1 \leq H, 1 \leq c_0 \leq c_1 \leq W). For each pair r, c (r_0 \leq r \leq r_1, c_0 \leq c \leq c_1), invert the color of (r, c) - that is, from white to black and vice versa.





Constraints
2 \leq H, W \leq 100







InputInput is given from Standard Input in the following format:
H W
s_{11} s_{12} \cdots s_{1W}
s_{21} s_{22} \cdots s_{2W}
 \vdots
s_{H1} s_{H2} \cdots s_{HW}

Here s_{rc} represents the color of (r, c) - # stands for black, and . stands for white.




OutputPrint the minimum number of operations needed.






Sample Input 13 3
.##
.#.
##.





Sample Output 11

Do the operation with (r_0, c_0, r_1, c_1) = (2, 2, 2, 2) to change just the color of (2, 2), and we are done.





Sample Input 22 2
#.
.#





Sample Output 22






Sample Input 34 4
..##
#...
###.
###.





Sample Output 30

No operation may be needed.





Sample Input 45 5
.#.#.
#.#.#
.#.#.
#.#.#
.#.#.





Sample Output 44


",Range Flip Find Route,"Dyanmic Programming, Grid Graph, Counting, Arithmetic",0.214,179,42
466,"
Score : 200 points


Problem StatementYou are given a string S of length N consisting of lowercase English letters.
We will cut this string at one position into two strings X and Y.
Here, we would like to maximize the number of different letters contained in both X and Y.
Find the largest possible number of different letters contained in both X and Y when we cut the string at the optimal position.




Constraints
2 \leq N \leq 100
|S| = N
S consists of lowercase English letters.







InputInput is given from Standard Input in the following format:
N
S





OutputPrint the largest possible number of different letters contained in both X and Y.






Sample Input 16
aabbca





Sample Output 12

If we cut the string between the third and fourth letters into X = aab and Y = bca, the letters contained in both X and Y are a and b.
There will never be three or more different letters contained in both X and Y, so the answer is 2.





Sample Input 210
aaaaaaaaaa





Sample Output 21

However we divide S, only a will be contained in both X and Y.





Sample Input 345
tgxgdqkyjzhyputjjtllptdfxocrylqfqjynmfbfucbir





Sample Output 39


",Cut and Count,"Bruteforcing, String, Set / Map, Counting, Data Structure",0.845,155,127
467,"
Score : 300 points


Problem StatementSnuke has N hats. The i-th hat has an integer a_i written on it.
There are N camels standing in a circle.
Snuke will put one of his hats on each of these camels.
If there exists a way to distribute the hats to the camels such that the following condition is satisfied for every camel, print Yes; otherwise, print No.

The bitwise XOR of the numbers written on the hats on both adjacent camels is equal to the number on the hat on itself.


What is XOR?

The bitwise XOR x_1 \oplus x_2 \oplus \ldots \oplus x_n of n non-negative integers x_1, x_2, \ldots, x_n is defined as follows:

- When x_1 \oplus x_2 \oplus \ldots \oplus x_n is written in base two, the digit in the 2^k's place (k \geq 0) is 1 if the number of integers among x_1, x_2, \ldots, x_n whose binary representations have 1 in the 2^k's place is odd, and 0 if that count is even.

For example, 3 \oplus 5 = 6.






Constraints
All values in input are integers.
3 \leq N \leq 10^{5}
0 \leq a_i \leq 10^{9}







InputInput is given from Standard Input in the following format:
N
a_1 a_2 \ldots a_{N}





OutputPrint the answer.






Sample Input 13
1 2 3





Sample Output 1Yes


If we put the hats with 1, 2, and 3 in this order, clockwise, the condition will be satisfied for every camel, so the answer is Yes.






Sample Input 24
1 2 4 8





Sample Output 2No


There is no such way to distribute the hats; the answer is No.


",XOR Circle,"Bitmask, Arithmetic, Counting, Mathematics, Boolean Operations On Geometric Objects",0.221,279,49
468,"
Score : 300 points


Problem StatementThere are N people standing in a row from west to east.
Each person is facing east or west.
The directions of the people is given as a string S of length N.
The i-th person from the west is facing east if S_i = E, and west if S_i = W.
You will appoint one of the N people as the leader, then command the rest of them to face in the direction of the leader.
Here, we do not care which direction the leader is facing.
The people in the row hate to change their directions, so you would like to select the leader so that the number of people who have to change their directions is minimized.
Find the minimum number of people who have to change their directions.




Constraints
2 \leq N \leq 3 \times 10^5
|S| = N
S_i is E or W.







InputInput is given from Standard Input in the following format:
N
S





OutputPrint the minimum number of people who have to change their directions.






Sample Input 15
WEEWW





Sample Output 11

Assume that we appoint the third person from the west as the leader.
Then, the first person from the west needs to face east and has to turn around.
The other people do not need to change their directions, so the number of people who have to change their directions is 1 in this case.
It is not possible to have 0 people who have to change their directions, so the answer is 1.





Sample Input 212
WEWEWEEEWWWE





Sample Output 24






Sample Input 38
WWWWWEEE





Sample Output 33


",Attention,"Prefix sum, Bruteforcing, Segment Tree, Mathematics",0.613,97,56
469,"
Score : 500 points


Problem StatementSnuke received a positive integer N from Takahashi.
A positive integer m is called a favorite number when the following condition is satisfied:

The quotient and remainder of N divided by m are equal, that is, \lfloor \frac{N}{m} \rfloor = N \bmod m holds.

Find all favorite numbers and print the sum of those.




Constraints
All values in input are integers.
1 \leq N \leq 10^{12}







InputInput is given from Standard Input in the following format:
N





OutputPrint the answer.






Sample Input 18





Sample Output 110

There are two favorite numbers: 3 and 7. Print the sum of these, 10.





Sample Input 21000000000000





Sample Output 22499686339916

Watch out for overflow.

",DivRem Number,"Arithmetic, Mathematics, Bruteforcing",0.386,117,53
470,"
Score : 300 points


Problem StatementSnuke loves ""paper cutting"": he cuts out characters from a newspaper headline and rearranges them to form another string.
He will receive a headline which contains one of the strings S_1,...,S_n tomorrow.
He is excited and already thinking of what string he will create.
Since he does not know the string on the headline yet, he is interested in strings that can be created regardless of which string the headline contains.
Find the longest string that can be created regardless of which string among S_1,...,S_n the headline contains.
If there are multiple such strings, find the lexicographically smallest one among them.




Constraints
1 \leq n \leq 50
1 \leq |S_i| \leq 50 for every i = 1, ..., n.
S_i consists of lowercase English letters (a - z) for every i = 1, ..., n.







InputInput is given from Standard Input in the following format:
n
S_1
...
S_n





OutputPrint the lexicographically smallest string among the longest strings that satisfy the condition.
If the answer is an empty string, print an empty line.






Sample Input 13
cbaa
daacc
acacac





Sample Output 1aac

The strings that can be created from each of cbaa, daacc and acacac, are aa, aac, aca, caa and so forth.
Among them, aac, aca and caa are the longest, and the lexicographically smallest of these three is aac.





Sample Input 23
a
aa
b





Sample Output 2

The answer is an empty string.

",Dubious Document,"Counting, Array, Mathematics, String, Sorting",0.877,85,56
471,"
Score : 200 points


Problem StatementThere is a kangaroo at coordinate 0 on an infinite number line that runs from left to right, at time 0.
During the period between time i-1 and time i, the kangaroo can either stay at his position, or perform a jump of length exactly i to the left or to the right.
That is, if his coordinate at time i-1 is x, he can be at coordinate x-i, x or x+i at time i.
The kangaroo's nest is at coordinate X, and he wants to travel to coordinate X as fast as possible.
Find the earliest possible time to reach coordinate X.




Constraints
X is an integer.
1≤X≤10^9







InputThe input is given from Standard Input in the following format:
X





OutputPrint the earliest possible time for the kangaroo to reach coordinate X.






Sample Input 16





Sample Output 13

The kangaroo can reach his nest at time 3 by jumping to the right three times, which is the earliest possible time.





Sample Input 22





Sample Output 22

He can reach his nest at time 2 by staying at his position during the first second, and jumping to the right at the next second.





Sample Input 311





Sample Output 35


",Go Home,"Arithmetic, Greedy Algorithm, Parity, Bruteforcing",0.681,117,72
472,"
Score : 300 points


Problem StatementSnuke loves puzzles.
Today, he is working on a puzzle using S- and c-shaped pieces.
In this puzzle, you can combine two c-shaped pieces into one S-shaped piece, as shown in the figure below:



Snuke decided to create as many Scc groups as possible by putting together one S-shaped piece and two c-shaped pieces.
Find the maximum number of Scc groups that can be created when Snuke has N S-shaped pieces and M c-shaped pieces.




Constraints
1 ≤ N,M ≤ 10^{12}







InputThe input is given from Standard Input in the following format:
N M





OutputPrint the answer.






Sample Input 11 6





Sample Output 12

Two Scc groups can be created as follows:

Combine two c-shaped pieces into one S-shaped piece
Create two Scc groups, each from one S-shaped piece and two c-shaped pieces






Sample Input 212345 678901





Sample Output 2175897


",Scc Puzzle,"Greedy Algorithm, Arithmetic, Mathematics",0.333,189,66
473,"
Score : 300 points


Problem StatementSnuke has decided to play with a six-sided die. Each of its six sides shows an integer 1 through 6, and two numbers on opposite sides always add up to 7.
Snuke will first put the die on the table with an arbitrary side facing upward, then repeatedly perform the following operation:

Operation: Rotate the die 90° toward one of the following directions: left, right, front (the die will come closer) and back (the die will go farther). Then, obtain y points where y is the number written in the side facing upward.

For example, let us consider the situation where the side showing 1 faces upward, the near side shows 5 and the right side shows 4, as illustrated in the figure.
If the die is rotated toward the right as shown in the figure, the side showing 3 will face upward.
Besides, the side showing 4 will face upward if the die is rotated toward the left, the side showing 2 will face upward if the die is rotated toward the front, and the side showing 5 will face upward if the die is rotated toward the back.



Find the minimum number of operation Snuke needs to perform in order to score at least x points in total.




Constraints
1 ≦ x ≦ 10^{15}
x is an integer.







InputThe input is given from Standard Input in the following format:
x





OutputPrint the answer.






Sample Input 17





Sample Output 12






Sample Input 2149696127901





Sample Output 227217477801


",X: Yet Another Die Game,"Arithmetic, Machine Learning, Greedy Algorithm",0.439,163,64
474,"
Score : 300 points


Problem StatementYou are given an integer N.
Find the number of the positive divisors of N!, modulo 10^9+7.




Constraints
1≤N≤10^3







InputThe input is given from Standard Input in the following format:
N





OutputPrint the number of the positive divisors of N!, modulo 10^9+7.






Sample Input 13





Sample Output 14

There are four divisors of 3! =6: 1, 2, 3 and 6. Thus, the output should be 4.





Sample Input 26





Sample Output 230






Sample Input 31000





Sample Output 3972926972


",Factors of Factorial,"Sieve Of Eratosthenes, Prime Factorization, Number Theory, Arithmetic, Bruteforcing",0.678,82,52
475,"
Score : 300 points


Problem StatementThere are N people, conveniently numbered 1 through N.
They were standing in a row yesterday, but now they are unsure of the order in which they were standing.
However, each person remembered the following fact: the absolute difference of the number of the people who were standing to the left of that person, and the number of the people who were standing to the right of that person.
According to their reports, the difference above for person i is A_i.
Based on these reports, find the number of the possible orders in which they were standing.
Since it can be extremely large, print the answer modulo 10^9+7.
Note that the reports may be incorrect and thus there may be no consistent order.
In such a case, print 0.




Constraints
1≦N≦10^5
0≦A_i≦N-1







InputThe input is given from Standard Input in the following format:
N
A_1 A_2 ... A_N





OutputPrint the number of the possible orders in which they were standing, modulo 10^9+7.






Sample Input 15
2 4 4 0 2





Sample Output 14

There are four possible orders, as follows:

2,1,4,5,3
2,5,4,1,3
3,1,4,5,2
3,5,4,1,2






Sample Input 27
6 4 0 2 4 0 2





Sample Output 20

Any order would be inconsistent with the reports, thus the answer is 0.





Sample Input 38
7 5 1 1 7 3 5 3





Sample Output 316


",Lining Up,"Counting, Machine Learning, Exponentiation By Squaring, Implementation, Combinatorics",0.37,167,52
476,"
Score : 300 points


Problem StatementYou are given a string S consisting of lowercase English letters.
Another string T is initially empty.
Determine whether it is possible to obtain S = T by performing the following operation an arbitrary number of times:

Append one of the following at the end of T: dream, dreamer, erase and eraser.





Constraints
1≦|S|≦10^5
S consists of lowercase English letters.







InputThe input is given from Standard Input in the following format:
S





OutputIf it is possible to obtain S = T, print YES. Otherwise, print NO.






Sample Input 1erasedream





Sample Output 1YES

Append erase and dream at the end of T in this order, to obtain S = T.





Sample Input 2dreameraser





Sample Output 2YES

Append dream and eraser at the end of T in this order, to obtain S = T.





Sample Input 3dreamerer





Sample Output 3NO


",Daydream,"Greedy Algorithm, String, Bruteforcing, Backtracking",0.358,561,160
477,"
Score : 500 points


Problem StatementN players will participate in a tennis tournament. We will call them Player 1, Player 2, \ldots, Player N.
The tournament is round-robin format, and there will be N(N-1)/2 matches in total.
Is it possible to schedule these matches so that all of the following conditions are satisfied? If the answer is yes, also find the minimum number of days required.

Each player plays at most one matches in a day.
Each player i (1 \leq i \leq N) plays one match against Player A_{i, 1}, A_{i, 2}, \ldots, A_{i, N-1} in this order.





Constraints
3 \leq N \leq 1000
1 \leq A_{i, j} \leq N
A_{i, j} \neq i
A_{i, 1}, A_{i, 2}, \ldots, A_{i, N-1} are all different.







InputInput is given from Standard Input in the following format:
N
A_{1, 1} A_{1, 2} \ldots A_{1, N-1}
A_{2, 1} A_{2, 2} \ldots A_{2, N-1}
:
A_{N, 1} A_{N, 2} \ldots A_{N, N-1}





OutputIf it is possible to schedule all the matches so that all of the conditions are satisfied, print the minimum number of days required; if it is impossible, print -1.






Sample Input 13
2 3
1 3
1 2





Sample Output 13

All the conditions can be satisfied if the matches are scheduled for three days as follows:

Day 1: Player 1 vs Player 2
Day 2: Player 1 vs Player 3
Day 3: Player 2 vs Player 3

This is the minimum number of days required.





Sample Input 24
2 3 4
1 3 4
4 1 2
3 1 2





Sample Output 24

All the conditions can be satisfied if the matches are scheduled for four days as follows:

Day 1: Player 1 vs Player 2, Player 3 vs Player 4
Day 2: Player 1 vs Player 3
Day 3: Player 1 vs Player 4, Player 2 vs Player 3
Day 4: Player 2 vs Player 4

This is the minimum number of days required.





Sample Input 33
2 3
3 1
1 2





Sample Output 3-1

Any scheduling of the matches violates some condition.

",League,"Directed Acyclic Graph, Topological Sorting, Queue, Graph Theory, Permutation Cycle Decomposition",0.146,196,28
478,"
Score: 600 points


Problem Statement
E869120 is initially standing at the origin (0, 0) in a two-dimensional plane.
He has N engines, which can be used as follows:

When E869120 uses the i-th engine, his X- and Y-coordinate change by x_i and y_i, respectively. In other words, if E869120 uses the i-th engine from coordinates (X, Y), he will move to the coordinates (X + x_i, Y + y_i).
E869120 can use these engines in any order, but each engine can be used at most once. He may also choose not to use some of the engines.

He wants to go as far as possible from the origin.
Let (X, Y) be his final coordinates. Find the maximum possible value of \sqrt{X^2 + Y^2}, the distance from the origin.




Constraints

1 \leq N \leq 100
-1 \ 000 \ 000 \leq x_i \leq 1 \ 000 \ 000
-1 \ 000 \ 000 \leq y_i \leq 1 \ 000 \ 000
All values in input are integers.







Input
Input is given from Standard Input in the following format:
N
x_1 y_1
x_2 y_2
 : :
x_N y_N





Output
Print the maximum possible final distance from the origin, as a real value.
Your output is considered correct when the relative or absolute error from the true answer is at most 10^{-10}.






Sample Input 13
0 10
5 -5
-5 -5





Sample Output 110.000000000000000000000000000000000000000000000000

The final distance from the origin can be 10 if we use the engines in one of the following three ways:

Use Engine 1 to move to (0, 10).
Use Engine 2 to move to (5, -5), and then use Engine 3 to move to (0, -10).
Use Engine 3 to move to (-5, -5), and then use Engine 2 to move to (0, -10).

The distance cannot be greater than 10, so the maximum possible distance is 10.





Sample Input 25
1 1
1 0
0 1
-1 0
0 -1





Sample Output 22.828427124746190097603377448419396157139343750753

The maximum possible final distance is 2 \sqrt{2} = 2.82842....
One of the ways to achieve it is:

Use Engine 1 to move to (1, 1), and then use Engine 2 to move to (2, 1), and finally use Engine 3 to move to (2, 2).






Sample Input 35
1 1
2 2
3 3
4 4
5 5





Sample Output 321.213203435596425732025330863145471178545078130654

If we use all the engines in the order 1 \rightarrow 2 \rightarrow 3 \rightarrow 4 \rightarrow 5, we will end up at (15, 15), with the distance 15 \sqrt{2} = 21.2132... from the origin.





Sample Input 43
0 0
0 1
1 0





Sample Output 41.414213562373095048801688724209698078569671875376

There can be useless engines with (x_i, y_i) = (0, 0).





Sample Input 51
90447 91000





Sample Output 5128303.000000000000000000000000000000000000000000000000

Note that there can be only one engine.





Sample Input 62
96000 -72000
-72000 54000





Sample Output 6120000.000000000000000000000000000000000000000000000000

There can be only two engines, too.





Sample Input 710
1 2
3 4
5 6
7 8
9 10
11 12
13 14
15 16
17 18
19 20





Sample Output 7148.660687473185055226120082139313966514489855137208


",Engines,"Mathematics, Sorting, Array, Prefix sum, Bruteforcing",0.0,66,8
479,"
Score : 400 points


Problem StatementThere are N people standing in a queue from west to east.
Given is a string S of length N representing the directions of the people.
The i-th person from the west is facing west if the i-th character of S is L, and east if that character of S is R.
A person is happy if the person in front of him/her is facing the same direction.
If no person is standing in front of a person, however, he/she is not happy.
You can perform the following operation any number of times between 0 and K (inclusive):
Operation: Choose integers l and r such that 1 \leq l \leq r \leq N, and rotate by 180 degrees the part of the queue: the l-th, (l+1)-th, ..., r-th persons. That is, for each i = 0, 1, ..., r-l, the (l + i)-th person from the west will stand the (r - i)-th from the west after the operation, facing east if he/she is facing west now, and vice versa.
What is the maximum possible number of happy people you can have?




Constraints
N is an integer satisfying 1 \leq N \leq 10^5.
K is an integer satisfying 1 \leq K \leq 10^5.
|S| = N
Each character of S is L or R.







InputInput is given from Standard Input in the following format:
N K
S





OutputPrint the maximum possible number of happy people after at most K operations.






Sample Input 16 1
LRLRRL





Sample Output 13

If we choose (l, r) = (2, 5), we have LLLRLL, where the 2-nd, 3-rd, and 6-th persons from the west are happy.





Sample Input 213 3
LRRLRLRRLRLLR





Sample Output 29






Sample Input 310 1
LLLLLRRRRR





Sample Output 39






Sample Input 49 2
RRRLRLRLL





Sample Output 47


",Face Produces Unhappiness,"String, Counting, Greedy Algorithm, Mathematics",0.631,144,75
480,"
Score : 500 points


Problem StatementGiven is a string S of length N.
Find the maximum length of a non-empty string that occurs twice or more in S as contiguous substrings without overlapping.
More formally, find the maximum positive integer len such that there exist integers l_1 and l_2 ( 1 \leq l_1, l_2 \leq N - len + 1 ) that satisfy the following:


l_1 + len \leq l_2


S[l_1+i] = S[l_2+i] (i = 0, 1, ..., len - 1)


If there is no such integer len, print 0.




Constraints
2 \leq N \leq 5 \times 10^3
|S| = N
S consists of lowercase English letters.







InputInput is given from Standard Input in the following format:
N
S





OutputPrint the maximum length of a non-empty string that occurs twice or more in S as contiguous substrings without overlapping. If there is no such non-empty string, print 0 instead.






Sample Input 15
ababa





Sample Output 12

The strings satisfying the conditions are: a, b, ab, and ba. The maximum length among them is 2, which is the answer.
Note that aba occurs twice in S as contiguous substrings, but there is no pair of integers l_1 and l_2 mentioned in the statement such that l_1 + len \leq l_2.





Sample Input 22
xy





Sample Output 20

No non-empty string satisfies the conditions.





Sample Input 313
strangeorange





Sample Output 35


",Who Says a Pun?,"String, Bruteforcing, Implementation",0.255,152,36
481,"
Score : 400 points


Problem StatementTakahashi is going to buy N items one by one.
The price of the i-th item he buys is A_i yen (the currency of Japan).
He has M discount tickets, and he can use any number of them when buying an item.
If Y tickets are used when buying an item priced X yen, he can get the item for \frac{X}{2^Y} (rounded down to the nearest integer) yen.
What is the minimum amount of money required to buy all the items?




Constraints
All values in input are integers.
1 \leq N, M \leq 10^5
1 \leq A_i \leq 10^9







InputInput is given from Standard Input in the following format:
N M
A_1 A_2 ... A_N





OutputPrint the minimum amount of money required to buy all the items.






Sample Input 13 3
2 13 8





Sample Output 19

We can buy all the items for 9 yen, as follows:

Buy the 1-st item for 2 yen without tickets.
Buy the 2-nd item for 3 yen with 2 tickets.
Buy the 3-rd item for 4 yen with 1 ticket.






Sample Input 24 4
1 9 3 5





Sample Output 26






Sample Input 31 100000
1000000000





Sample Output 30

We can buy the item priced 1000000000 yen for 0 yen with 100000 tickets.





Sample Input 410 1
1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000





Sample Output 49500000000


",Powerful Discount Tickets,"Priority Queue, Greedy Algorithm, Arithmetic, Bruteforcing",0.448,329,122
482,"
Score : 300 points


Problem StatementGiven is an integer sequence D_1,...,D_N of N elements. Find the number, modulo 998244353, of trees with N vertices numbered 1 to N that satisfy the following condition:

For every integer i from 1 to N, the distance between Vertex 1 and Vertex i is D_i.





Notes
A tree of N vertices is a connected undirected graph with N vertices and N-1 edges, and the distance between two vertices are the number of edges in the shortest path between them.
Two trees are considered different if and only if there are two vertices x and y such that there is an edge between x and y in one of those trees and not in the other.





Constraints
1 \leq N \leq 10^5
0 \leq D_i \leq N-1







InputInput is given from Standard Input in the following format:
N
D_1 D_2 ... D_N





OutputPrint the answer.






Sample Input 14
0 1 1 2





Sample Output 12

For example, a tree with edges (1,2), (1,3), and (2,4) satisfies the condition.





Sample Input 24
1 1 1 1





Sample Output 20






Sample Input 37
0 3 2 1 2 2 1





Sample Output 324


",Counting of Trees,"Counting, Mathematics, Arithmetic, Combinatorics, Exponentiation By Squaring",0.16,190,31
483,"
Score : 400 points


Problem StatementWe have N integers. The i-th integer is A_i.
Find \sum_{i=1}^{N-1}\sum_{j=i+1}^{N} (A_i \mbox{ XOR } A_j), modulo (10^9+7).

What is \mbox{ XOR }?

The XOR of integers A and B, A \mbox{ XOR } B, is defined as follows:

When A \mbox{ XOR } B is written in base two, the digit in the 2^k's place (k \geq 0) is 1 if either A or B, but not both, has 1 in the 2^k's place, and 0 otherwise.

For example, 3 \mbox{ XOR } 5 = 6. (In base two: 011 \mbox{ XOR } 101 = 110.)






Constraints
2 \leq N \leq 3 \times 10^5
0 \leq A_i < 2^{60}
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
A_1 A_2 ... A_N





OutputPrint the value \sum_{i=1}^{N-1}\sum_{j=i+1}^{N} (A_i \mbox{ XOR } A_j), modulo (10^9+7).






Sample Input 13
1 2 3





Sample Output 16

We have (1\mbox{ XOR } 2)+(1\mbox{ XOR } 3)+(2\mbox{ XOR } 3)=3+2+1=6.





Sample Input 210
3 1 4 1 5 9 2 6 5 3





Sample Output 2237






Sample Input 310
3 14 159 2653 58979 323846 2643383 27950288 419716939 9375105820





Sample Output 3103715602

Print the sum modulo (10^9+7).

",Xor Sum 4,"Bitmask, Counting, Arithmetic, Combinatorics, Bruteforcing",0.188,234,56
484,"
Score : 300 points


Problem StatementDolphin resides in two-dimensional Cartesian plane, with the positive x-axis pointing right and the positive y-axis pointing up.
Currently, he is located at the point (sx,sy). In each second, he can move up, down, left or right by a distance of 1.
Here, both the x- and y-coordinates before and after each movement must be integers.
He will first visit the point (tx,ty) where sx < tx and sy < ty, then go back to the point (sx,sy), then visit the point (tx,ty) again, and lastly go back to the point (sx,sy).
Here, during the whole travel, he is not allowed to pass through the same point more than once, except the points (sx,sy) and (tx,ty).
Under this condition, find a shortest path for him.  




Constraints
-1000 ≤ sx < tx ≤ 1000 
-1000 ≤ sy < ty ≤ 1000 
sx,sy,tx and ty are integers.







InputThe input is given from Standard Input in the following format:
sx sy tx ty





OutputPrint a string S that represents a shortest path for Dolphin.
The i-th character in S should correspond to his i-th movement.
The directions of the movements should be indicated by the following characters:  

U: Up
D: Down
L: Left
R: Right

If there exist multiple shortest paths under the condition, print any of them.






Sample Input 10 0 1 2





Sample Output 1UURDDLLUUURRDRDDDLLU

One possible shortest path is:

Going from (sx,sy) to (tx,ty) for the first time: (0,0) → (0,1) → (0,2) → (1,2)
Going from (tx,ty) to (sx,sy) for the first time: (1,2) → (1,1) → (1,0) → (0,0)
Going from (sx,sy) to (tx,ty) for the second time: (0,0) → (-1,0) → (-1,1) → (-1,2) → (-1,3) → (0,3) → (1,3) → (1,2)
Going from (tx,ty) to (sx,sy) for the second time: (1,2) → (2,2) → (2,1) → (2,0) → (2,-1) → (1,-1) → (0,-1) → (0,0)






Sample Input 2-2 -2 1 1





Sample Output 2UURRURRDDDLLDLLULUUURRURRDDDLLDL


",Back and Forth,"Grid Graph, String, Geometry; 3d, Bruteforcing, Constructive",0.627,163,100
485,"
Score : 300 points


Problem StatementTwo foxes Jiro and Saburo are playing a game called 1D Reversi. This game is played on a board, using black and white stones. On the board, stones are placed in a row, and each player places a new stone to either end of the row. Similarly to the original game of Reversi, when a white stone is placed, all black stones between the new white stone and another white stone, turn into white stones, and vice versa.
In the middle of a game, something came up and Saburo has to leave the game. The state of the board at this point is described by a string S. There are |S| (the length of S) stones on the board, and each character in S represents the color of the i-th (1 ≦ i ≦ |S|) stone from the left. If the i-th character in S is B, it means that the color of the corresponding stone on the board is black. Similarly, if the i-th character in S is W, it means that the color of the corresponding stone is white.
Jiro wants all stones on the board to be of the same color. For this purpose, he will place new stones on the board according to the rules. Find the minimum number of new stones that he needs to place.




Constraints
1 ≦ |S| ≦ 10^5
Each character in S is B or W.







InputThe input is given from Standard Input in the following format:
S





OutputPrint the minimum number of new stones that Jiro needs to place for his purpose.






Sample Input 1BBBWW





Sample Output 11

By placing a new black stone to the right end of the row of stones, all white stones will become black. Also, by placing a new white stone to the left end of the row of stones, all black stones will become white.
In either way, Jiro's purpose can be achieved by placing one stone.





Sample Input 2WWWWWW





Sample Output 20

If all stones are already of the same color, no new stone is necessary.





Sample Input 3WBWBWBWBWB





Sample Output 39


",1D Reversi,"String, Counting, Greedy Algorithm, Mathematics",0.838,92,71
486,"
Score : 100 points


Problem StatementThere is an N-car train.
You are given an integer i. Find the value of j such that the following statement is true: ""the i-th car from the front of the train is the j-th car from the back.""




Constraints
1 \leq N \leq 100
1 \leq i \leq N







InputInput is given from Standard Input in the following format:
N i





OutputPrint the answer.






Sample Input 14 2





Sample Output 13

The second car from the front of a 4-car train is the third car from the back.





Sample Input 21 1





Sample Output 21






Sample Input 315 11





Sample Output 35


",Train,"Arithmetic, Mathematics",0.896,158,135
487,"
Score : 100 points


Problem StatementThree people, A, B and C, are trying to communicate using transceivers.
They are standing along a number line, and the coordinates of A, B and C are a, b and c (in meters), respectively.
Two people can directly communicate when the distance between them is at most d meters.
Determine if A and C can communicate, either directly or indirectly.
Here, A and C can indirectly communicate when A and B can directly communicate and also B and C can directly communicate.




Constraints
1 ≤ a,b,c ≤ 100
1 ≤ d ≤ 100
All values in input are integers.







InputInput is given from Standard Input in the following format:
a b c d





OutputIf A and C can communicate, print Yes; if they cannot, print No.






Sample Input 14 7 9 3





Sample Output 1Yes

A and B can directly communicate, and also B and C can directly communicate, so we should print Yes.





Sample Input 2100 10 1 2





Sample Output 2No

They cannot communicate in this case.





Sample Input 310 10 10 1





Sample Output 3Yes

There can be multiple people at the same position.





Sample Input 41 100 2 10





Sample Output 4Yes


",Colorful Transceivers,"Arithmetic, Boolean Operations On Geometric Objects",0.611,281,145
488,"
Score: 100 points


Problem Statement
In AtCoder Kingdom, Gregorian calendar is used, and dates are written in the ""year-month-day"" order, or the ""month-day"" order without the year.
For example, May 3, 2018 is written as 2018-5-3, or 5-3 without the year.  
In this country, a date is called Takahashi when the month and the day are equal as numbers. For example, 5-5 is Takahashi.
How many days from 2018-1-1 through 2018-a-b are Takahashi?




Constraints

a is an integer between 1 and 12 (inclusive).
b is an integer between 1 and 31 (inclusive).
2018-a-b is a valid date in Gregorian calendar.







Input
Input is given from Standard Input in the following format:
a b





Output
Print the number of days from 2018-1-1 through 2018-a-b that are Takahashi.






Sample Input 15 5





Sample Output 15

There are five days that are Takahashi: 1-1, 2-2, 3-3, 4-4 and 5-5.





Sample Input 22 1





Sample Output 21

There is only one day that is Takahashi: 1-1.





Sample Input 311 30





Sample Output 311

There are eleven days that are Takahashi: 1-1, 2-2, 3-3, 4-4, 5-5, 6-6, 7-7, 8-8, 9-9, 10-10 and 11-11.

",Day of Takahashi,"Boolean Operations On Geometric Objects, Arithmetic, Mathematics",0.667,271,151
489,"
Score : 300 points


Problem StatementYou are given a string S consisting of digits between 1 and 9, inclusive.
You can insert the letter + into some of the positions (possibly none) between two letters in this string.
Here, + must not occur consecutively after insertion.
All strings that can be obtained in this way can be evaluated as formulas.
Evaluate all possible formulas, and print the sum of the results.




Constraints
1 \leq |S| \leq 10
All letters in S are digits between 1 and 9, inclusive.







InputThe input is given from Standard Input in the following format:
S





OutputPrint the sum of the evaluated value over all possible formulas.






Sample Input 1125





Sample Output 1176

There are 4 formulas that can be obtained: 125, 1+25, 12+5 and 1+2+5. When each formula is evaluated,

125
1+25=26
12+5=17
1+2+5=8

Thus, the sum is 125+26+17+8=176.





Sample Input 29999999999





Sample Output 212656242944


",Many Formulas,"Bitmask, Enumeration, String, Parsing, Arithmetic",0.74,110,80
490,"
Score: 400 points


Problem statement
We have an H \times W grid whose squares are painted black or white. The square at the i-th row from the top and the j-th column from the left is denoted as (i, j).
Snuke would like to play the following game on this grid. At the beginning of the game, there is a character called Kenus at square (1, 1). The player repeatedly moves Kenus up, down, left or right by one square. The game is completed when Kenus reaches square (H, W) passing only white squares.
Before Snuke starts the game, he can change the color of some of the white squares to black. However, he cannot change the color of square (1, 1) and (H, W). Also, changes of color must all be carried out before the beginning of the game.
When the game is completed, Snuke's score will be the number of times he changed the color of a square before the beginning of the game. Find the maximum possible score that Snuke can achieve, or print -1 if the game cannot be completed, that is, Kenus can never reach square (H, W) regardless of how Snuke changes the color of the squares.  
The color of the squares are given to you as characters s_{i, j}. If square (i, j) is initially painted by white, s_{i, j} is .; if square (i, j) is initially painted by black, s_{i, j} is #.




Constraints

H is an integer between 2 and 50 (inclusive).
W is an integer between 2 and 50 (inclusive).
s_{i, j} is . or # (1 \leq i \leq H, 1 \leq j \leq W).
s_{1, 1} and s_{H, W} are ..







Input
Input is given from Standard Input in the following format:
H W
s_{1, 1}s_{1, 2}s_{1, 3} ... s_{1, W}
s_{2, 1}s_{2, 2}s_{2, 3} ... s_{2, W}
 :   :
s_{H, 1}s_{H, 2}s_{H, 3} ... s_{H, W}





Output
Print the maximum possible score that Snuke can achieve, or print -1 if the game cannot be completed.






Sample Input 13 3
..#
#..
...





Sample Output 12

The score 2 can be achieved by changing the color of squares as follows:






Sample Input 210 37
.....................................
...#...####...####..###...###...###..
..#.#..#...#.##....#...#.#...#.#...#.
..#.#..#...#.#.....#...#.#...#.#...#.
.#...#.#..##.#.....#...#.#.###.#.###.
.#####.####..#.....#...#..##....##...
.#...#.#...#.#.....#...#.#...#.#...#.
.#...#.#...#.##....#...#.#...#.#...#.
.#...#.####...####..###...###...###..
.....................................





Sample Output 2209


",Grid Repainting,"Graph Traversal, Breadth-first Search, Shortest Path, Grid Graph, Queue",0.508,125,65
491,"
Score : 600 points


Problem Statement
We have a tree with N vertices. The vertices are numbered 1 to N, and the i-th edge connects Vertex a_i and Vertex b_i.
Takahashi loves the number 3. He is seeking a permutation p_1, p_2, \ldots , p_N of integers from 1 to N satisfying the following condition:

For every pair of vertices (i, j), if the distance between Vertex i and Vertex j is 3, the sum or product of p_i and p_j is a multiple of 3.

Here the distance between Vertex i and Vertex j is the number of edges contained in the shortest path from Vertex i to Vertex j.
Help Takahashi by finding a permutation that satisfies the condition.




Constraints

2\leq N\leq 2\times 10^5
1\leq a_i, b_i \leq N
The given graph is a tree.







Input
Input is given from Standard Input in the following format:
N
a_1 b_1
a_2 b_2
\vdots
a_{N-1} b_{N-1}





Output
If no permutation satisfies the condition, print -1.
Otherwise, print a permutation satisfying the condition, with space in between.
If there are multiple solutions, you can print any of them.






Sample Input 15
1 2
1 3
3 4
3 5





Sample Output 11 2 5 4 3 

The distance between two vertices is 3 for the two pairs (2, 4) and (2, 5).

p_2 + p_4 = 6
p_2\times p_5 = 6

Thus, this permutation satisfies the condition.

",ThREE,"Graph Theory, Graph Traversal, Bipartite Graph, Arithmetic, Constructive, Greedy Algorithm",0.05,67,6
492,"
Score : 800 points


Problem StatementThere are N stores called Store 1, Store 2, \cdots, Store N. Takahashi, who is at his house at time 0, is planning to visit some of these stores.
It takes Takahashi one unit of time to travel from his house to one of the stores, or between any two stores.
If Takahashi reaches Store i at time t, he can do shopping there after standing in a queue for a_i \times t + b_i units of time. (We assume that it takes no time other than waiting.)
All the stores close at time T + 0.5. If Takahashi is standing in a queue for some store then, he cannot do shopping there.
Takahashi does not do shopping more than once in the same store.
Find the maximum number of times he can do shopping before time T + 0.5.




Constraints
All values in input are integers.
1 \leq N \leq 2 \times 10^5
0 \leq a_i \leq 10^9
0 \leq b_i \leq 10^9
0 \leq T \leq 10^9







InputInput is given from Standard Input in the following format:
N T
a_1 b_1
a_2 b_2
\vdots
a_N b_N





OutputPrint the answer.






Sample Input 13 7
2 0
3 2
0 3





Sample Output 12

Here is one possible way to visit stores:

From time 0 to time 1: in 1 unit of time, he travels from his house to Store 1.
From time 1 to time 3: for 2 units of time, he stands in a queue for Store 1 to do shopping.
From time 3 to time 4: in 1 unit of time, he travels from Store 1 to Store 3.
From time 4 to time 7: for 3 units of time, he stands in a queue for Store 3 to do shopping.

In this way, he can do shopping twice before time 7.5.





Sample Input 21 3
0 3





Sample Output 20






Sample Input 35 21600
2 14
3 22
1 3
1 10
1 9





Sample Output 35






Sample Input 47 57
0 25
3 10
2 4
5 15
3 22
2 14
1 15





Sample Output 43


",Manga Market,"Sorting, Dyanmic Programming, Greedy Algorithm, Mathematics",0.091,19,1
493,"
Score: 500 points


Problem Statement
Given is a permutation P of \{1, 2, \ldots, N\}.
For a pair (L, R) (1 \le L \lt R \le N), let X_{L, R} be the second largest value among P_L, P_{L+1}, \ldots, P_R.
Find \displaystyle \sum_{L=1}^{N-1} \sum_{R=L+1}^{N} X_{L,R}.




Constraints

 2 \le N \le 10^5 
 1 \le P_i \le N 
 P_i \neq P_j  (i \neq j)
All values in input are integers.







Input
Input is given from Standard Input in the following format:
N
P_1 P_2 \ldots P_N





Output
Print \displaystyle \sum_{L=1}^{N-1} \sum_{R=L+1}^{N} X_{L,R}.






Sample Input 13
2 3 1





Sample Output 15

X_{1, 2} = 2, X_{1, 3} = 2, and X_{2, 3} = 1, so the sum is 2 + 2 + 1 = 5.





Sample Input 25
1 2 3 4 5





Sample Output 230






Sample Input 38
8 2 7 3 4 5 6 1





Sample Output 3136


",Second Sum,"Binary Search Tree, Counting",0.375,54,13
494,"
Score : 600 points


Problem Statement
Takahashi has N cards. The i-th of these cards has an integer A_i written on it.
Takahashi will choose an integer K, and then repeat the following operation some number of times:

Choose exactly K cards such that the integers written on them are all different, and eat those cards. (The eaten cards disappear.)

For each K = 1,2, \ldots, N, find the maximum number of times Takahashi can do the operation.




Constraints

 1 \le N \le 3 \times 10^5 
 1 \le A_i \le N 
All values in input are integers.







Input
Input is given from Standard Input in the following format:
N
A_1 A_2 \ldots A_N





Output
Print N integers.
The t-th (1 \le t \le N) of them should be the answer for the case K=t.






Sample Input 13
2 1 2





Sample Output 13
1
0

For K = 1, we can do the operation as follows:

Choose the first card to eat.
Choose the second card to eat.
Choose the third card to eat.

For K = 2, we can do the operation as follows:

Choose the first and second cards to eat.

For K = 3, we cannot do the operation at all. Note that we cannot choose the first and third cards at the same time.





Sample Input 25
1 2 3 4 5





Sample Output 25
2
1
1
1






Sample Input 34
1 3 3 3





Sample Output 34
1
0
0


",Distinct Numbers,"Counting, Stack, Prefix sum, Binary Search, Greedy Algorithm, Sorting",0.222,43,8
495,"
Score : 400 points


Problem StatementTakahashi has a water bottle with the shape of a rectangular prism whose base is a square of side a~\mathrm{cm} and whose height is b~\mathrm{cm}. (The thickness of the bottle can be ignored.)
We will pour x~\mathrm{cm}^3 of water into the bottle, and gradually tilt the bottle around one of the sides of the base.
When will the water be spilled? More formally, find the maximum angle in which we can tilt the bottle without spilling any water.




Constraints
All values in input are integers.
1 \leq a \leq 100
1 \leq b \leq 100
1 \leq x \leq a^2b







InputInput is given from Standard Input in the following format:
a b x





OutputPrint the maximum angle in which we can tilt the bottle without spilling any water, in degrees.
Your output will be judged as correct when the absolute or relative error from the judge's output is at most 10^{-6}.






Sample Input 12 2 4





Sample Output 145.0000000000

This bottle has a cubic shape, and it is half-full. The water gets spilled when we tilt the bottle more than 45 degrees.





Sample Input 212 21 10





Sample Output 289.7834636934

This bottle is almost empty. When the water gets spilled, the bottle is nearly horizontal.





Sample Input 33 1 8





Sample Output 34.2363947991

This bottle is almost full. When the water gets spilled, the bottle is still nearly vertical.

",Water Bottle,"Geometry; 3d, Mathematics, Boolean Operations On Geometric Objects, Arithmetic",0.588,145,86
496,"
Score : 400 points


Problem StatementThere are N pieces of sushi. Each piece has two parameters: ""kind of topping"" t_i and ""deliciousness"" d_i.
You are choosing K among these N pieces to eat.
Your ""satisfaction"" here will be calculated as follows:

The satisfaction is the sum of the ""base total deliciousness"" and the ""variety bonus"".
The base total deliciousness is the sum of the deliciousness of the pieces you eat.
The variety bonus is x*x, where x is the number of different kinds of toppings of the pieces you eat.

You want to have as much satisfaction as possible.
Find this maximum satisfaction.




Constraints
1 \leq K \leq N  \leq 10^5
1 \leq t_i \leq N
1 \leq d_i \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N K
t_1 d_1
t_2 d_2
.
.
.
t_N d_N





OutputPrint the maximum satisfaction that you can obtain.






Sample Input 15 3
1 9
1 7
2 6
2 5
3 1





Sample Output 126

If you eat Sushi 1,2 and 3:

The base total deliciousness is 9+7+6=22.
The variety bonus is 2*2=4.

Thus, your satisfaction will be 26, which is optimal.





Sample Input 27 4
1 1
2 1
3 1
4 6
4 5
4 5
4 5





Sample Output 225

It is optimal to eat Sushi 1,2,3 and 4.





Sample Input 36 5
5 1000000000
2 990000000
3 980000000
6 970000000
6 960000000
4 950000000





Sample Output 34900000016

Note that the output may not fit into a 32-bit integer type.

",Various Sushi,"Greedy Algorithm, Sorting, Hashing, Priority Queue, Bruteforcing, Mathematics",0.133,87,22
497,"
Score : 300 points


Problem StatementYou are given an integer N. Among the integers between 1 and N (inclusive), how many Shichi-Go-San numbers (literally ""Seven-Five-Three numbers"") are there?
Here, a Shichi-Go-San number is a positive integer that satisfies the following condition:

When the number is written in base ten, each of the digits 7, 5 and 3 appears at least once, and the other digits never appear.





Constraints
1 \leq N < 10^9
N is an integer.







InputInput is given from Standard Input in the following format:
N





OutputPrint the number of the Shichi-Go-San numbers between 1 and N (inclusive).






Sample Input 1575





Sample Output 14

There are four Shichi-Go-San numbers not greater than 575: 357, 375, 537 and 573.





Sample Input 23600





Sample Output 213

There are 13 Shichi-Go-San numbers not greater than 3600: the above four numbers, 735, 753, 3357, 3375, 3537, 3557, 3573, 3575 and 3577.





Sample Input 3999999999





Sample Output 326484


",755,"Backtracking, Recursion, Bitmask, Combinatorics",0.5,150,68
498,"
Score : 400 points


Problem StatementYou are given an integer N. Among the divisors of N! (= 1 \times 2 \times ... \times N), how many Shichi-Go numbers (literally ""Seven-Five numbers"") are there?
Here, a Shichi-Go number is a positive integer that has exactly 75 divisors.




NoteWhen a positive integer A divides a positive integer B, A is said to a divisor of B.
For example, 6 has four divisors: 1, 2, 3 and 6.




Constraints
1 \leq N \leq 100
N is an integer.







InputInput is given from Standard Input in the following format:
N





OutputPrint the number of the Shichi-Go numbers that are divisors of N!.






Sample Input 19





Sample Output 10

There are no Shichi-Go numbers among the divisors of 9! = 1 \times 2 \times ... \times 9 = 362880.





Sample Input 210





Sample Output 21

There is one Shichi-Go number among the divisors of 10! = 3628800: 32400.





Sample Input 3100





Sample Output 3543


",756,"Sieve Of Eratosthenes, Prime Factorization, Arithmetic, Combinatorics, Number Theory",0.771,55,37
499,"
Score: 300 points


Problem StatementIn Republic of Atcoder, there are N prefectures, and a total of M cities that belong to those prefectures.
City i is established in year Y_i and belongs to Prefecture P_i.
You can assume that there are no multiple cities that are established in the same year.
It is decided to allocate a 12-digit ID number to each city.
If City i is the x-th established city among the cities that belong to Prefecture i, the first six digits of the ID number of City i is P_i, and the last six digits of the ID number is x.
Here, if P_i or x (or both) has less than six digits, zeros are added to the left until it has six digits.
Find the ID numbers for all the cities.
Note that there can be a prefecture with no cities.




Constraints
1 \leq N \leq 10^5
1 \leq M \leq 10^5
1 \leq P_i \leq N
1 \leq Y_i \leq 10^9
Y_i are all different.
All values in input are integers.







InputInput is given from Standard Input in the following format:
N M
P_1 Y_1
:
P_M Y_M





OutputPrint the ID numbers for all the cities, in ascending order of indices (City 1, City 2, ...).






Sample Input 12 3
1 32
2 63
1 12





Sample Output 1000001000002
000002000001
000001000001


As City 1 is the second established city among the cities that belong to Prefecture 1, its ID number is 000001000002.
As City 2 is the first established city among the cities that belong to Prefecture 2, its ID number is 000002000001.
As City 3 is the first established city among the cities that belong to Prefecture 1, its ID number is 000001000001.






Sample Input 22 3
2 55
2 77
2 99





Sample Output 2000002000001
000002000002
000002000003


",ID,"Sorting, Disjoint Set, Array, Implementation, Data Structures",0.286,318,104
500,"
Score: 300 points


Problem Statement
In the Ancient Kingdom of Snuke, there was a pyramid to strengthen the authority of Takahashi, the president of AtCoder Inc.
The pyramid had center coordinates (C_X, C_Y) and height H. The altitude of coordinates (X, Y) is max(H - |X - C_X| - |Y - C_Y|, 0).  
Aoki, an explorer, conducted a survey to identify the center coordinates and height of this pyramid. As a result, he obtained the following information:  

C_X, C_Y was integers between 0 and 100 (inclusive), and H was an integer not less than 1.  
Additionally, he obtained N pieces of information. The i-th of them is: ""the altitude of point (x_i, y_i) is h_i.""  

This was enough to identify the center coordinates and the height of the pyramid. Find these values with the clues above.  




Constraints

N is an integer between 1 and 100 (inclusive).
x_i and y_i are integers between 0 and 100 (inclusive).
h_i is an integer between 0 and 10^9 (inclusive).
The N coordinates (x_1, y_1), (x_2, y_2), (x_3, y_3), ..., (x_N, y_N) are all different.
The center coordinates and the height of the pyramid can be uniquely identified.







Input
Input is given from Standard Input in the following format:  
N
x_1 y_1 h_1
x_2 y_2 h_2
x_3 y_3 h_3
:
x_N y_N h_N





Output
Print values C_X, C_Y and H representing the center coordinates and the height of the pyramid in one line, with spaces in between.  






Sample Input 14
2 3 5
2 1 5
1 2 5
3 2 5





Sample Output 12 2 6

In this case, the center coordinates and the height can be identified as (2, 2) and 6.  





Sample Input 22
0 0 100
1 1 98





Sample Output 20 0 100

In this case, the center coordinates and the height can be identified as (0, 0) and 100.
Note that C_X and C_Y are known to be integers between 0 and 100.





Sample Input 33
99 1 191
100 1 192
99 0 192





Sample Output 3100 0 193

In this case, the center coordinates and the height can be identified as (100, 0) and 193.  

",Pyramid,"Bruteforcing, Geometry; 3d, Implementation, Heuristics",0.179,349,86
501,"
Score : 400 points


Problem StatementYou are given integers N and M.
Consider a sequence a of length N consisting of positive integers such that a_1 + a_2 + ... + a_N = M. Find the maximum possible value of the greatest common divisor of a_1, a_2, ..., a_N.




Constraints
All values in input are integers.
1 \leq N \leq 10^5
N \leq M \leq 10^9







InputInput is given from Standard Input in the following format:
N M





OutputPrint the maximum possible value of the greatest common divisor of a sequence a_1, a_2, ..., a_N that satisfies the condition.






Sample Input 13 14





Sample Output 12

Consider the sequence (a_1, a_2, a_3) = (2, 4, 8). Their greatest common divisor is 2, and this is the maximum value.





Sample Input 210 123





Sample Output 23






Sample Input 3100000 1000000000





Sample Output 310000


",Partition,"Number Theory, Data Structures, Mathematics, Greedy Algorithm",0.419,249,74
502,"
Score : 600 points


Problem StatementSnuke is introducing a robot arm with the following properties to his factory:

The robot arm consists of m sections and m+1 joints. The sections are numbered 1, 2, ..., m, and the joints are numbered 0, 1, ..., m. Section i connects Joint i-1 and Joint i. The length of Section i is d_i.
For each section, its mode can be specified individually. There are four modes: L, R, D and U. The mode of a section decides the direction of that section. If we consider the factory as a coordinate plane, the position of Joint i will be determined as follows (we denote its coordinates as (x_i, y_i)):
(x_0, y_0) = (0, 0).
If the mode of Section i is L, (x_{i}, y_{i}) = (x_{i-1} - d_{i}, y_{i-1}).
If the mode of Section i is R, (x_{i}, y_{i}) = (x_{i-1} + d_{i}, y_{i-1}).
If the mode of Section i is D, (x_{i}, y_{i}) = (x_{i-1}, y_{i-1} - d_{i}).
If the mode of Section i is U, (x_{i}, y_{i}) = (x_{i-1}, y_{i-1} + d_{i}).



Snuke would like to introduce a robot arm so that the position of Joint m can be matched with all of the N points (X_1, Y_1), (X_2, Y_2), ..., (X_N, Y_N) by properly specifying the modes of the sections.
Is this possible?
If so, find such a robot arm and how to bring Joint m to each point (X_j, Y_j).




Constraints
All values in input are integers.
1 \leq N \leq 1000
-10^9 \leq X_i \leq 10^9
-10^9 \leq Y_i \leq 10^9





Partial Score
In the test cases worth 300 points, -10 \leq X_i \leq 10 and -10 \leq Y_i \leq 10 hold.







InputInput is given from Standard Input in the following format:
N
X_1 Y_1
X_2 Y_2
:
X_N Y_N





OutputIf the condition can be satisfied, follow the following format. If the condition cannot be satisfied, print -1.
m
d_1 d_2 ... d_m
w_1
w_2
:
w_N

m and d_i are the configurations of the robot arm. Refer to the problem statement for what each of them means.
Here, 1 \leq m \leq 40 and 1 \leq d_i \leq 10^{12} must hold. Also, m and d_i must all be integers.
w_j is a string of length m that represents the way to bring Joint m of the robot arm to point (X_j, Y_j).
The i-th character of w_j should be one of the letters L, R, D and U, representing the mode of Section i.






Sample Input 13
-1 0
0 3
2 -1





Sample Output 12
1 2
RL
UU
DR

In the given way to bring Joint m of the robot arm to each (X_j, Y_j), the positions of the joints will be as follows:

To (X_1, Y_1) = (-1, 0): First, the position of Joint 0 is (x_0, y_0) = (0, 0). As the mode of Section 1 is R, the position of Joint 1 is (x_1, y_1) = (1, 0). Then, as the mode of Section 2 is L, the position of Joint 2 is (x_2, y_2) = (-1, 0).
To (X_2, Y_2) = (0, 3): (x_0, y_0) = (0, 0), (x_1, y_1) = (0, 1), (x_2, y_2) = (0, 3).
To (X_3, Y_3) = (2, -1): (x_0, y_0) = (0, 0), (x_1, y_1) = (0, -1), (x_2, y_2) = (2, -1).






Sample Input 25
0 0
1 0
2 0
3 0
4 0





Sample Output 2-1






Sample Input 32
1 1
1 1





Sample Output 32
1 1
RU
UR

There may be duplicated points among (X_j, Y_j).





Sample Input 43
-7 -3
7 3
-3 -7





Sample Output 45
3 1 4 1 5
LRDUL
RDULR
DULRD


",Robot Arms,"Parity, Greedy Algorithm, Bitmask, Geometry; 3d, Constructive, Mathematics",0.125,18,4
503,"
Score : 200 points


Problem Statement
Niwango created a playlist of N songs.
The title and the duration of the i-th song are s_i and t_i seconds, respectively.
It is guaranteed that s_1,\ldots,s_N are all distinct.
Niwango was doing some work while playing this playlist. (That is, all the songs were played once, in the order they appear in the playlist, without any pause in between.)
However, he fell asleep during his work, and he woke up after all the songs were played.
According to his record, it turned out that he fell asleep at the very end of the song titled X.
Find the duration of time when some song was played while Niwango was asleep.




Constraints

1 \leq N \leq 50
s_i and X are strings of length between 1 and 100 (inclusive) consisting of lowercase English letters.
s_1,\ldots,s_N are distinct.
There exists an integer i such that s_i = X.
1 \leq t_i \leq 1000
t_i is an integer.







Input
Input is given from Standard Input in the following format:
N
s_1 t_1
\vdots
s_{N} t_N
X





Output
Print the answer.






Sample Input 13
dwango 2
sixth 5
prelims 25
dwango





Sample Output 130


While Niwango was asleep, two songs were played: sixth and prelims.
The answer is the total duration of these songs, 30.






Sample Input 21
abcde 1000
abcde





Sample Output 20


No songs were played while Niwango was asleep.
In such a case, the total duration of songs is 0.






Sample Input 315
ypnxn 279
kgjgwx 464
qquhuwq 327
rxing 549
pmuduhznoaqu 832
dagktgdarveusju 595
wunfagppcoi 200
dhavrncwfw 720
jpcmigg 658
wrczqxycivdqn 639
mcmkkbnjfeod 992
htqvkgkbhtytsz 130
twflegsjz 467
dswxxrxuzzfhkp 989
szfwtzfpnscgue 958
pmuduhznoaqu





Sample Output 36348


",Falling Asleep,"Array, Prefix sum, Arithmetic",0.765,76,49
504,"
Score : 500 points


Problem StatementFor a finite set of integers X, let f(X)=\max X - \min X.
Given are N integers A_1,...,A_N.
We will choose K of them and let S be the set of the integers chosen. If we distinguish elements with different indices even when their values are the same, there are {}_N C_K ways to make this choice. Find the sum of f(S) over all those ways.
Since the answer can be enormous, print it \bmod (10^9+7).




Constraints
1 \leq N \leq 10^5
1 \leq K \leq N
|A_i| \leq 10^9







InputInput is given from Standard Input in the following format:
N K
A_1 ... A_N





OutputPrint the answer \bmod (10^9+7).






Sample Input 14 2
1 1 3 4





Sample Output 111

There are six ways to choose S: \{1,1\},\{1,3\},\{1,4\},\{1,3\},\{1,4\}, \{3,4\} (we distinguish the two 1s). The value of f(S) for these choices are 0,2,3,2,3,1, respectively, for the total of 11.





Sample Input 26 3
10 10 10 -10 -10 -10





Sample Output 2360

There are 20 ways to choose S. In 18 of them, f(S)=20, and in 2 of them, f(S)=0.





Sample Input 33 1
1 1 1





Sample Output 30






Sample Input 410 6
1000000000 1000000000 1000000000 1000000000 1000000000 0 0 0 0 0





Sample Output 4999998537

Print the sum \bmod (10^9+7).

",Max-Min Sums,"Sorting, Combinatorics, Arithmetic, Prefix sum, Counting, Bruteforcing",0.5,85,30
505,"
Score : 500 points


Problem StatementFor two sequences S and T of length N consisting of 0 and 1, let us define f(S, T) as follows:


Consider repeating the following operation on S so that S will be equal to T. f(S, T) is the minimum possible total cost of those operations.

Change S_i (from 0 to 1 or vice versa). The cost of this operation is D \times C_i, where D is the number of integers j such that S_j \neq T_j (1 \leq j \leq N) just before this change.



There are 2^N \times (2^N - 1) pairs (S, T) of different sequences of length N consisting of 0 and 1. Compute the sum of f(S, T) over all of those pairs, modulo (10^9+7).




Constraints
1 \leq N \leq 2 \times 10^5
1 \leq C_i \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
C_1 C_2 \cdots C_N





OutputPrint the sum of f(S, T), modulo (10^9+7).






Sample Input 11
1000000000





Sample Output 1999999993

There are two pairs (S, T) of different sequences of length 2 consisting of 0 and 1, as follows:

S = (0), T = (1): by changing S_1 to 1, we can have S = T at the cost of 1000000000, so f(S, T) = 1000000000.
S = (1), T = (0): by changing S_1 to 0, we can have S = T at the cost of 1000000000, so f(S, T) = 1000000000.

The sum of these is 2000000000, and we should print it modulo (10^9+7), that is, 999999993.





Sample Input 22
5 8





Sample Output 2124

There are 12 pairs (S, T) of different sequences of length 3 consisting of 0 and 1, which include:

S = (0, 1), T = (1, 0)

In this case, if we first change S_1 to 1 then change S_2 to 0, the total cost is 5 \times 2 + 8 = 18. We cannot have S = T at a smaller cost, so f(S, T) = 18.





Sample Input 35
52 67 72 25 79





Sample Output 3269312


",Change a Little Bit,"Greedy Algorithm, Combinatorics, Sorting, Arithmetic, Exponentiation By Squaring, Precomputation",0.667,14,9
506,"
Score : 200 points


Problem StatementKurohashi has never participated in AtCoder Beginner Contest (ABC).
The next ABC to be held is ABC N (the N-th ABC ever held).
Kurohashi wants to make his debut in some ABC x such that all the digits of x in base ten are the same.
What is the earliest ABC where Kurohashi can make his debut?




Constraints
100 \leq N \leq 999
N is an integer.







InputInput is given from Standard Input in the following format:
N





OutputIf the earliest ABC where Kurohashi can make his debut is ABC n, print n.






Sample Input 1111





Sample Output 1111

The next ABC to be held is ABC 111, where Kurohashi can make his debut.





Sample Input 2112





Sample Output 2222

The next ABC to be held is ABC 112, which means Kurohashi can no longer participate in ABC 111.
Among the ABCs where Kurohashi can make his debut, the earliest one is ABC 222.





Sample Input 3750





Sample Output 3777


",AtCoder Beginner Contest 111,"Bruteforcing, Implementation, Arithmetic, Greedy Algorithm",0.757,211,139
507,"
Score : 200 points


Problem StatementA sequence a=\{a_1,a_2,a_3,......\} is determined as follows:


The first term s is given as input.


Let f(n) be the following function: f(n) = n/2 if n is even, and f(n) = 3n+1 if n is odd.


a_i = s when i = 1, and a_i = f(a_{i-1}) when i > 1.


Find the minimum integer m that satisfies the following condition:

There exists an integer n such that a_m = a_n (m > n).





Constraints
1 \leq s \leq 100
All values in input are integers.
It is guaranteed that all elements in a and the minimum m that satisfies the condition are at most 1000000.







InputInput is given from Standard Input in the following format:
s





OutputPrint the minimum integer m that satisfies the condition.






Sample Input 18





Sample Output 15

a=\{8,4,2,1,4,2,1,4,2,1,......\}. As a_5=a_2, the answer is 5.





Sample Input 27





Sample Output 218

a=\{7,22,11,34,17,52,26,13,40,20,10,5,16,8,4,2,1,4,2,1,......\}.





Sample Input 354





Sample Output 3114


",Collatz Problem,"Recursion, Boolean Operations On Geometric Objects, Hashing, Bruteforcing",0.759,209,137
508,"
Score : 100 points


Problem StatementDetermine if we can choose K different integers between 1 and N (inclusive) so that no two of them differ by 1.




Constraints
1\leq N,K\leq 100
N and K are integers.







InputInput is given from Standard Input in the following format:
N K





OutputIf we can choose K integers as above, print YES; otherwise, print NO.






Sample Input 13 2





Sample Output 1YES

We can choose 1 and 3.





Sample Input 25 5





Sample Output 2NO






Sample Input 331 10





Sample Output 3YES






Sample Input 410 90





Sample Output 4NO


",Anti-Adjacency,"Arithmetic, Mathematics, Implementation",0.595,148,65
509,"
Score : 200 points


Problem StatementThere are four towns, numbered 1,2,3 and 4.
Also, there are three roads. The i-th road connects different towns a_i and b_i bidirectionally.
No two roads connect the same pair of towns. Other than these roads, there is no way to travel between these towns, but any town can be reached from any other town using these roads.
Determine if we can visit all the towns by traversing each of the roads exactly once.




Constraints
1 \leq a_i,b_i \leq 4(1\leq i\leq 3)
a_i and b_i are different. (1\leq i\leq 3)
No two roads connect the same pair of towns.
Any town can be reached from any other town using the roads.







InputInput is given from Standard Input in the following format:
a_1 b_1
a_2 b_2
a_3 b_3





OutputIf we can visit all the towns by traversing each of the roads exactly once, print YES; otherwise, print NO.






Sample Input 14 2
1 3
2 3





Sample Output 1YES

We can visit all the towns in the order 1,3,2,4.





Sample Input 23 2
2 4
1 2





Sample Output 2NO






Sample Input 32 1
3 2
4 3





Sample Output 3YES


",Path,"Graph Theory, Bruteforcing, Boolean Operations On Geometric Objects",0.829,92,72
510,"
Score : 200 points


Problem StatementWhen Mr. X is away from home, he has decided to use his smartwatch to search the best route to go back home, to participate in ABC.
You, the smartwatch, has found N routes to his home.
If Mr. X uses the i-th of these routes, he will get home in time t_i at cost c_i.
Find the smallest cost of a route that takes not longer than time T.




Constraints
All values in input are integers.
1 \leq N \leq 100
1 \leq T \leq 1000
1 \leq c_i \leq 1000
1 \leq t_i \leq 1000
The pairs (c_i, t_i) are distinct.







InputInput is given from Standard Input in the following format:
N T
c_1 t_1
c_2 t_2
:
c_N t_N





OutputPrint the smallest cost of a route that takes not longer than time T.
If there is no route that takes not longer than time T, print TLE instead.






Sample Input 13 70
7 60
1 80
4 50





Sample Output 14


The first route gets him home at cost 7.
The second route takes longer than time T = 70.
The third route gets him home at cost 4.

Thus, the cost 4 of the third route is the minimum.





Sample Input 24 3
1 1000
2 4
3 1000
4 500





Sample Output 2TLE

There is no route that takes not longer than time T = 3.





Sample Input 35 9
25 8
5 9
4 10
1000 1000
6 1





Sample Output 35


",Time Limit Exceeded,"Bruteforcing, Implementation, Data Structure",0.717,249,161
511,"
Score : 200 points


Problem StatementThere are N participants in the CODE FESTIVAL 2016 Qualification contests. The participants are either students in Japan, students from overseas, or neither of these.
Only Japanese students or overseas students can pass the Qualification contests. The students pass when they satisfy the conditions listed below, from the top rank down. Participants who are not students cannot pass the Qualification contests.

A Japanese student passes the Qualification contests if the number of the participants who have already definitively passed is currently fewer than A+B.
An overseas student passes the Qualification contests if the number of the participants who have already definitively passed is currently fewer than A+B and the student ranks B-th or above among all overseas students.

A string S is assigned indicating attributes of all participants. If the i-th character of string S is a, this means the participant ranked i-th in the Qualification contests is a Japanese student; b means the participant ranked i-th is an overseas student; and c means the participant ranked i-th is neither of these.
Write a program that outputs for all the participants in descending rank either Yes if they passed the Qualification contests or No if they did not pass.




Constraints
1≦N,A,B≦100000
A+B≦N
S is N characters long.
S consists only of the letters a, b and c.







InputInputs are provided from Standard Input in the following form.
N A B
S





OutputOutput N lines. On the i-th line, output Yes if the i-th participant passed the Qualification contests or No if that participant did not pass.






Sample Input 110 2 3
abccabaabb





Sample Output 1Yes
Yes
No
No
Yes
Yes
Yes
No
No
No

The first, second, fifth, sixth, and seventh participants pass the Qualification contests.





Sample Input 212 5 2
cabbabaacaba





Sample Output 2No
Yes
Yes
Yes
Yes
No
Yes
Yes
No
Yes
No
No

The sixth participant is third among overseas students and thus does not pass the Qualification contests.





Sample Input 35 2 2
ccccc





Sample Output 3No
No
No
No
No


",Qualification simulator,"Greedy Algorithm, Counting, Boolean Operations On Geometric Objects, Bruteforcing",0.737,122,78
512,"
Score : 200 points


Problem StatementAtCoDeer the deer has found two positive integers, a and b.
Determine whether the concatenation of a and b in this order is a square number.




Constraints
1 ≤ a,b ≤ 100
a and b are integers.







InputInput is given from Standard Input in the following format:
a b





OutputIf the concatenation of a and b in this order is a square number, print Yes; otherwise, print No.






Sample Input 11 21





Sample Output 1Yes

As 121 = 11 × 11, it is a square number.





Sample Input 2100 100





Sample Output 2No

100100 is not a square number.





Sample Input 312 10





Sample Output 3No


",1 21,"String, Implementation, Mathematics",0.753,289,187
513,"
Score : 300 points


Problem StatementTakahashi, Aoki and Snuke love cookies. They have A, B and C cookies, respectively. Now, they will exchange those cookies by repeating the action below:

Each person simultaneously divides his cookies in half and gives one half to each of the other two persons.

This action will be repeated until there is a person with odd number of cookies in hand.
How many times will they repeat this action?
Note that the answer may not be finite.




Constraints
1 ≤ A,B,C ≤ 10^9







InputInput is given from Standard Input in the following format:
A B C





OutputPrint the number of times the action will be performed by the three people, if this number is finite.
If it is infinite, print -1 instead.






Sample Input 14 12 20





Sample Output 13

Initially, Takahashi, Aoki and Snuke have 4, 12 and 20 cookies. Then,

After the first action, they have 16, 12 and 8.
After the second action, they have 10, 12 and 14.
After the third action, they have 13, 12 and 11.

Now, Takahashi and Snuke have odd number of cookies, and therefore the answer is 3.





Sample Input 214 14 14





Sample Output 2-1






Sample Input 3454 414 444





Sample Output 31


",Cookie Exchanges,"Bruteforcing, Parity, Dynamic Programming, Graph Theory, Implementation",0.45,135,56
514,"
Score : 200 points


Problem StatementThere are N + 1 squares arranged in a row, numbered 0, 1, ..., N from left to right.
Initially, you are in Square X.
You can freely travel between adjacent squares. Your goal is to reach Square 0 or Square N.
However, for each i = 1, 2, ..., M, there is a toll gate in Square A_i, and traveling to Square A_i incurs a cost of 1.
It is guaranteed that there is no toll gate in Square 0, Square X and Square N.
Find the minimum cost incurred before reaching the goal.




Constraints
1 \leq N \leq 100
1 \leq M \leq 100
1 \leq X \leq N - 1
1 \leq A_1 < A_2 < ... < A_M \leq N
A_i \neq X
All values in input are integers.







InputInput is given from Standard Input in the following format:
N M X
A_1 A_2 ... A_M





OutputPrint the minimum cost incurred before reaching the goal.






Sample Input 15 3 3
1 2 4





Sample Output 11

The optimal solution is as follows:

First, travel from Square 3 to Square 4. Here, there is a toll gate in Square 4, so the cost of 1 is incurred.
Then, travel from Square 4 to Square 5. This time, no cost is incurred.
Now, we are in Square 5 and we have reached the goal.

In this case, the total cost incurred is 1.





Sample Input 27 3 2
4 5 6





Sample Output 20

We may be able to reach the goal at no cost.





Sample Input 310 7 5
1 2 3 4 6 8 9





Sample Output 33


",Toll Gates,"Counting, Boolean Operations On Geometric Objects, Array, Greedy Algorithm",0.863,185,143
515,"
Score : 500 points


Problem StatementYou are going to hold a competition of one-to-one game called AtCoder Janken. (Janken is the Japanese name for Rock-paper-scissors.)
N players will participate in this competition, and they are given distinct integers from 1 through N.
The arena has M playing fields for two players. You need to assign each playing field two distinct integers between 1 and N (inclusive).
You cannot assign the same integer to multiple playing fields.
The competition consists of N rounds, each of which proceeds as follows:

For each player, if there is a playing field that is assigned the player's integer, the player goes to that field and fight the other player who comes there.
Then, each player adds 1 to its integer. If it becomes N+1, change it to 1.

You want to ensure that no player fights the same opponent more than once during the N rounds.
Print an assignment of integers to the playing fields satisfying this condition.
It can be proved that such an assignment always exists under the constraints given.




Constraints
1 \leq M
M \times 2 +1 \leq N \leq 200000







InputInput is given from Standard Input in the following format:
N M





OutputPrint M lines in the format below.
The i-th line should contain the two integers a_i and b_i assigned to the i-th playing field.
a_1 b_1
a_2 b_2
:
a_M b_M







Sample Input 14 1





Sample Output 12 3

Let us call the four players A, B, C, and D, and assume that they are initially given the integers 1, 2, 3, and 4, respectively.


The 1-st round is fought by B and C, who has the integers 2 and 3, respectively. After this round, A, B, C, and D have the integers 2, 3, 4, and 1, respectively.


The 2-nd round is fought by A and B, who has the integers 2 and 3, respectively. After this round, A, B, C, and D have the integers 3, 4, 1, and 2, respectively.


The 3-rd round is fought by D and A, who has the integers 2 and 3, respectively. After this round, A, B, C, and D have the integers 4, 1, 2, and 3, respectively.


The 4-th round is fought by C and D, who has the integers 2 and 3, respectively. After this round, A, B, C, and D have the integers 1, 2, 3, and 4, respectively.


No player fights the same opponent more than once during the four rounds, so this solution will be accepted.





Sample Input 27 3





Sample Output 21 6
2 5
3 4


",Rotation Matching,"Two-pointer, Arithmetic, Constructive, Tree",0.086,179,19
516,"
Score : 300 points


Problem StatementFind the maximum possible sum of the digits (in base 10) of a positive integer not greater than N.




Constraints
1\leq N \leq 10^{16}
N is an integer.







InputInput is given from Standard Input in the following format:
N





OutputPrint the maximum possible sum of the digits (in base 10) of a positive integer not greater than N.






Sample Input 1100





Sample Output 118

For example, the sum of the digits in 99 is 18, which turns out to be the maximum value.





Sample Input 29995





Sample Output 235

For example, the sum of the digits in 9989 is 35, which turns out to be the maximum value.





Sample Input 33141592653589793





Sample Output 3137


",Digit Sum 2,"Greedy Algorithm, String, Digit Dp, Array, Arithmetic",0.491,98,48
517,"
Score : 100 points


Problem StatementCODE FESTIVAL 2016 is going to be held. For the occasion, Mr. Takahashi decided to make a signboard.
He intended to write CODEFESTIVAL2016 on it, but he mistakenly wrote a different string S. Fortunately, the string he wrote was the correct length.
So Mr. Takahashi decided to perform an operation that replaces a certain character with another in the minimum number of iterations, changing the string to CODEFESTIVAL2016.
Find the minimum number of iterations for the rewrite operation.




Constraints
S is 16 characters long.
S consists of uppercase and lowercase alphabet letters and numerals.







InputInputs are provided from Standard Input in the following form.
S





OutputOutput an integer representing the minimum number of iterations needed for the rewrite operation.






Sample Input 1C0DEFESTIVAL2O16





Sample Output 12

The second character 0 must be changed to O and the 14th character O changed to 0.





Sample Input 2FESTIVAL2016CODE





Sample Output 216


",Signboard,"String, Bruteforcing, Counting",0.833,76,53
518,"
Score : 100 points


Problem StatementTwo students of AtCoder Kindergarten are fighting over candy packs.
There are three candy packs, each of which contains a, b, and c candies, respectively.
Teacher Evi is trying to distribute the packs between the two students so that each student gets the same number of candies. Determine whether it is possible.
Note that Evi cannot take candies out of the packs, and the whole contents of each pack must be given to one of the students.




Constraints
1 ≦ a, b, c ≦ 100







InputThe input is given from Standard Input in the following format:
a b c





OutputIf it is possible to distribute the packs so that each student gets the same number of candies, print Yes. Otherwise, print No.






Sample Input 110 30 20





Sample Output 1Yes

Give the pack with 30 candies to one student, and give the two packs with 10 and 20 candies to the other. Then, each gets 30 candies.





Sample Input 230 30 100





Sample Output 2No

In this case, the student who gets the pack with 100 candies always has more candies than the other.
Note that every pack must be given to one of them.





Sample Input 356 25 31





Sample Output 3Yes


",Fighting over Candies,"Implementation, Arithmetic, Dynamic Programming",0.689,275,162
519,"
Score : 400 points


Problem StatementGiven is a string S consisting of L and R.
Let N be the length of S. There are N squares arranged from left to right, and the i-th character of S from the left is written on the i-th square from the left.
The character written on the leftmost square is always R, and the character written on the rightmost square is always L.
Initially, one child is standing on each square.
Each child will perform the move below 10^{100} times:

Move one square in the direction specified by the character written in the square on which the child is standing. L denotes left, and R denotes right.

Find the number of children standing on each square after the children performed the moves.




Constraints
S is a string of length between 2 and 10^5 (inclusive).
Each character of S is L or R.
The first and last characters of S are R and L, respectively.







InputInput is given from Standard Input in the following format:
S





OutputPrint the number of children standing on each square after the children performed the moves, in order from left to right.






Sample Input 1RRLRL





Sample Output 10 1 2 1 1


After each child performed one move, the number of children standing on each square is 0, 2, 1, 1, 1 from left to right.
After each child performed two moves, the number of children standing on each square is 0, 1, 2, 1, 1 from left to right.
After each child performed 10^{100} moves, the number of children standing on each square is 0, 1, 2, 1, 1 from left to right.






Sample Input 2RRLLLLRLRRLL





Sample Output 20 3 3 0 0 0 1 1 0 2 2 0






Sample Input 3RRRLLRLLRRRLLLLL





Sample Output 30 0 3 2 0 2 1 0 0 0 4 4 0 0 0 0


",Gathering Children,"Parsing, Two-pointer, Arithmetic, Array",0.549,214,93
520,"
Score : 200 points


Problem StatementYou are given three strings A, B and C. Each of these is a string of length N consisting of lowercase English letters.
Our objective is to make all these three strings equal. For that, you can repeatedly perform the following operation:

Operation: Choose one of the strings A, B and C, and specify an integer i between 1 and N (inclusive). Change the i-th character from the beginning of the chosen string to some other lowercase English letter.

What is the minimum number of operations required to achieve the objective?




Constraints
1 \leq N \leq 100
Each of the strings A, B and C is a string of length N.
Each character in each of the strings A, B and C is a lowercase English letter.







InputInput is given from Standard Input in the following format:
N
A
B
C





OutputPrint the minimum number of operations required.






Sample Input 14
west
east
wait





Sample Output 13

In this sample, initially A = west、B = east、C = wait. We can achieve the objective in the minimum number of operations by performing three operations as follows:

Change the second character in A to a. A is now wast.
Change the first character in B to w. B is now wast.
Change the third character in C to s. C is now wast.






Sample Input 29
different
different
different





Sample Output 20

If A, B and C are already equal in the beginning, the number of operations required is 0.





Sample Input 37
zenkoku
touitsu
program





Sample Output 313


",Touitsu,"Bruteforcing, Boolean Operations On Geometric Objects, Greedy Algorithm",0.778,76,51
521,"
Score : 300 points


Problem StatementYou are given an integer sequence of length N, a_1,a_2,...,a_N.
For each 1≤i≤N, you have three choices: add 1 to a_i, subtract 1 from a_i or do nothing.
After these operations, you select an integer X and count the number of i such that a_i=X.
Maximize this count by making optimal choices.




Constraints
1≤N≤10^5
0≤a_i<10^5 (1≤i≤N)
a_i is an integer.







InputThe input is given from Standard Input in the following format:
N
a_1 a_2 .. a_N





OutputPrint the maximum possible number of i such that a_i=X.






Sample Input 17
3 1 4 1 5 9 2





Sample Output 14

For example, turn the sequence into 2,2,3,2,6,9,2 and select X=2 to obtain 4, the maximum possible count.





Sample Input 210
0 1 2 3 4 5 6 7 8 9





Sample Output 23






Sample Input 31
99999





Sample Output 31


",Together,"Counting, Bruteforcing, Sliding Window, Set / Map, Hashing, Mathematics",0.543,187,92
522,"
Score : 300 points


Problem StatementIroha is very particular about numbers. There are K digits that she dislikes: D_1, D_2, ..., D_K.
She is shopping, and now paying at the cashier.
Her total is N yen (the currency of Japan), thus she has to hand at least N yen to the cashier (and possibly receive the change).
However, as mentioned before, she is very particular about numbers. When she hands money to the cashier, the decimal notation of the amount must not contain any digits that she dislikes. Under this condition, she will hand the minimum amount of money.
Find the amount of money that she will hand to the cashier.




Constraints
 1 ≦ N < 10000
 1 ≦ K < 10
 0 ≦ D_1 < D_2 < … < D_K≦9
\{D_1,D_2,...,D_K\} ≠ \{1,2,3,4,5,6,7,8,9\}







InputThe input is given from Standard Input in the following format:
N K
D_1 D_2 … D_K





OutputPrint the amount of money that Iroha will hand to the cashier.






Sample Input 11000 8
1 3 4 5 6 7 8 9





Sample Output 12000

She dislikes all digits except 0 and 2.
The smallest integer equal to or greater than N=1000 whose decimal notation contains only 0 and 2, is 2000.





Sample Input 29999 1
0





Sample Output 29999


",Iroha's Obsession,"Bruteforcing, String, Set / Map",0.318,528,137
523,"
Score : 300 points


Problem StatementYou are given an integer sequence of length n, a_1, ..., a_n.
Let us consider performing the following n operations on an empty sequence b.
The i-th operation is as follows:

Append a_i to the end of b.
Reverse the order of the elements in b.

Find the sequence b obtained after these n operations.




Constraints
1 \leq n \leq 2\times 10^5
0 \leq a_i \leq 10^9
n and a_i are integers.







InputInput is given from Standard Input in the following format:
n
a_1 a_2 ... a_n





OutputPrint n integers in a line with spaces in between.
The i-th integer should be b_i.






Sample Input 14
1 2 3 4





Sample Output 14 2 1 3


After step 1 of the first operation, b becomes: 1.
After step 2 of the first operation, b becomes: 1.
After step 1 of the second operation, b becomes: 1, 2.
After step 2 of the second operation, b becomes: 2, 1.
After step 1 of the third operation, b becomes: 2, 1, 3.
After step 2 of the third operation, b becomes: 3, 1, 2.
After step 1 of the fourth operation, b becomes: 3, 1, 2, 4.
After step 2 of the fourth operation, b becomes: 4, 2, 1, 3.

Thus, the answer is 4 2 1 3.





Sample Input 23
1 2 3





Sample Output 23 1 2

As shown above in Sample Output 1, b becomes 3, 1, 2 after step 2 of the third operation. Thus, the answer is 3 1 2.





Sample Input 31
1000000000





Sample Output 31000000000






Sample Input 46
0 6 7 6 7 0





Sample Output 40 6 6 0 7 7


",pushpush,"Deque, Simulation, Parity, Dynamic Programming, Bruteforcing",0.39,226,82
524,"
Score : 300 points


Problem StatementWe have N sticks with negligible thickness.
The length of the i-th stick is A_i.
Snuke wants to select four different sticks from these sticks and form a rectangle (including a square), using the sticks as its sides.
Find the maximum possible area of the rectangle.




Constraints
4 \leq N \leq 10^5
1 \leq A_i \leq 10^9
A_i is an integer.







InputInput is given from Standard Input in the following format:
N
A_1 A_2 ... A_N





OutputPrint the maximum possible area of the rectangle.
If no rectangle can be formed, print 0.






Sample Input 16
3 1 2 4 2 1





Sample Output 12

1 \times 2 rectangle can be formed.





Sample Input 24
1 2 3 4





Sample Output 20

No rectangle can be formed.





Sample Input 310
3 3 3 3 4 4 4 5 5 5





Sample Output 320


",Make a Rectangle,"Sorting, Two-pointer, Greedy Algorithm, Array",0.279,136,41
525,"
Score : 300 points


Problem StatementSnuke loves puzzles.
Today, he is working on a puzzle using S- and c-shaped pieces.
In this puzzle, you can combine two c-shaped pieces into one S-shaped piece, as shown in the figure below:



Snuke decided to create as many Scc groups as possible by putting together one S-shaped piece and two c-shaped pieces.
Find the maximum number of Scc groups that can be created when Snuke has N S-shaped pieces and M c-shaped pieces.




Constraints
1 ≤ N,M ≤ 10^{12}







InputThe input is given from Standard Input in the following format:
N M





OutputPrint the answer.






Sample Input 11 6





Sample Output 12

Two Scc groups can be created as follows:

Combine two c-shaped pieces into one S-shaped piece
Create two Scc groups, each from one S-shaped piece and two c-shaped pieces






Sample Input 212345 678901





Sample Output 2175897


",Scc Puzzle,"Greedy Algorithm, Mathematics, Arithmetic, Boolean Operations On Geometric Objects",0.432,93,37
526,"
Score : 400 points


Problem StatementSnuke has a string S consisting of three kinds of letters: a, b and c.
He has a phobia for palindromes, and wants to permute the characters in S so that S will not contain a palindrome of length 2 or more as a substring. Determine whether this is possible.




Constraints
1 \leq |S| \leq 10^5
S consists of a, b and c.







InputInput is given from Standard Input in the following format:
S





OutputIf the objective is achievable, print YES; if it is unachievable, print NO.






Sample Input 1abac





Sample Output 1YES

As it stands now, S contains a palindrome aba, but we can permute the characters to get acba, for example, that does not contain a palindrome of length 2 or more.





Sample Input 2aba





Sample Output 2NO






Sample Input 3babacccabab





Sample Output 3YES


",Palindrome-phobia,"Counting, Mathematics, String, Boolean Operations On Geometric Objects",0.8,20,15
527,"
Score : 300 points


Problem StatementThere is a sequence of length N: A_1, A_2, ..., A_N. Initially, this sequence is a permutation of 1, 2, ..., N.
On this sequence, Snuke can perform the following operation:

Choose K consecutive elements in the sequence. Then, replace the value of each chosen element with the minimum value among the chosen elements.

Snuke would like to make all the elements in this sequence equal by repeating the operation above some number of times.
Find the minimum number of operations required.
It can be proved that, Under the constraints of this problem, this objective is always achievable.




Constraints
2 \leq K \leq N \leq 100000
A_1, A_2, ..., A_N is a permutation of 1, 2, ..., N.







InputInput is given from Standard Input in the following format:
N K
A_1 A_2 ... A_N





OutputPrint the minimum number of operations required.






Sample Input 14 3
2 3 1 4





Sample Output 12

One optimal strategy is as follows:


In the first operation, choose the first, second and third elements. The sequence A becomes 1, 1, 1, 4.


In the second operation, choose the second, third and fourth elements. The sequence A becomes 1, 1, 1, 1.







Sample Input 23 3
1 2 3





Sample Output 21






Sample Input 38 3
7 3 1 8 4 6 2 5





Sample Output 34


",Minimization,"Greedy Algorithm, Mathematics, Arithmetic",0.525,94,38
528,"
Score : 200 points


Problem StatementRng is preparing a problem set for a qualification round of CODEFESTIVAL.
He has N candidates of problems. The difficulty of the i-th candidate is D_i.
There must be M problems in the problem set, and the difficulty of the i-th problem must be T_i. Here, one candidate of a problem cannot be used as multiple problems.
Determine whether Rng can complete the problem set without creating new candidates of problems.




Constraints
1 \leq N \leq 200,000
1 \leq D_i \leq 10^9
1 \leq M \leq 200,000
1 \leq T_i \leq 10^9
All numbers in the input are integers.





Partial Score
100 points will be awarded for passing the test set satisfying N \leq 100 and M \leq 100.







InputInput is given from Standard Input in the following format:
N
D_1 D_2 ... D_N
M
T_1 T_2 ... T_M





OutputPrint YES if Rng can complete the problem set without creating new candidates of problems; print NO if he cannot.






Sample Input 15
3 1 4 1 5
3
5 4 3





Sample Output 1YES






Sample Input 27
100 200 500 700 1200 1600 2000
6
100 200 500 700 1600 1600





Sample Output 2NO

Not enough 1600s.





Sample Input 31
800
5
100 100 100 100 100





Sample Output 3NO






Sample Input 415
1 2 2 3 3 3 4 4 4 4 5 5 5 5 5
9
5 4 3 2 1 2 3 4 5





Sample Output 4YES


",Problem Set,"Counting, Sorting, Two-pointer, Greedy Algorithm",0.475,119,49
529,"
Score : 300 points


Problem StatementIn Takahashi Kingdom, there is an archipelago of N islands, called Takahashi Islands.
For convenience, we will call them Island 1, Island 2, ..., Island N.
There are M kinds of regular boat services between these islands.
Each service connects two islands. The i-th service connects Island a_i and Island b_i.
Cat Snuke is on Island 1 now, and wants to go to Island N.
However, it turned out that there is no boat service from Island 1 to Island N, so he wants to know whether it is possible to go to Island N by using two boat services.
Help him.




Constraints
3 ≤ N ≤ 200 000
1 ≤ M ≤ 200 000
1 ≤ a_i < b_i ≤ N
(a_i, b_i) \neq (1, N)
If i \neq j, (a_i, b_i) \neq (a_j, b_j).







InputInput is given from Standard Input in the following format:
N M
a_1 b_1
a_2 b_2
:
a_M b_M





OutputIf it is possible to go to Island N by using two boat services, print POSSIBLE; otherwise, print IMPOSSIBLE.






Sample Input 13 2
1 2
2 3





Sample Output 1POSSIBLE






Sample Input 24 3
1 2
2 3
3 4





Sample Output 2IMPOSSIBLE

You have to use three boat services to get to Island 4.





Sample Input 3100000 1
1 99999





Sample Output 3IMPOSSIBLE






Sample Input 45 5
1 3
4 5
2 3
2 4
1 4





Sample Output 4POSSIBLE

You can get to Island 5 by using two boat services: Island 1 -> Island 4 -> Island 5.

",Cat Snuke and a Voyage,"Graph Theory, Array, Bruteforcing",0.35,244,80
530,"
Score : 300 points


Problem StatementIn a public bath, there is a shower which emits water for T seconds when the switch is pushed.
If the switch is pushed when the shower is already emitting water, from that moment it will be emitting water for T seconds.
Note that it does not mean that the shower emits water for T additional seconds.
N people will push the switch while passing by the shower.
The i-th person will push the switch t_i seconds after the first person pushes it.
How long will the shower emit water in total?




Constraints
1 ≤ N ≤ 200,000
1 ≤ T ≤ 10^9
0 = t_1 < t_2 < t_3 < , ..., < t_{N-1} < t_N ≤ 10^9
T and each t_i are integers.







InputInput is given from Standard Input in the following format:
N T
t_1 t_2 ... t_N





OutputAssume that the shower will emit water for a total of X seconds. Print X.






Sample Input 12 4
0 3





Sample Output 17

Three seconds after the first person pushes the water, the switch is pushed again and the shower emits water for four more seconds, for a total of seven seconds.





Sample Input 22 4
0 5





Sample Output 28

One second after the shower stops emission of water triggered by the first person, the switch is pushed again.





Sample Input 34 1000000000
0 1000 1000000 1000000000





Sample Output 32000000000






Sample Input 41 1
0





Sample Output 41






Sample Input 59 10
0 3 5 7 100 110 200 300 311





Sample Output 567


",Sentou,"Greedy Algorithm, Bruteforcing, Arithmetic, Boolean Operations On Geometric Objects",0.759,104,71
531,"
Score : 300 points


Problem StatementYou are taking a computer-based examination. The examination consists of N questions, and the score allocated to the i-th question is s_i. Your answer to each question will be judged as either ""correct"" or ""incorrect"", and your grade will be the sum of the points allocated to questions that are answered correctly. When you finish answering the questions, your answers will be immediately judged and your grade will be displayed... if everything goes well.
However, the examination system is actually flawed, and if your grade is a multiple of 10, the system displays 0 as your grade. Otherwise, your grade is displayed correctly. In this situation, what is the maximum value that can be displayed as your grade?




Constraints
All input values are integers.
1 ≤ N ≤ 100
1 ≤ s_i ≤ 100







InputInput is given from Standard Input in the following format:
N
s_1
s_2
:
s_N





OutputPrint the maximum value that can be displayed as your grade.






Sample Input 13
5
10
15





Sample Output 125

Your grade will be 25 if the 10-point and 15-point questions are answered correctly and the 5-point question is not, and this grade will be displayed correctly. Your grade will become 30 if the 5-point question is also answered correctly, but this grade will be incorrectly displayed as 0.





Sample Input 23
10
10
15





Sample Output 235

Your grade will be 35 if all the questions are answered correctly, and this grade will be displayed correctly.





Sample Input 33
10
20
30





Sample Output 30

Regardless of whether each question is answered correctly or not, your grade will be a multiple of 10 and displayed as 0.

",Bugged,"Greedy Algorithm, Arithmetic, Dynamic Programming, Dyanmic Programming, Sorting",0.462,174,75
532,"
Score : 300 points


Problem StatementYou are given a string S consisting of digits between 1 and 9, inclusive.
You can insert the letter + into some of the positions (possibly none) between two letters in this string.
Here, + must not occur consecutively after insertion.
All strings that can be obtained in this way can be evaluated as formulas.
Evaluate all possible formulas, and print the sum of the results.




Constraints
1 \leq |S| \leq 10
All letters in S are digits between 1 and 9, inclusive.







InputThe input is given from Standard Input in the following format:
S





OutputPrint the sum of the evaluated value over all possible formulas.






Sample Input 1125





Sample Output 1176

There are 4 formulas that can be obtained: 125, 1+25, 12+5 and 1+2+5. When each formula is evaluated,

125
1+25=26
12+5=17
1+2+5=8

Thus, the sum is 125+26+17+8=176.





Sample Input 29999999999





Sample Output 212656242944


",Many Formulas,"Bitmask, Enumeration, String, Parsing, Arithmetic",0.885,70,59
533,"
Score : 200 points


Problem StatementYou are given a positive integer X.
Find the largest perfect power that is at most X.
Here, a perfect power is an integer that can be represented as b^p, where b is an integer not less than 1 and p is an integer not less than 2.




Constraints
1 ≤ X ≤ 1000
X is an integer.







InputInput is given from Standard Input in the following format:
X





OutputPrint the largest perfect power that is at most X.






Sample Input 110





Sample Output 19

There are four perfect powers that are at most 10: 1, 4, 8 and 9.
We should print the largest among them, 9.





Sample Input 21





Sample Output 21






Sample Input 3999





Sample Output 3961


",Exponential,"Bruteforcing, Exponentiation By Squaring, Implementation, Data Structure",0.371,345,124
534,"
Score : 100 points


Problem StatementGiven a lowercase English letter c, determine whether it is a vowel. Here, there are five vowels in the English alphabet: a, e, i, o and u.




Constraints
c is a lowercase English letter.







InputThe input is given from Standard Input in the following format:
c





OutputIf c is a vowel, print vowel. Otherwise, print consonant.






Sample Input 1a





Sample Output 1vowel

Since a is a vowel, print vowel.





Sample Input 2z





Sample Output 2consonant






Sample Input 3s





Sample Output 3consonant


",UOIAUAI,"Implementation, String, Set / Map",0.75,228,152
535,"
Score : 100 points


Problem StatementAs a New Year's gift, Dolphin received a string s of length 19.
The string s has the following format: [five lowercase English letters],[seven lowercase English letters],[five lowercase English letters].
Dolphin wants to convert the comma-separated string s into a space-separated string.
Write a program to perform the conversion for him.  




Constraints
The length of s is 19.
The sixth and fourteenth characters in s are ,.
The other characters in s are lowercase English letters.







InputThe input is given from Standard Input in the following format:
s





OutputPrint the string after the conversion.






Sample Input 1happy,newyear,enjoy





Sample Output 1happy newyear enjoy

Replace all the commas in happy,newyear,enjoy with spaces to obtain happy newyear enjoy.





Sample Input 2haiku,atcoder,tasks





Sample Output 2haiku atcoder tasks






Sample Input 3abcde,fghihgf,edcba





Sample Output 3abcde fghihgf edcba


",Haiku,"String, Implementation",0.816,253,177
536,"
Score : 100 points


Problem StatementThere are two rectangles.
The lengths of the vertical sides of the first rectangle are A, and the lengths of the horizontal sides of the first rectangle are B.
The lengths of the vertical sides of the second rectangle are C, and the lengths of the horizontal sides of the second rectangle are D.
Print the area of the rectangle with the larger area.
If the two rectangles have equal areas, print that area.




Constraints
All input values are integers.
1≤A≤10^4
1≤B≤10^4
1≤C≤10^4
1≤D≤10^4







InputThe input is given from Standard Input in the following format:
A B C D





OutputPrint the area of the rectangle with the larger area.
If the two rectangles have equal areas, print that area.






Sample Input 13 5 2 7





Sample Output 115

The first rectangle has an area of 3×5=15, and the second rectangle has an area of 2×7=14.
Thus, the output should be 15, the larger area.





Sample Input 2100 600 200 300





Sample Output 260000


",Two Rectangles,"Arithmetic, Implementation",0.861,201,160
537,"
Score : 100 points


Problem StatementSmeke has decided to participate in AtCoder Beginner Contest (ABC) if his current rating is less than 1200, and participate in AtCoder Regular Contest (ARC) otherwise.
You are given Smeke's current rating, x. Print ABC if Smeke will participate in ABC, and print ARC otherwise.




Constraints
1 ≦ x ≦ 3{,}000
x is an integer.







InputThe input is given from Standard Input in the following format:
x





OutputPrint the answer.






Sample Input 11000





Sample Output 1ABC

Smeke's current rating is less than 1200, thus the output should be ABC.





Sample Input 22000





Sample Output 2ARC

Smeke's current rating is not less than 1200, thus the output should be ARC.

",ABC/ARC,Implementation,0.849,196,144
538,"
Score : 100 points


Problem StatementAlice and Bob are playing One Card Poker.
One Card Poker is a two-player game using playing cards.  
Each card in this game shows an integer between 1 and 13, inclusive.
The strength of a card is determined by the number written on it, as follows:  
Weak 2 < 3 < 4 < 5 < 6 < 7 < 8 < 9 < 10 < 11 < 12 < 13 < 1 Strong  
One Card Poker is played as follows:  

Each player picks one card from the deck. The chosen card becomes the player's hand.
The players reveal their hands to each other. The player with the stronger card wins the game.
If their cards are equally strong, the game is drawn.  

You are watching Alice and Bob playing the game, and can see their hands.
The number written on Alice's card is A, and the number written on Bob's card is B.
Write a program to determine the outcome of the game.  




Constraints
1≦A≦13 
1≦B≦13 
A and B are integers.







InputThe input is given from Standard Input in the following format:
A B





OutputPrint Alice if Alice will win. Print Bob if Bob will win. Print Draw if the game will be drawn.






Sample Input 18 6





Sample Output 1Alice

8 is written on Alice's card, and 6 is written on Bob's card.
Alice has the stronger card, and thus the output should be Alice.





Sample Input 21 1





Sample Output 2Draw

Since their cards have the same number, the game will be drawn.





Sample Input 313 1





Sample Output 3Bob


",One Card Poker,"Implementation, Arithmetic",0.574,325,168
539,"
Score : 100 points


Problem StatementSnuke has a favorite restaurant.
The price of any meal served at the restaurant is 800 yen (the currency of Japan), and each time a customer orders 15 meals, the restaurant pays 200 yen back to the customer.
So far, Snuke has ordered N meals at the restaurant.
Let the amount of money Snuke has paid to the restaurant be x yen, and let the amount of money the restaurant has paid back to Snuke be y yen.
Find x-y.




Constraints
1 ≤ N ≤ 100







InputThe input is given from Standard Input in the following format:
N





OutputPrint the answer.






Sample Input 120





Sample Output 115800

So far, Snuke has paid 16000 yen, and the restaurant has paid back 200 yen. Thus, the answer is 15800.





Sample Input 260





Sample Output 247200

Snuke has paid 48000 yen for 60 meals, and the restaurant has paid back 800 yen.

",Restaurant,"Arithmetic, Implementation",0.743,257,167
540,"
Score : 100 points


Problem StatementTwo deer, AtCoDeer and TopCoDeer, are playing a game called Honest or Dishonest.
In this game, an honest player always tells the truth, and an dishonest player always tell lies.
You are given two characters a and b as the input. Each of them is either H or D, and carries the following information:
If a=H, AtCoDeer is honest; if a=D, AtCoDeer is dishonest.
If b=H, AtCoDeer is saying that TopCoDeer is honest; if b=D, AtCoDeer is saying that TopCoDeer is dishonest.
Given this information, determine whether TopCoDeer is honest.




Constraints
a=H or a=D.
b=H or b=D.







InputThe input is given from Standard Input in the following format:
a b





OutputIf TopCoDeer is honest, print H. If he is dishonest, print D.






Sample Input 1H H





Sample Output 1H

In this input, AtCoDeer is honest. Hence, as he says, TopCoDeer is honest.





Sample Input 2D H





Sample Output 2D

In this input, AtCoDeer is dishonest. Hence, contrary to what he says, TopCoDeer is dishonest.





Sample Input 3D D





Sample Output 3H


",HonestOrDishonest,Boolean Operations On Geometric Objects,0.788,187,130
541,"
Score : 100 points


Problem StatementDolphin loves programming contests. Today, he will take part in a contest in AtCoder.
In this country, 24-hour clock is used. For example, 9:00 p.m. is referred to as ""21 o'clock"".
The current time is A o'clock, and a contest will begin in exactly B hours.
When will the contest begin? Answer in 24-hour time.




Constraints
0 \leq A,B \leq 23
A and B are integers.







InputThe input is given from Standard Input in the following format:
A B





OutputPrint the hour of the starting time of the contest in 24-hour time.






Sample Input 19 12





Sample Output 121

In this input, the current time is 9 o'clock, and 12 hours later it will be 21 o'clock in 24-hour time.





Sample Input 219 0





Sample Output 219

The contest has just started.





Sample Input 323 2





Sample Output 31

The contest will begin at 1 o'clock the next day.

",Remaining Time,"Arithmetic, Implementation",0.707,241,153
542,"
Score : 100 points


Problem StatementThree poles stand evenly spaced along a line. Their heights are a, b and c meters, from left to right.
We will call the arrangement of the poles beautiful if the tops of the poles lie on the same line, that is, b-a = c-b.
Determine whether the arrangement of the poles is beautiful.




Constraints
1 \leq a,b,c \leq 100
a, b and c are integers.







InputInput is given from Standard Input in the following format:
a b c





OutputPrint YES if the arrangement of the poles is beautiful; print NO otherwise.






Sample Input 12 4 6





Sample Output 1YES

Since 4-2 = 6-4, this arrangement of poles is beautiful.





Sample Input 22 5 6





Sample Output 2NO

Since 5-2 \neq 6-5, this arrangement of poles is not beautiful.





Sample Input 33 2 1





Sample Output 3YES

Since 1-2 = 2-3, this arrangement of poles is beautiful.

",ι⊥l,"Arithmetic, Implementation",0.764,176,125
543,"
Score : 100 points


Problem StatementYou are given three words s_1, s_2 and s_3, each composed of lowercase English letters, with spaces in between.
Print the acronym formed from the uppercased initial letters of the words.




Constraints
s_1, s_2 and s_3 are composed of lowercase English letters.
1 ≤ |s_i| ≤ 10 (1≤i≤3)







InputInput is given from Standard Input in the following format:
s_1 s_2 s_3





OutputPrint the answer.






Sample Input 1atcoder beginner contest





Sample Output 1ABC

The initial letters of atcoder, beginner and contest are a, b and c. Uppercase and concatenate them to obtain ABC.





Sample Input 2resident register number





Sample Output 2RRN






Sample Input 3k nearest neighbor





Sample Output 3KNN






Sample Input 4async layered coding





Sample Output 4ALC


",Three-letter acronym,"String, Implementation",0.85,158,107
544,"
Score : 100 points


Problem StatementYou are given three strings A, B and C. Check whether they form a word chain.
More formally, determine whether both of the following are true:

The last character in A and the initial character in B are the same.
The last character in B and the initial character in C are the same.

If both are true, print YES. Otherwise, print NO.




Constraints
A, B and C are all composed of lowercase English letters (a - z).
1 ≤ |A|, |B|, |C| ≤ 10, where |A|, |B| and |C| are the lengths of A, B and C, respectively.







InputInput is given from Standard Input in the following format:
A B C





OutputPrint YES or NO.






Sample Input 1rng gorilla apple





Sample Output 1YES

They form a word chain.





Sample Input 2yakiniku unagi sushi





Sample Output 2NO

A and B form a word chain, but B and C do not.





Sample Input 3a a a





Sample Output 3YES






Sample Input 4aaaaaaaaab aaaaaaaaaa aaaaaaaaab





Sample Output 4NO


",Shiritori,"String, Implementation",0.764,170,117
545,"
Score : 100 points


Problem StatementYou are given three integers A, B and C.
Determine whether C is not less than A and not greater than B.




Constraints
-100≤A,B,C≤100 
A, B and C are all integers.







InputInput is given from Standard Input in the following format:  
A B C





OutputIf the condition is satisfied, print Yes; otherwise, print No.






Sample Input 11 3 2





Sample Output 1Yes

C=2 is not less than A=1 and not greater than B=3, and thus the output should be Yes.





Sample Input 26 5 4





Sample Output 2No

C=4 is less than A=6, and thus the output should be No.





Sample Input 32 2 2





Sample Output 3Yes


",Between Two Integers,"Implementation, Arithmetic",0.69,223,136
546,"
Score : 200 points


Problem StatementThere is an image with a height of H pixels and a width of W pixels. Each of the pixels is represented by either . or *. The character representing the pixel at the i-th row from the top and the j-th column from the left, is denoted by C_{i,j}.
Extend this image vertically so that its height is doubled. That is, print a image with a height of 2H pixels and a width of W pixels where the pixel at the i-th row and j-th column is equal to C_{(i+1)/2,j} (the result of division is rounded down).




Constraints
1≦H, W≦100
C_{i,j} is either . or *.







InputThe input is given from Standard Input in the following format:
H W
C_{1,1}...C_{1,W}
:
C_{H,1}...C_{H,W}





OutputPrint the extended image.






Sample Input 12 2
*.
.*





Sample Output 1*.
*.
.*
.*






Sample Input 21 4
***.





Sample Output 2***.
***.






Sample Input 39 20
.....***....***.....
....*...*..*...*....
...*.....**.....*...
...*.....*......*...
....*.....*....*....
.....**..*...**.....
.......*..*.*.......
........**.*........
.........**.........





Sample Output 3.....***....***.....
.....***....***.....
....*...*..*...*....
....*...*..*...*....
...*.....**.....*...
...*.....**.....*...
...*.....*......*...
...*.....*......*...
....*.....*....*....
....*.....*....*....
.....**..*...**.....
.....**..*...**.....
.......*..*.*.......
.......*..*.*.......
........**.*........
........**.*........
.........**.........
.........**.........


",Thin,"Bruteforcing, String, Implementation",0.835,164,124
547,"
Score : 200 points


Problem StatementJoisino is about to compete in the final round of a certain programming competition.
In this contest, there are N problems, numbered 1 through N.
Joisino knows that it takes her T_i seconds to solve problem i(1≦i≦N).
Also, there are M kinds of drinks offered to the contestants, numbered 1 through M.
If Joisino takes drink i(1≦i≦M), her brain will be stimulated and the time it takes for her to solve problem P_i will become X_i seconds.
It does not affect the time to solve the other problems.
A contestant is allowed to take exactly one of the drinks before the start of the contest.
For each drink, Joisino wants to know how many seconds it takes her to solve all the problems if she takes that drink.
Here, assume that the time it takes her to solve all the problems is equal to the sum of the time it takes for her to solve individual problems.
Your task is to write a program to calculate it instead of her.




Constraints
All input values are integers.
1≦N≦100
1≦T_i≦10^5
1≦M≦100
1≦P_i≦N
1≦X_i≦10^5







InputThe input is given from Standard Input in the following format:
N
T_1 T_2 ... T_N
M
P_1 X_1
P_2 X_2
:
P_M X_M





OutputFor each drink, calculate how many seconds it takes Joisino to solve all the problems if she takes that drink, and print the results, one per line.






Sample Input 13
2 1 4
2
1 1
2 3





Sample Output 16
9

If Joisino takes drink 1, the time it takes her to solve each problem will be 1, 1 and 4 seconds, respectively, totaling 6 seconds.
If Joisino takes drink 2, the time it takes her to solve each problem will be 2, 3 and 4 seconds, respectively, totaling 9 seconds.





Sample Input 25
7 2 3 8 5
3
4 2
1 7
4 13





Sample Output 219
25
30


",Contest with Drinks Easy,"Array, Bruteforcing, Arithmetic",0.854,206,158
548,"
Score : 200 points


Problem StatementAtCoDeer the deer found two rectangles lying on the table, each with height 1 and width W.
If we consider the surface of the desk as a two-dimensional plane, the first rectangle covers the vertical range of [0,1] and the horizontal range of [a,a+W], and the second rectangle covers the vertical range of [1,2] and the horizontal range of [b,b+W], as shown in the following figure:

AtCoDeer will move the second rectangle horizontally so that it connects with the first rectangle.
Find the minimum distance it needs to be moved.




Constraints
All input values are integers.
1≤W≤10^5
1≤a,b≤10^5







InputThe input is given from Standard Input in the following format:
W a b





OutputPrint the minimum distance the second rectangle needs to be moved.






Sample Input 13 2 6





Sample Output 11

This input corresponds to the figure in the statement. In this case, the second rectangle should be moved to the left by a distance of 1.





Sample Input 23 1 3





Sample Output 20

The rectangles are already connected, and thus no move is needed.





Sample Input 35 10 1





Sample Output 34


",NarrowRectanglesEasy,"Arithmetic, Boolean Operations On Geometric Objects",0.766,215,132
549,"
Score : 200 points


Problem StatementThere are N students and M checkpoints on the xy-plane.
The coordinates of the i-th student (1 \leq i \leq N) is (a_i,b_i), and the coordinates of the checkpoint numbered j (1 \leq j \leq M) is (c_j,d_j).
When the teacher gives a signal, each student has to go to the nearest checkpoint measured in Manhattan distance. 
The Manhattan distance between two points (x_1,y_1) and (x_2,y_2) is |x_1-x_2|+|y_1-y_2|.
Here, |x| denotes the absolute value of x.
If there are multiple nearest checkpoints for a student, he/she will select the checkpoint with the smallest index.
Which checkpoint will each student go to?




Constraints
1 \leq N,M \leq 50
-10^8 \leq a_i,b_i,c_j,d_j \leq 10^8
All input values are integers.







InputThe input is given from Standard Input in the following format:
N M
a_1 b_1
:  
a_N b_N
c_1 d_1
:  
c_M d_M





OutputPrint N lines.
The i-th line (1 \leq i \leq N) should contain the index of the checkpoint for the i-th student to go.






Sample Input 12 2
2 0
0 0
-1 0
1 0





Sample Output 12
1

The Manhattan distance between the first student and each checkpoint is:

For checkpoint 1: |2-(-1)|+|0-0|=3
For checkpoint 2: |2-1|+|0-0|=1

The nearest checkpoint is checkpoint 2. Thus, the first line in the output should contain 2.
The Manhattan distance between the second student and each checkpoint is:

For checkpoint 1: |0-(-1)|+|0-0|=1
For checkpoint 2: |0-1|+|0-0|=1

When there are multiple nearest checkpoints, the student will go to the checkpoint with the smallest index. Thus, the second line in the output should contain 1.





Sample Input 23 4
10 10
-10 -10
3 3
1 2
2 3
3 5
3 5





Sample Output 23
1
2

There can be multiple checkpoints at the same coordinates.





Sample Input 35 5
-100000000 -100000000
-100000000 100000000
100000000 -100000000
100000000 100000000
0 0
0 0
100000000 100000000
100000000 -100000000
-100000000 100000000
-100000000 -100000000





Sample Output 35
4
3
2
1


",Checkpoints,"Bruteforcing, Geometry; 3d, Greedy Algorithm, Boolean Operations On Geometric Objects",0.703,219,138
550,"
Score : 200 points


Problem StatementSnuke signed up for a new website which holds programming competitions.
He worried that he might forget his password, and he took notes of it.
Since directly recording his password would cause him trouble if stolen,
he took two notes: one contains the characters at the odd-numbered positions, and the other contains the characters at the even-numbered positions.
You are given two strings O and E. O contains the characters at the odd-numbered positions retaining their relative order, and E contains the characters at the even-numbered positions retaining their relative order.
Restore the original password.




Constraints
O and E consists of lowercase English letters (a - z).
1 \leq |O|,|E| \leq 50
|O| - |E| is either 0 or 1.







InputInput is given from Standard Input in the following format:
O
E





OutputPrint the original password.






Sample Input 1xyz
abc





Sample Output 1xaybzc

The original password is xaybzc. Extracting the characters at the odd-numbered positions results in xyz, and extracting the characters at the even-numbered positions results in abc.





Sample Input 2atcoderbeginnercontest
atcoderregularcontest





Sample Output 2aattccooddeerrbreeggiunlnaerrccoonntteesstt


",∵∴∵,"String, Bruteforcing, Boolean Operations On Geometric Objects, Two-pointer",0.803,196,137
551,"
Score : 100 points


Problem StatementThere is a directed graph G with N vertices and M edges.
The vertices are numbered 1, 2, \ldots, N, and for each i (1 \leq i \leq M), the i-th directed edge goes from Vertex x_i to y_i.
G does not contain directed cycles.
Find the length of the longest directed path in G.
Here, the length of a directed path is the number of edges in it.




Constraints
All values in input are integers.
2 \leq N \leq 10^5
1 \leq M \leq 10^5
1 \leq x_i, y_i \leq N
All pairs (x_i, y_i) are distinct.
G does not contain directed cycles.







InputInput is given from Standard Input in the following format:
N M
x_1 y_1
x_2 y_2
:
x_M y_M





OutputPrint the length of the longest directed path in G.






Sample Input 14 5
1 2
1 3
3 2
2 4
3 4





Sample Output 13

The red directed path in the following figure is the longest:






Sample Input 26 3
2 3
4 5
5 6





Sample Output 22

The red directed path in the following figure is the longest:






Sample Input 35 8
5 3
2 3
2 4
5 2
5 1
1 4
4 3
1 3





Sample Output 33

The red directed path in the following figure is one of the longest:


",Longest Path,"Graph Theory, Directed Acyclic Graph, Depth-first Search, Memoization",0.574,523,272
552,"
Score : 400 points


Problem StatementGiven is a string S. Each character in S is either a digit (0, ..., 9) or ?.
Among the integers obtained by replacing each occurrence of ? with a digit, how many have a remainder of 5 when divided by 13? An integer may begin with 0.
Since the answer can be enormous, print the count modulo 10^9+7.




Constraints

S is a string consisting of digits (0, ..., 9) and ?.
1 \leq |S| \leq 10^5







Input
Input is given from Standard Input in the following format:
S





Output
Print the number of integers satisfying the condition, modulo 10^9+7.






Sample Input 1??2??5





Sample Output 1768

For example, 482305, 002865, and 972665 satisfy the condition.





Sample Input 2?44





Sample Output 21

Only 044 satisfies the condition.





Sample Input 37?4





Sample Output 30

We may not be able to produce an integer satisfying the condition.





Sample Input 4?6?42???8??2??06243????9??3???7258??5??7???????774????4?1??17???9?5?70???76???





Sample Output 4153716888


",Digits Parade,"Dyanmic Programming, Arithmetic, Dynamic Programming",0.673,71,45
553,"
Score : 400 points


Problem StatementGiven is an integer S.
Find a combination of six integers X_1,Y_1,X_2,Y_2,X_3, and Y_3 that satisfies all of the following conditions:

0 \leq X_1,Y_1,X_2,Y_2,X_3,Y_3 \leq 10^9
The area of the triangle in a two-dimensional plane whose vertices are (X_1,Y_1),(X_2,Y_2), and (X_3,Y_3) is S/2.

We can prove that there always exist six integers that satisfy the conditions under the constraints of this problem.




Constraints
1 \leq S \leq 10^{18}
All values in input are integers.







InputInput is given from Standard Input in the following format:
S





OutputPrint six integers X_1,Y_1,X_2,Y_2,X_3, and Y_3 that satisfy the conditions, in this order, with spaces in between.
If multiple solutions exist, any of them will be accepted.






Sample Input 13





Sample Output 11 0 2 2 0 1

The area of the triangle in a two-dimensional plane whose vertices are (1,0),(2,2), and (0,1) is 3/2.
Printing 3 0 3 1 0 1 or 1 0 0 1 2 2 will also be accepted.





Sample Input 2100





Sample Output 20 0 10 0 0 10






Sample Input 3311114770564041497





Sample Output 3314159265 358979323 846264338 327950288 419716939 937510582


",Triangle,"Geometry; 3d, Number Theory, Constructive, Arithmetic",0.204,152,34
554,"
Score : 300 points


Problem StatementGiven is a string S. Let T be the concatenation of K copies of S.
We can repeatedly perform the following operation: choose a character in T and replace it with a different character.
Find the minimum number of operations required to satisfy the following condition: any two adjacent characters in T are different.




Constraints
1 \leq |S| \leq 100
S consists of lowercase English letters.
1 \leq K \leq 10^9
K is an integer.







InputInput is given from Standard Input in the following format:
S
K





OutputPrint the minimum number of operations required.






Sample Input 1issii
2





Sample Output 14

T is issiiissii.  For example, we can rewrite it into ispiqisyhi, and now any two adjacent characters are different.





Sample Input 2qq
81





Sample Output 281






Sample Input 3cooooooooonteeeeeeeeeest
999993333





Sample Output 38999939997


",Connection and Disconnection,"String, Arithmetic, Implementation, Mathematics",0.169,412,52
555,"
Score : 300 points


Problem StatementGiven is a string S of length N-1.
Each character in S is < or >.
A sequence of N non-negative integers, a_1,a_2,\cdots,a_N, is said to be good when the following condition is satisfied for all i (1 \leq i \leq N-1):

If S_i= <: a_i<a_{i+1}
If S_i= >: a_i>a_{i+1}

Find the minimum possible sum of the elements of a good sequence of N non-negative integers.




Constraints
2 \leq N \leq 5 \times 10^5
S is a string of length N-1 consisting of < and >.







InputInput is given from Standard Input in the following format:
S





OutputFind the minimum possible sum of the elements of a good sequence of N non-negative integers.






Sample Input 1<>>





Sample Output 13

a=(0,2,1,0) is a good sequence whose sum is 3.
There is no good sequence whose sum is less than 3.





Sample Input 2<>>><<><<<<<>>><





Sample Output 228


",><,"Greedy Algorithm, Dyanmic Programming, Array, Mathematics",0.441,121,54
556,"
Score : 500 points


Problem StatementWe have N logs of lengths A_1,A_2,\cdots A_N.
We can cut these logs at most K times in total. When a log of length L is cut at a point whose distance from an end of the log is t (0<t<L), it becomes two logs of lengths t and L-t.
Find the shortest possible length of the longest log after at most K cuts, and print it after rounding up to an integer.




Constraints
1 \leq N \leq 2 \times 10^5
0 \leq K \leq 10^9
1 \leq A_i \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N K
A_1 A_2 \cdots A_N





OutputPrint an integer representing the answer.






Sample Input 12 3
7 9





Sample Output 14


First, we will cut the log of length 7 at a point whose distance from an end of the log is 3.5, resulting in two logs of length 3.5 each.
Next, we will cut the log of length 9 at a point whose distance from an end of the log is 3, resulting in two logs of length 3 and 6.
Lastly, we will cut the log of length 6 at a point whose distance from an end of the log is 3.3, resulting in two logs of length 3.3 and 2.7.

In this case, the longest length of a log will be 3.5, which is the shortest possible result. After rounding up to an integer, the output should be 4.





Sample Input 23 0
3 4 5





Sample Output 25






Sample Input 310 10
158260522 877914575 602436426 24979445 861648772 623690081 433933447 476190629 262703497 211047202





Sample Output 3292638192


",Logs,"Binary Search, Greedy Algorithm, Arithmetic, Prefix sum",0.462,372,139
557,"
Score : 400 points


Problem StatementThere are N one-off jobs available. If you take the i-th job and complete it, you will earn the reward of B_i after A_i days from the day you do it.
You can take and complete at most one of these jobs in a day.
However, you cannot retake a job that you have already done.
Find the maximum total reward that you can earn no later than M days from today.
You can already start working today.




Constraints
All values in input are integers.
1 \leq N \leq 10^5
1 \leq M \leq 10^5
1 \leq A_i \leq 10^5
1 \leq B_i \leq 10^4







InputInput is given from Standard Input in the following format:
N M
A_1 B_1
A_2 B_2
\vdots
A_N B_N





OutputPrint the maximum total reward that you can earn no later than M days from today.






Sample Input 13 4
4 3
4 1
2 2





Sample Output 15

You can earn the total reward of 5 by taking the jobs as follows:

Take and complete the first job today. You will earn the reward of 3 after four days from today.
Take and complete the third job tomorrow. You will earn the reward of 2 after two days from tomorrow, that is, after three days from today.






Sample Input 25 3
1 2
1 3
1 4
2 1
2 3





Sample Output 210






Sample Input 31 1
2 1





Sample Output 30


",Summer Vacation,"Sorting, Greedy Algorithm, Priority Queue",0.298,197,54
558,"
Score : 300 points


Problem StatementYou are given a sequence of positive integers of length N, a = (a_1, a_2, ..., a_N).
Your objective is to remove some of the elements in a so that a will be a good sequence.
Here, an sequence b is a good sequence when the following condition holds true:

For each element x in b, the value x occurs exactly x times in b.

For example, (3, 3, 3), (4, 2, 4, 1, 4, 2, 4) and () (an empty sequence) are good sequences, while (3, 3, 3, 3) and (2, 4, 1, 4, 2) are not.
Find the minimum number of elements that needs to be removed so that a will be a good sequence.




Constraints
1 \leq N \leq 10^5
a_i is an integer.
1 \leq a_i \leq 10^9







InputInput is given from Standard Input in the following format:
N
a_1 a_2 ... a_N





OutputPrint the minimum number of elements that needs to be removed so that a will be a good sequence.






Sample Input 14
3 3 3 3





Sample Output 11

We can, for example, remove one occurrence of 3. Then, (3, 3, 3) is a good sequence.





Sample Input 25
2 4 1 4 2





Sample Output 22

We can, for example, remove two occurrences of 4. Then, (2, 1, 2) is a good sequence.





Sample Input 36
1 2 2 3 3 3





Sample Output 30






Sample Input 41
1000000000





Sample Output 41

Remove one occurrence of 10^9. Then, () is a good sequence.





Sample Input 58
2 7 1 8 2 8 1 8





Sample Output 55


",Good Sequence,"Hashing, Set / Map, Boolean Operations On Geometric Objects, Arithmetic",0.695,145,78
559,"
Score : 400 points


Problem StatementYou have N items and a bag of strength W.
The i-th item has a weight of w_i and a value of v_i.
You will select some of the items and put them in the bag.
Here, the total weight of the selected items needs to be at most W.
Your objective is to maximize the total value of the selected items.




Constraints
1 ≤ N ≤ 100
1 ≤ W ≤ 10^9
1 ≤ w_i ≤ 10^9
For each i = 2,3,...,N, w_1 ≤ w_i ≤ w_1 + 3.
1 ≤ v_i ≤ 10^7
W, each w_i and v_i are integers.







InputInput is given from Standard Input in the following format:
N W
w_1 v_1
w_2 v_2
:
w_N v_N





OutputPrint the maximum possible total value of the selected items.






Sample Input 14 6
2 1
3 4
4 10
3 4





Sample Output 111

The first and third items should be selected.





Sample Input 24 6
2 1
3 7
4 10
3 6





Sample Output 213

The second and fourth items should be selected.





Sample Input 34 10
1 100
1 100
1 100
1 100





Sample Output 3400

You can take everything.





Sample Input 44 1
10 100
10 100
10 100
10 100





Sample Output 40

You can take nothing.

",Simple Knapsack,"Difference Array, Sorting, Prefix sum, Bruteforcing, Backtracking, Dyanmic Programming, Bitmask",0.12,137,15
560,"
Score : 400 points


Problem StatementLet {\rm comb}(n,r) be the number of ways to choose r objects from among n objects, disregarding order.
From n non-negative integers a_1, a_2, ..., a_n, select two numbers a_i > a_j so that {\rm comb}(a_i,a_j) is maximized.
If there are multiple pairs that maximize the value, any of them is accepted.




Constraints
2 \leq n \leq 10^5
0 \leq a_i \leq 10^9
a_1,a_2,...,a_n are pairwise distinct.
All values in input are integers.







InputInput is given from Standard Input in the following format:
n
a_1 a_2 ... a_n





OutputPrint a_i and a_j that you selected, with a space in between.






Sample Input 15
6 9 4 2 11





Sample Output 111 6

\rm{comb}(a_i,a_j) for each possible selection is as follows:

\rm{comb}(4,2)=6 
\rm{comb}(6,2)=15 
\rm{comb}(6,4)=15 
\rm{comb}(9,2)=36 
\rm{comb}(9,4)=126 
\rm{comb}(9,6)=84 
\rm{comb}(11,2)=55 
\rm{comb}(11,4)=330 
\rm{comb}(11,6)=462 
\rm{comb}(11,9)=55

Thus, we should print 11 and 6.





Sample Input 22
100 0





Sample Output 2100 0


",Binomial Coefficients,"Sorting, Binary Search, Combinatorics, Greedy Algorithm, Array",0.422,100,37
561,"
Score : 400 points


Problem StatementSnuke has decided to play a game using cards.
He has a deck consisting of N cards. On the i-th card from the top, an integer A_i is written.
He will perform the operation described below zero or more times, so that the values written on the remaining cards will be pairwise distinct. Find the maximum possible number of remaining cards. Here, N is odd, which guarantees that at least one card can be kept.
Operation: Take out three arbitrary cards from the deck. Among those three cards, eat two: one with the largest value, and another with the smallest value. Then, return the remaining one card to the deck.




Constraints
3 ≦ N ≦ 10^{5}
N is odd.
1 ≦ A_i ≦ 10^{5}
A_i is an integer.







InputThe input is given from Standard Input in the following format:
N
A_1 A_2 A_3 ... A_{N}





OutputPrint the answer.






Sample Input 15
1 2 1 3 7





Sample Output 13

One optimal solution is to perform the operation once, taking out two cards with 1 and one card with 2. One card with 1 and another with 2 will be eaten, and the remaining card with 1 will be returned to deck. Then, the values written on the remaining cards in the deck will be pairwise distinct: 1, 3 and 7.





Sample Input 215
1 3 5 2 1 3 2 8 8 6 2 6 11 1 1





Sample Output 27


",Card Eater,"Sorting, Counting, Set / Map, Parity",0.717,87,42
562,"
Score : 400 points


Problem StatementWe have a board with a 2 \times N grid.
Snuke covered the board with N dominoes without overlaps.
Here, a domino can cover a 1 \times 2 or 2 \times 1 square.
Then, Snuke decided to paint these dominoes using three colors: red, cyan and green.
Two dominoes that are adjacent by side should be painted by different colors.
Here, it is not always necessary to use all three colors.
Find the number of such ways to paint the dominoes, modulo 1000000007.
The arrangement of the dominoes is given to you as two strings S_1 and S_2 in the following manner:

Each domino is represented by a different English letter (lowercase or uppercase).
The j-th character in S_i represents the domino that occupies the square at the i-th row from the top and j-th column from the left.





Constraints
1 \leq N \leq 52
|S_1| = |S_2| = N
S_1 and S_2 consist of lowercase and uppercase English letters.
S_1 and S_2 represent a valid arrangement of dominoes.







InputInput is given from Standard Input in the following format:
N
S_1
S_2





OutputPrint the number of such ways to paint the dominoes, modulo 1000000007.






Sample Input 13
aab
ccb





Sample Output 16

There are six ways as shown below:






Sample Input 21
Z
Z





Sample Output 23

Note that it is not always necessary to use all the colors.





Sample Input 352
RvvttdWIyyPPQFFZZssffEEkkaSSDKqcibbeYrhAljCCGGJppHHn
RLLwwdWIxxNNQUUXXVVMMooBBaggDKqcimmeYrhAljOOTTJuuzzn





Sample Output 3958681902


",Coloring Dominoes,"String, Greedy Algorithm, Combinatorics, Arithmetic, Counting, Dyanmic Programming",0.773,33,23
563,"
Score : 400 points


Problem StatementYou are given a permutation p_1,p_2,...,p_N consisting of 1,2,..,N.
You can perform the following operation any number of times (possibly zero):
Operation: Swap two adjacent elements in the permutation.
You want to have p_i ≠ i for all 1≤i≤N.
Find the minimum required number of operations to achieve this.




Constraints
2≤N≤10^5
p_1,p_2,..,p_N is a permutation of 1,2,..,N.







InputThe input is given from Standard Input in the following format:
N
p_1 p_2 .. p_N





OutputPrint the minimum required number of operations






Sample Input 15
1 4 3 5 2





Sample Output 12

Swap 1 and 4, then swap 1 and 3. p is now 4,3,1,5,2 and satisfies the condition.
This is the minimum possible number, so the answer is 2.





Sample Input 22
1 2





Sample Output 21

Swapping 1 and 2 satisfies the condition.





Sample Input 32
2 1





Sample Output 30

The condition is already satisfied initially.





Sample Input 49
1 2 4 9 5 8 7 3 6





Sample Output 43


",Derangement,"Permutation Cycle Decomposition, Greedy Algorithm, Enumeration, Arithmetic",0.443,130,65
564,"
Score : 300 points


Problem StatementYou are playing the following game with Joisino.

Initially, you have a blank sheet of paper.
Joisino announces a number. If that number is written on the sheet, erase the number from the sheet; if not, write the number on the sheet. This process is repeated N times.
Then, you are asked a question: How many numbers are written on the sheet now?

The numbers announced by Joisino are given as A_1, ... ,A_N in the order she announces them. How many numbers will be written on the sheet at the end of the game?




Constraints
1≤N≤100000
1≤A_i≤1000000000(=10^9)
All input values are integers.







InputInput is given from Standard Input in the following format:
N
A_1
:
A_N





OutputPrint how many numbers will be written on the sheet at the end of the game.






Sample Input 13
6
2
6





Sample Output 11

The game proceeds as follows:


6 is not written on the sheet, so write 6.


2 is not written on the sheet, so write 2.


6 is written on the sheet, so erase 6.


Thus, the sheet contains only 2 in the end. The answer is 1.





Sample Input 24
2
5
5
2





Sample Output 20

It is possible that no number is written on the sheet in the end.





Sample Input 36
12
22
16
22
18
12





Sample Output 32


",Write and Erase,"Set / Map, Arithmetic, Bruteforcing, Boolean Operations On Geometric Objects",0.523,336,135
565,"
Score : 300 points


Problem StatementTakahashi is now competing in a programming contest, but he received TLE in a problem where the answer is YES or NO.
When he checked the detailed status of the submission, there were N test cases in the problem, and the code received TLE in M of those cases.
Then, he rewrote the code to correctly solve each of those M cases with 1/2 probability in 1900 milliseconds, and correctly solve each of the other N-M cases without fail in 100 milliseconds.
Now, he goes through the following process:

Submit the code.
Wait until the code finishes execution on all the cases.
If the code fails to correctly solve some of the M cases, submit it again.
Repeat until the code correctly solve all the cases in one submission.

Let the expected value of the total execution time of the code be X milliseconds. Print X (as an integer).




Constraints
All input values are integers.
1 \leq N \leq 100
1 \leq M \leq {\rm min}(N, 5)







InputInput is given from Standard Input in the following format:
N M





OutputPrint X, the expected value of the total execution time of the code, as an integer. It can be proved that, under the constraints in this problem, X is an integer not exceeding 10^9.






Sample Input 11 1





Sample Output 13800

In this input, there is only one case. Takahashi will repeatedly submit the code that correctly solves this case with 1/2 probability in 1900 milliseconds.
The code will succeed in one attempt with 1/2 probability, in two attempts with 1/4 probability, and in three attempts with 1/8 probability, and so on.
Thus, the answer is 1900 \times 1/2 + (2 \times 1900) \times 1/4 + (3 \times 1900) \times 1/8 + ... = 3800.





Sample Input 210 2





Sample Output 218400

The code will take 1900 milliseconds in each of the 2 cases, and 100 milliseconds in each of the 10-2=8 cases. The probability of the code correctly solving all the cases is 1/2 \times 1/2 = 1/4.





Sample Input 3100 5





Sample Output 3608000


",HSI,"Probability Theory, Arithmetic, Mathematics",0.897,67,57
566,"
Score : 300 points


Problem StatementAtCoDeer the deer is going on a trip in a two-dimensional plane.
In his plan, he will depart from point (0, 0) at time 0, then for each i between 1 and N (inclusive), he will visit point (x_i,y_i) at time t_i.
If AtCoDeer is at point (x, y) at time t, he can be at one of the following points at time t+1: (x+1,y), (x-1,y), (x,y+1) and (x,y-1).
Note that he cannot stay at his place.
Determine whether he can carry out his plan.




Constraints
1 ≤ N ≤ 10^5
0 ≤ x_i ≤ 10^5
0 ≤ y_i ≤ 10^5
1 ≤ t_i ≤ 10^5
t_i < t_{i+1} (1 ≤ i ≤ N-1)
All input values are integers.







InputInput is given from Standard Input in the following format:
N
t_1 x_1 y_1
t_2 x_2 y_2
:
t_N x_N y_N





OutputIf AtCoDeer can carry out his plan, print Yes; if he cannot, print No.






Sample Input 12
3 1 2
6 1 1





Sample Output 1Yes

For example, he can travel as follows: (0,0), (0,1), (1,1), (1,2), (1,1), (1,0), then (1,1).





Sample Input 21
2 100 100





Sample Output 2No

It is impossible to be at (100,100) two seconds after being at (0,0).





Sample Input 32
5 1 1
100 1 1





Sample Output 3No


",Traveling,"Bruteforcing, Geometry; 3d, Greedy Algorithm, Parity, Implementation",0.602,410,191
567,"
Score : 700 points


Problem StatementGiven is a sequence of N digits a_1a_2\ldots a_N, where each element is 1, 2, or 3.
Let x_{i,j} defined as follows:

x_{1,j} := a_j \quad (1 \leq j \leq N)
x_{i,j} := | x_{i-1,j} - x_{i-1,j+1} | \quad (2 \leq i \leq N and 1 \leq j \leq N+1-i)

Find x_{N,1}.




Constraints
2 \leq N \leq 10^6
a_i = 1,2,3 (1 \leq i \leq N)







InputInput is given from Standard Input in the following format:
N
a_1a_2\ldotsa_N





OutputPrint x_{N,1}.






Sample Input 14
1231





Sample Output 11

x_{1,1},x_{1,2},x_{1,3},x_{1,4} are respectively 1,2,3,1.
x_{2,1},x_{2,2},x_{2,3} are respectively |1-2| = 1,|2-3| = 1,|3-1| = 2.
x_{3,1},x_{3,2} are respectively |1-1| = 0,|1-2| = 1.
Finally, x_{4,1} = |0-1| = 1, so the answer is 1.





Sample Input 210
2311312312





Sample Output 20


",123 Triangle,"Combinatorics, Arithmetic",0.2,106,9
568,"
Score : 400 points


Problem StatementThere are N empty boxes arranged in a row from left to right.
The integer i is written on the i-th box from the left (1 \leq i \leq N).
For each of these boxes, Snuke can choose either to put a ball in it or to put nothing in it.
We say a set of choices to put a ball or not in the boxes is good when the following condition is satisfied:

For every integer i between 1 and N (inclusive), the total number of balls contained in the boxes with multiples of i written on them is congruent to a_i modulo 2.

Does there exist a good set of choices? If the answer is yes, find one good set of choices.




Constraints
All values in input are integers.
1 \leq N \leq 2 \times 10^5
a_i is 0 or 1.







InputInput is given from Standard Input in the following format:
N
a_1 a_2 ... a_N





OutputIf a good set of choices does not exist, print -1.
If a good set of choices exists, print one such set of choices in the following format:
M
b_1 b_2 ... b_M

where M denotes the number of boxes that will contain a ball, and b_1,\ b_2,\ ...,\ b_M are the integers written on these boxes, in any order.






Sample Input 13
1 0 0





Sample Output 11
1

Consider putting a ball only in the box with 1 written on it.

There are three boxes with multiples of 1 written on them: the boxes with 1, 2, and 3. The total number of balls contained in these boxes is 1.
There is only one box with a multiple of 2 written on it: the box with 2. The total number of balls contained in these boxes is 0.
There is only one box with a multiple of 3 written on it: the box with 3. The total number of balls contained in these boxes is 0.

Thus, the condition is satisfied, so this set of choices is good.





Sample Input 25
0 0 0 0 0





Sample Output 20

Putting nothing in the boxes can be a good set of choices.

",Preparing Boxes,"Arithmetic, Xor Basis (gf(2)), Greedy Algorithm, Parity, Array",0.252,304,87
569,"
Score : 400 points


Problem StatementGiven is a rooted tree with N vertices numbered 1 to N.
The root is Vertex 1, and the i-th edge (1 \leq i \leq N - 1) connects Vertex a_i and b_i.
Each of the vertices has a counter installed. Initially, the counters on all the vertices have the value 0.
Now, the following Q operations will be performed:

Operation j (1 \leq j \leq Q): Increment by x_j the counter on every vertex contained in the subtree rooted at Vertex p_j.

Find the value of the counter on each vertex after all operations.




Constraints
2 \leq N \leq 2 \times 10^5
1 \leq Q \leq 2 \times 10^5
1 \leq a_i < b_i \leq N
1 \leq p_j \leq N
1 \leq x_j \leq 10^4
The given graph is a tree.
All values in input are integers.







InputInput is given from Standard Input in the following format:
N Q
a_1 b_1
:
a_{N-1} b_{N-1}
p_1 x_1
:
p_Q x_Q





OutputPrint the values of the counters on Vertex 1, 2, \ldots, N after all operations, in this order, with spaces in between.






Sample Input 14 3
1 2
2 3
2 4
2 10
1 100
3 1





Sample Output 1100 110 111 110

The tree in this input is as follows:

Each operation changes the values of the counters on the vertices as follows:

Operation 1: Increment by 10 the counter on every vertex contained in the subtree rooted at Vertex 2, that is, Vertex 2, 3, 4. The values of the counters on Vertex 1, 2, 3, 4 are now 0, 10, 10, 10, respectively.
Operation 2: Increment by 100 the counter on every vertex contained in the subtree rooted at Vertex 1, that is, Vertex 1, 2, 3, 4. The values of the counters on Vertex 1, 2, 3, 4 are now 100, 110, 110, 110, respectively.
Operation 3: Increment by 1 the counter on every vertex contained in the subtree rooted at Vertex 3, that is, Vertex 3. The values of the counters on Vertex 1, 2, 3, 4 are now 100, 110, 111, 110, respectively.






Sample Input 26 2
1 2
1 3
2 4
3 6
2 5
1 10
1 10





Sample Output 220 20 20 20 20 20


",Ki,"Graph Theory, Depth-first Search, Prefix sum, Data Structure, Segment Tree With Lazy Propagation",0.292,499,100
570,"
Score : 500 points


Problem StatementThere are N cards placed face down in a row. On each card, an integer 1 or 2 is written.
Let A_i be the integer written on the i-th card.
Your objective is to guess A_1, A_2, ..., A_N correctly.
You know the following facts:

For each i = 1, 2, ..., M, the value A_{X_i} + A_{Y_i} + Z_i is an even number.

You are a magician and can use the following magic any number of times:
Magic: Choose one card and know the integer A_i written on it. The cost of using this magic is 1.
What is the minimum cost required to determine all of A_1, A_2, ..., A_N?
It is guaranteed that there is no contradiction in given input.




Constraints
All values in input are integers.
2 \leq N \leq 10^5
1 \leq M \leq 10^5
1 \leq X_i < Y_i \leq N
1 \leq Z_i \leq 100
The pairs (X_i, Y_i) are distinct.
There is no contradiction in input. (That is, there exist integers A_1, A_2, ..., A_N that satisfy the conditions.)







InputInput is given from Standard Input in the following format:
N M
X_1 Y_1 Z_1
X_2 Y_2 Z_2
\vdots
X_M Y_M Z_M





OutputPrint the minimum total cost required to determine all of A_1, A_2, ..., A_N.






Sample Input 13 1
1 2 1





Sample Output 12

You can determine all of A_1, A_2, A_3 by using the magic for the first and third cards.





Sample Input 26 5
1 2 1
2 3 2
1 3 3
4 5 4
5 6 5





Sample Output 22






Sample Input 3100000 1
1 100000 100





Sample Output 399999


",1 or 2,"Graph Theory, Parity, Disjoint Set, Graph Traversal, Arithmetic",0.607,134,57
571,"
Score : 400 points


Problem StatementWe have a large square grid with H rows and W columns.
Iroha is now standing in the top-left cell.
She will repeat going right or down to the adjacent cell, until she reaches the bottom-right cell.
However, she cannot enter the cells in the intersection of the bottom A rows and the leftmost B columns. (That is, there are A×B forbidden cells.) There is no restriction on entering the other cells.
Find the number of ways she can travel to the bottom-right cell.
Since this number can be extremely large, print the number modulo 10^9+7.




Constraints
 1 ≦ H, W ≦ 100,000
 1 ≦ A < H
 1 ≦ B < W







InputThe input is given from Standard Input in the following format:
H W A B





OutputPrint the number of ways she can travel to the bottom-right cell, modulo 10^9+7.






Sample Input 12 3 1 1





Sample Output 12

We have a 2×3 grid, but entering the bottom-left cell is forbidden. The number of ways to travel is two: ""Right, Right, Down"" and ""Right, Down, Right"".





Sample Input 210 7 3 4





Sample Output 23570

There are 12 forbidden cells.





Sample Input 3100000 100000 99999 99999





Sample Output 31






Sample Input 4100000 100000 44444 55555





Sample Output 4738162020


",Iroha and a Grid,"Combinatorics, Arithmetic, Exponentiation By Squaring, Precomputation, Inclusion And Exclusion",0.325,84,21
572,"
Score : 400 points


Problem Statement
Given is a tree G with N vertices.
The vertices are numbered 1 through N, and the i-th edge connects Vertex a_i and Vertex b_i.
Consider painting the edges in G with some number of colors.
We want to paint them so that, for each vertex, the colors of the edges incident to that vertex are all different.
Among the colorings satisfying the condition above, construct one that uses the minimum number of colors.




Constraints

 2 \le N \le 10^5
 1 \le a_i \lt b_i \le N
All values in input are integers.
The given graph is a tree.







Input
Input is given from Standard Input in the following format:
N
a_1 b_1
a_2 b_2
\vdots
a_{N-1} b_{N-1}





Output
Print N lines.
The first line should contain K, the number of colors used.
The (i+1)-th line (1 \le i \le N-1) should contain c_i, the integer representing the color of the i-th edge, where 1 \le c_i \le K must hold.
If there are multiple colorings with the minimum number of colors that satisfy the condition, printing any of them will be accepted.






Sample Input 13
1 2
2 3





Sample Output 12
1
2






Sample Input 28
1 2
2 3
2 4
2 5
4 7
5 6
6 8





Sample Output 24
1
2
3
4
1
1
2






Sample Input 36
1 2
1 3
1 4
1 5
1 6





Sample Output 35
1
2
3
4
5


",Coloring Edges on Tree,"Graph Theory, Tree, Depth-first Search, Greedy Algorithm, Set / Map",0.469,136,48
573,"
Score : 200 points


Problem StatementSquare1001 has seen an electric bulletin board displaying the integer 1.
He can perform the following operations A and B to change this value:

Operation A: The displayed value is doubled.
Operation B: The displayed value increases by K.

Square1001 needs to perform these operations N times in total.
Find the minimum possible value displayed in the board after N operations.




Constraints
1 \leq N, K \leq 10
All input values are integers.







InputInput is given from Standard Input in the following format:
N
K





OutputPrint the minimum possible value displayed in the board after N operations.






Sample Input 14
3





Sample Output 110

The value will be minimized when the operations are performed in the following order: A, A, B, B.
In this case, the value will change as follows: 1 → 2 → 4 → 7 → 10.  





Sample Input 210
10





Sample Output 276

The value will be minimized when the operations are performed in the following order: A, A, A, A, B, B, B, B, B, B.
In this case, the value will change as follows: 1 → 2 → 4 → 8 → 16 → 26 → 36 → 46 → 56 → 66 → 76.  
By the way, this contest is AtCoder Beginner Contest 076.

",Addition and Multiplication,"Greedy Algorithm, Bruteforcing, Implementation, Arithmetic",0.909,140,123
574,"
Score : 200 points


Problem StatementThere is a string S consisting of digits 1, 2, ..., 9.
Lunlun, the Dachshund, will take out three consecutive digits from S, treat them as a single integer X and bring it to her master. (She cannot rearrange the digits.)
The master's favorite number is 753. The closer to this number, the better.
What is the minimum possible (absolute) difference between X and 753?




Constraints
S is a string of length between 4 and 10 (inclusive).
Each character in S is 1, 2, ..., or 9.







InputInput is given from Standard Input in the following format:
S





OutputPrint the minimum possible difference between X and 753.






Sample Input 11234567876





Sample Output 134

Taking out the seventh to ninth characters results in X = 787, and the difference between this and 753 is 787 - 753 = 34. The difference cannot be made smaller, no matter where X is taken from.
Note that the digits cannot be rearranged. For example, taking out 567 and rearranging it to 765 is not allowed.
We cannot take out three digits that are not consecutive from S, either. For example, taking out the seventh digit 7, the ninth digit 7 and the tenth digit 6 to obtain 776 is not allowed.





Sample Input 235753





Sample Output 20

If 753 itself can be taken out, the answer is 0.





Sample Input 31111111111





Sample Output 3642

No matter where X is taken from, X = 111, with the difference 753 - 111 = 642.

",754,"Bruteforcing, String, Parsing, Arithmetic, Data Structure",0.744,198,133
575,"
Score : 200 points


Problem StatementOur world is one-dimensional, and ruled by two empires called Empire A and Empire B.
The capital of Empire A is located at coordinate X, and that of Empire B is located at coordinate Y.
One day, Empire A becomes inclined to put the cities at coordinates x_1, x_2, ..., x_N under its control, and Empire B becomes inclined to put the cities at coordinates y_1, y_2, ..., y_M under its control.
If there exists an integer Z that satisfies all of the following three conditions, they will come to an agreement, but otherwise war will break out.

X < Z \leq Y
x_1, x_2, ..., x_N < Z
y_1, y_2, ..., y_M \geq Z

Determine if war will break out.




Constraints
All values in input are integers.
1 \leq N, M \leq 100
-100 \leq X < Y \leq 100
-100 \leq x_i, y_i \leq 100
x_1, x_2, ..., x_N \neq X
x_i are all different.
y_1, y_2, ..., y_M \neq Y
y_i are all different.







InputInput is given from Standard Input in the following format:
N M X Y
x_1 x_2 ... x_N
y_1 y_2 ... y_M





OutputIf war will break out, print War; otherwise, print No War.






Sample Input 13 2 10 20
8 15 13
16 22





Sample Output 1No War

The choice Z = 16 satisfies all of the three conditions as follows, thus they will come to an agreement.

X = 10 < 16 \leq 20 = Y
8, 15, 13 < 16
16, 22 \geq 16






Sample Input 24 2 -48 -1
-20 -35 -91 -23
-22 66





Sample Output 2War






Sample Input 35 3 6 8
-10 3 1 5 -100
100 6 14





Sample Output 3War


",1 Dimensional World's Tale,"Array, Boolean Operations On Geometric Objects",0.574,233,128
576,"
Score : 200 points


Problem StatementTakahashi is practicing shiritori alone again today.
Shiritori is a game as follows:

In the first turn, a player announces any one word.
In the subsequent turns, a player announces a word that satisfies the following conditions:
That word is not announced before.
The first character of that word is the same as the last character of the last word announced.



In this game, he is practicing to announce as many words as possible in ten seconds.
You are given the number of words Takahashi announced, N, and the i-th word he announced, W_i, for each i. Determine if the rules of shiritori was observed, that is, every word announced by him satisfied the conditions.




Constraints
N is an integer satisfying 2 \leq N \leq 100.
W_i is a string of length between 1 and 10 (inclusive) consisting of lowercase English letters.







InputInput is given from Standard Input in the following format:
N
W_1
W_2
:
W_N





OutputIf every word announced by Takahashi satisfied the conditions, print Yes; otherwise, print No.






Sample Input 14
hoge
english
hoge
enigma





Sample Output 1No

As hoge is announced multiple times, the rules of shiritori was not observed.





Sample Input 29
basic
c
cpp
php
python
nadesico
ocaml
lua
assembly





Sample Output 2Yes






Sample Input 38
a
aa
aaa
aaaa
aaaaa
aaaaaa
aaa
aaaaaaa





Sample Output 3No






Sample Input 43
abc
arc
agc





Sample Output 4No


",Shiritori,"Bruteforcing, String, Set / Map, Combinatorics",0.758,239,165
577,"
Score : 200 points


Problem StatementThere is a square in the xy-plane. The coordinates of its four vertices are (x_1,y_1),(x_2,y_2),(x_3,y_3) and (x_4,y_4) in counter-clockwise order.
(Assume that the positive x-axis points right, and the positive y-axis points up.)
Takahashi remembers (x_1,y_1) and (x_2,y_2), but he has forgot (x_3,y_3) and (x_4,y_4).
Given x_1,x_2,y_1,y_2, restore x_3,y_3,x_4,y_4. It can be shown that x_3,y_3,x_4 and y_4 uniquely exist and have integer values.




Constraints
|x_1|,|y_1|,|x_2|,|y_2| \leq 100
(x_1,y_1) ≠ (x_2,y_2)
All values in input are integers.







InputInput is given from Standard Input in the following format:
x_1 y_1 x_2 y_2





OutputPrint x_3,y_3,x_4 and y_4 as integers, in this order.






Sample Input 10 0 0 1





Sample Output 1-1 1 -1 0

(0,0),(0,1),(-1,1),(-1,0) is the four vertices of a square in counter-clockwise order.
Note that (x_3,y_3)=(1,1),(x_4,y_4)=(1,0) is not accepted, as the vertices are in clockwise order.





Sample Input 22 3 6 6





Sample Output 23 10 -1 7






Sample Input 331 -41 -59 26





Sample Output 3-126 -64 -36 -131


",Ruined Square,"Arithmetic, Geometry; 3d",0.817,138,99
578,"
Score : 200 points


Problem StatementThere is a grid of squares with H horizontal rows and W vertical columns.
The square at the i-th row from the top and the j-th column from the left is represented as (i, j).
Each square is black or white.
The color of the square is given as an H-by-W matrix (a_{i, j}).
If a_{i, j} is ., the square (i, j) is white; if a_{i, j} is #, the square (i, j) is black.
Snuke is compressing this grid.
He will do so by repeatedly performing the following operation while there is a row or column that consists only of white squares:

Operation: choose any one row or column that consists only of white squares, remove it and delete the space between the rows or columns.

It can be shown that the final state of the grid is uniquely determined regardless of what row or column is chosen in each operation.
Find the final state of the grid.




Constraints
1 \leq H, W \leq 100
a_{i, j} is . or #.
There is at least one black square in the whole grid.







InputInput is given from Standard Input in the following format:
H W
a_{1, 1}...a_{1, W}
:
a_{H, 1}...a_{H, W}





OutputPrint the final state of the grid in the same format as input (without the numbers of rows and columns); see the samples for clarity.






Sample Input 14 4
##.#
....
##.#
.#.#





Sample Output 1###
###
.##

The second row and the third column in the original grid will be removed.





Sample Input 23 3
#..
.#.
..#





Sample Output 2#..
.#.
..#

As there is no row or column that consists only of white squares, no operation will be performed.





Sample Input 34 5
.....
.....
..#..
.....





Sample Output 3#






Sample Input 47 6
......
....#.
.#....
..#...
..#...
......
.#..#.





Sample Output 4..#
#..
.#.
.#.
#.#


",Grid Compression,"Array, Bitmask, Bruteforcing, Data Structures",0.82,118,95
579,"
Score : 500 points


Problem StatementSnuke has a string s.
From this string, Anuke, Bnuke, and Cnuke obtained strings a, b, and c, respectively, as follows:

Choose a non-empty (contiguous) substring of s (possibly s itself). Then, replace some characters (possibly all or none) in it with ?s.

For example, if s is mississippi, we can choose the substring ssissip and replace its 1-st and 3-rd characters with ? to obtain ?s?ssip.
You are given the strings a, b, and c.
Find the minimum possible length of s.




Constraints
1 \leq |a|, |b|, |c| \leq 2000
a, b, and c consists of lowercase English letters and ?s.







InputInput is given from Standard Input in the following format:
a
b
c





OutputPrint the minimum possible length of s.






Sample Input 1a?c
der
cod





Sample Output 17

For example, s could be atcoder.





Sample Input 2atcoder
atcoder
???????





Sample Output 27

a, b, and c may not be distinct.

",Three Substrings,"String, Dynamic Programming, Precomputation, Permutation Cycle Decomposition, Bruteforcing, Array",0.357,26,5
580,"
Score : 100 points


Problem StatementYou are given an undirected graph with N vertices and 0 edges. Process Q queries of the following types.

0 u v: Add an edge (u, v).
1 u v: Print 1 if u and v are in the same connected component, 0 otherwise.





Constraints
1 \leq N \leq 200,000
1 \leq Q \leq 200,000
0 \leq u_i, v_i \lt N







InputInput is given from Standard Input in the following format:
N Q
t_1 u_1 v_1
t_2 u_2 v_2
:
t_Q u_Q v_Q





出力For each query of the latter type, print the answer.






Sample Input 14 7
1 0 1
0 0 1
0 2 3
1 0 1
1 1 2
0 0 2
1 1 3





Sample Output 10
1
0
1


",Disjoint Set Union,"Disjoint Set, Graph Theory, Offline Queries",0.88,58,47
581,"
Score : 100 points


Problem StatementYou are given an array a_0, a_1, ..., a_{N-1} of length N. Process Q queries of the following types.
The type of i-th query is represented by T_i.

T_i=1: You are given two integers X_i,V_i. Replace the value of A_{X_i} with V_i.
T_i=2: You are given two integers L_i,R_i. Calculate the maximum value among A_{L_i},A_{L_i+1},\cdots,A_{R_i}.
T_i=3: You are given two integers X_i,V_i. Calculate the minimum j such that X_i \leq j \leq N, V_i \leq A_j. If there is no such j, answer j=N+1 instead.





Constraints
1 \leq N \leq 2 \times 10^5
0 \leq A_i \leq 10^9
1 \leq Q \leq 2 \times 10^5
1 \leq T_i \leq 3
1 \leq X_i \leq N, 0 \leq V_i \leq 10^9 (T_i=1,3)
1 \leq L_i \leq R_i \leq N (T_i=2)
All values in Input are integer.







InputInput is given from Standard Input in the following format:
N Q
A_1 A_2 \cdots A_N
First query
Second query
\vdots
Q-th query

Each query is given in the following format:
If T_i=1,3,
T_i X_i V_i

If T_i=2,
T_i L_i R_i





OutputFor each query with T_i=2, 3, print the answer.






Sample Input 15 5
1 2 3 2 1
2 1 5
3 2 3
1 3 1
2 2 4
3 1 3





Sample Output 13
3
2
6


First query: Print 3, which is the maximum of (A_1,A_2,A_3,A_4,A_5)=(1,2,3,2,1).
Second query: Since 3>A_2, j=2 does not satisfy the condition．Since 3 \leq A_3, print j=3.
Third query: Replace the value of A_3 with 1. It becomes A=(1,2,1,2,1).
Fourth query: Print 2, which is the maximum of (A_2,A_3,A_4)=(2,1,2).
Fifth query: Since there is no j that satisfies the condition, print j=N+1=6.


",Segment Tree,Segment Tree,0.6,73,43
582,"
Score : 600 points


Problem StatementWe have a tree with N vertices. The i-th edge connects Vertex A_i and B_i bidirectionally.
Takahashi is standing at Vertex u, and Aoki is standing at Vertex v.
Now, they will play a game of tag as follows:


1. If Takahashi and Aoki are standing at the same vertex, the game ends. Otherwise, Takahashi moves to a vertex of his choice that is adjacent to his current vertex.


2. If Takahashi and Aoki are standing at the same vertex, the game ends. Otherwise, Aoki moves to a vertex of his choice that is adjacent to his current vertex.


3. Go back to step 1.


Takahashi performs his moves so that the game ends as late as possible, while Aoki performs his moves so that the game ends as early as possible.
Find the number of moves Aoki will perform before the end of the game if both Takahashi and Aoki know each other's position and strategy.
It can be proved that the game is bound to end.




Constraints
2 \leq N \leq 10^5
1 \leq u,v \leq N
u \neq v
1 \leq A_i,B_i \leq N
The given graph is a tree.







InputInput is given from Standard Input in the following format:
N u v
A_1 B_1
:
A_{N-1} B_{N-1}





OutputPrint the number of moves Aoki will perform before the end of the game.






Sample Input 15 4 1
1 2
2 3
3 4
3 5





Sample Output 12

If both players play optimally, the game will progress as follows:

Takahashi moves to Vertex 3.
Aoki moves to Vertex 2.
Takahashi moves to Vertex 5.
Aoki moves to Vertex 3.
Takahashi moves to Vertex 3.

Here, Aoki performs two moves.
Note that, in each move, it is prohibited to stay at the current vertex.





Sample Input 25 4 5
1 2
1 3
1 4
1 5





Sample Output 21






Sample Input 32 1 2
1 2





Sample Output 30






Sample Input 49 6 1
1 2
2 3
3 4
4 5
5 6
4 7
7 8
8 9





Sample Output 45


",Playing Tag on Tree,"Graph Theory, Breadth-first Search, Shortest Path, Tree, Game Theory, Geometry; 3d",0.444,34,17
583,"
Score : 500 points


Problem StatementWe have a grid with H horizontal rows and W vertical columns. Let (i,j) denote the square at the i-th row from the top and the j-th column from the left.
The square (i, j) has two numbers A_{ij} and B_{ij} written on it.
First, for each square, Takahashi paints one of the written numbers red and the other blue.
Then, he travels from the square (1, 1) to the square (H, W). In one move, he can move from a square (i, j) to the square (i+1, j) or the square (i, j+1). He must not leave the grid.
Let the unbalancedness be the absolute difference of the sum of red numbers and the sum of blue numbers written on the squares along Takahashi's path, including the squares (1, 1) and (H, W).
Takahashi wants to make the unbalancedness as small as possible by appropriately painting the grid and traveling on it.
Find the minimum unbalancedness possible.




Constraints
2 \leq H \leq 80
2 \leq W \leq 80
0 \leq A_{ij} \leq 80
0 \leq B_{ij} \leq 80
All values in input are integers.







InputInput is given from Standard Input in the following format:
H W
A_{11} A_{12} \ldots A_{1W}
:
A_{H1} A_{H2} \ldots A_{HW}
B_{11} B_{12} \ldots B_{1W}
:
B_{H1} B_{H2} \ldots B_{HW}





OutputPrint the minimum unbalancedness possible.






Sample Input 12 2
1 2
3 4
3 4
2 1





Sample Output 10

By painting the grid and traveling on it as shown in the figure below, the sum of red numbers and the sum of blue numbers are 3+3+1=7 and 1+2+4=7, respectively, for the unbalancedness of 0.






Sample Input 22 3
1 10 80
80 10 1
1 2 3
4 5 6





Sample Output 22


",Balanced Path,"Dyanmic Programming, Bitmask, Grid Graph, Arithmetic, Mathematics",0.32,85,26
584,"
Score : 600 points


Problem StatementFor a non-negative integer K, we define a fractal of level K as follows:

A fractal of level 0 is a grid with just one white square.
When K > 0, a fractal of level K is a 3^K \times 3^K grid. If we divide this grid into nine 3^{K-1} \times 3^{K-1} subgrids:
The central subgrid consists of only black squares.
Each of the other eight subgrids is a fractal of level K-1.



For example, a fractal of level 2 is as follows:

In a fractal of level 30, let (r, c) denote the square at the r-th row from the top and the c-th column from the left.
You are given Q quadruples of integers (a_i, b_i, c_i, d_i).
For each quadruple, find the distance from (a_i, b_i) to (c_i, d_i).
Here the distance from (a, b) to (c, d) is the minimum integer n that satisfies the following condition:

There exists a sequence of white squares (x_0, y_0), \ldots, (x_n, y_n) satisfying the following conditions:
(x_0, y_0) = (a, b)
(x_n, y_n) = (c, d)
For every i (0 \leq i \leq n-1), (x_i, y_i) and (x_{i+1}, y_{i+1}) share a side.







Constraints
1 \leq Q \leq 10000
1 \leq a_i, b_i, c_i, d_i \leq 3^{30}
(a_i, b_i) \neq (c_i, d_i)
(a_i, b_i) and (c_i, d_i) are white squares.
All values in input are integers.







InputInput is given from Standard Input in the following format:
Q
a_1 \ b_1 \ c_1 \ d_1
:
a_Q \ b_Q \ c_Q \ d_Q





OutputPrint Q lines.
The i-th line should contain the distance from (a_i, b_i) to (c_i, d_i).






Sample Input 12
4 2 7 4
9 9 1 9





Sample Output 15
8



",Fractal Shortest Path,"Divide And Conquer, Depth-first Search, Memoization, Geometry; 3d, Mathematics, Grid Graph",0.333,8,1
585,"
Score : 500 points


Problem StatementConsider sequences \{A_1,...,A_N\} of length N consisting of integers between 1 and K (inclusive).
There are K^N such sequences. Find the sum of \gcd(A_1, ..., A_N) over all of them.
Since this sum can be enormous, print the value modulo (10^9+7).
Here \gcd(A_1, ..., A_N) denotes the greatest common divisor of A_1, ..., A_N.




Constraints
2 \leq N \leq 10^5
1 \leq K \leq 10^5
All values in input are integers.







InputInput is given from Standard Input in the following format:
N K





OutputPrint the sum of \gcd(A_1, ..., A_N) over all K^N sequences, modulo (10^9+7).






Sample Input 13 2





Sample Output 19

\gcd(1,1,1)+\gcd(1,1,2)+\gcd(1,2,1)+\gcd(1,2,2)
+\gcd(2,1,1)+\gcd(2,1,2)+\gcd(2,2,1)+\gcd(2,2,2)
=1+1+1+1+1+1+1+2=9
Thus, the answer is 9.





Sample Input 23 200





Sample Output 210813692






Sample Input 3100000 100000





Sample Output 3742202979

Be sure to print the sum modulo (10^9+7).

",Sum of gcd of Tuples (Hard),"Arithmetic, Exponentiation By Squaring, Inclusion And Exclusion, Number Theory, Dyanmic Programming",0.738,60,40
586,"
Score : 500 points


Problem StatementThere are N children standing in a line from left to right. The activeness of the i-th child from the left is A_i.
You can rearrange these children just one time in any order you like.
When a child who originally occupies the x-th position from the left in the line moves to the y-th position from the left, that child earns A_x \times |x-y| happiness points.
Find the maximum total happiness points the children can earn.




Constraints
2 \leq N \leq 2000
1 \leq A_i \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
A_1 A_2 ... A_N





OutputPrint the maximum total happiness points the children can earn.






Sample Input 14
1 3 4 2





Sample Output 120

If we move the 1-st child from the left to the 3-rd position from the left, the 2-nd child to the 4-th position, the 3-rd child to the 1-st position, and the 4-th child to the 2-nd position, the children earns 1 \times |1-3|+3 \times |2-4|+4 \times |3-1|+2 \times |4-2|=20 happiness points in total.





Sample Input 26
5 5 6 1 1 1





Sample Output 258






Sample Input 36
8 6 9 1 2 1





Sample Output 385


",Active Infants,"Sorting, Dyanmic Programming, Greedy Algorithm, Mathematics",0.259,104,28
587,"
Score : 500 points


Problem Statement
There are N cities numbered 1 to N, connected by M railroads.
You are now at City 1, with 10^{100} gold coins and S silver coins in your pocket.
The i-th railroad connects City U_i and City V_i bidirectionally, and a one-way trip costs A_i silver coins and takes B_i minutes.
You cannot use gold coins to pay the fare.
There is an exchange counter in each city. At the exchange counter in City i, you can get C_i silver coins for 1 gold coin.
The transaction takes D_i minutes for each gold coin you give.
You can exchange any number of gold coins at each exchange counter.
For each t=2, ..., N, find the minimum time needed to travel from City 1 to City t. You can ignore the time spent waiting for trains.




Constraints

2 \leq N \leq 50
N-1 \leq M \leq 100
0 \leq S \leq 10^9
1 \leq A_i \leq 50
1 \leq B_i,C_i,D_i \leq 10^9
1 \leq U_i < V_i \leq N
There is no pair i, j(i \neq j) such that (U_i,V_i)=(U_j,V_j).
Each city t=2,...,N can be reached from City 1 with some number of railroads.
All values in input are integers.







Input
Input is given from Standard Input in the following format:
N M S
U_1 V_1 A_1 B_1
:
U_M V_M A_M B_M
C_1 D_1
:
C_N D_N





Output
For each t=2, ..., N in this order, print a line containing the minimum time needed to travel from City 1 to City t.






Sample Input 13 2 1
1 2 1 2
1 3 2 4
1 11
1 2
2 5





Sample Output 12
14

The railway network in this input is shown in the figure below.
In this figure, each city is labeled as follows:

The first line: the ID number i of the city (i for City i)
The second line: C_i / D_i

Similarly, each railroad is labeled as follows:

The first line: the ID number i of the railroad (i for the i-th railroad in input)
The second line: A_i / B_i


You can travel from City 1 to City 2 in 2 minutes, as follows:

Use the 1-st railroad to move from City 1 to City 2 in 2 minutes.


You can travel from City 1 to City 3 in 14 minutes, as follows:

Use the 1-st railroad to move from City 1 to City 2 in 2 minutes.
At the exchange counter in City 2, exchange 3 gold coins for 3 silver coins in 6 minutes.
Use the 1-st railroad to move from City 2 to City 1 in 2 minutes.
Use the 2-nd railroad to move from City 1 to City 3 in 4 minutes.






Sample Input 24 4 1
1 2 1 5
1 3 4 4
2 4 2 2
3 4 1 1
3 1
3 1
5 2
6 4





Sample Output 25
5
7

The railway network in this input is shown in the figure below:

You can travel from City 1 to City 4 in 7 minutes, as follows:

At the exchange counter in City 1, exchange 2 gold coins for 6 silver coins in 2 minutes.
Use the 2-nd railroad to move from City 1 to City 3 in 4 minutes.
Use the 4-th railroad to move from City 3 to City 4 in 1 minutes.






Sample Input 36 5 1
1 2 1 1
1 3 2 1
2 4 5 1
3 5 11 1
1 6 50 1
1 10000
1 3000
1 700
1 100
1 1
100 1





Sample Output 31
9003
14606
16510
16576

The railway network in this input is shown in the figure below:

You can travel from City 1 to City 6 in 16576 minutes, as follows:

Use the 1-st railroad to move from City 1 to City 2 in 1 minute.
At the exchange counter in City 2, exchange 3 gold coins for 3 silver coins in 9000 minutes.
Use the 1-st railroad to move from City 2 to City 1 in 1 minute.
Use the 2-nd railroad to move from City 1 to City 3 in 1 minute.
At the exchange counter in City 3, exchange 8 gold coins for 8 silver coins in 5600 minutes.
Use the 2-nd railroad to move from City 3 to City 1 in 1 minute.
Use the 1-st railroad to move from City 1 to City 2 in 1 minute.
Use the 3-rd railroad to move from City 2 to City 4 in 1 minute.
At the exchange counter in City 4, exchange 19 gold coins for 19 silver coins in 1900 minutes.
Use the 3-rd railroad to move from City 4 to City 2 in 1 minute.
Use the 1-st railroad to move from City 2 to City 1 in 1 minute.
Use the 2-nd railroad to move from City 1 to City 3 in 1 minute.
Use the 4-th railroad to move from City 3 to City 5 in 1 minute.
At the exchange counter in City 5, exchange 63 gold coins for 63 silver coins in 63 minutes.
Use the 4-th railroad to move from City 5 to City 3 in 1 minute.
Use the 2-nd railroad to move from City 3 to City 1 in 1 minute.
Use the 5-th railroad to move from City 1 to City 6 in 1 minute.






Sample Input 44 6 1000000000
1 2 50 1
1 3 50 5
1 4 50 7
2 3 50 2
2 4 50 4
3 4 50 3
10 2
4 4
5 5
7 7





Sample Output 41
3
5

The railway network in this input is shown in the figure below:






Sample Input 52 1 0
1 2 1 1
1 1000000000
1 1





Sample Output 51000000001

The railway network in this input is shown in the figure below:

You can travel from City 1 to City 2 in 1000000001 minutes, as follows:

At the exchange counter in City 1, exchange 1 gold coin for 1 silver coin in 1000000000 minutes.
Use the 1-st railroad to move from City 1 to City 2 in 1 minute.


",Two Currencies,"Graph Theory, Dijkstra's, Priority Queue, Dyanmic Programming, Dynamic Programming",0.333,107,32
588,"
Score : 600 points


Problem StatementWe have a tree with N vertices, whose i-th edge connects Vertex u_i and Vertex v_i.
Vertex i has an integer a_i written on it.
For every integer k from 1 through N, solve the following problem:

We will make a sequence by lining up the integers written on the vertices along the shortest path from Vertex 1 to Vertex k, in the order they appear. Find the length of the longest increasing subsequence of this sequence.

Here, the longest increasing subsequence of a sequence A of length L is the subsequence A_{i_1} , A_{i_2} , ... , A_{i_M} with the greatest possible value of M such that 1 \leq i_1 < i_2 < ... < i_M \leq L and A_{i_1} < A_{i_2} < ... < A_{i_M}.




Constraints
2 \leq N \leq 2 \times 10^5
1 \leq a_i \leq 10^9
1 \leq u_i , v_i \leq N
u_i \neq v_i
The given graph is a tree.
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
a_1 a_2 ... a_N
u_1 v_1
u_2 v_2
:
u_{N-1} v_{N-1}





OutputPrint N lines. The k-th line, print the length of the longest increasing subsequence of the sequence obtained from the shortest path from Vertex 1 to Vertex k.






Sample Input 110
1 2 5 3 4 6 7 3 2 4
1 2
2 3
3 4
4 5
3 6
6 7
1 8
8 9
9 10





Sample Output 11
2
3
3
4
4
5
2
2
3

For example, the sequence A obtained from the shortest path from Vertex 1 to Vertex 5 is 1,2,5,3,4. Its longest increasing subsequence is A_1, A_2, A_4, A_5, with the length of 4.

",LIS on Tree,"Depth-first Search, Tree, Dynamic Programming, Binary Search, Backtracking, Graph Theory",0.162,176,30
589,"
Score : 400 points


Problem StatementYou are going out for a walk, when you suddenly encounter a monster. Fortunately, you have N katana (swords), Katana 1, Katana 2, …, Katana N, and can perform the following two kinds of attacks in any order:

Wield one of the katana you have. When you wield Katana i (1 ≤ i ≤ N), the monster receives a_i points of damage. The same katana can be wielded any number of times.
Throw one of the katana you have. When you throw Katana i (1 ≤ i ≤ N) at the monster, it receives b_i points of damage, and you lose the katana. That is, you can no longer wield or throw that katana.

The monster will vanish when the total damage it has received is H points or more. At least how many attacks do you need in order to vanish it in total?




Constraints
1 ≤ N ≤ 10^5
1 ≤ H ≤ 10^9
1 ≤ a_i ≤ b_i ≤ 10^9
All input values are integers.







InputInput is given from Standard Input in the following format:
N H
a_1 b_1
:
a_N b_N





OutputPrint the minimum total number of attacks required to vanish the monster.






Sample Input 11 10
3 5





Sample Output 13

You have one katana. Wielding it deals 3 points of damage, and throwing it deals 5 points of damage. By wielding it twice and then throwing it, you will deal 3 + 3 + 5 = 11 points of damage in a total of three attacks, vanishing the monster.





Sample Input 22 10
3 5
2 6





Sample Output 22

In addition to the katana above, you also have another katana. Wielding it deals 2 points of damage, and throwing it deals 6 points of damage. By throwing both katana, you will deal 5 + 6 = 11 points of damage in two attacks, vanishing the monster.





Sample Input 34 1000000000
1 1
1 10000000
1 30000000
1 99999999





Sample Output 3860000004






Sample Input 45 500
35 44
28 83
46 62
31 79
40 43





Sample Output 49


",Katana Thrower,"Greedy Algorithm, Sorting, Arithmetic, Bruteforcing",0.371,225,70
590,"
Score : 600 points


Problem StatementGiven are two integer sequences of N elements each: A_1,...,A_N and B_1,...,B_N.
Determine if it is possible to do the following operation at most N-2 times (possibly zero) so that, for every integer i from 1 to N, A_i \leq B_i holds:

Choose two distinct integers x and y between 1 and N (inclusive), and swap the values of A_x and A_y.





Constraints
2 \leq N \leq 10^5
1 \leq A_i,B_i \leq 10^9







InputInput is given from Standard Input in the following format:
N
A_1 A_2 ... A_N
B_1 B_2 ... B_N





OutputIf the objective is achievable, print Yes; if it is not, print No.






Sample Input 13
1 3 2
1 2 3





Sample Output 1Yes

We should swap the values of A_2 and A_3.





Sample Input 23
1 2 3
2 2 2





Sample Output 2No






Sample Input 36
3 1 2 6 3 4
2 2 8 3 4 3





Sample Output 3Yes


",Swaps,"Sorting, Array, Permutation Cycle Decomposition, Greedy Algorithm, Value / Coordinate Compression",0.043,51,3
591,"
Score : 100 points


Problem StatementYou are given an integer N that has exactly four digits in base ten.
How many times does 2 occur in the base-ten representation of N?




Constraints
1000 \leq N \leq 9999







InputInput is given from Standard Input in the following format:
N





OutputPrint the answer.






Sample Input 11222





Sample Output 13

2 occurs three times in 1222. By the way, this contest is held on December 22 (JST).





Sample Input 23456





Sample Output 20






Sample Input 39592





Sample Output 31


",12/22,"String, Counting",0.84,64,50
592,"
Score : 200 points


Problem StatementThere are N rectangular plate materials made of special metal called AtCoder Alloy.
The dimensions of the i-th material are A_i \times B_i (A_i vertically and B_i horizontally).
Takahashi wants a rectangular plate made of AtCoder Alloy whose dimensions are exactly H \times W.
He is trying to obtain such a plate by choosing one of the N materials and cutting it if necessary.
When cutting a material, the cuts must be parallel to one of the sides of the material.
Also, the materials have fixed directions and cannot be rotated.
For example, a 5 \times 3 material cannot be used as a 3 \times 5 plate.
Out of the N materials, how many can produce an H \times W plate if properly cut?




Constraints
1 \leq N \leq 1000
1 \leq H \leq 10^9
1 \leq W \leq 10^9
1 \leq A_i \leq 10^9
1 \leq B_i \leq 10^9







InputInput is given from Standard Input in the following format:
N H W
A_1 B_1
A_2 B_2
:
A_N B_N





OutputPrint the answer.






Sample Input 13 5 2
10 3
5 2
2 5





Sample Output 12

Takahashi wants a 5 \times 2 plate.

The dimensions of the first material are 10 \times 3. We can obtain a 5 \times 2 plate by properly cutting it.
The dimensions of the second material are 5 \times 2. We can obtain a 5 \times 2 plate without cutting it.
The dimensions of the third material are 2 \times 5. We cannot obtain a 5 \times 2 plate, whatever cuts are made. Note that the material cannot be rotated and used as a 5 \times 2 plate.






Sample Input 210 587586158 185430194
894597290 708587790
680395892 306946994
590262034 785368612
922328576 106880540
847058850 326169610
936315062 193149191
702035777 223363392
11672949 146832978
779291680 334178158
615808191 701464268





Sample Output 28


",AtCoder Alloy,"Bruteforcing, Implementation, Counting",0.889,50,44
593,"
Score : 400 points


Problem StatementThere are N mountains in a circle, called Mountain 1, Mountain 2, ..., Mountain N in clockwise order. N is an odd number.
Between these mountains, there are N dams, called Dam 1, Dam 2, ..., Dam N. Dam i (1 \leq i \leq N) is located between Mountain i and i+1 (Mountain N+1 is Mountain 1).
When Mountain i (1 \leq i \leq N) receives 2x liters of rain, Dam i-1 and Dam i each accumulates x liters of water (Dam 0 is Dam N).
One day, each of the mountains received a non-negative even number of liters of rain.
As a result, Dam i (1 \leq i \leq N) accumulated a total of A_i liters of water.
Find the amount of rain each of the mountains received. We can prove that the solution is unique under the constraints of this problem.




Constraints
All values in input are integers.
3 \leq N \leq 10^5-1
N is an odd number.
0 \leq A_i \leq 10^9
The situation represented by input can occur when each of the mountains receives a non-negative even number of liters of rain.







InputInput is given from Standard Input in the following format:
N
A_1 A_2 ... A_N





OutputPrint N integers representing the number of liters of rain Mountain 1, Mountain 2, ..., Mountain N received, in this order.






Sample Input 13
2 2 4





Sample Output 14 0 4

If we assume Mountain 1, 2, and 3 received 4, 0, and 4 liters of rain, respectively, it is consistent with this input, as follows:

Dam 1 should have accumulated \frac{4}{2} + \frac{0}{2} = 2 liters of water.
Dam 2 should have accumulated \frac{0}{2} + \frac{4}{2} = 2 liters of water.
Dam 3 should have accumulated \frac{4}{2} + \frac{4}{2} = 4 liters of water.






Sample Input 25
3 8 7 5 5





Sample Output 22 4 12 2 8






Sample Input 33
1000000000 1000000000 0





Sample Output 30 2000000000 0


",Rain Flows into Dams,"Mathematics, Arithmetic, Parity, Recursion, Array",0.545,170,88
594,"
Score : 100 points


Problem StatementIt has been decided that a programming contest sponsored by company A will be held, so we will post the notice on a bulletin board.
The bulletin board is in the form of a grid with N rows and N columns, and the notice will occupy a rectangular region with H rows and W columns.
How many ways are there to choose where to put the notice so that it completely covers exactly HW squares?




Constraints
1 \leq H, W \leq N \leq 100
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
H
W





OutputPrint the answer.






Sample Input 13
2
3





Sample Output 12

There are two ways to put the notice, as follows:
###   ...
###   ###
...   ###

Here, # represents a square covered by the notice, and . represents a square not covered.





Sample Input 2100
1
1





Sample Output 210000






Sample Input 35
4
2





Sample Output 38


",Bulletin Board,"Arithmetic, Boolean Operations On Geometric Objects, Mathematics",0.891,70,55
595,"
Score : 200 points


Problem StatementYou have written N problems to hold programming contests.
The i-th problem will have a score of P_i points if used in a contest.
With these problems, you would like to hold as many contests as possible under the following condition:

A contest has three problems. The first problem has a score not greater than A points, the second has a score between A + 1 and B points (inclusive), and the third has a score not less than B + 1 points.

The same problem should not be used in multiple contests.
At most how many contests can be held?




Constraints
3 \leq N \leq 100
1 \leq P_i \leq 20 (1 \leq i \leq N)
1 \leq A < B < 20
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
A B
P_1 P_2 ... P_N





OutputPrint the answer.






Sample Input 17
5 15
1 10 16 2 7 20 12





Sample Output 12

Two contests can be held by putting the first, second, third problems and the fourth, fifth, sixth problems together.





Sample Input 28
3 8
5 5 5 10 10 10 15 20





Sample Output 20

No contest can be held, because there is no problem with a score of A = 3 or less.





Sample Input 33
5 6
5 6 10





Sample Output 31


",Contests,"Bruteforcing, Implementation, Mathematics",0.846,64,51
596,"
Score : 300 points


Problem StatementThere is a grid with H rows and W columns, where each square is painted black or white.
You are given H strings S_1, S_2, ..., S_H, each of length W.
If the square at the i-th row from the top and the j-th column from the left is painted black, the j-th character in the string S_i is #; if that square is painted white, the j-th character in the string S_i is ..
Find the number of pairs of a black square c_1 and a white square c_2 that satisfy the following condition:

There is a path from the square c_1 to the square c_2 where we repeatedly move to a vertically or horizontally adjacent square through an alternating sequence of black and white squares: black, white, black, white...





Constraints
1 \leq H, W \leq 400
|S_i| = W (1 \leq i \leq H)
For each i (1 \leq i \leq H), the string S_i consists of characters # and ..







InputInput is given from Standard Input in the following format:
H W
S_1
S_2
:
S_H





OutputPrint the answer.






Sample Input 13 3
.#.
..#
#..





Sample Output 110

Some of the pairs satisfying the condition are ((1, 2), (3, 3)) and ((3, 1), (3, 2)), where (i, j) denotes the square at the i-th row from the top and the j-th column from the left.





Sample Input 22 4
....
....





Sample Output 20






Sample Input 34 3
###
###
...
###





Sample Output 36


",Alternating Path,"Grid Graph, Depth-first Search, Graph Theory, Counting",0.125,58,16
597,"
Score : 200 points


Problem StatementFind the largest square number not exceeding N. Here, a square number is an integer that can be represented as the square of an integer.




Constraints
1 \leq N \leq 10^9
N is an integer.







InputInput is given from Standard Input in the following format:
N





OutputPrint the largest square number not exceeding N.






Sample Input 110





Sample Output 19

10 is not square, but 9 = 3 × 3 is. Thus, we print 9.





Sample Input 281





Sample Output 281






Sample Input 3271828182





Sample Output 3271821169


",Around Square,"Mathematics, Bruteforcing, Binary Search",0.819,146,113
598,"
Score : 100 points


Problem StatementThere are N flowers arranged in a row.
For each i (1 \leq i \leq N), the height and the beauty of the i-th flower from the left is h_i and a_i, respectively.
Here, h_1, h_2, \ldots, h_N are all distinct.
Taro is pulling out some flowers so that the following condition is met:

The heights of the remaining flowers are monotonically increasing from left to right.

Find the maximum possible sum of the beauties of the remaining flowers.




Constraints
All values in input are integers.
1 \leq N \leq 2 × 10^5
1 \leq h_i \leq N
h_1, h_2, \ldots, h_N are all distinct.
1 \leq a_i \leq 10^9







InputInput is given from Standard Input in the following format:
N
h_1 h_2 \ldots h_N
a_1 a_2 \ldots a_N





OutputPrint the maximum possible sum of the beauties of the remaining flowers.






Sample Input 14
3 1 4 2
10 20 30 40





Sample Output 160

We should keep the second and fourth flowers from the left.
Then, the heights would be 1, 2 from left to right, which is monotonically increasing, and the sum of the beauties would be 20 + 40 = 60.





Sample Input 21
1
10





Sample Output 210

The condition is met already at the beginning.





Sample Input 35
1 2 3 4 5
1000000000 1000000000 1000000000 1000000000 1000000000





Sample Output 35000000000

The answer may not fit into a 32-bit integer type.





Sample Input 49
4 2 5 8 3 6 1 7 9
6 8 8 4 6 3 5 7 5





Sample Output 431

We should keep the second, third, sixth, eighth and ninth flowers from the left.

",Flowers,"Dyanmic Programming, Segment Tree, Binary Indexed Tree, Value / Coordinate Compression, Sorting",0.471,143,55
599,"
Score : 100 points


Problem StatementLet N be a positive odd number.
There are N coins, numbered 1, 2, \ldots, N.
For each i (1 \leq i \leq N), when Coin i is tossed, it comes up heads with probability p_i and tails with probability 1 - p_i.
Taro has tossed all the N coins.
Find the probability of having more heads than tails.




Constraints
N is an odd number.
1 \leq N \leq 2999
p_i is a real number and has two decimal places.
0 < p_i < 1







InputInput is given from Standard Input in the following format:
N
p_1 p_2 \ldots p_N





OutputPrint the probability of having more heads than tails.
The output is considered correct when the absolute error is not greater than 10^{-9}.






Sample Input 13
0.30 0.60 0.80





Sample Output 10.612

The probability of each case where we have more heads than tails is as follows:

The probability of having (Coin 1, Coin 2, Coin 3) = (Head, Head, Head) is 0.3 × 0.6 × 0.8 = 0.144;
The probability of having (Coin 1, Coin 2, Coin 3) = (Tail, Head, Head) is 0.7 × 0.6 × 0.8 = 0.336;
The probability of having (Coin 1, Coin 2, Coin 3) = (Head, Tail, Head) is 0.3 × 0.4 × 0.8 = 0.096;
The probability of having (Coin 1, Coin 2, Coin 3) = (Head, Head, Tail) is 0.3 × 0.6 × 0.2 = 0.036.

Thus, the probability of having more heads than tails is 0.144 + 0.336 + 0.096 + 0.036 = 0.612.





Sample Input 21
0.50





Sample Output 20.5

Outputs such as 0.500, 0.500000001 and 0.499999999 are also considered correct.





Sample Input 35
0.42 0.01 0.42 0.99 0.42





Sample Output 30.3821815872


",Coins,"Dyanmic Programming, Probability Theory, Dynamic Programming",0.767,344,237
600,"
Score : 100 points


Problem StatementThere are N dishes, numbered 1, 2, \ldots, N.
Initially, for each i (1 \leq i \leq N), Dish i has a_i (1 \leq a_i \leq 3) pieces of sushi on it.
Taro will perform the following operation repeatedly until all the pieces of sushi are eaten:

Roll a die that shows the numbers 1, 2, \ldots, N with equal probabilities, and let i be the outcome. If there are some pieces of sushi on Dish i, eat one of them; if there is none, do nothing.

Find the expected number of times the operation is performed before all the pieces of sushi are eaten.




Constraints
All values in input are integers.
1 \leq N \leq 300
1 \leq a_i \leq 3







InputInput is given from Standard Input in the following format:
N
a_1 a_2 \ldots a_N





OutputPrint the expected number of times the operation is performed before all the pieces of sushi are eaten.
The output is considered correct when the relative difference is not greater than 10^{-9}.






Sample Input 13
1 1 1





Sample Output 15.5

The expected number of operations before the first piece of sushi is eaten, is 1.
After that, the expected number of operations before the second sushi is eaten, is 1.5.
After that, the expected number of operations before the third sushi is eaten, is 3.
Thus, the expected total number of operations is 1 + 1.5 + 3 = 5.5.





Sample Input 21
3





Sample Output 23

Outputs such as 3.00, 3.000000003 and 2.999999997 will also be accepted.





Sample Input 32
1 2





Sample Output 34.5






Sample Input 410
1 3 2 3 3 2 3 2 1 3





Sample Output 454.48064457488221


",Sushi,"Dyanmic Programming, Bitmask, Probability Theory, Mathematics, Memoization",0.681,124,80
601,"
Score : 100 points


Problem StatementTaro and Jiro will play the following game against each other.
Initially, they are given a sequence a = (a_1, a_2, \ldots, a_N).
Until a becomes empty, the two players perform the following operation alternately, starting from Taro:

Remove the element at the beginning or the end of a. The player earns x points, where x is the removed element.

Let X and Y be Taro's and Jiro's total score at the end of the game, respectively.
Taro tries to maximize X - Y, while Jiro tries to minimize X - Y.
Assuming that the two players play optimally, find the resulting value of X - Y.




Constraints
All values in input are integers.
1 \leq N \leq 3000
1 \leq a_i \leq 10^9







InputInput is given from Standard Input in the following format:
N
a_1 a_2 \ldots a_N





OutputPrint the resulting value of X - Y, assuming that the two players play optimally.






Sample Input 14
10 80 90 30





Sample Output 110

The game proceeds as follows when the two players play optimally (the element being removed is written bold):

Taro: (10, 80, 90, 30) → (10, 80, 90)
Jiro: (10, 80, 90) → (10, 80)
Taro: (10, 80) → (10)
Jiro: (10) → ()

Here, X = 30 + 80 = 110 and Y = 90 + 10 = 100.





Sample Input 23
10 100 10





Sample Output 2-80

The game proceeds, for example, as follows when the two players play optimally:

Taro: (10, 100, 10) → (100, 10)
Jiro: (100, 10) → (10)
Taro: (10) → ()

Here, X = 10 + 10 = 20 and Y = 100.





Sample Input 31
10





Sample Output 310






Sample Input 410
1000000000 1 1000000000 1 1000000000 1 1000000000 1 1000000000 1





Sample Output 44999999995

The answer may not fit into a 32-bit integer type.





Sample Input 56
4 2 9 7 1 5





Sample Output 52

The game proceeds, for example, as follows when the two players play optimally:

Taro: (4, 2, 9, 7, 1, 5) → (4, 2, 9, 7, 1)
Jiro: (4, 2, 9, 7, 1) → (2, 9, 7, 1)
Taro: (2, 9, 7, 1) → (2, 9, 7)
Jiro: (2, 9, 7) → (2, 9)
Taro: (2, 9) → (2)
Jiro: (2) → ()

Here, X = 5 + 1 + 9 = 15 and Y = 4 + 7 + 2 = 13.

",Deque,"Dyanmic Programming, Game Theory, Mathematics, Two-pointer",0.607,229,135
602,"
Score : 100 points


Problem StatementConsider a string of length N consisting of 0 and 1.
The score for the string is calculated as follows:

For each i (1 \leq i \leq M), a_i is added to the score if the string contains 1 at least once between the l_i-th and r_i-th characters (inclusive).

Find the maximum possible score of a string.




Constraints
All values in input are integers.
1 \leq N \leq 2 × 10^5
1 \leq M \leq 2 × 10^5
1 \leq l_i \leq r_i \leq N
|a_i| \leq 10^9







InputInput is given from Standard Input in the following format:
N M
l_1 r_1 a_1
l_2 r_2 a_2
:
l_M r_M a_M





OutputPrint the maximum possible score of a string.






Sample Input 15 3
1 3 10
2 4 -10
3 5 10





Sample Output 120

The score for 10001 is a_1 + a_3 = 10 + 10 = 20.





Sample Input 23 4
1 3 100
1 1 -10
2 2 -20
3 3 -30





Sample Output 290

The score for 100 is a_1 + a_2 = 100 + (-10) = 90.





Sample Input 31 1
1 1 -10





Sample Output 30

The score for 0 is 0.





Sample Input 41 5
1 1 1000000000
1 1 1000000000
1 1 1000000000
1 1 1000000000
1 1 1000000000





Sample Output 45000000000

The answer may not fit into a 32-bit integer type.





Sample Input 56 8
5 5 3
1 1 10
1 6 -8
3 6 5
3 4 9
5 5 -2
1 3 -6
4 6 -7





Sample Output 510

For example, the score for 101000 is a_2 + a_3 + a_4 + a_5 + a_7 = 10 + (-8) + 5 + 9 + (-6) = 10.

",Intervals,"Dyanmic Programming, Sorting, Segment Tree With Lazy Propagation, Segment Tree, Offline Queries",0.7,18,11
603,"
Score : 100 points


Problem StatementThere is a simple directed graph G with N vertices, numbered 1, 2, \ldots, N.
For each i and j (1 \leq i, j \leq N), you are given an integer a_{i, j} that represents whether there is a directed edge from Vertex i to j.
If a_{i, j} = 1, there is a directed edge from Vertex i to j; if a_{i, j} = 0, there is not.
Find the number of different directed paths of length K in G, modulo 10^9 + 7.
We will also count a path that traverses the same edge multiple times.




Constraints
All values in input are integers.
1 \leq N \leq 50
1 \leq K \leq 10^{18}
a_{i, j} is 0 or 1.
a_{i, i} = 0







InputInput is given from Standard Input in the following format:
N K
a_{1, 1} \ldots a_{1, N}
:
a_{N, 1} \ldots a_{N, N}





OutputPrint the number of different directed paths of length K in G, modulo 10^9 + 7.






Sample Input 14 2
0 1 0 0
0 0 1 1
0 0 0 1
1 0 0 0





Sample Output 16

G is drawn in the figure below:

There are six directed paths of length 2:

1 → 2 → 3
1 → 2 → 4
2 → 3 → 4
2 → 4 → 1
3 → 4 → 1
4 → 1 → 2






Sample Input 23 3
0 1 0
1 0 1
0 0 0





Sample Output 23

G is drawn in the figure below:

There are three directed paths of length 3:

1 → 2 → 1 → 2
2 → 1 → 2 → 1
2 → 1 → 2 → 3






Sample Input 36 2
0 0 0 0 0 0
0 0 1 0 0 0
0 0 0 0 0 0
0 0 0 0 1 0
0 0 0 0 0 1
0 0 0 0 0 0





Sample Output 31

G is drawn in the figure below:

There is one directed path of length 2:

4 → 5 → 6






Sample Input 41 1
0





Sample Output 40






Sample Input 510 1000000000000000000
0 0 1 1 0 0 0 1 1 0
0 0 0 0 0 1 1 1 0 0
0 1 0 0 0 1 0 1 0 1
1 1 1 0 1 1 0 1 1 0
0 1 1 1 0 1 0 1 1 1
0 0 0 1 0 0 1 0 1 0
0 0 0 1 1 0 0 1 0 1
1 0 0 0 1 0 1 0 0 0
0 0 0 0 0 1 0 0 0 0
1 0 1 1 1 0 1 1 1 0





Sample Output 5957538352

Be sure to print the count modulo 10^9 + 7.

",Walk,"Graph Theory, Matrix, Exponentiation By Squaring, Arithmetic",0.909,49,45
604,"
Score : 200 points


Problem StatementAn integer X is called a Harshad number if X is divisible by f(X), where f(X) is the sum of the digits in X when written in base 10.
Given an integer N, determine whether it is a Harshad number.




Constraints
1?N?10^8
N is an integer.







InputInput is given from Standard Input in the following format:
N





OutputPrint Yes if N is a Harshad number; print No otherwise.






Sample Input 112





Sample Output 1Yes

f(12)=1+2=3. Since 12 is divisible by 3, 12 is a Harshad number.





Sample Input 257





Sample Output 2No

f(57)=5+7=12. Since 57 is not divisible by 12, 12 is not a Harshad number.





Sample Input 3148





Sample Output 3No


",Harshad Number,"Arithmetic, Bruteforcing, Implementation",0.73,303,179
605,"
Score : 300 points


Problem Statement""Pizza At"", a fast food chain, offers three kinds of pizza: ""A-pizza"", ""B-pizza"" and ""AB-pizza"". A-pizza and B-pizza are completely different pizzas, and AB-pizza is one half of A-pizza and one half of B-pizza combined together. The prices of one A-pizza, B-pizza and AB-pizza are A yen, B yen and C yen (yen is the currency of Japan), respectively.
Nakahashi needs to prepare X A-pizzas and Y B-pizzas for a party tonight. He can only obtain these pizzas by directly buying A-pizzas and B-pizzas, or buying two AB-pizzas and then rearrange them into one A-pizza and one B-pizza. At least how much money does he need for this? It is fine to have more pizzas than necessary by rearranging pizzas.




Constraints
1 ≤ A, B, C ≤ 5000
1 ≤ X, Y ≤ 10^5
All values in input are integers.







InputInput is given from Standard Input in the following format:
A B C X Y





OutputPrint the minimum amount of money required to prepare X A-pizzas and Y B-pizzas.






Sample Input 11500 2000 1600 3 2





Sample Output 17900

It is optimal to buy four AB-pizzas and rearrange them into two A-pizzas and two B-pizzas, then buy additional one A-pizza.





Sample Input 21500 2000 1900 3 2





Sample Output 28500

It is optimal to directly buy three A-pizzas and two B-pizzas.





Sample Input 31500 2000 500 90000 100000





Sample Output 3100000000

It is optimal to buy 200000 AB-pizzas and rearrange them into 100000 A-pizzas and 100000 B-pizzas. We will have 10000 more A-pizzas than necessary, but that is fine.

",Half and Half,"Bruteforcing, Greedy Algorithm, Mathematics, Boolean Operations On Geometric Objects",0.654,87,49
606,"
Score : 600 points


Problem StatementConstruct a sequence a = {a_1,\ a_2,\ ...,\ a_{2^{M + 1}}} of length 2^{M + 1} that satisfies the following conditions, if such a sequence exists.

Each integer between 0 and 2^M - 1 (inclusive) occurs twice in a.
For any i and j (i < j) such that a_i = a_j, the formula a_i \ xor \ a_{i + 1} \ xor \ ... \ xor \ a_j = K holds.


What is xor (bitwise exclusive or)?
The xor of integers c_1, c_2, ..., c_n is defined as follows:

When c_1 \ xor \ c_2 \ xor \ ... \ xor \ c_n is written in base two, the digit in the 2^k's place (k \geq 0) is 1 if the number of integers among c_1, c_2, ...c_m whose binary representations have 1 in the 2^k's place is odd, and 0 if that count is even.

For example, 3 \ xor \ 5 = 6. (If we write it in base two: 011 xor 101 = 110.)
",XOR Matching,"Bitmask, Xor Basis (gf(2)), Boolean Operations On Geometric Objects, Constructive, Bruteforcing",0.391,50,18
607,"
Score : 500 points


Problem StatementThere is an infinitely long street that runs west to east, which we consider as a number line.
There are N roadworks scheduled on this street.
The i-th roadwork blocks the point at coordinate X_i from time S_i - 0.5 to time T_i - 0.5.
Q people are standing at coordinate 0. The i-th person will start the coordinate 0 at time D_i, continue to walk with speed 1 in the positive direction and stop walking when reaching a blocked point.
Find the distance each of the Q people will walk.




Constraints
All values in input are integers.
1 \leq N, Q \leq 2 \times 10^5
0 \leq S_i < T_i \leq 10^9
1 \leq X_i \leq 10^9
0 \leq D_1 < D_2 < ... < D_Q \leq 10^9
If i \neq j and X_i = X_j, the intervals [S_i, T_i) and [S_j, T_j) do not overlap.







InputInput is given from Standard Input in the following format:
N Q
S_1 T_1 X_1
:
S_N T_N X_N
D_1
:
D_Q





OutputPrint Q lines. The i-th line should contain the distance the i-th person will walk or -1 if that person walks forever.






Sample Input 14 6
1 3 2
7 13 10
18 20 13
3 4 2
0
1
2
3
5
8





Sample Output 12
2
10
-1
13
-1

The first person starts coordinate 0 at time 0 and stops walking at coordinate 2 when reaching a point blocked by the first roadwork at time 2.
The second person starts coordinate 0 at time 1 and reaches coordinate 2 at time 3. The first roadwork has ended, but the fourth roadwork has begun, so this person also stops walking at coordinate 2.
The fourth and sixth persons encounter no roadworks while walking, so they walk forever. The output for these cases is -1.

",Roadwork,"Sorting, Binary Search Tree, Dynamic Programming, Binary Search",0.217,68,12
608,"
Score : 400 points


Problem StatementWe have a grid with H rows and W columns of squares.
Snuke is painting these squares in colors 1, 2, ..., N.
Here, the following conditions should be satisfied:

For each i (1 ≤ i ≤ N), there are exactly a_i squares painted in Color i. Here, a_1 + a_2 + ... + a_N = H W.
For each i (1 ≤ i ≤ N), the squares painted in Color i are 4-connected. That is, every square painted in Color i can be reached from every square painted in Color i by repeatedly traveling to a horizontally or vertically adjacent square painted in Color i.

Find a way to paint the squares so that the conditions are satisfied.
It can be shown that a solution always exists.




Constraints
1 ≤ H, W ≤ 100
1 ≤ N ≤ H W
a_i ≥ 1
a_1 + a_2 + ... + a_N = H W







InputInput is given from Standard Input in the following format:
H W
N
a_1 a_2 ... a_N





OutputPrint one way to paint the squares that satisfies the conditions.
Output in the following format:
c_{1 1} ... c_{1 W}
:
c_{H 1} ... c_{H W}

Here, c_{i j} is the color of the square at the i-th row from the top and j-th column from the left.






Sample Input 12 2
3
2 1 1





Sample Output 11 1
2 3

Below is an example of an invalid solution:
1 2
3 1

This is because the squares painted in Color 1 are not 4-connected.





Sample Input 23 5
5
1 2 3 4 5





Sample Output 21 4 4 4 3
2 5 4 5 3
2 5 5 5 3






Sample Input 31 1
1
1





Sample Output 31


",Grid Coloring,"Greedy Algorithm, Grid Graph, Array, Graph Theory",0.761,61,42
609,"
Score : 500 points


Problem StatementThere are N blocks arranged in a row. Let us paint these blocks.
We will consider two ways to paint the blocks different if and only if there is a block painted in different colors in those two ways.
Find the number of ways to paint the blocks under the following conditions:

For each block, use one of the M colors, Color 1 through Color M, to paint it. It is not mandatory to use all the colors.
There may be at most K pairs of adjacent blocks that are painted in the same color.

Since the count may be enormous, print it modulo 998244353.




Constraints
All values in input are integers.
1 \leq N, M \leq 2 \times 10^5
0 \leq K \leq N - 1







InputInput is given from Standard Input in the following format:
N M K





OutputPrint the answer.






Sample Input 13 2 1





Sample Output 16

The following ways to paint the blocks satisfy the conditions: 112, 121, 122, 211, 212, and 221. Here, digits represent the colors of the blocks.





Sample Input 2100 100 0





Sample Output 273074801






Sample Input 360522 114575 7559





Sample Output 3479519525


",Colorful Blocks,"Combinatorics, Arithmetic, Exponentiation By Squaring, Precomputation, Mathematics",0.588,79,39
610,"
Score : 300 points


Problem StatementYou are given N real values A_1, A_2, \ldots, A_N.
Compute the number of pairs of indices (i, j)
    such that i < j and the product A_i \cdot A_j is integer.




Constraints
2 \leq N \leq 200\,000
0 < A_i < 10^4
A_i is given with at most 9 digits after the decimal.







InputInput is given from Standard Input in the following format.
N
A_1
A_2
\vdots
A_N





OutputPrint the number of pairs with integer product A_i \cdot A_j (and i < j).






Sample Input 15
7.5
2.4
17.000000001
17
16.000000000





Sample Output 13

There are 3 pairs with integer product:

7.5 \cdot 2.4 = 18
7.5 \cdot 16 = 120
17 \cdot 16 = 272






Sample Input 211
0.9
1
1
1.25
2.30000
5
70
0.000000001
9999.999999999
0.999999999
1.000000001





Sample Output 28


",Integer Product,"Prime Factorization, Counting, Enumeration, Combinatorics, Mathematics",0.145,178,36
611,"
Score : 1800 points


Problem StatementThis is an output-only problem. You shouldn't read anything from the input.
In short, your task is to simulate multiplication by using only comparison (x < y) and addition (x + y).
There is no input in this problem, you just print a sequence of operations.
Imagine that there is a big array a[0], a[1], ..., a[N-1] of length N.
The first two values are initially two non-negative integers A and B (which are unknown to you),
    the other elements are zeros.
Your goal is to get the product A \cdot B in a[2] at the end.
You are allowed operations of two types, with the following format (where 0 \leq i, j, k < N):

+ i j k — applies operation a[k] = a[i] + a[j].
< i j k — applies operation a[k] = a[i] < a[j].
    That is, if a[i] < a[j] then a[k] becomes 1, otherwise it becomes 0.

You can use at most Q operations.
Elements of a can't exceed V.
Indices (i, j, k) don't have to be distinct.
It's allowed to modify any element of the array (including the first two).
The actual checker simulates the process for multiple pairs (A, B) within a single test.
Each time, the checker chooses values A and B, creates the array a = [A, B, 0, 0, \ldots, 0],
    applies all your operations and ensures that a[2] = A \cdot B.




Constraints
0 \leq A, B \leq 10^9
N = Q = 200\,000
V = 10^{19} = 10\,000\,000\,000\,000\,000\,000





Partial Score
800 points will be awarded for passing tests that satisfy A, B \leq 10.
Another 1000 points will be awarded for passing all tests.







InputThe Standard Input is empty.




OutputIn the first line, print the number of operations.
Each operation should then be printed in a single line of format + i j k or < i j k.






Sample Input 1




Sample Output 14
< 0 1 8
+ 0 1 2
+ 2 8 2
+ 0 0 0
In the first sample test, the checker checks your sequence only for a pair (A, B) = (2, 3).
The provided output is correct for this test:

Initially, a[0] = 2, a[1] = 3, a[2] = a[3] = \ldots = a[N-1] = 0.
< 0 1 8 applies a[8] = 1 because a[0] < a[1].
+ 0 1 2 applies a[2] = a[0] + a[1] = 5.
+ 2 8 2 applies a[2] = a[2] + a[8] = 6.
+ 0 0 0 applies a[0] = a[0] + a[0] = 4.
As required, at the end we have a[2] = 6 = A \cdot B.


",Product Simulation,"Arithmetic, Bitmask, Simulation, Bruteforcing",0.2,16,3
612,"
Score : 400 points


Problem StatementWe have a grid with H rows and W columns. At first, all cells were painted white.
Snuke painted N of these cells. The i-th ( 1 \leq i \leq N ) cell he painted is the cell at the a_i-th row and b_i-th column.
Compute the following:

For each integer j ( 0 \leq j \leq 9 ), how many subrectangles of size 3×3 of the grid contains exactly j black cells, after Snuke painted N cells?





Constraints
3 \leq H \leq 10^9
3 \leq W \leq 10^9
0 \leq N \leq min(10^5,H×W)
1 \leq a_i \leq H (1 \leq i \leq N)
1 \leq b_i \leq W (1 \leq i \leq N)
(a_i, b_i) \neq (a_j, b_j) (i \neq j)







InputThe input is given from Standard Input in the following format:
H W N
a_1 b_1
:
a_N b_N





OutputPrint 10 lines.
The (j+1)-th ( 0 \leq j \leq 9 ) line should contain the number of the subrectangles of size 3×3 of the grid that contains exactly j black cells.






Sample Input 14 5 8
1 1
1 4
1 5
2 3
3 1
3 2
3 4
4 4





Sample Output 10
0
0
2
4
0
0
0
0
0


There are six subrectangles of size 3×3. Two of them contain three black cells each, and the remaining four contain four black cells each.





Sample Input 210 10 20
1 1
1 4
1 9
2 5
3 10
4 2
4 7
5 9
6 4
6 6
6 7
7 1
7 3
7 7
8 1
8 5
8 10
9 2
10 4
10 9





Sample Output 24
26
22
10
2
0
0
0
0
0






Sample Input 31000000000 1000000000 0





Sample Output 3999999996000000004
0
0
0
0
0
0
0
0
0


",Snuke's Coloring,"Set / Map, Value / Coordinate Compression, Bruteforcing, Counting, Implementation",0.188,59,12
613,"
Score : 300 points


Problem StatementSnuke has a calculator. It has a display and two buttons.
Initially, the display shows an integer x.
Snuke wants to change this value into another integer y, by pressing the following two buttons some number of times in arbitrary order:

Button A: When pressed, the value on the display is incremented by 1.
Button B: When pressed, the sign of the value on the display is reversed.

Find the minimum number of times Snuke needs to press the buttons to achieve his objective.
It can be shown that the objective is always achievable regardless of the values of the integers x and y.




Constraints
x and y are integers.
|x|, |y| ≤ 10^9
x and y are different.







InputThe input is given from Standard Input in the following format:
x y





OutputPrint the minimum number of times Snuke needs to press the buttons to achieve his objective.






Sample Input 110 20





Sample Output 110

Press button A ten times.





Sample Input 210 -10





Sample Output 21

Press button B once.





Sample Input 3-10 -20





Sample Output 312

Press the buttons as follows:

Press button B once.
Press button A ten times.
Press button B once.


",Simple Calculator,"Arithmetic, Mathematics, Greedy Algorithm, Boolean Operations On Geometric Objects",0.132,159,32
614,"
Score : 400 points


Problem StatementThere are N squares aligned in a row.
The i-th square from the left contains an integer a_i.
Initially, all the squares are white.
Snuke will perform the following operation some number of times:

Select K consecutive squares. Then, paint all of them white, or paint all of them black. Here, the colors of the squares are overwritten.

After Snuke finishes performing the operation, the score will be calculated as the sum of the integers contained in the black squares.
Find the maximum possible score.




Constraints
1≤N≤10^5
1≤K≤N
a_i is an integer.
|a_i|≤10^9







InputThe input is given from Standard Input in the following format:
N K
a_1 a_2 ... a_N





OutputPrint the maximum possible score.






Sample Input 15 3
-10 10 -10 10 -10





Sample Output 110

Paint the following squares black: the second, third and fourth squares from the left.





Sample Input 24 2
10 -10 -10 10





Sample Output 220

One possible way to obtain the maximum score is as follows:

Paint the following squares black: the first and second squares from the left.
Paint the following squares black: the third and fourth squares from the left.
Paint the following squares white: the second and third squares from the left.






Sample Input 31 1
-10





Sample Output 30






Sample Input 410 5
5 -4 -5 -8 -4 7 2 -4 0 7





Sample Output 417


",Contiguous Repainting,"Prefix sum, Sliding Window, Segment Tree, Greedy Algorithm, Bruteforcing",0.417,27,11
615,"
Score : 300 points


Problem StatementTo make it difficult to withdraw money, a certain bank allows its customers to withdraw only one of the following amounts in one operation:


1 yen (the currency of Japan)


6 yen, 6^2(=36) yen, 6^3(=216) yen, ...


9 yen, 9^2(=81) yen, 9^3(=729) yen, ...


At least how many operations are required to withdraw exactly N yen in total?
It is not allowed to re-deposit the money you withdrew.




Constraints
1 \leq N \leq 100000
N is an integer.







InputInput is given from Standard Input in the following format:
N





OutputIf at least x operations are required to withdraw exactly N yen in total, print x.






Sample Input 1127





Sample Output 14

By withdrawing 1 yen, 9 yen, 36(=6^2) yen and 81(=9^2) yen, we can withdraw 127 yen in four operations.





Sample Input 23





Sample Output 23

By withdrawing 1 yen three times, we can withdraw 3 yen in three operations.





Sample Input 344852





Sample Output 316


",Strange Bank,"Dyanmic Programming, Dynamic Programming, Arithmetic, Bruteforcing, Exponentiation By Squaring",0.439,197,89
616,"
Score : 600 points


Problem StatementGiven is a tree T with N vertices. The i-th edge connects Vertex A_i and B_i (1 \leq A_i,B_i \leq N).
Now, each vertex is painted black with probability 1/2 and white with probability 1/2, which is chosen independently from other vertices. Then, let S be the smallest subtree (connected subgraph) of T containing all the vertices painted black. (If no vertex is painted black, S is the empty graph.)
Let the holeyness of S be the number of white vertices contained in S. Find the expected holeyness of S.
Since the answer is a rational number, we ask you to print it \bmod 10^9+7, as described in Notes.




NotesWhen you print a rational number, first write it as a fraction \frac{y}{x}, where x, y are integers, and x is not divisible by 10^9 + 7
(under the constraints of the problem, such representation is always possible).
Then, you need to print the only integer z between 0 and 10^9 + 6, inclusive, that satisfies xz \equiv y \pmod{10^9 + 7}.




Constraints
2 \leq N \leq 2 \times 10^5
1 \leq A_i,B_i \leq N
The given graph is a tree.







InputInput is given from Standard Input in the following format:
N
A_1 B_1
:
A_{N-1} B_{N-1}





OutputPrint the expected holeyness of S, \bmod 10^9+7.






Sample Input 13
1 2
2 3





Sample Output 1125000001

If the vertices 1, 2, 3 are painted black, white, black, respectively, the holeyness of S is 1.
Otherwise, the holeyness is 0, so the expected holeyness is 1/8.
Since 8 \times 125000001 \equiv 1 \pmod{10^9+7}, we should print 125000001.





Sample Input 24
1 2
2 3
3 4





Sample Output 2375000003

The expected holeyness is 3/8.
Since 8 \times 375000003 \equiv 3 \pmod{10^9+7}, we should print 375000003.





Sample Input 34
1 2
1 3
1 4





Sample Output 3250000002

The expected holeyness is 1/4.





Sample Input 47
4 7
3 1
2 6
5 2
7 1
2 7





Sample Output 4570312505


",Surrounded Nodes,"Tree, Dynamic Programming On Trees, Combinatorics, Probability Theory, Arithmetic, Precomputation",0.0,5,2
617,"
Score : 600 points


Problem StatementGiven are two sequences a=\{a_0,\ldots,a_{N-1}\} and b=\{b_0,\ldots,b_{N-1}\} of N non-negative integers each.
Snuke will choose an integer k such that 0 \leq k < N and an integer x not less than 0, to make a new sequence of length N, a'=\{a_0',\ldots,a_{N-1}'\}, as follows:

a_i'= a_{i+k \mod N}\ XOR \ x

Find all pairs (k,x) such that a' will be equal to b.

What is \mbox{ XOR }?

The XOR of integers A and B, A \mbox{ XOR } B, is defined as follows:

When A \mbox{ XOR } B is written in base two, the digit in the 2^k's place (k \geq 0) is 1 if either A or B, but not both, has 1 in the 2^k's place, and 0 otherwise.

For example, 3 \mbox{ XOR } 5 = 6. (In base two: 011 \mbox{ XOR } 101 = 110.)






Constraints
1 \leq N \leq 2 \times 10^5
0 \leq a_i,b_i < 2^{30}
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
a_0 a_1 ... a_{N-1}
b_0 b_1 ... b_{N-1}





OutputPrint all pairs (k, x) such that a' and b will be equal, using one line for each pair, in ascending order of k (ascending order of x for pairs with the same k).
If there are no such pairs, the output should be empty.






Sample Input 13
0 2 1
1 2 3





Sample Output 11 3

If (k,x)=(1,3),


a_0'=(a_1\ XOR \ 3)=1


a_1'=(a_2\ XOR \ 3)=2


a_2'=(a_0\ XOR \ 3)=3


and we have a' = b.





Sample Input 25
0 0 0 0 0
2 2 2 2 2





Sample Output 20 2
1 2
2 2
3 2
4 2






Sample Input 36
0 1 3 7 6 4
1 5 4 6 2 3





Sample Output 32 2
5 5






Sample Input 42
1 2
0 0





Sample Output 4
No pairs may satisfy the condition.

",Xor Shift,"Array, Bitmask, Dynamic Programming, String, Arithmetic",0.5,9,4
618,"
Score : 500 points


Problem StatementGiven are N integers A_1,\ldots,A_N.
We will choose exactly K of these elements. Find the maximum possible product of the chosen elements.
Then, print the maximum product modulo (10^9+7), using an integer between 0 and 10^9+6 (inclusive).




Constraints
1 \leq K \leq N \leq 2\times 10^5
|A_i| \leq 10^9







InputInput is given from Standard Input in the following format:
N K
A_1 \ldots A_N





OutputPrint the maximum product modulo (10^9+7), using an integer between 0 and 10^9+6 (inclusive).






Sample Input 14 2
1 2 -3 -4





Sample Output 112

The possible products of the two chosen elements are 2, -3, -4, -6, -8, and 12, so the maximum product is 12.





Sample Input 24 3
-1 -2 -3 -4





Sample Output 21000000001

The possible products of the three chosen elements are -24, -12, -8, and -6, so the maximum product is -6.
We print this value modulo (10^9+7), that is, 1000000001.





Sample Input 32 1
-1 1000000000





Sample Output 31000000000

The possible products of the one chosen element are -1 and 1000000000, so the maximum product is 1000000000.





Sample Input 410 10
1000000000 100000000 10000000 1000000 100000 10000 1000 100 10 1





Sample Output 4999983200

Be sure to print the product modulo (10^9+7).

",Multiplication 4,"Sorting, Two-pointer, Greedy Algorithm, Arithmetic, Array, Implementation",0.076,625,70
619,"
Score : 600 points


Problem StatementWe have N colored balls arranged in a row from left to right; the color of the i-th ball from the left is c_i.
You are given Q queries. The i-th query is as follows: how many different colors do the l_i-th through r_i-th balls from the left have?




Constraints
1\leq N,Q \leq 5 \times 10^5
1\leq c_i \leq N
1\leq l_i \leq r_i \leq N
All values in input are integers.







InputInput is given from Standard Input in the following format:
N Q
c_1 c_2 \cdots c_N
l_1 r_1
l_2 r_2
:
l_Q r_Q





OutputPrint Q lines. The i-th line should contain the response to the i-th query.






Sample Input 14 3
1 2 1 3
1 3
2 4
3 3





Sample Output 12
3
1


The 1-st, 2-nd, and 3-rd balls from the left have the colors 1, 2, and 1 - two different colors.
The 2-st, 3-rd, and 4-th balls from the left have the colors 2, 1, and 3 - three different colors.
The 3-rd ball from the left has the color 1 - just one color.






Sample Input 210 10
2 5 6 5 2 1 7 9 7 2
5 5
2 4
6 7
2 2
7 8
7 9
1 8
6 9
8 10
6 8





Sample Output 21
2
2
1
2
2
6
3
3
3


",Range Set Query,"Binary Indexed Tree, Offline Queries, Sorting, Prefix sum, Two-pointer",0.144,329,52
620,"
Score : 200 points


Problem StatementSnuke is having a barbeque party.
At the party, he will make N servings of Skewer Meal.


Example of a serving of Skewer Meal

He has a stock of 2N skewers, all of which will be used in Skewer Meal. The length of the i-th skewer is L_i.
Also, he has an infinite supply of ingredients.
To make a serving of Skewer Meal, he picks 2 skewers and threads ingredients onto those skewers.
Let the length of the shorter skewer be x, then the serving can hold the maximum of x ingredients.
What is the maximum total number of ingredients that his N servings of Skewer Meal can hold, if he uses the skewers optimally?




Constraints
1≦N≦100
1≦L_i≦100
For each i, L_i is an integer.







InputThe input is given from Standard Input in the following format:
N
L_1 L_2 ... L_{2N}





OutputPrint the maximum total number of ingredients that Snuke's N servings of Skewer Meal can hold.






Sample Input 12
1 3 1 2





Sample Output 13

If he makes a serving using the first and third skewers, and another using the second and fourth skewers, each serving will hold 1 and 2 ingredients, for the total of 3.





Sample Input 25
100 1 2 3 14 15 58 58 58 29





Sample Output 2135


",BBQ Easy,"Sorting, Greedy Algorithm, Bruteforcing, Game Theory",0.726,165,97
621,"
Score : 300 points


Problem StatementGiven is a string S consisting of lowercase English letters. Find the maximum positive integer K that satisfies the following condition:

There exists a partition of S into K non-empty strings S=S_1S_2...S_K such that S_i \neq S_{i+1} (1 \leq i \leq K-1).

Here S_1S_2...S_K represents the concatenation of S_1,S_2,...,S_K in this order.




Constraints
1 \leq |S| \leq 2 \times 10^5
S consists of lowercase English letters.







InputInput is given from Standard Input in the following format:
S





OutputPrint the maximum positive integer K that satisfies the condition.






Sample Input 1aabbaa





Sample Output 14

We can, for example, divide S into four strings aa, b, ba, and a.





Sample Input 2aaaccacabaababc





Sample Output 212


",Dividing a String,"Greedy Algorithm, String, Bruteforcing, Boolean Operations On Geometric Objects",0.509,104,42
622,"
Score : 100 points


Problem StatementIn K-city, there are n streets running east-west, and m streets running north-south. Each street running east-west and each street running north-south cross each other. We will call the smallest area that is surrounded by four streets a block. How many blocks there are in K-city?




Constraints
2 ≤ n, m ≤ 100







InputInput is given from Standard Input in the following format:
n m





OutputPrint the number of blocks in K-city.






Sample Input 13 4





Sample Output 16

There are six blocks, as shown below:








Sample Input 22 2





Sample Output 21

There are one block, as shown below:




",K-City,"Arithmetic, Mathematics",0.874,154,118
623,"
Score : 100 points


Problem StatementAn elementary school student Takahashi has come to a variety store.
He has two coins, A-yen and B-yen coins (yen is the currency of Japan), and wants to buy a toy that costs C yen. Can he buy it?
Note that he lives in Takahashi Kingdom, and may have coins that do not exist in Japan.




Constraints
All input values are integers.
1 \leq A, B \leq 500
1 \leq C \leq 1000







InputInput is given from Standard Input in the following format:
A B C





OutputIf Takahashi can buy the toy, print Yes; if he cannot, print No.






Sample Input 150 100 120





Sample Output 1Yes

He has 50 + 100 = 150 yen, so he can buy the 120-yen toy.





Sample Input 2500 100 1000





Sample Output 2No

He has 500 + 100 = 600 yen, but he cannot buy the 1000-yen toy.





Sample Input 319 123 143





Sample Output 3No

There are 19-yen and 123-yen coins in Takahashi Kingdom, which are rather hard to use.





Sample Input 419 123 142





Sample Output 4Yes


",Two Coins,"Arithmetic, Implementation",0.689,273,178
624,"
Score : 100 points


Problem StatementTakahashi is a user of a site that hosts programming contests.
When a user competes in a contest, the rating of the user (not necessarily an integer) changes according to the performance of the user, as follows:  

Let the current rating of the user be a.
Suppose that the performance of the user in the contest is b.
Then, the new rating of the user will be the avarage of a and b.

For example, if a user with rating 1 competes in a contest and gives performance 1000, his/her new rating will be 500.5, the average of 1 and 1000.
Takahashi's current rating is R, and he wants his rating to be exactly G after the next contest.
Find the performance required to achieve it.  




Constraints
0 \leq R, G \leq 4500
All input values are integers.







InputInput is given from Standard Input in the following format:
R
G





OutputPrint the performance required to achieve the objective.






Sample Input 12002
2017





Sample Output 12032

Takahashi's current rating is 2002.
If his performance in the contest is 2032, his rating will be the average of 2002 and 2032, which is equal to the desired rating, 2017.





Sample Input 24500
0





Sample Output 2-4500

Although the current and desired ratings are between 0 and 4500, the performance of a user can be below 0.

",Rating Goal,"Arithmetic, Implementation",0.829,174,123
625,"
Score : 100 points


Problem StatementRng is going to a festival.
The name of the festival is given to you as a string S, which ends with FESTIVAL, from input. Answer the question: ""Rng is going to a festival of what?"" Output the answer.
Here, assume that the name of ""a festival of s"" is a string obtained by appending FESTIVAL to the end of s.
For example, CODEFESTIVAL is a festival of CODE.




Constraints
9 \leq |S| \leq 50
S consists of uppercase English letters.
S ends with FESTIVAL.







InputInput is given from Standard Input in the following format:
S





OutputPrint the answer to the question: ""Rng is going to a festival of what?""






Sample Input 1CODEFESTIVAL





Sample Output 1CODE

This is the same as the example in the statement.





Sample Input 2CODEFESTIVALFESTIVAL





Sample Output 2CODEFESTIVAL

This string is obtained by appending FESTIVAL to the end of CODEFESTIVAL, so it is a festival of CODEFESTIVAL.





Sample Input 3YAKINIKUFESTIVAL





Sample Output 3YAKINIKU


",XXFESTIVAL,String,0.852,67,56
626,"
Score : 400 points


Problem StatementThere is a grid of square cells with H horizontal rows and W vertical columns. The cell at the i-th row and the j-th column will be denoted as Cell (i, j).
In Cell (i, j), a_{ij} coins are placed.
You can perform the following operation any number of times:
Operation: Choose a cell that was not chosen before and contains one or more coins, then move one of those coins to a vertically or horizontally adjacent cell.
Maximize the number of cells containing an even number of coins.




Constraints
All values in input are integers.
1 \leq H, W \leq 500
0 \leq a_{ij} \leq 9







InputInput is given from Standard Input in the following format:
H W
a_{11} a_{12} ... a_{1W}
a_{21} a_{22} ... a_{2W}
:
a_{H1} a_{H2} ... a_{HW}





OutputPrint a sequence of operations that maximizes the number of cells containing an even number of coins, in the following format:
N
y_1 x_1 y_1' x_1'
y_2 x_2 y_2' x_2'
:
y_N x_N y_N' x_N'

That is, in the first line, print an integer N between 0 and H \times W (inclusive), representing the number of operations.
In the (i+1)-th line (1 \leq i \leq N), print four integers y_i, x_i, y_i' and x_i' (1 \leq y_i, y_i' \leq H and 1 \leq x_i, x_i' \leq W), representing the i-th operation. These four integers represents the operation of moving one of the coins placed in Cell (y_i, x_i) to a vertically or horizontally adjacent cell, (y_i', x_i').
Note that if the specified operation violates the specification in the problem statement or the output format is invalid, it will result in Wrong Answer.






Sample Input 12 3
1 2 3
0 1 1





Sample Output 13
2 2 2 3
1 1 1 2
1 3 1 2

Every cell contains an even number of coins after the following sequence of operations:

Move the coin in Cell (2, 2) to Cell (2, 3).
Move the coin in Cell (1, 1) to Cell (1, 2).
Move one of the coins in Cell (1, 3) to Cell (1, 2).






Sample Input 23 2
1 0
2 1
1 0





Sample Output 23
1 1 1 2
1 2 2 2
3 1 3 2






Sample Input 31 5
9 9 9 9 9





Sample Output 32
1 1 1 2
1 3 1 4


",Make Them Even,"Grid Graph, Greedy Algorithm, Parity, Graph Theory, Simulation, Array",0.379,141,57
627,"
Score : 300 points


Problem StatementThere are N Reversi pieces arranged in a row. (A Reversi piece is a disc with a black side and a white side.)
The state of each piece is represented by a string S of length N.
If S_i=B, the i-th piece from the left is showing black;
If S_i=W, the i-th piece from the left is showing white.
Consider performing the following operation:

Choose i (1 \leq i < N) such that the i-th piece from the left is showing black and the (i+1)-th piece from the left is showing white, then flip both of those pieces. That is, the i-th piece from the left is now showing white and the (i+1)-th piece from the left is now showing black.

Find the maximum possible number of times this operation can be performed.




Constraints
1 \leq |S| \leq 2\times 10^5
S_i=B or W







InputInput is given from Standard Input in the following format:
S





OutputPrint the maximum possible number of times the operation can be performed.






Sample Input 1BBW





Sample Output 12

The operation can be performed twice, as follows:

Flip the second and third pieces from the left.
Flip the first and second pieces from the left.






Sample Input 2BWBWBW





Sample Output 26


",Irreversible operation,"Counting, Greedy Algorithm, Prefix sum",0.3,177,52
628,"
Score : 400 points


Problem StatementThere is a knight - the chess piece - at the origin (0, 0) of a two-dimensional grid.
When the knight is at the square (i, j), it can be moved to either (i+1,j+2) or (i+2, j+1).
In how many ways can the knight reach the square (X, Y)?
Find the number of ways modulo 10^9 + 7.




Constraints
1 \leq X \leq 10^6
1 \leq Y \leq 10^6
All values in input are integers.







InputInput is given from Standard Input in the following format:
X Y





OutputPrint the number of ways for the knight to reach (X, Y) from (0, 0), modulo 10^9 + 7.






Sample Input 13 3





Sample Output 12

There are two ways: (0,0) \to (1,2) \to (3,3) and (0,0) \to (2,1) \to (3,3).





Sample Input 22 2





Sample Output 20

The knight cannot reach (2,2).





Sample Input 3999999 999999





Sample Output 3151840682

Print the number of ways modulo 10^9 + 7.

",Knight,"Mathematics, Arithmetic, Combinatorics, Modular Multiplicative Inverse, Precomputation",0.371,123,49
629,"
Score : 700 points


Problem StatementSnuke has a permutation (P_0,P_1,\cdots,P_{N-1}) of (0,1,\cdots,N-1).
Now, he will perform the following operation exactly once:

Choose K consecutive elements in P and sort them in ascending order.

Find the number of permutations that can be produced as P after the operation.




Constraints
2 \leq N \leq 200000
2 \leq K \leq N
0 \leq P_i \leq N-1
P_0,P_1,\cdots,P_{N-1} are all different.
All values in input are integers.







InputInput is given from Standard Input in the following format:
N K
P_0 P_1 \cdots P_{N-1}





OutputPrint the number of permutations that can be produced as P after the operation.






Sample Input 15 3
0 2 1 4 3





Sample Output 12

Two permutations can be produced as P after the operation: (0,1,2,4,3) and (0,2,1,3,4).





Sample Input 24 4
0 1 2 3





Sample Output 21






Sample Input 310 4
2 0 1 3 7 5 4 6 8 9





Sample Output 36


",Sorting a Segment,"Sliding Window, Monotonic Stack, Binary Search Tree, Sorting, Combinatorics, Array",0.414,61,18
630,"
Score : 200 points


Problem StatementEvi has N integers a_1,a_2,..,a_N. His objective is to have N equal integers by transforming some of them.
He may transform each integer at most once. Transforming an integer x into another integer y costs him (x-y)^2 dollars. Even if a_i=a_j (i≠j), he has to pay the cost separately for transforming each of them (See Sample 2).
Find the minimum total cost to achieve his objective.




Constraints
1≦N≦100
-100≦a_i≦100







InputThe input is given from Standard Input in the following format:
N
a_1 a_2 ... a_N





OutputPrint the minimum total cost to achieve Evi's objective.






Sample Input 12
4 8





Sample Output 18

Transforming the both into 6s will cost (4-6)^2+(8-6)^2=8 dollars, which is the minimum.





Sample Input 23
1 1 3





Sample Output 23

Transforming the all into 2s will cost (1-2)^2+(1-2)^2+(3-2)^2=3 dollars. Note that Evi has to pay (1-2)^2 dollar separately for transforming each of the two 1s.





Sample Input 33
4 2 5





Sample Output 35

Leaving the 4 as it is and transforming the 2 and the 5 into 4s will achieve the total cost of (2-4)^2+(5-4)^2=5 dollars, which is the minimum.





Sample Input 44
-100 -100 -100 -100





Sample Output 40

Without transforming anything, Evi's objective is already achieved. Thus, the necessary cost is 0.

",Be Together,"Bruteforcing, Arithmetic, Mathematics",0.778,64,44
631,"
Score : 1300 points


Problem StatementTakahashi has a string S of length N consisting of lowercase English letters.
On this string, he will perform the following operation K times:

Let T be the string obtained by reversing S, and U be the string obtained by concatenating S and T in this order.
Let S' be some contiguous substring of U with length N, and replace S with S'.

Among the strings that can be the string S after the K operations, find the lexicographically smallest possible one.




Constraints
1 \leq N \leq 5000
1 \leq K \leq 10^9
|S|=N
S consists of lowercase English letters.







InputInput is given from Standard Input in the following format:
N K
S





OutputPrint the lexicographically smallest possible string that can be the string S after the K operations.






Sample Input 15 1
bacba





Sample Output 1aabca

When S=bacba, T=abcab, U=bacbaabcab, and the optimal choice of S' is S'=aabca.





Sample Input 210 2
bbaabbbaab





Sample Output 2aaaabbaabb


",Reversing and Concatenating,"String, Sliding Window, Greedy Algorithm",0.455,25,8
632,"
Score : 500 points


Problem StatementGiven are two strings s and t consisting of lowercase English letters. Determine if there exists an integer i satisfying the following condition, and find the minimum such i if it exists.

Let s' be the concatenation of 10^{100} copies of s. t is a subsequence of the string {s'}_1{s'}_2\ldots{s'}_i (the first i characters in s').





Notes
A subsequence of a string a is a string obtained by deleting zero or more characters from a and concatenating the remaining characters without changing the relative order. For example, the subsequences of contest include net, c, and contest.





Constraints
1 \leq |s| \leq 10^5
1 \leq |t| \leq 10^5
s and t consists of lowercase English letters.







InputInput is given from Standard Input in the following format:
s
t





OutputIf there exists an integer i satisfying the following condition, print the minimum such i; otherwise, print -1.






Sample Input 1contest
son





Sample Output 110

t = son is a subsequence of the string contestcon (the first 10 characters in s' = contestcontestcontest...), so i = 10 satisfies the condition.
On the other hand, t is not a subsequence of the string contestco (the first 9 characters in s'), so i = 9 does not satisfy the condition.
Similarly, any integer less than 9 does not satisfy the condition, either. Thus, the minimum integer i satisfying the condition is 10.





Sample Input 2contest
programming





Sample Output 2-1

t = programming is not a substring of s' = contestcontestcontest.... Thus, there is no integer i satisfying the condition.





Sample Input 3contest
sentence





Sample Output 333

Note that the answer may not fit into a 32-bit integer type, though we cannot put such a case here.

",Strings of Impurity,"Binary Search, Hashing, Arithmetic, Greedy Algorithm, String",0.233,239,40
633,"
Score : 600 points


Problem StatementTakahashi is playing a board game called Sugoroku.
On the board, there are N + 1 squares numbered 0 to N. Takahashi starts at Square 0, and he has to stop exactly at Square N to win the game.
The game uses a roulette with the M numbers from 1 to M. In each turn, Takahashi spins the roulette. If the number x comes up when he is at Square s, he moves to Square s+x. If this makes him go beyond Square N, he loses the game.
Additionally, some of the squares are Game Over Squares. He also loses the game if he stops at one of those squares. You are given a string S of length N + 1, representing which squares are Game Over Squares. For each i (0 \leq i \leq N), Square i is a Game Over Square if S[i] = 1 and not if S[i] = 0.
Find the sequence of numbers coming up in the roulette in which Takahashi can win the game in the fewest number of turns possible. If there are multiple such sequences, find the lexicographically smallest such sequence. If Takahashi cannot win the game, print -1.




Constraints
1 \leq N \leq 10^5
1 \leq M \leq 10^5
|S| = N + 1
S consists of 0 and 1.
S[0] = 0
S[N] = 0







InputInput is given from Standard Input in the following format:
N M
S





OutputIf Takahashi can win the game, print the lexicographically smallest sequence among the shortest sequences of numbers coming up in the roulette in which Takahashi can win the game, with spaces in between.
If Takahashi cannot win the game, print -1.






Sample Input 19 3
0001000100





Sample Output 11 3 2 3

If the numbers 1, 3, 2, 3 come up in this order, Takahashi can reach Square 9 via Square 1, 4, and 6. He cannot reach Square 9 in three or fewer turns, and this is the lexicographically smallest sequence in which he reaches Square 9 in four turns.





Sample Input 25 4
011110





Sample Output 2-1

Takahashi cannot reach Square 5.





Sample Input 36 6
0101010





Sample Output 36


",Sugoroku,"Breadth-first Search, Greedy Algorithm, Binary Search, Prefix sum, Graph Theory",0.667,38,17
634,"
Score : 600 points


Problem StatementWe have a set S of N points in a two-dimensional plane. The coordinates of the i-th point are (x_i, y_i). The N points have distinct x-coordinates and distinct y-coordinates.
For a non-empty subset T of S, let f(T) be the number of points contained in the smallest rectangle, whose sides are parallel to the coordinate axes, that contains all the points in T. More formally, we define f(T) as follows:

f(T) :=  (the number of integers i (1 \leq i \leq N) such that a \leq x_i \leq b and c \leq y_i \leq d, where a, b, c, and d are the minimum x-coordinate, the maximum x-coordinate, the minimum y-coordinate, and the maximum y-coordinate of the points in T)

Find the sum of f(T) over all non-empty subset T of S. Since it can be enormous, print the sum modulo 998244353.




Constraints
1 \leq N \leq 2 \times 10^5
-10^9 \leq x_i, y_i \leq 10^9
x_i \neq x_j (i \neq j)
y_i \neq y_j (i \neq j)
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
x_1 y_1
:
x_N y_N





OutputPrint the sum of f(T) over all non-empty subset T of S, modulo 998244353.






Sample Input 13
-1 3
2 1
3 -2





Sample Output 113

Let the first, second, and third points be P_1, P_2, and P_3, respectively. S = \{P_1, P_2, P_3\} has seven non-empty subsets, and f has the following values for each of them:

f(\{P_1\}) = 1
f(\{P_2\}) = 1
f(\{P_3\}) = 1
f(\{P_1, P_2\}) = 2
f(\{P_2, P_3\}) = 2
f(\{P_3, P_1\}) = 3
f(\{P_1, P_2, P_3\}) = 3

The sum of these is 13.





Sample Input 24
1 4
2 1
3 3
4 2





Sample Output 234






Sample Input 310
19 -11
-3 -12
5 3
3 -15
8 -14
-9 -20
10 -9
0 2
-7 17
6 -6





Sample Output 37222

Be sure to print the sum modulo 998244353.

",Enclosed Points,"Value / Coordinate Compression, Sorting, Binary Indexed Tree, Inclusion And Exclusion, Arithmetic",0.5,17,10
635,"
Score : 300 points


Problem StatementYou are given an integer sequence of length N. The i-th term in the sequence is a_i.
In one operation, you can select a term and either increment or decrement it by one.
At least how many operations are necessary to satisfy the following conditions?

For every i (1≤i≤n), the sum of the terms from the 1-st through i-th term is not zero.
For every i (1≤i≤n-1), the sign of the sum of the terms from the 1-st through i-th term, is different from the sign of the sum of the terms from the 1-st through (i+1)-th term.





Constraints
2 ≤ n ≤ 10^5
|a_i| ≤ 10^9
Each a_i is an integer.







InputInput is given from Standard Input in the following format:
n
a_1 a_2 ... a_n





OutputPrint the minimum necessary count of operations.






Sample Input 14
1 -3 1 0





Sample Output 14

For example, the given sequence can be transformed into 1, -2, 2, -2 by four operations. The sums of the first one, two, three and four terms are 1, -1, 1 and -1, respectively, which satisfy the conditions.





Sample Input 25
3 -6 4 -5 7





Sample Output 20

The given sequence already satisfies the conditions.





Sample Input 36
-1 4 3 2 -5 4





Sample Output 38


",Sequence,"Greedy Algorithm, Prefix sum, Mathematics",0.208,146,37
636,"
Score : 700 points


Problem StatementWe have a graph with N vertices and M edges, and there are two people on the graph: Takahashi and Aoki.
The i-th edge connects Vertex U_i and Vertex V_i.
The time it takes to traverse this edge is D_i minutes, regardless of direction and who traverses the edge (Takahashi or Aoki).
Takahashi departs Vertex S and Aoki departs Vertex T at the same time. Takahashi travels to Vertex T and Aoki travels to Vertex S, both in the shortest time possible.
Find the number of the pairs of ways for Takahashi and Aoki to choose their shortest paths such that they never meet (at a vertex or on an edge) during the travel, modulo 10^9 + 7.




Constraints
1 \leq N \leq 100 000
1 \leq M \leq 200 000
1 \leq S, T \leq N
S \neq T
1 \leq U_i, V_i \leq N (1 \leq i \leq M)
1 \leq D_i \leq 10^9 (1 \leq i \leq M)
If i \neq j, then (U_i, V_i) \neq (U_j, V_j) and (U_i, V_i) \neq (V_j, U_j).
U_i \neq V_i (1 \leq i \leq M)
D_i are integers.
The given graph is connected.







InputInput is given from Standard Input in the following format:
N M
S T
U_1 V_1 D_1
U_2 V_2 D_2
:
U_M V_M D_M





OutputPrint the answer.






Sample Input 14 4
1 3
1 2 1
2 3 1
3 4 1
4 1 1





Sample Output 12

There are two ways to choose shortest paths that satisfies the condition:

Takahashi chooses the path 1 \rightarrow 2 \rightarrow 3, and Aoki chooses the path 3 \rightarrow 4 \rightarrow 1.
Takahashi chooses the path 1 \rightarrow 4 \rightarrow 3, and Aoki chooses the path 3 \rightarrow 2 \rightarrow 1.






Sample Input 23 3
1 3
1 2 1
2 3 1
3 1 2





Sample Output 22






Sample Input 33 3
1 3
1 2 1
2 3 1
3 1 2





Sample Output 32






Sample Input 48 13
4 2
7 3 9
6 2 3
1 6 4
7 6 9
3 8 9
1 2 2
2 8 12
8 6 9
2 5 5
4 2 18
5 3 7
5 1 515371567
4 8 6





Sample Output 46


",Avoiding Collision,"Graph Theory, Dijkstra's, Priority Queue, Dyanmic Programming, Counting, Inclusion And Exclusion",0.0,15,1
637,"
Score : 300 points


Problem StatementThere are N boxes arranged in a row.
Initially, the i-th box from the left contains a_i candies.
Snuke can perform the following operation any number of times:

Choose a box containing at least one candy, and eat one of the candies in the chosen box.

His objective is as follows:

Any two neighboring boxes contain at most x candies in total.

Find the minimum number of operations required to achieve the objective.




Constraints
2 ≤ N ≤ 10^5
0 ≤ a_i ≤ 10^9
0 ≤ x ≤ 10^9







InputThe input is given from Standard Input in the following format:
N x
a_1 a_2 ... a_N





OutputPrint the minimum number of operations required to achieve the objective.






Sample Input 13 3
2 2 2





Sample Output 11

Eat one candy in the second box.
Then, the number of candies in each box becomes (2, 1, 2).





Sample Input 26 1
1 6 1 2 0 4





Sample Output 211

For example, eat six candies in the second box, two in the fourth box, and three in the sixth box.
Then, the number of candies in each box becomes (1, 0, 1, 0, 0, 1).





Sample Input 35 9
3 1 4 1 5





Sample Output 30

The objective is already achieved without performing operations.





Sample Input 42 0
5 5





Sample Output 410

All the candies need to be eaten.

",Boxes and Candies,"Greedy Algorithm, Bruteforcing, Array, Arithmetic",0.288,154,55
638,"
Score : 400 points


Problem StatementThere are two persons, numbered 0 and 1, and a variable x whose initial value is 0.
The two persons now play a game.
The game is played in N rounds. The following should be done in the i-th round (1 \leq i \leq N):

Person S_i does one of the following:
Replace x with x \oplus A_i, where \oplus represents bitwise XOR.
Do nothing.



Person 0 aims to have x=0 at the end of the game, while Person 1 aims to have x \neq 0 at the end of the game.
Determine whether x becomes 0 at the end of the game when the two persons play optimally.
Solve T test cases for each input file.




Constraints
1 \leq T \leq 100
1 \leq N \leq 200
1 \leq A_i \leq 10^{18}
S is a string of length N consisting of 0 and 1.
All numbers in input are integers.







InputInput is given from Standard Input in the following format.
The first line is as follows:
T

Then, T test cases follow.
Each test case is given in the following format:
N
A_1 A_2 \cdots A_N
S





OutputFor each test case, print a line containing 0 if x becomes 0 at the end of the game, and 1 otherwise.






Sample Input 13
2
1 2
10
2
1 1
10
6
2 3 4 5 6 7
111000





Sample Output 11
0
0

In the first test case, if Person 1 replaces x with 0 \oplus 1=1, we surely have x \neq 0 at the end of the game, regardless of the choice of Person 0.
In the second test case, regardless of the choice of Person 1, Person 0 can make x=0 with a suitable choice.

",Xor Battle,"Xor Basis (gf(2)), Bitmask, Greedy Algorithm, Dynamic Programming",0.125,67,7
639,"
Score : 400 points


Problem StatementYou are given N integers; the i-th of them is A_i.
Find the maximum possible sum of the absolute differences between the adjacent elements after arranging these integers in a row in any order you like.




Constraints
2 \leq N \leq 10^5
1 \leq A_i \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
A_1
:
A_N





OutputPrint the maximum possible sum of the absolute differences between the adjacent elements after arranging the given integers in a row in any order you like.






Sample Input 15
6
8
1
2
3





Sample Output 121

When the integers are arranged as 3,8,1,6,2, the sum of the absolute differences between the adjacent elements is |3 - 8| + |8 - 1| + |1 - 6| + |6 - 2| = 21. This is the maximum possible sum.





Sample Input 26
3
1
4
1
5
9





Sample Output 225






Sample Input 33
5
5
1





Sample Output 38


",Align,"Sorting, Array, Arithmetic, Greedy Algorithm, Boolean Operations On Geometric Objects",0.412,36,15
640,"
Score : 100 points


Problem StatementYou are given a string S of length 2 or 3 consisting of lowercase English letters. If the length of the string is 2, print it as is; if the length is 3, print the string after reversing it.




Constraints
The length of S is 2 or 3.
S consists of lowercase English letters.







InputInput is given from Standard Input in the following format:
S





OutputIf the length of S is 2, print S as is; if the length is 3, print S after reversing it.






Sample Input 1abc





Sample Output 1cba

As the length of S is 3, we print it after reversing it.





Sample Input 2ac





Sample Output 2ac

As the length of S is 2, we print it as is.

",Measure,"Implementation, String, Bruteforcing",0.778,95,63
641,"
Score : 200 points


Problem StatementIn the beginning, Takahashi has A cookies, and Aoki has B cookies.
They will perform the following operation alternately, starting from Takahashi:

If the number of cookies in his hand is odd, eat one of those cookies; if the number is even, do nothing. Then, give one-half of the cookies in his hand to the other person.

Find the numbers of cookies Takahashi and Aoki respectively have after performing K operations in total.




Constraints
1 \leq A,B \leq 10^9
1 \leq K \leq 100
A,B and K are integers.







InputInput is given from Standard Input in the following format:
A B K





OutputPrint the number of cookies Takahashi has, and the number of cookies Aoki has, in this order, after performing K operations in total.






Sample Input 15 4 2





Sample Output 15 3

The process will go as follows:

In the beginning, Takahashi and Aoki have 5 and 4 cookies, respectively.
Takahashi eats one cookie and gives two cookies to Aoki. They now have 2 and 6 cookies, respectively.
Aoki gives three cookies to Takahashi. They now have 5 and 3 cookies, respectively.






Sample Input 23 3 3





Sample Output 21 3






Sample Input 3314159265 358979323 84





Sample Output 3448759046 224379523


",Exchange,"Simulation, Arithmetic, Data Structure",0.864,77,59
642,"
Score : 300 points


Problem StatementYou are given a string s.
Among the different substrings of s, print the K-th lexicographically smallest one.
A substring of s is a string obtained by taking out a non-empty contiguous part in s.
For example, if s = ababc, a, bab and ababc are substrings of s, while ac, z and an empty string are not.
Also, we say that substrings are different when they are different as strings.
Let X = x_{1}x_{2}...x_{n} and Y = y_{1}y_{2}...y_{m} be two distinct strings. X is lexicographically larger than Y if and only if Y is a prefix of X or x_{j} > y_{j} where j is the smallest integer such that x_{j} \neq y_{j}.




Constraints
1 ≤ |s| ≤ 5000
s consists of lowercase English letters.
1 ≤ K ≤ 5
s has at least K different substrings.





Partial Score
200 points will be awarded as a partial score for passing the test set satisfying |s| ≤ 50.







InputInput is given from Standard Input in the following format:
s
K





OutputPrint the K-th lexicographically smallest substring of K.






Sample Input 1aba
4





Sample Output 1b

s has five substrings: a, b, ab, ba and aba.
Among them, we should print the fourth smallest one, b.
Note that we do not count a twice.





Sample Input 2atcoderandatcodeer
5





Sample Output 2andat






Sample Input 3z
1





Sample Output 3z


",K-th Substring,"String, Set / Map, Sorting, Bruteforcing",0.225,160,53
643,"
Score: 200 points


Problem Statement
There are three positive integers A, B and C written on a blackboard. E869120 performs the following operation K times:

Choose one integer written on the blackboard and let the chosen integer be n. Replace the chosen integer with 2n.

What is the largest possible sum of the integers written on the blackboard after K operations?




Constraints

A, B and C are integers between 1 and 50 (inclusive).
K is an integer between 1 and 10 (inclusive).







Input
Input is given from Standard Input in the following format:
A B C
K





Output
Print the largest possible sum of the integers written on the blackboard after K operations by E869220.






Sample Input 15 3 11
1





Sample Output 130

In this sample, 5, 3, 11 are initially written on the blackboard, and E869120 can perform the operation once.
There are three choices:  

Double 5: The integers written on the board after the operation are 10, 3, 11.
Double 3: The integers written on the board after the operation are 5, 6, 11.
Double 11: The integers written on the board after the operation are 5, 3, 22.

If he chooses 3., the sum of the integers written on the board afterwards is 5 + 3 + 22 = 30, which is the largest among 1. through 3.  





Sample Input 23 3 4
2





Sample Output 222

E869120 can perform the operation twice. The sum of the integers eventually written on the blackboard is maximized as follows:  

First, double 4. The integers written on the board are now 3, 3, 8.  
Next, double 8. The integers written on the board are now 3, 3, 16.  

Then, the sum of the integers eventually written on the blackboard is 3 + 3 + 16 = 22.

",Maximum Sum,"Sorting, Binary Search, Arithmetic, Boolean Operations On Geometric Objects",0.645,262,155
644,"
Score: 300 points


Problem Statement
We have a canvas divided into a grid with H rows and W columns. The square at the i-th row from the top and the j-th column from the left is represented as (i, j).
Initially, all the squares are white. square1001 wants to draw a picture with black paint. His specific objective is to make Square (i, j) black when s_{i, j}= #, and to make Square (i, j) white when s_{i, j}= ..
However, since he is not a good painter, he can only choose two squares that are horizontally or vertically adjacent and paint those squares black, for some number of times (possibly zero). He may choose squares that are already painted black, in which case the color of those squares remain black.
Determine if square1001 can achieve his objective.  




Constraints

H is an integer between 1 and 50 (inclusive).
W is an integer between 1 and 50 (inclusive).
For every (i, j) (1 \leq i \leq H, 1 \leq j \leq W), s_{i, j} is # or ..







Input
Input is given from Standard Input in the following format:
H W
s_{1, 1} s_{1, 2} s_{1, 3} ... s_{1, W}
s_{2, 1} s_{2, 2} s_{2, 3} ... s_{2, W}
  :   :
s_{H, 1} s_{H, 2} s_{H, 3} ... s_{H, W}





Output
If square1001 can achieve his objective, print Yes; if he cannot, print No.






Sample Input 13 3
.#.
###
.#.





Sample Output 1Yes

One possible way to achieve the objective is shown in the figure below. Here, the squares being painted are marked by stars.






Sample Input 25 5
#.#.#
.#.#.
#.#.#
.#.#.
#.#.#





Sample Output 2No

square1001 cannot achieve his objective here.





Sample Input 311 11
...#####...
.##.....##.
#..##.##..#
#..##.##..#
#.........#
#...###...#
.#########.
.#.#.#.#.#.
##.#.#.#.##
..##.#.##..
.##..#..##.





Sample Output 3Yes


",Grid Repainting 2,"Grid Graph, Graph Theory, Implementation, Bruteforcing",0.614,299,133
645,"
Score : 300 points


Problem StatementThere are N candles placed on a number line.
The i-th candle from the left is placed on coordinate x_i.
Here, x_1 < x_2 < ... < x_N holds.
Initially, no candles are burning.
Snuke decides to light K of the N candles.
Now, he is at coordinate 0.
He can move left and right along the line with speed 1.
He can also light a candle when he is at the same position as the candle, in negligible time.
Find the minimum time required to light K candles.




Constraints
1 \leq N \leq 10^5
1 \leq K \leq N
x_i is an integer.
|x_i| \leq 10^8
x_1 < x_2 < ... < x_N







InputInput is given from Standard Input in the following format:
N K
x_1 x_2 ... x_N





OutputPrint the minimum time required to light K candles.






Sample Input 15 3
-30 -10 10 20 50





Sample Output 140

He should move and light candles as follows:

Move from coordinate 0 to -10.
Light the second candle from the left.
Move from coordinate -10 to 10.
Light the third candle from the left.
Move from coordinate 10 to 20.
Light the fourth candle from the left.






Sample Input 23 2
10 20 30





Sample Output 220






Sample Input 31 1
0





Sample Output 30


There may be a candle placed at coordinate 0.






Sample Input 48 5
-9 -7 -4 -3 1 2 3 4





Sample Output 410


",Candles,"Sliding Window, Arithmetic, Greedy Algorithm, Bruteforcing, Mathematics",0.5,144,65
646,"
Score : 700 points


Problem StatementWe will define the median of a sequence b of length M, as follows:

Let b' be the sequence obtained by sorting b in non-decreasing order. Then, the value of the (M / 2 + 1)-th element of b' is the median of b. Here, / is integer division, rounding down.

For example, the median of (10, 30, 20) is 20; the median of (10, 30, 20, 40) is 30; the median of (10, 10, 10, 20, 30) is 10.
Snuke comes up with the following problem.
You are given a sequence a of length N.
For each pair (l, r) (1 \leq l \leq r \leq N), let m_{l, r} be the median of the contiguous subsequence (a_l, a_{l + 1}, ..., a_r) of a.
We will list m_{l, r} for all pairs (l, r) to create a new sequence m.
Find the median of m.




Constraints
1 \leq N \leq 10^5
a_i is an integer.
1 \leq a_i \leq 10^9







InputInput is given from Standard Input in the following format:
N
a_1 a_2 ... a_N





OutputPrint the median of m.






Sample Input 13
10 30 20





Sample Output 130

The median of each contiguous subsequence of a is as follows:

The median of (10) is 10.
The median of (30) is 30.
The median of (20) is 20.
The median of (10, 30) is 30.
The median of (30, 20) is 30.
The median of (10, 30, 20) is 20.

Thus, m = (10, 30, 20, 30, 30, 20) and the median of m is 30.





Sample Input 21
10





Sample Output 210






Sample Input 310
5 9 5 9 8 9 3 5 4 3





Sample Output 38


",Median of Medians,"Binary Search, Prefix sum, Value / Coordinate Compression, Binary Indexed Tree, Counting, Sorting, Array",0.3,22,5
647,"
Score : 100 points


Problem StatementTakahashi is distributing N balls to K persons.
If each person has to receive at least one ball, what is the maximum possible difference in the number of balls received between the person with the most balls and the person with the fewest balls?




Constraints
1 \leq K \leq N \leq 100
All values in input are integers.







InputInput is given from Standard Input in the following format:
N K





OutputPrint the maximum possible difference in the number of balls received.






Sample Input 13 2





Sample Output 11

The only way to distribute three balls to two persons so that each of them receives at least one ball is to give one ball to one person and give two balls to the other person.
Thus, the maximum possible difference in the number of balls received is 1.





Sample Input 23 1





Sample Output 20

We have no choice but to give three balls to the only person, in which case the difference in the number of balls received is 0.





Sample Input 38 5





Sample Output 33

For example, if we give 1, 4, 1, 1, 1 balls to the five persons, the number of balls received between the person with the most balls and the person with the fewest balls would be 3, which is the maximum result.

",Ball Distribution,"Mathematics, Greedy Algorithm, Implementation",0.779,122,85
648,"
Score : 100 points


Problem StatementThere are N children, numbered 1, 2, \ldots, N.
They have decided to share K candies among themselves.
Here, for each i (1 \leq i \leq N), Child i must receive between 0 and a_i candies (inclusive).
Also, no candies should be left over.
Find the number of ways for them to share candies, modulo 10^9 + 7.
Here, two ways are said to be different when there exists a child who receives a different number of candies.




Constraints
All values in input are integers.
1 \leq N \leq 100
0 \leq K \leq 10^5
0 \leq a_i \leq K







InputInput is given from Standard Input in the following format:
N K
a_1 a_2 \ldots a_N





OutputPrint the number of ways for the children to share candies, modulo 10^9 + 7.






Sample Input 13 4
1 2 3





Sample Output 15

There are five ways for the children to share candies, as follows:

(0, 1, 3)
(0, 2, 2)
(1, 0, 3)
(1, 1, 2)
(1, 2, 1)

Here, in each sequence, the i-th element represents the number of candies that Child i receives.





Sample Input 21 10
9





Sample Output 20

There may be no ways for the children to share candies.





Sample Input 32 0
0 0





Sample Output 31

There is one way for the children to share candies, as follows:

(0, 0)






Sample Input 44 100000
100000 100000 100000 100000





Sample Output 4665683269

Be sure to print the answer modulo 10^9 + 7.

",Candies,"Dyanmic Programming, Prefix sum, Arithmetic, Difference Array",0.352,320,104
649,"
Score : 200 points


Problem StatementWe have a grid with N rows and M columns of squares. Initially, all the squares are white.
There is a button attached to each row and each column.
When a button attached to a row is pressed, the colors of all the squares in that row are inverted; that is, white squares become black and vice versa.
When a button attached to a column is pressed, the colors of all the squares in that column are inverted.
Takahashi can freely press the buttons any number of times. Determine whether he can have exactly K black squares in the grid.




Constraints
1 \leq N,M \leq 1000
0 \leq K \leq NM







InputInput is given from Standard Input in the following format:
N M K





OutputIf Takahashi can have exactly K black squares in the grid, print Yes; otherwise, print No.






Sample Input 12 2 2





Sample Output 1Yes

Press the buttons in the order of the first row, the first column.





Sample Input 22 2 1





Sample Output 2No






Sample Input 33 5 8





Sample Output 3Yes

Press the buttons in the order of the first column, third column, second row, fifth column.





Sample Input 47 9 20





Sample Output 4No


",fLIP,"Bruteforcing, Mathematics",0.392,124,49
650,"
Score : 300 points


Problem StatementThe problem set at CODE FESTIVAL 20XX Finals consists of N problems.
The score allocated to the i-th (1≦i≦N) problem is i points.
Takahashi, a contestant, is trying to score exactly N points. For that, he is deciding which problems to solve.
As problems with higher scores are harder, he wants to minimize the highest score of a problem among the ones solved by him.
Determine the set of problems that should be solved.




Constraints
1≦N≦10^7





Partial Score
200 points will be awarded for passing the test set satisfying 1≦N≦1000.
Additional 100 points will be awarded for passing the test set without additional constraints.







InputThe input is given from Standard Input in the following format:
N





OutputAmong the sets of problems with the total score of N, find a set in which the highest score of a problem is minimum, then print the indices of the problems in the set in any order, one per line.
If there exists more than one such set, any of them will be accepted.






Sample Input 14





Sample Output 11
3

Solving only the 4-th problem will also result in the total score of 4 points, but solving the 1-st and 3-rd problems will lower the highest score of a solved problem.





Sample Input 27





Sample Output 21
2
4

The set \{3,4\} will also be accepted.





Sample Input 31





Sample Output 31


",Exactly N points,"Arithmetic, Greedy Algorithm, Bruteforcing, Constructive",0.773,34,21
651,"
Score : 300 points


Problem StatementThere are N integers a_1, a_2, ..., a_N not less than 1.
The values of a_1, a_2, ..., a_N are not known, but it is known that a_1 \times a_2 \times ... \times a_N = P.
Find the maximum possible greatest common divisor of a_1, a_2, ..., a_N.




Constraints
1 \leq N \leq 10^{12}
1 \leq P \leq 10^{12}







InputInput is given from Standard Input in the following format:
N P





OutputPrint the answer.






Sample Input 13 24





Sample Output 12

The greatest common divisor would be 2 when, for example, a_1=2, a_2=6 and a_3=2.





Sample Input 25 1





Sample Output 21

As a_i are positive integers, the only possible case is a_1 = a_2 = a_3 = a_4 = a_5 = 1.





Sample Input 31 111





Sample Output 3111






Sample Input 44 972439611840





Sample Output 4206


",Product and GCD,"Prime Factorization, Arithmetic, Data Structures, Counting",0.5,76,30
652,"
Score : 300 points


Problem StatementThere is an empty array.
The following N operations will be performed to insert integers into the array.
In the i-th operation (1≤i≤N), b_i copies of an integer a_i are inserted into the array.
Find the K-th smallest integer in the array after the N operations.
For example, the 4-th smallest integer in the array \{1,2,2,3,3,3\} is 3.




Constraints
1≤N≤10^5 
1≤a_i,b_i≤10^5 
1≤K≤b_1…+…b_n
All input values are integers.







InputInput is given from Standard Input in the following format:  
N K
a_1 b_1
:  
a_N b_N





OutputPrint the K-th smallest integer in the array after the N operations.  






Sample Input 13 4
1 1
2 2
3 3





Sample Output 13

The resulting array is the same as the one in the problem statement.





Sample Input 210 500000
1 100000
1 100000
1 100000
1 100000
1 100000
100000 100000
100000 100000
100000 100000
100000 100000
100000 100000





Sample Output 21


",Big Array,"Binary Search Tree, Sorting, Prefix sum, Bruteforcing, Binary Search",0.119,423,76
653,"
Score : 400 points


Problem StatementSnuke has N strings. The i-th string is s_i.
Let us concatenate these strings into one string after arranging them in some order.
Find the maximum possible number of occurrences of AB in the resulting string.




Constraints
1 \leq N \leq 10^{4}
2 \leq |s_i| \leq 10
s_i consists of uppercase English letters.







InputInput is given from Standard Input in the following format:
N
s_1
\vdots
s_N





OutputPrint the answer.






Sample Input 13
ABCA
XBAZ
BAD





Sample Output 12

For example, if we concatenate ABCA, BAD and XBAZ in this order, the resulting string ABCABADXBAZ has two occurrences of AB.





Sample Input 29
BEWPVCRWH
ZZNQYIJX
BAVREA
PA
HJMYITEOX
BCJHMRMNK
BP
QVFABZ
PRGKSPUNA





Sample Output 24






Sample Input 37
RABYBBE
JOZ
BMHQUVA
BPA
ISU
MCMABAOBHZ
SZMEHMA





Sample Output 34


",AB Substrings,"String, Greedy Algorithm, Counting",0.195,260,61
654,"
Score : 100 points


Problem StatementTakahashi has a strong stomach. He never gets a stomachache from eating something whose ""best-by"" date is at most X days earlier.
He gets a stomachache if the ""best-by"" date of the food is X+1 or more days earlier, though.
Other than that, he finds the food delicious if he eats it not later than the ""best-by"" date. Otherwise, he does not find it delicious.
Takahashi bought some food A days before the ""best-by"" date, and ate it B days after he bought it.
Write a program that outputs delicious if he found it delicious, safe if he did not found it delicious but did not get a stomachache either, and dangerous if he got a stomachache.




Constraints
1 ≤ X,A,B ≤ 10^9







InputInput is given from Standard Input in the following format:
X A B





OutputPrint delicious if Takahashi found the food delicious; print safe if he neither found it delicious nor got a stomachache; print dangerous if he got a stomachache.






Sample Input 14 3 6





Sample Output 1safe

He ate the food three days after the ""best-by"" date. It was not delicious or harmful for him.





Sample Input 26 5 1





Sample Output 2delicious

He ate the food by the ""best-by"" date. It was delicious for him.





Sample Input 33 7 12





Sample Output 3dangerous

He ate the food five days after the ""best-by"" date. It was harmful for him.

",Expired?,"Implementation, Arithmetic, Sorting",0.553,230,112
655,"
Score : 200 points


Problem StatementIt is only six months until Christmas, and AtCoDeer the reindeer is now planning his travel to deliver gifts.
There are N houses along TopCoDeer street. The i-th house is located at coordinate a_i. He has decided to deliver gifts to all these houses.
Find the minimum distance to be traveled when AtCoDeer can start and end his travel at any positions.  




Constraints
1 ≤ N ≤ 100
0 ≤ a_i ≤ 1000
a_i is an integer.







InputInput is given from Standard Input in the following format:
N
a_1 a_2 ... a_N





OutputPrint the minimum distance to be traveled.  






Sample Input 14
2 3 7 9





Sample Output 17

The travel distance of 7 can be achieved by starting at coordinate 9 and traveling straight to coordinate 2.
It is not possible to do with a travel distance of less than 7, and thus 7 is the minimum distance to be traveled.  





Sample Input 28
3 1 4 1 5 9 2 6





Sample Output 28

There may be more than one house at a position.  

",Traveling AtCoDeer Problem,"Bruteforcing, Sorting, Greedy Algorithm, Arithmetic",0.895,173,141
656,"
Score : 600 points


Problem Statement10^9 contestants, numbered 1 to 10^9, will compete in a competition.
There will be two contests in this competition.
The organizer prepared N problems, numbered 1 to N, to use in these contests.
When Problem i is presented in a contest, it will be solved by all contestants from Contestant L_i to Contestant R_i (inclusive), and will not be solved by any other contestants.
The organizer will use these N problems in the two contests.
Each problem must be used in exactly one of the contests, and each contest must have at least one problem.
The joyfulness of each contest is the number of contestants who will solve all the problems in the contest.
Find the maximum possible total joyfulness of the two contests.




Constraints
2 \leq N \leq 10^5
1 \leq L_i \leq R_i \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
L_1 R_1
L_2 R_2
\vdots
L_N R_N





OutputPrint the maximum possible total joyfulness of the two contests.






Sample Input 14
4 7
1 4
5 8
2 5





Sample Output 16

The optimal choice is:

Use Problem 1 and 3 in the first contest. Contestant 5, 6, and 7 will solve both of them, so the joyfulness of this contest is 3.
Use Problem 2 and 4 in the second contest. Contestant 2, 3, and 4 will solve both of them, so the joyfulness of this contest is 3.
The total joyfulness of these two contests is 6. We cannot make the total joyfulness greater than 6.






Sample Input 24
1 20
2 19
3 18
4 17





Sample Output 234






Sample Input 310
457835016 996058008
456475528 529149798
455108441 512701454
455817105 523506955
457368248 814532746
455073228 459494089
456651538 774276744
457667152 974637457
457293701 800549465
456580262 636471526





Sample Output 3540049931


",Two Contests,"Sorting, Geometry; 3d, Array, Bruteforcing, Greedy Algorithm, Data Structure",0.167,64,15
657,"
Score : 500 points


Problem StatementWe have N bulbs arranged on a number line, numbered 1 to N from left to right.
Bulb i is at coordinate i.
Each bulb has a non-negative integer parameter called intensity.
When there is a bulb of intensity d at coordinate x, the bulb illuminates the segment from coordinate x-d-0.5 to x+d+0.5.
Initially, the intensity of Bulb i is A_i. We will now do the following operation K times in a row:

For each integer i between 1 and N (inclusive), let B_i be the number of bulbs illuminating coordinate i. Then, change the intensity of each bulb i to B_i.

Find the intensity of each bulb after the K operations.




Constraints
1 \leq N \leq 2 \times 10^5
1 \leq K \leq 2 \times 10^5
0 \leq A_i \leq N







InputInput is given from Standard Input in the following format:
N K
A_1 A_2 \ldots A_N





OutputPrint the intensity A{'}_i of each bulb i after the K operations to Standard Output in the following format:
A{'}_1 A{'}_2 \ldots A{'}_N







Sample Input 15 1
1 0 0 1 0





Sample Output 11 2 2 1 2 

Initially, only Bulb 1 illuminates coordinate 1, so the intensity of Bulb 1 becomes 1 after the operation.
Similarly, the bulbs initially illuminating coordinate 2 are Bulb 1 and 2, so the intensity of Bulb 2 becomes 2.





Sample Input 25 2
1 0 0 1 0





Sample Output 23 3 4 4 3 


",Lamps,"Difference Array, Prefix sum, Segment Tree With Lazy Propagation, Simulation, Bruteforcing",0.244,252,42
658,"
Score : 700 points


Problem StatementWe have a sequence of N \times K integers: X=(X_0,X_1,\cdots,X_{N \times K-1}).
Its elements are represented by another sequence of N integers: A=(A_0,A_1,\cdots,A_{N-1}). For each pair i, j (0 \leq i \leq K-1,\ 0 \leq j \leq N-1), X_{i \times N + j}=A_j holds.
Snuke has an integer sequence s, which is initially empty.
For each i=0,1,2,\cdots,N \times K-1, in this order, he will perform the following operation:

If s does not contain X_i: add X_i to the end of s.
If s does contain X_i: repeatedly delete the element at the end of s until s no longer contains X_i. Note that, in this case, we do not add X_i to the end of s.

Find the elements of s after Snuke finished the operations.




Constraints
1 \leq N \leq 2 \times 10^5
1 \leq K \leq 10^{12}
1 \leq A_i \leq 2 \times 10^5
All values in input are integers.







InputInput is given from Standard Input in the following format:
N K
A_0 A_1 \cdots A_{N-1}





OutputPrint the elements of s after Snuke finished the operations, in order from beginning to end, with spaces in between.






Sample Input 13 2
1 2 3





Sample Output 12 3

In this case, X=(1,2,3,1,2,3).
We will perform the operations as follows:

i=0: s does not contain 1, so we add 1 to the end of s, resulting in s=(1).
i=1: s does not contain 2, so we add 2 to the end of s, resulting in s=(1,2).
i=2: s does not contain 3, so we add 3 to the end of s, resulting in s=(1,2,3).
i=3: s does contain 1, so we repeatedly delete the element at the end of s as long as s contains 1, which causes the following changes to s: (1,2,3)→(1,2)→(1)→().
i=4: s does not contain 2, so we add 2 to the end of s, resulting in s=(2).
i=5: s does not contain 3, so we add 3 to the end of s, resulting in s=(2,3).






Sample Input 25 10
1 2 3 2 3





Sample Output 23






Sample Input 36 1000000000000
1 1 2 2 3 3





Sample Output 3
s may be empty in the end.





Sample Input 411 97
3 1 4 1 5 9 2 6 5 3 5





Sample Output 49 2 6


",Do Not Duplicate,"Stack, Array, Tree, Graph Theory, Arithmetic, Dynamic Programming",0.174,55,8
659,"
Score : 200 points


Problem StatementSig has built his own keyboard. Designed for ultimate simplicity, this keyboard only has 3 keys on it: the 0 key, the 1 key and the backspace key.
To begin with, he is using a plain text editor with this keyboard. This editor always displays one string (possibly empty). Just after the editor is launched, this string is empty. When each key on the keyboard is pressed, the following changes occur to the string:

The 0 key: a letter 0 will be inserted to the right of the string.
The 1 key: a letter 1 will be inserted to the right of the string.
The backspace key: if the string is empty, nothing happens. Otherwise, the rightmost letter of the string is deleted.

Sig has launched the editor, and pressed these keys several times. You are given a string s, which is a record of his keystrokes in order. In this string, the letter 0 stands for the 0 key, the letter 1 stands for the 1 key and the letter B stands for the backspace key. What string is displayed in the editor now?




Constraints
1 ≦ |s| ≦ 10 (|s| denotes the length of s)
s consists of the letters 0, 1 and B.
The correct answer is not an empty string.







InputThe input is given from Standard Input in the following format:
s





OutputPrint the string displayed in the editor in the end.






Sample Input 101B0





Sample Output 100

Each time the key is pressed, the string in the editor will change as follows: 0, 01, 0, 00.





Sample Input 20BB1





Sample Output 21

Each time the key is pressed, the string in the editor will change as follows: 0, (empty), (empty), 1.

",Unhappy Hacking (ABC Edit),"Bruteforcing, Stack, String",0.641,374,203
660,"
Score : 700 points


Problem StatementN problems are proposed for an upcoming contest. Problem i has an initial integer score of A_i points.
M judges are about to vote for problems they like. Each judge will choose exactly V problems, independently from the other judges,
and increase the score of each chosen problem by 1.
After all M judges cast their vote, the problems will be sorted in non-increasing order of score, and the first P problems will be chosen for the problemset.
Problems with the same score can be ordered arbitrarily, this order is decided by the chief judge.
How many problems out of the given N have a chance to be chosen for the problemset?




Constraints
2 \le N \le 10^5
1 \le M \le 10^9
1 \le V \le N - 1
1 \le P \le N - 1
0 \le A_i \le 10^9







InputInput is given from Standard Input in the following format:
N M V P
A_1 A_2 ... A_N





OutputPrint the number of problems that have a chance to be chosen for the problemset.






Sample Input 16 1 2 2
2 1 1 3 0 2





Sample Output 15

If the only judge votes for problems 2 and 5, the scores will be 2 2 1 3 1 2.
The problemset will consist of problem 4 and one of problems 1, 2, or 6.
If the only judge votes for problems 3 and 4, the scores will be 2 1 2 4 0 2.
The problemset will consist of problem 4 and one of problems 1, 3, or 6.
Thus, problems 1, 2, 3, 4, and 6 have a chance to be chosen for the problemset. On the contrary, there is no way for problem 5 to be chosen.





Sample Input 26 1 5 2
2 1 1 3 0 2





Sample Output 23

Only problems 1, 4, and 6 have a chance to be chosen.





Sample Input 310 4 8 5
7 2 3 6 1 6 5 4 6 5





Sample Output 38


",Voting Judges,"Sorting, Binary Search, Greedy Algorithm, Prefix sum, Boolean Operations On Geometric Objects",0.172,81,19
661,"
Score : 500 points


Problem StatementTakahashi has come to a party as a special guest.
There are N ordinary guests at the party. The i-th ordinary guest has a power of A_i.
Takahashi has decided to perform M handshakes to increase the happiness of the party (let the current happiness be 0).
A handshake will be performed as follows:

Takahashi chooses one (ordinary) guest x for his left hand and another guest y for his right hand (x and y can be the same).
Then, he shakes the left hand of Guest x and the right hand of Guest y simultaneously to increase the happiness by A_x+A_y.

However, Takahashi should not perform the same handshake more than once. Formally, the following condition must hold:

Assume that, in the k-th handshake, Takahashi shakes the left hand of Guest x_k and the right hand of Guest y_k. Then, there is no pair p, q (1 \leq p < q \leq M) such that (x_p,y_p)=(x_q,y_q).

What is the maximum possible happiness after M handshakes?




Constraints
1 \leq N \leq 10^5
1 \leq M \leq N^2
1 \leq A_i \leq 10^5
All values in input are integers.







InputInput is given from Standard Input in the following format:
N M
A_1 A_2 ... A_N





OutputPrint the maximum possible happiness after M handshakes.






Sample Input 15 3
10 14 19 34 33





Sample Output 1202

Let us say that Takahashi performs the following handshakes:

In the first handshake, Takahashi shakes the left hand of Guest 4 and the right hand of Guest 4.
In the second handshake, Takahashi shakes the left hand of Guest 4 and the right hand of Guest 5.
In the third handshake, Takahashi shakes the left hand of Guest 5 and the right hand of Guest 4.

Then, we will have the happiness of (34+34)+(34+33)+(33+34)=202.
We cannot achieve the happiness of 203 or greater, so the answer is 202.





Sample Input 29 14
1 3 5 110 24 21 34 5 3





Sample Output 21837






Sample Input 39 73
67597 52981 5828 66249 75177 64141 40773 79105 16076





Sample Output 38128170


",Handshake,"Sorting, Binary Search, Two-pointer, Prefix sum, Counting",0.0,104,11
662,"
Score : 800 points


Problem Statement
Niwango has N cards, numbered 1,2,\ldots,N.
He will now arrange these cards in a row.
Niwango wants to know if there is a way to arrange the cards while satisfying all the N conditions below.
To help him, determine whether such a way exists. If the answer is yes, also find the lexicographically smallest such arrangement.

To the immediate right of Card 1 (if any) is NOT Card a_1.
To the immediate right of Card 2 (if any) is NOT Card a_2.
\vdots
To the immediate right of Card N (if any) is NOT Card a_N.





Constraints

2 \leq N \leq 10^{5}
1 \leq a_i \leq N
a_i \neq i







Input
Input is given from Standard Input in the following format:
N
a_1 a_2 \ldots a_N





Output
If no arrangements satisfy the conditions, print -1. If such arrangements exist, print the lexicographically smallest such arrangement, in the following format:
b_1 b_2 \ldots b_N

Here, b_i represents the i-th card from the left.






Sample Input 14
2 3 4 1





Sample Output 11 3 2 4


The arrangement (1,2,3,4) is lexicographically smaller than (1,3,2,4), but is invalid, since it violates the condition ""to the immediate right of Card 1 is not Card 2.""






Sample Input 22
2 1





Sample Output 2-1


If no arrangements satisfy the conditions, print -1.






Sample Input 313
2 3 4 5 6 7 8 9 10 11 12 13 12





Sample Output 31 3 2 4 6 5 7 9 8 10 12 11 13


",Arrangement,"Permutation Cycle Decomposition, Greedy Algorithm, Segment Tree, Graph Theory, Backtracking, Sorting",0.0,14,1
663,"
Score : 600 points


Problem StatementThere is a cave consisting of N rooms and M one-directional passages. The rooms are numbered 1 through N.
Takahashi is now in Room 1, and Room N has the exit. The i-th passage connects Room s_i and Room t_i (s_i < t_i) and can only be traversed in the direction from Room s_i to Room t_i. It is known that, for each room except Room N, there is at least one passage going from that room.
Takahashi will escape from the cave. Each time he reaches a room (assume that he has reached Room 1 at the beginning), he will choose a passage uniformly at random from the ones going from that room and take that passage.
Aoki, a friend of Takahashi's, can block one of the passages (or do nothing) before Takahashi leaves Room 1. However, it is not allowed to block a passage so that Takahashi is potentially unable to reach Room N.
Let E be the expected number of passages Takahashi takes before he reaches Room N. Find the value of E when Aoki makes a choice that minimizes E.




Constraints
2 \leq N \leq 600
N-1 \leq M \leq \frac{N(N-1)}{2}
s_i < t_i
If i != j, (s_i, t_i) \neq (s_j, t_j). (Added 21:23 JST)
For every v = 1, 2, ..., N-1, there exists i such that v = s_i.







InputInput is given from Standard Input in the following format:
N M
s_1 t_1
:
s_M t_M





OutputPrint the value of E when Aoki makes a choice that minimizes E.
Your output will be judged as correct when the absolute or relative error from the judge's output is at most 10^{-6}.






Sample Input 14 6
1 4
2 3
1 3
1 2
3 4
2 4





Sample Output 11.5000000000

If Aoki blocks the passage from Room 1 to Room 2, Takahashi will go along the path 1 → 3 → 4 with probability \frac{1}{2} and 1 → 4 with probability \frac{1}{2}. E = 1.5 here, and this is the minimum possible value of E.





Sample Input 23 2
1 2
2 3





Sample Output 22.0000000000

Blocking any one passage makes Takahashi unable to reach Room N, so Aoki cannot block a passage.





Sample Input 310 33
3 7
5 10
8 9
1 10
4 6
2 5
1 7
6 10
1 4
1 3
8 10
1 5
2 6
6 9
5 6
5 8
3 6
4 8
2 7
2 9
6 7
1 2
5 9
6 8
9 10
3 9
7 8
4 5
2 10
5 7
3 5
4 7
4 9





Sample Output 33.0133333333


",Fork in the Road,"Dyanmic Programming, Graph Traversal, Probability Theory, Graph Theory, Greedy Algorithm",0.25,16,7
664,"
Score : 500 points


Problem StatementTakahashi is at an all-you-can-eat restaurant.
The restaurant offers N kinds of dishes. It takes A_i minutes to eat the i-th dish, whose deliciousness is B_i.
The restaurant has the following rules:

You can only order one dish at a time. The dish ordered will be immediately served and ready to eat.
You cannot order the same kind of dish more than once.
Until you finish eating the dish already served, you cannot order a new dish.
After T-0.5 minutes from the first order, you can no longer place a new order, but you can continue eating the dish already served.

Let Takahashi's happiness be the sum of the deliciousness of the dishes he eats in this restaurant.
What is the maximum possible happiness achieved by making optimal choices?




Constraints
2 \leq N \leq 3000
1 \leq T \leq 3000
1 \leq A_i \leq 3000
1 \leq B_i \leq 3000
All values in input are integers.







InputInput is given from Standard Input in the following format:
N T
A_1 B_1
:
A_N B_N





OutputPrint the maximum possible happiness Takahashi can achieve.






Sample Input 12 60
10 10
100 100





Sample Output 1110

By ordering the first and second dishes in this order, Takahashi's happiness will be 110.
Note that, if we manage to order a dish in time, we can spend any amount of time to eat it.





Sample Input 23 60
10 10
10 20
10 30





Sample Output 260

Takahashi can eat all the dishes within 60 minutes.





Sample Input 33 60
30 10
30 20
30 30





Sample Output 350

By ordering the second and third dishes in this order, Takahashi's happiness will be 50.
We cannot order three dishes, in whatever order we place them.





Sample Input 410 100
15 23
20 18
13 17
24 12
18 29
19 27
23 21
18 20
27 15
22 25





Sample Output 4145


",All-you-can-eat,"Dyanmic Programming, Sorting, Knapsack, Implementation",0.259,87,23
665,"
Score : 600 points


Problem StatementWe will create an artwork by painting black some squares in a white square grid with 10^9 rows and N columns.
The current plan is as follows: for the i-th column from the left, we will paint the H_i bottommost squares and will not paint the other squares in that column.
Before starting to work, you can choose at most K columns (possibly zero) and change the values of H_i for these columns to any integers of your choice between 0 and 10^9 (inclusive).
Different values can be chosen for different columns.
Then, you will create the modified artwork by repeating the following operation:

Choose one or more consecutive squares in one row and paint them black. (Squares already painted black can be painted again, but squares not to be painted according to the modified plan should not be painted.)

Find the minimum number of times you need to perform this operation.




Constraints
1 \leq N \leq 300
0 \leq K \leq N
0 \leq H_i \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N K
H_1 H_2 ... H_N





OutputPrint the minimum number of operations required.






Sample Input 14 1
2 3 4 1





Sample Output 13

For example, by changing the value of H_3 to 2, you can create the modified artwork by the following three operations:

Paint black the 1-st through 4-th squares from the left in the 1-st row from the bottom.
Paint black the 1-st through 3-rd squares from the left in the 2-nd row from the bottom.
Paint black the 2-nd square from the left in the 3-rd row from the bottom.






Sample Input 26 2
8 6 9 1 2 1





Sample Output 27






Sample Input 310 0
1 1000000000 1 1000000000 1 1000000000 1 1000000000 1 1000000000





Sample Output 34999999996


",Laminate,"Dyanmic Programming, Value / Coordinate Compression, Mathematics",0.5,10,4
666,"
Score : 500 points


Problem StatementYou are given a sequence with N integers: A = \{ A_1, A_2, \cdots, A_N \}.
For each of these N integers, we will choose a color and paint the integer with that color. Here the following condition must be satisfied:

If A_i and A_j (i < j) are painted with the same color, A_i < A_j.

Find the minimum number of colors required to satisfy the condition.




Constraints
1 \leq N \leq 10^5
0 \leq A_i \leq 10^9







InputInput is given from Standard Input in the following format:
N
A_1
:
A_N





OutputPrint the minimum number of colors required to satisfy the condition.






Sample Input 15
2
1
4
5
3





Sample Output 12

We can satisfy the condition with two colors by, for example, painting 2 and 3 red and painting 1, 4, and 5 blue.





Sample Input 24
0
0
0
0





Sample Output 24

We have to paint all the integers with distinct colors.

",Sequence Decomposing,"Greedy Algorithm, Dynamic Programming, Binary Search, Data Structure",0.206,145,31
667,"
Score : 100 points


Problem StatementThere are N children in AtCoder Kindergarten. Mr. Evi will arrange the children in a line, then give 1 candy to the first child in the line, 2 candies to the second child, ..., N candies to the N-th child. How many candies will be necessary in total?




Constraints
1≦N≦100







InputThe input is given from Standard Input in the following format:
N





OutputPrint the necessary number of candies in total.






Sample Input 13





Sample Output 16

The answer is 1+2+3=6.





Sample Input 210





Sample Output 255

The sum of the integers from 1 to 10 is 55.





Sample Input 31





Sample Output 31

Only one child. The answer is 1 in this case.

",Children and Candies (ABC Edit),"Arithmetic, Implementation",0.781,357,235
668,"
Score : 700 points


Problem StatementWe have N cards numbered 1, 2, ..., N.
Card i (1 \leq i \leq N) has an integer A_i written in red ink on one side and an integer B_i written in blue ink on the other side.
Initially, these cards are arranged from left to right in the order from Card 1 to Card N, with the red numbers facing up.
Determine whether it is possible to have a non-decreasing sequence facing up from left to right (that is, for each i (1 \leq i \leq N - 1), the integer facing up on the (i+1)-th card from the left is not less than the integer facing up on the i-th card from the left) by repeating the operation below. If the answer is yes, find the minimum number of operations required to achieve it.

Choose an integer i (1 \leq i \leq N - 1).
Swap the i-th and (i+1)-th cards from the left, then flip these two cards.





Constraints
1 \leq N \leq 18
1 \leq A_i, B_i \leq 50 (1 \leq i \leq N)
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
A_1 A_2 ... A_N
B_1 B_2 ... B_N





OutputIf it is impossible to have a non-decreasing sequence, print -1.
If it is possible, print the minimum number of operations required to achieve it.






Sample Input 13
3 4 3
3 2 3





Sample Output 11

By doing the operation once with i = 1, we have a sequence [2, 3, 3] facing up, which is non-decreasing.





Sample Input 22
2 1
1 2





Sample Output 2-1

After any number of operations, we have the sequence [2, 1] facing up, which is not non-decreasing.





Sample Input 34
1 2 3 4
5 6 7 8





Sample Output 30

No operation may be required.





Sample Input 45
28 15 22 43 31
20 22 43 33 32





Sample Output 4-1






Sample Input 55
4 46 6 38 43
33 15 18 27 37





Sample Output 53


",Swap and Flip,"Bitmask, Parity, Permutation Cycle Decomposition, Greedy Algorithm, Counting, Sorting, Dyanmic Programming",0.417,19,7
669,"
Score : 100 points


Problem StatementYou are given a trapezoid. The lengths of its upper base, lower base, and height are a, b, and h, respectively.


An example of a trapezoid

Find the area of this trapezoid.




Constraints
1≦a≦100
1≦b≦100
1≦h≦100
All input values are integers.
h is even.







InputThe input is given from Standard Input in the following format:
a
b
h





OutputPrint the area of the given trapezoid. It is guaranteed that the area is an integer.






Sample Input 13
4
2





Sample Output 17

When the lengths of the upper base, lower base, and height are 3, 4, and 2, respectively, the area of the trapezoid is (3+4)×2/2 = 7.





Sample Input 24
4
4





Sample Output 216

In this case, a parallelogram is given, which is also a trapezoid.

",Trapezoids,Arithmetic,0.794,271,192
670,"
Score : 400 points


Problem StatementThere are N integers, A_1, A_2, ..., A_N, arranged in a row in this order.
You can perform the following operation on this integer sequence any number of times:
Operation: Choose an integer i satisfying 1 \leq i \leq N-1. Multiply both A_i and A_{i+1} by -1.
Let B_1, B_2, ..., B_N be the integer sequence after your operations.
Find the maximum possible value of B_1 + B_2 + ... + B_N.




Constraints
All values in input are integers.
2 \leq N \leq 10^5
-10^9 \leq A_i \leq 10^9







InputInput is given from Standard Input in the following format:
N
A_1 A_2 ... A_N





OutputPrint the maximum possible value of B_1 + B_2 + ... + B_N.






Sample Input 13
-10 5 -4





Sample Output 119

If we perform the operation as follows:

Choose 1 as i, which changes the sequence to 10, -5, -4.
Choose 2 as i, which changes the sequence to 10, 5, 4.

we have B_1 = 10, B_2 = 5, B_3 = 4. The sum here, B_1 + B_2 + B_3 = 10 + 5 + 4 = 19, is the maximum possible result.





Sample Input 25
10 -4 -8 -11 3





Sample Output 230






Sample Input 311
-1000000000 1000000000 -1000000000 1000000000 -1000000000 0 1000000000 -1000000000 1000000000 -1000000000 1000000000





Sample Output 310000000000

The output may not fit into a 32-bit integer type.

",Flipping Signs,"Parity, Greedy Algorithm, Mathematics, Arithmetic, Array, Sorting",0.59,205,98
671,"
Score : 700 points


Problem StatementYou are given an integer L. Construct a directed graph that satisfies the conditions below. The graph may contain multiple edges between the same pair of vertices. It can be proved that such a graph always exists.

The number of vertices, N, is at most 20. The vertices are given ID numbers from 1 to N.
The number of edges, M, is at most 60. Each edge has an integer length between 0 and 10^6 (inclusive).
Every edge is directed from the vertex with the smaller ID to the vertex with the larger ID. That is, 1,2,...,N is one possible topological order of the vertices.
There are exactly L different paths from Vertex 1 to Vertex N. The lengths of these paths are all different, and they are integers between 0 and L-1.

Here, the length of a path is the sum of the lengths of the edges contained in that path, and two paths are considered different when the sets of the edges contained in those paths are different.




Constraints
2 \leq L \leq 10^6
L is an integer.







InputInput is given from Standard Input in the following format:
L





OutputIn the first line, print N and M, the number of the vertices and edges in your graph.
In the i-th of the following M lines, print three integers u_i,v_i and w_i, representing the starting vertex, the ending vertex and the length of the i-th edge.
If there are multiple solutions, any of them will be accepted.






Sample Input 14





Sample Output 18 10
1 2 0
2 3 0
3 4 0
1 5 0
2 6 0
3 7 0
4 8 0
5 6 1
6 7 1
7 8 1

In the graph represented by the sample output, there are four paths from Vertex 1 to N=8:

1 → 2 → 3 → 4 → 8 with length 0
1 → 2 → 3 → 7 → 8 with length 1
1 → 2 → 6 → 7 → 8 with length 2
1 → 5 → 6 → 7 → 8 with length 3

There are other possible solutions.





Sample Input 25





Sample Output 25 7
1 2 0
2 3 1
3 4 0
4 5 0
2 4 0
1 3 3
3 5 1


",All Your Paths are Different Lengths,"Bitmask, Directed Acyclic Graph, Graph Theory, Combinatorics, Topological Sorting",0.2,31,9
672,"
Score : 900 points


Problem StatementYou are given an undirected graph consisting of N vertices and M edges.
The vertices are numbered 1 to N, and the edges are numbered 1 to M.
In addition, each vertex has a label, A or B. The label of Vertex i is s_i.
Edge i bidirectionally connects vertex a_i and b_i.
The phantom thief Nusook likes to choose some vertex as the startpoint and traverse an edge zero or more times.
Today, he will make a string after traveling as above, by placing the labels of the visited vertices in the order visited, beginning from the startpoint.
For example, in a graph where Vertex 1 has the label A and Vertex 2 has the label B, if Nusook travels along the path 1 \rightarrow 2 \rightarrow 1 \rightarrow 2 \rightarrow 2, the resulting string is ABABB.
Determine if Nusook can make all strings consisting of A and B.




Constraints
2 \leq N \leq 2 \times 10^{5}
1 \leq M \leq 2 \times 10^{5}
|s| = N
s_i is A or B.
1 \leq a_i, b_i \leq N
The given graph may NOT be simple or connected.







InputInput is given from Standard Input in the following format:
N M
s
a_1 b_1
:
a_{M} b_{M}





OutputIf Nusook can make all strings consisting of A and B, print Yes; otherwise, print No.






Sample Input 12 3
AB
1 1
1 2
2 2





Sample Output 1Yes


Since Nusook can visit Vertex 1 and Vertex 2 in any way he likes, he can make all strings consisting of A and B.









Sample Input 24 3
ABAB
1 2
2 3
3 1





Sample Output 2No


For example, Nusook cannot make BB.
The given graph may not be connected.









Sample Input 313 23
ABAAAABBBBAAB
7 1
10 6
1 11
2 10
2 8
2 11
11 12
8 3
7 12
11 2
13 13
11 9
4 1
9 7
9 6
8 13
8 6
4 10
8 7
4 3
2 1
8 12
6 9





Sample Output 3Yes






Sample Input 413 17
BBABBBAABABBA
7 1
7 9
11 12
3 9
11 9
2 1
11 5
12 11
10 8
1 11
1 8
7 7
9 10
8 8
8 12
6 2
13 11





Sample Output 4No


",ABland Yard,"Graph Theory, Graph Traversal, Queue, Segment Tree With Lazy Propagation",0.438,38,15
673,"
Score : 900 points


Problem StatementThere are N Snukes lining up in a row.
You are given a string S of length N. The i-th Snuke from the front has two red balls if the i-th character in S is 0; one red ball and one blue ball if the i-th character in S is 1; two blue balls if the i-th character in S is 2.
Takahashi has a sequence that is initially empty. Find the number of the possible sequences he may have after repeating the following procedure 2N times, modulo 998244353:

Each Snuke who has one or more balls simultaneously chooses one of his balls and hand it to the Snuke in front of him, or hand it to Takahashi if he is the first Snuke in the row.
Takahashi receives the ball and put it to the end of his sequence.





Constraints
1 \leq |S| \leq 2000
S consists of 0,1 and 2.

Note that the integer N is not directly given in input; it is given indirectly as the length of the string S.






InputInput is given from Standard Input in the following format:
S





OutputPrint the number of the possible sequences Takahashi may have after repeating the procedure 2N times, modulo 998244353.






Sample Input 102





Sample Output 13

There are three sequences that Takahashi may have: rrbb, rbrb and rbbr, where r and b stand for red and blue balls, respectively.





Sample Input 21210





Sample Output 255






Sample Input 312001021211100201020





Sample Output 3543589959


",Pass,"Dyanmic Programming, Combinatorics, Arithmetic, Graph Theory",0.625,10,7
674,"
Score : 1000 points


Problem StatementSnuke participated in a magic show.
A magician prepared N identical-looking boxes.
He put a treasure in one of the boxes, closed the boxes, shuffled them, and numbered them 1 through N.
Since the boxes are shuffled, now Snuke has no idea which box contains the treasure.
Snuke wins the game if he opens a box containing the treasure.
You may think that if Snuke opens all boxes at once, he can always win the game.
However, there are some tricks:

Snuke must open the boxes one by one. After he opens a box and checks the content of the box, he must close the box before opening the next box.
He is only allowed to open Box i at most a_i times.
The magician may secretly move the treasure from a closed box to another closed box, using some magic trick.
For simplicity, assume that the magician never moves the treasure while Snuke is opening some box.
However, he can move it at any other time (before Snuke opens the first box, or between he closes some box and opens the next box).
The magician can perform the magic trick at most K times.

Can Snuke always win the game, regardless of the initial position of the treasure and the movements of the magician?




Constraints
2 \leq N \leq 50
1 \leq K \leq 50
1 \leq a_i \leq 100







InputInput is given from Standard Input in the following format:
N K
a_1 a_2 \cdots a_N





OutputIf the answer is no, print a single -1.
Otherwise, print one possible move of Snuke in the following format:
Q
x_1 x_2 \cdots x_Q

It means that he opens boxes x_1, x_2, \cdots, x_Q in this order.
In case there are multiple possible solutions, you can output any.






Sample Input 12 1
5 5





Sample Output 17
1 1 2 1 2 2 1

If Snuke opens the boxes 7 times in the order 1 \rightarrow 1 \rightarrow 2 \rightarrow 1 \rightarrow 2 \rightarrow 2 \rightarrow 1, he can always find the treasure regardless of its initial position and the movements of the magician.





Sample Input 23 50
5 10 15





Sample Output 2-1


",Magic,"Dyanmic Programming, Backtracking, Game Theory, Arithmetic",0.0,8,0
675,"
Score : 800 points


Problem StatementYou are given integers N,\ A and B.
Determine if there exists a permutation (P_0,\ P_1,\ ...\ P_{2^N-1}) of (0,\ 1,\ ...\ 2^N-1) that satisfies all of the following conditions, and create one such permutation if it exists.

P_0=A
P_{2^N-1}=B
For all 0 \leq i < 2^N-1, the binary representations of P_i and P_{i+1} differ by exactly one bit.





Constraints
1 \leq N \leq 17
0 \leq A \leq 2^N-1
0 \leq B \leq 2^N-1
A \neq B
All values in input are integers.







InputInput is given from Standard Input in the following format:
N A B





OutputIf there is no permutation that satisfies the conditions, print NO.
If there is such a permutation, print YES in the first line.
Then, print (P_0,\ P_1,\ ...\ P_{2^N-1}) in the second line, with spaces in between.
If there are multiple solutions, any of them is accepted.






Sample Input 12 1 3





Sample Output 1YES
1 0 2 3

The binary representation of P=(1,0,2,3) is (01,00,10,11), where any two adjacent elements differ by exactly one bit.





Sample Input 23 2 1





Sample Output 2NO


",Differ by 1 Bit,"Bitmask, Divide And Conquer, Permutation Cycle Decomposition, Combinatorics, Dynamic Programming",0.353,30,10
676,"
Score : 700 points


Problem StatementYou are given an integer N.
Build an undirected graph with N vertices with indices 1 to N that satisfies the following two conditions:

The graph is simple and connected.
There exists an integer S such that, for every vertex, the sum of the indices of the vertices adjacent to that vertex is S.

It can be proved that at least one such graph exists under the constraints of this problem.




Constraints
All values in input are integers.
3 \leq N \leq 100







InputInput is given from Standard Input in the following format:
N





OutputIn the first line, print the number of edges, M, in the graph you made. In the i-th of the following M lines, print two integers a_i and b_i, representing the endpoints of the i-th edge.
The output will be judged correct if the graph satisfies the conditions.






Sample Input 13





Sample Output 12
1 3
2 3


For every vertex, the sum of the indices of the vertices adjacent to that vertex is 3.


",Balanced Neighbors,"Graph Theory, Bruteforcing",0.65,28,20
677,"
Score : 800 points


Problem StatementYou are given a simple connected undirected graph consisting of N vertices and M edges.
The vertices are numbered 1 to N, and the edges are numbered 1 to M.
Edge i connects Vertex a_i and b_i bidirectionally.
Determine if three circuits (see Notes) can be formed using each of the edges exactly once.




NotesA circuit is a cycle allowing repetitions of vertices but not edges.




Constraints
All values in input are integers.
1 \leq N,M \leq 10^{5}
1 \leq a_i, b_i \leq N
The given graph is simple and connected.







InputInput is given from Standard Input in the following format:
N M
a_1 b_1
:
a_M b_M





OutputIf three circuits can be formed using each of the edges exactly once, print Yes; if they cannot, print No.






Sample Input 17 9
1 2
1 3
2 3
1 4
1 5
4 5
1 6
1 7
6 7





Sample Output 1Yes


Three circuits can be formed using each of the edges exactly once, as follows:









Sample Input 23 3
1 2
2 3
3 1





Sample Output 2No


Three circuits are needed.






Sample Input 318 27
17 7
12 15
18 17
13 18
13 6
5 7
7 1
14 5
15 11
7 6
1 9
5 4
18 16
4 6
7 2
7 11
6 3
12 14
5 2
10 5
7 8
10 15
3 15
9 8
7 15
5 16
18 15





Sample Output 3Yes


",Three Circuits,"Graph Theory, Graph Theory, Depth-first Search, Boolean Operations On Geometric Objects",0.167,50,10
678,"
Score : 400 points


Problem StatementAlong a road running in an east-west direction, there are A shrines and B temples.
The i-th shrine from the west is located at a distance of s_i meters from the west end of the road, and the i-th temple from the west is located at a distance of t_i meters from the west end of the road.
Answer the following Q queries:

Query i (1 \leq i \leq Q): If we start from a point at a distance of x_i meters from the west end of the road and freely travel along the road, what is the minimum distance that needs to be traveled in order to visit one shrine and one temple? (It is allowed to pass by more shrines and temples than required.)





Constraints
1 \leq A, B \leq 10^5
1 \leq Q \leq 10^5
1 \leq s_1 < s_2 < ... < s_A \leq 10^{10}
1 \leq t_1 < t_2 < ... < t_B \leq 10^{10}
1 \leq x_i \leq 10^{10}
s_1, ..., s_A, t_1, ..., t_B, x_1, ..., x_Q are all different.
All values in input are integers.







InputInput is given from Standard Input in the following format:
A B Q
s_1
:
s_A
t_1
:
t_B
x_1
:
x_Q





OutputPrint Q lines. The i-th line should contain the answer to the i-th query.






Sample Input 12 3 4
100
600
400
900
1000
150
2000
899
799





Sample Output 1350
1400
301
399

There are two shrines and three temples. The shrines are located at distances of 100, 600 meters from the west end of the road, and the temples are located at distances of 400, 900, 1000 meters from the west end of the road.

Query 1: If we start from a point at a distance of 150 meters from the west end of the road, the optimal move is first to walk 50 meters west to visit a shrine, then to walk 300 meters east to visit a temple.
Query 2: If we start from a point at a distance of 2000 meters from the west end of the road, the optimal move is first to walk 1000 meters west to visit a temple, then to walk 400 meters west to visit a shrine. We will pass by another temple on the way, but it is fine.
Query 3: If we start from a point at a distance of 899 meters from the west end of the road, the optimal move is first to walk 1 meter east to visit a temple, then to walk 300 meters west to visit a shrine.
Query 4: If we start from a point at a distance of 799 meters from the west end of the road, the optimal move is first to walk 199 meters west to visit a shrine, then to walk 200 meters west to visit a temple.






Sample Input 21 1 3
1
10000000000
2
9999999999
5000000000





Sample Output 210000000000
10000000000
14999999998

The road is quite long, and we may need to travel a distance that does not fit into a 32-bit integer.

",Lazy Faith,"Binary Search, Binary Search Tree, Array, Implementation, Combinatorics, Arithmetic",0.569,137,65
679,"
Score : 700 points


Problem StatementThere is an integer sequence of length 2^N: A_0, A_1, ..., A_{2^N-1}. (Note that the sequence is 0-indexed.)
For every integer K satisfying 1 \leq K \leq 2^N-1, solve the following problem:

Let i and j be integers. Find the maximum value of A_i + A_j where 0 \leq i < j \leq 2^N-1 and (i or j) \leq K.
Here, or denotes the bitwise OR.





Constraints
1 \leq N \leq 18
1 \leq A_i \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
A_0 A_1 ... A_{2^N-1}





OutputPrint 2^N-1 lines.
In the i-th line, print the answer of the problem above for K=i.






Sample Input 12
1 2 3 1





Sample Output 13
4
5

For K=1, the only possible pair of i and j is (i,j)=(0,1), so the answer is A_0+A_1=1+2=3.
For K=2, the possible pairs of i and j are (i,j)=(0,1),(0,2).
When (i,j)=(0,2), A_i+A_j=1+3=4. This is the maximum value, so the answer is 4.
For K=3, the possible pairs of i and j are (i,j)=(0,1),(0,2),(0,3),(1,2),(1,3),(2,3) .
When (i,j)=(1,2), A_i+A_j=2+3=5. This is the maximum value, so the answer is 5.





Sample Input 23
10 71 84 33 6 47 23 25





Sample Output 281
94
155
155
155
155
155






Sample Input 34
75 26 45 72 81 47 97 97 2 2 25 82 84 17 56 32





Sample Output 3101
120
147
156
156
178
194
194
194
194
194
194
194
194
194


",Or Plus Max,"Dynamic Programming Using Bitfield, Dynamic Programming, Bitmask, Enumeration, Priority Queue, Dyanmic Programming, Array",0.533,30,11
680,"
Score : 800 points


Problem StatementFor a positive integer n, we denote the integer obtained by reversing the decimal notation of n (without leading zeroes) by rev(n). For example, rev(123) = 321 and rev(4000) = 4.
You are given a positive integer D. How many positive integers N satisfy rev(N) = N + D?




Constraints
D is an integer.
1 ≤ D < 10^9







InputInput is given from Standard Input in the following format:
D





OutputPrint the number of the positive integers N such that rev(N) = N + D.






Sample Input 163





Sample Output 12

There are two positive integers N such that rev(N) = N + 63: N = 18 and 29.





Sample Input 275





Sample Output 20

There are no positive integers N such that rev(N) = N + 75.





Sample Input 3864197532





Sample Output 31920


",Mirrored,"Mathematics, Arithmetic, Depth-first Search, Dyanmic Programming, Combinatorics",0.5,4,2
681,"
Score : 1000 points


Problem StatementTakahashi and Aoki are going to together construct a sequence of integers.
First, Takahashi will provide a sequence of integers a, satisfying all of the following conditions:

The length of a is N.
Each element in a is an integer between 1 and K, inclusive.
a is a palindrome, that is, reversing the order of elements in a will result in the same sequence as the original.

Then, Aoki will perform the following operation an arbitrary number of times:

Move the first element in a to the end of a.

How many sequences a can be obtained after this procedure, modulo 10^9+7?




Constraints
1≤N≤10^9
1≤K≤10^9







InputThe input is given from Standard Input in the following format:
N K





OutputPrint the number of the sequences a that can be obtained after the procedure, modulo 10^9+7.






Sample Input 14 2





Sample Output 16

The following six sequences can be obtained:

(1, 1, 1, 1)
(1, 1, 2, 2)
(1, 2, 2, 1)
(2, 2, 1, 1)
(2, 1, 1, 2)
(2, 2, 2, 2)






Sample Input 21 10





Sample Output 210






Sample Input 36 3





Sample Output 375






Sample Input 41000000000 1000000000





Sample Output 4875699961


",Rotated Palindromes,"Mathematics, Combinatorics",0.5,3,2
682,"
Score : 600 points


Problem StatementOn the xy-plane, Snuke is going to travel from the point (x_s, y_s) to the point (x_t, y_t).
He can move in arbitrary directions with speed 1.
Here, we will consider him as a point without size.
There are N circular barriers deployed on the plane.
The center and the radius of the i-th barrier are (x_i, y_i) and r_i, respectively.
The barriers may overlap or contain each other.
A point on the plane is exposed to cosmic rays if the point is not within any of the barriers.
Snuke wants to avoid exposure to cosmic rays as much as possible during the travel.
Find the minimum possible duration of time he is exposed to cosmic rays during the travel.




Constraints
All input values are integers.
-10^9 ≤ x_s, y_s, x_t, y_t ≤ 10^9
(x_s, y_s) ≠ (x_t, y_t)
1≤N≤1,000
-10^9 ≤ x_i, y_i ≤ 10^9
1 ≤ r_i ≤ 10^9







InputThe input is given from Standard Input in the following format:
x_s y_s x_t y_t
N
x_1 y_1 r_1
x_2 y_2 r_2
:
x_N y_N r_N





OutputPrint the minimum possible duration of time Snuke is exposed to cosmic rays during the travel.
The output is considered correct if the absolute or relative error is at most 10^{-9}.






Sample Input 1-2 -2 2 2
1
0 0 1





Sample Output 13.6568542495

An optimal route is as follows:








Sample Input 2-2 0 2 0
2
-1 0 2
1 0 2





Sample Output 20.0000000000

An optimal route is as follows:








Sample Input 34 -2 -2 4
3
0 0 2
4 0 1
0 4 1





Sample Output 34.0000000000

An optimal route is as follows:




",Cosmic Rays,"Graph Theory, Mathematics, Dijkstra's, Priority Queue",0.412,48,17
683,"
Score : 1000 points


Problem StatementThere are M chairs arranged in a line. The coordinate of the i-th chair (1 ≤ i ≤ M) is i.
N people of the Takahashi clan played too much games, and they are all suffering from backaches. They need to sit in chairs and rest, but they are particular about which chairs they sit in. Specifically, the i-th person wishes to sit in a chair whose coordinate is not greater than L_i, or not less than R_i. Naturally, only one person can sit in the same chair.
It may not be possible for all of them to sit in their favorite chairs, if nothing is done.
Aoki, who cares for the health of the people of the Takahashi clan, decides to provide additional chairs so that all of them can sit in chairs at their favorite positions.
Additional chairs can be placed at arbitrary real coordinates. Find the minimum required number of additional chairs.




Constraints
1 ≤ N,M ≤ 2 × 10^5
0 ≤ L_i < R_i ≤ M + 1(1 ≤ i ≤ N)
All input values are integers.







InputInput is given from Standard Input in the following format:
N M
L_1 R_1
:
L_N R_N





OutputPrint the minimum required number of additional chairs.






Sample Input 14 4
0 3
2 3
1 3
3 4





Sample Output 10

The four people can sit in chairs at the coordinates 3, 2, 1 and 4, respectively, and no more chair is needed.





Sample Input 27 6
0 7
1 5
3 6
2 7
1 6
2 6
3 7





Sample Output 22

If we place additional chairs at the coordinates 0 and 2.5, the seven people can sit at coordinates 0, 5, 3, 2, 6, 1 and 2.5, respectively.





Sample Input 33 1
1 2
1 2
1 2





Sample Output 32






Sample Input 46 6
1 6
1 6
1 5
1 5
2 6
2 6





Sample Output 42


",Exhausted?,"Sorting, Greedy Algorithm, Segment Tree, Binary Search Tree, Two-pointer",0.0,8,2
684,"
Score : 700 points


Problem StatementHaiku is a short form of Japanese poetry. A Haiku consists of three phrases with 5, 7 and 5 syllables, in this order.
Iroha is looking for X,Y,Z-Haiku (defined below) in integer sequences.
Consider all integer sequences of length N whose elements are between 1 and 10, inclusive. Out of those 10^N sequences, how many contain an X,Y,Z-Haiku?
Here, an integer sequence a_0, a_1, ..., a_{N-1} is said to contain an X,Y,Z-Haiku if and only if there exist four indices x, y, z, w (0 ≦ x < y < z < w ≦ N) such that all of the following are satisfied:

a_x + a_{x+1} + ... + a_{y-1} = X
a_y + a_{y+1} + ... + a_{z-1} = Y
a_z + a_{z+1} + ... + a_{w-1} = Z

Since the answer can be extremely large, print the number modulo 10^9+7.




Constraints
3 ≦ N ≦ 40
1 ≦ X ≦ 5
1 ≦ Y ≦ 7
1 ≦ Z ≦ 5







InputThe input is given from Standard Input in the following format:
N X Y Z





OutputPrint the number of the sequences that contain an X,Y,Z-Haiku, modulo 10^9+7.






Sample Input 13 5 7 5





Sample Output 11

Here, the only sequence that contains a 5,7,5-Haiku is [5, 7, 5].





Sample Input 24 5 7 5





Sample Output 234






Sample Input 337 4 2 3





Sample Output 3863912418






Sample Input 440 5 7 5





Sample Output 4562805100


",Iroha and Haiku,"Dyanmic Programming, Bitmask, Arithmetic, Dynamic Programming",0.7,15,9
685,"
Score : 600 points


Problem StatementSnuke's town has a subway system, consisting of N stations and M railway lines. The stations are numbered 1 through N. Each line is operated by a company. Each company has an identification number.
The i-th ( 1 \leq i \leq M ) line connects station p_i and q_i bidirectionally. There is no intermediate station. This line is operated by company c_i.
You can change trains at a station where multiple lines are available.
The fare system used in this subway system is a bit strange. When a passenger only uses lines that are operated by the same company, the fare is 1 yen (the currency of Japan). Whenever a passenger changes to a line that is operated by a different company from the current line, the passenger is charged an additional fare of 1 yen. In a case where a passenger who changed from some company A's line to another company's line changes to company A's line again, the additional fare is incurred again.
Snuke is now at station 1 and wants to travel to station N by subway. Find the minimum required fare.




Constraints
2 \leq N \leq 10^5
0 \leq M \leq 2×10^5
1 \leq p_i \leq N (1 \leq i \leq M)
1 \leq q_i \leq N (1 \leq i \leq M)
1 \leq c_i \leq 10^6 (1 \leq i \leq M)
p_i \neq q_i (1 \leq i \leq M)







InputThe input is given from Standard Input in the following format:
N M
p_1 q_1 c_1
:
p_M q_M c_M





OutputPrint the minimum required fare. If it is impossible to get to station N by subway, print -1 instead.






Sample Input 13 3
1 2 1
2 3 1
3 1 2





Sample Output 11

Use company 1's lines: 1 → 2 → 3. The fare is 1 yen.





Sample Input 28 11
1 3 1
1 4 2
2 3 1
2 5 1
3 4 3
3 6 3
3 7 3
4 8 4
5 6 1
6 7 5
7 8 5





Sample Output 22

First, use company 1's lines: 1 → 3 → 2 → 5 → 6. Then, use company 5's lines: 6 → 7 → 8. The fare is 2 yen.





Sample Input 32 0





Sample Output 3-1


",Snuke's Subway Trip,"Graph Theory, Breadth-first Search, Shortest Path, Graph Traversal, Deque, Boolean Operations On Geometric Objects, Set / Map",0.067,90,6
686,"
Score : 700 points


Problem StatementWe have an integer sequence of length N: A_0,A_1,\cdots,A_{N-1}.
Find the following sum (\mathrm{lcm}(a, b) denotes the least common multiple of a and b):

\sum_{i=0}^{N-2} \sum_{j=i+1}^{N-1} \mathrm{lcm}(A_i,A_j)

Since the answer may be enormous, compute it modulo 998244353.




Constraints
1 \leq N \leq 200000
1 \leq A_i \leq 1000000
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
A_0\ A_1\ \cdots\ A_{N-1}





OutputPrint the sum modulo 998244353.






Sample Input 13
2 4 6





Sample Output 122

\mathrm{lcm}(2,4)+\mathrm{lcm}(2,6)+\mathrm{lcm}(4,6)=4+6+12=22.





Sample Input 28
1 2 3 4 6 8 12 12





Sample Output 2313






Sample Input 310
356822 296174 484500 710640 518322 888250 259161 609120 592348 713644





Sample Output 3353891724


",LCMs,"Counting, Number Theory, Inclusion And Exclusion, Dyanmic Programming, Arithmetic, Sieve Of Eratosthenes",0.286,29,6
687,"
Score : 800 points


Problem StatementWe have 3N colored balls with IDs from 1 to 3N.
A string S of length 3N represents the colors of the balls. The color of Ball i is red if S_i is R, green if S_i is G, and blue if S_i is B. There are N red balls, N green balls, and N blue balls.
Takahashi will distribute these 3N balls to N people so that each person gets one red ball, one blue ball, and one green ball.
The people want balls with IDs close to each other, so he will additionally satisfy the following condition:

Let a_j < b_j < c_j be the IDs of the balls received by the j-th person in ascending order.
Then, \sum_j (c_j-a_j) should be as small as possible.

Find the number of ways in which Takahashi can distribute the balls. Since the answer can be enormous, compute it modulo 998244353.
We consider two ways to distribute the balls different if and only if there is a person who receives different sets of balls.




Constraints
1 \leq N \leq 10^5
|S|=3N
S consists of R, G, and B, and each of these characters occurs N times in S.







InputInput is given from Standard Input in the following format:
N
S





OutputPrint the number of ways in which Takahashi can distribute the balls, modulo 998244353.






Sample Input 13
RRRGGGBBB





Sample Output 1216

The minimum value of \sum_j (c_j-a_j) is 18 when the balls are, for example, distributed as follows:

The first person gets Ball 1, 5, and 9.
The second person gets Ball 2, 4, and 8.
The third person gets Ball 3, 6, and 7.






Sample Input 25
BBRGRRGRGGRBBGB





Sample Output 2960


",RGB Balls,"Greedy Algorithm, Combinatorics, Arithmetic, Dynamic Programming",0.818,14,11
688,"
Score : 800 points


Problem StatementThere are N positive integers arranged in a circle.
Now, the i-th number is A_i. Takahashi wants the i-th number to be B_i. For this objective, he will repeatedly perform the following operation:

Choose an integer i such that 1 \leq i \leq N.
Let a, b, c be the (i-1)-th, i-th, and (i+1)-th numbers, respectively. Replace the i-th number with a+b+c.

Here the 0-th number is the N-th number, and the (N+1)-th number is the 1-st number.
Determine if Takahashi can achieve his objective.
If the answer is yes, find the minimum number of operations required.




Constraints
3 \leq N \leq 2 \times 10^5
1 \leq A_i, B_i \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
A_1 A_2 ... A_N
B_1 B_2 ... B_N





OutputPrint the minimum number of operations required, or -1 if the objective cannot be achieved.






Sample Input 13
1 1 1
13 5 7





Sample Output 14

Takahashi can achieve his objective by, for example, performing the following operations:

Replace the second number with 3.
Replace the second number with 5.
Replace the third number with 7.
Replace the first number with 13.






Sample Input 24
1 2 3 4
2 3 4 5





Sample Output 2-1






Sample Input 35
5 6 5 2 1
9817 1108 6890 4343 8704





Sample Output 325


",Numbers on a Circle,"Greedy Algorithm, Priority Queue, Arithmetic, Simulation",0.188,66,10
689,"
Score : 500 points


Problem StatementWe have N locked treasure boxes, numbered 1 to N.
A shop sells M keys. The i-th key is sold for a_i yen (the currency of Japan), and it can unlock b_i of the boxes: Box c_{i1}, c_{i2}, ..., c_{i{b_i}}. Each key purchased can be used any number of times.
Find the minimum cost required to unlock all the treasure boxes. If it is impossible to unlock all of them, print -1.




Constraints
All values in input are integers.
1 \leq N \leq 12
1 \leq M \leq 10^3
1 \leq a_i \leq 10^5
1 \leq b_i \leq N
1 \leq c_{i1} < c_{i2} < ... < c_{i{b_i}} \leq N







InputInput is given from Standard Input in the following format:
N M
a_1 b_1
c_{11} c_{12} ... c_{1{b_1}}
:
a_M b_M
c_{M1} c_{M2} ... c_{M{b_M}}





OutputPrint the minimum cost required to unlock all the treasure boxes.
If it is impossible to unlock all of them, print -1.






Sample Input 12 3
10 1
1
15 1
2
30 2
1 2





Sample Output 125

We can unlock all the boxes by purchasing the first and second keys, at the cost of 25 yen, which is the minimum cost required.





Sample Input 212 1
100000 1
2





Sample Output 2-1

We cannot unlock all the boxes.





Sample Input 34 6
67786 3
1 3 4
3497 1
2
44908 3
2 3 4
2156 3
2 3 4
26230 1
2
86918 1
3





Sample Output 369942


",Get Everything,"Bitmask, Dynamic Programming Using Bitfield, Dyanmic Programming, Boolean Operations On Geometric Objects",0.545,73,38
690,"
Score : 600 points


Problem StatementGiven is a directed graph G with N vertices and M edges.
The vertices are numbered 1 to N, and the i-th edge is directed from Vertex A_i to Vertex B_i.
It is guaranteed that the graph contains no self-loops or multiple edges.
Determine whether there exists an induced subgraph (see Notes) of G such that the in-degree and out-degree of every vertex are both 1. If the answer is yes, show one such subgraph.
Here the null graph is not considered as a subgraph.




NotesFor a directed graph G = (V, E), we call a directed graph G' = (V', E') satisfying the following conditions an induced subgraph of G:

V' is a (non-empty) subset of V.
E' is the set of all the edges in E that have both endpoints in V'.





Constraints
1 \leq N \leq 1000
0 \leq M \leq 2000
1 \leq A_i,B_i \leq N
A_i \neq B_i
All pairs (A_i, B_i) are distinct.
All values in input are integers.







InputInput is given from Standard Input in the following format:
N M
A_1 B_1
A_2 B_2
:
A_M B_M





OutputIf there is no induced subgraph of G that satisfies the condition, print -1.
Otherwise, print an induced subgraph of G that satisfies the condition, in the following format:
K
v_1
v_2
:
v_K

This represents the induced subgraph of G with K vertices whose vertex set is \{v_1, v_2, \ldots, v_K\}. (The order of v_1, v_2, \ldots, v_K does not matter.)
If there are multiple subgraphs of G that satisfy the condition, printing any of them is accepted.






Sample Input 14 5
1 2
2 3
2 4
4 1
4 3





Sample Output 13
1
2
4

The induced subgraph of G whose vertex set is \{1, 2, 4\} has the edge set \{(1, 2), (2, 4), (4, 1)\}. The in-degree and out-degree of every vertex in this graph are both 1.





Sample Input 24 5
1 2
2 3
2 4
1 4
4 3





Sample Output 2-1

There is no induced subgraph of G that satisfies the condition.





Sample Input 36 9
1 2
2 3
3 4
4 5
5 6
5 1
5 2
6 1
6 2





Sample Output 34
2
3
4
5


",Pure,"Graph Theory, Graph Traversal",0.333,36,12
691,"
Score : 500 points


Problem StatementSnuke is conducting an optical experiment using mirrors and his new invention, the rifle of Mysterious Light.
Three mirrors of length N are set so that they form an equilateral triangle.
Let the vertices of the triangle be a, b and c.
Inside the triangle, the rifle is placed at the point p on segment ab such that ap = X.
(The size of the rifle is negligible.)
Now, the rifle is about to fire a ray of Mysterious Light in the direction of bc.
The ray of Mysterious Light will travel in a straight line, and will be reflected by mirrors, in the same ways as ""ordinary"" light.
There is one major difference, though: it will be also reflected by its own trajectory as if it is a mirror!
When the ray comes back to the rifle, the ray will be absorbed.
The following image shows the ray's trajectory where N = 5 and X = 2.



It can be shown that the ray eventually comes back to the rifle and is absorbed, regardless of the values of N and X.
Find the total length of the ray's trajectory.




Constraints
2≦N≦10^{12}
1≦X≦N-1
N and X are integers.





Partial Points
300 points will be awarded for passing the test set satisfying N≦1000.
Another 200 points will be awarded for passing the test set without additional constraints.







InputThe input is given from Standard Input in the following format:
N X





OutputPrint the total length of the ray's trajectory.






Sample Input 15 2





Sample Output 112

Refer to the image in the Problem Statement section.
The total length of the trajectory is 2+3+2+2+1+1+1 = 12.

",Mysterious Light,"Euclidean Algorithm, Bruteforcing, Mathematics, Arithmetic, Prefix sum",0.262,106,24
692,"
Score : 300 points


Problem StatementYou are given an array A of length N.
Your task is to divide it into several contiguous subarrays.
Here, all subarrays obtained must be sorted in either non-decreasing or non-increasing order.
At least how many subarrays do you need to divide A into?




Constraints
1 \leq N \leq 10^5
1 \leq A_i \leq 10^9
Each A_i is an integer.







InputInput is given from Standard Input in the following format:
N
A_1 A_2 ... A_N





OutputPrint the minimum possible number of subarrays after division of A.






Sample Input 16
1 2 3 2 2 1





Sample Output 12

One optimal solution is to divide the array into [1,2,3] and [2,2,1].





Sample Input 29
1 2 1 2 1 2 1 2 1





Sample Output 25






Sample Input 37
1 2 3 2 1 999999999 1000000000





Sample Output 33


",Sorted Arrays,"Greedy Algorithm, Array, Dynamic Programming, Boolean Operations On Geometric Objects",0.559,131,59
693,"
Score : 300 points


Problem StatementThere are N integers written on a blackboard. The i-th integer is A_i.
Takahashi will repeatedly perform the following operation on these numbers:

Select a pair of integers, A_i and A_j, that have the same parity (that is, both are even or both are odd) and erase them.
Then, write a new integer on the blackboard that is equal to the sum of those integers, A_i+A_j.

Determine whether it is possible to have only one integer on the blackboard.




Constraints
2 ≦ N ≦ 10^5
1 ≦ A_i ≦ 10^9
A_i is an integer.







InputThe input is given from Standard Input in the following format:
N
A_1 A_2 … A_N





OutputIf it is possible to have only one integer on the blackboard, print YES. Otherwise, print NO.






Sample Input 13
1 2 3





Sample Output 1YES

It is possible to have only one integer on the blackboard, as follows:

Erase 1 and 3 from the blackboard, then write 4. Now, there are two integers on the blackboard: 2 and 4.
Erase 2 and 4 from the blackboard, then write 6. Now, there is only one integer on the blackboard: 6.






Sample Input 25
1 2 3 4 5





Sample Output 2NO


",Addition,"Parity, Counting, Arithmetic, Greedy Algorithm",0.79,84,65
694,"
Score : 400 points


Problem StatementYou are given a tree with N vertices.
Here, a tree is a kind of graph, and more specifically, a connected undirected graph with N-1 edges, where N is the number of its vertices.
The i-th edge (1≤i≤N-1) connects Vertices a_i and b_i, and has a length of c_i.
You are also given Q queries and an integer K. In the j-th query (1≤j≤Q):

find the length of the shortest path from Vertex x_j and Vertex y_j via Vertex K.





Constraints
3≤N≤10^5 
1≤a_i,b_i≤N (1≤i≤N-1) 
1≤c_i≤10^9 (1≤i≤N-1) 
The given graph is a tree.
1≤Q≤10^5 
1≤K≤N 
1≤x_j,y_j≤N (1≤j≤Q) 
x_j≠y_j (1≤j≤Q) 
x_j≠K,y_j≠K (1≤j≤Q) 







InputInput is given from Standard Input in the following format:  
N  
a_1 b_1 c_1  
:  
a_{N-1} b_{N-1} c_{N-1}
Q K
x_1 y_1
:  
x_{Q} y_{Q}





OutputPrint the responses to the queries in Q lines.
In the j-th line j(1≤j≤Q), print the response to the j-th query.






Sample Input 15
1 2 1
1 3 1
2 4 1
3 5 1
3 1
2 4
2 3
4 5





Sample Output 13
2
4

The shortest paths for the three queries are as follows:

Query 1: Vertex 2 → Vertex 1 → Vertex 2 → Vertex 4 : Length 1+1+1=3 
Query 2: Vertex 2 → Vertex 1 → Vertex 3 : Length 1+1=2 
Query 3: Vertex 4 → Vertex 2 → Vertex 1 → Vertex 3 → Vertex 5 : Length 1+1+1+1=4 






Sample Input 27
1 2 1
1 3 3
1 4 5
1 5 7
1 6 9
1 7 11
3 2
1 3
4 5
6 7





Sample Output 25
14
22

The path for each query must pass Vertex K=2.





Sample Input 310
1 2 1000000000
2 3 1000000000
3 4 1000000000
4 5 1000000000
5 6 1000000000
6 7 1000000000
7 8 1000000000
8 9 1000000000
9 10 1000000000
1 1
9 10





Sample Output 317000000000


",Transit Tree Path,"Graph Theory, Tree, Depth-first Search, Shortest Path, Offline Queries",0.561,90,39
695,"
Score : 100 points


Problem StatementIt is September 9 in Japan now.
You are given a two-digit integer N. Answer the question: Is 9 contained in the decimal notation of N?




Constraints
10≤N≤99







InputInput is given from Standard Input in the following format:
N





OutputIf 9 is contained in the decimal notation of N, print Yes; if not, print No.






Sample Input 129





Sample Output 1Yes

The one's digit of 29 is 9.





Sample Input 272





Sample Output 2No

72 does not contain 9.





Sample Input 391





Sample Output 3Yes


",September 9,"String, Arithmetic, Implementation",0.759,222,144
696,"
Score : 200 points


Problem StatementJoisino is working as a receptionist at a theater.
The theater has 100000 seats, numbered from 1 to 100000.
According to her memo, N groups of audiences have come so far, and the i-th group occupies the consecutive seats from Seat l_i to Seat r_i (inclusive).
How many people are sitting at the theater now?




Constraints
1≤N≤1000
1≤l_i≤r_i≤100000
No seat is occupied by more than one person.
All input values are integers.







InputInput is given from Standard Input in the following format:
N
l_1 r_1
:
l_N r_N





OutputPrint the number of people sitting at the theater.






Sample Input 11
24 30





Sample Output 17

There are 7 people, sitting at Seat 24,25,26,27,28,29 and 30.





Sample Input 22
6 8
3 3





Sample Output 24


",Theater,"Bruteforcing, Arithmetic, Prefix sum",0.91,172,154
697,"
Score : 900 points


Problem StatementLet us consider a grid of squares with N rows and N columns. You want to put some domino pieces on this grid.
Each domino piece covers two squares that have a common side. Each square can be covered by at most one piece.
For each row of the grid, let's define its quality as the number of domino pieces that cover at least one square in this row.
We define the quality of each column similarly.
Find a way to put at least one domino piece on the grid so that the quality of every row is equal to the quality of every column,
or determine that such a placement doesn't exist.




Constraints
2 \le N \le 1000







InputInput is given from Standard Input in the following format:
N





OutputIf the required domino placement doesn't exist, print a single integer -1.
Otherwise, output your placement as N strings of N characters each.
If a square is not covered, the corresponding character must be . (a dot).
Otherwise, it must contain a lowercase English letter.
Squares covered by the same domino piece must contain the same letter.
If two squares have a common side but belong to different pieces, they must contain different letters.






Sample Input 16





Sample Output 1aabb..
b..zz.
ba....
.a..aa
..a..b
..a..b

The quality of every row and every column is 2.





Sample Input 22





Sample Output 2-1


",Domino Quality,"Backtracking, Bruteforcing, Arithmetic, Dynamic Programming, Mathematics, Constructive, Array, 2-sat",0.273,29,5
698,"
Score : 500 points


Problem StatementTakahashi is not good at problems about trees in programming contests, and Aoki is helping him practice.
First, Takahashi created a tree with N vertices numbered 1 through N, and wrote 0 at each edge.
Then, Aoki gave him M queries. The i-th of them is as follows:

Increment the number written at each edge along the path connecting vertices a_i and b_i, by one.

After Takahashi executed all of the queries, he told Aoki that, for every edge, the written number became an even number.
However, Aoki forgot to confirm that the graph Takahashi created was actually a tree, and it is possible that Takahashi made a mistake in creating a tree or executing queries.
Determine whether there exists a tree that has the property mentioned by Takahashi.




Constraints
2 ≤ N ≤ 10^5
1 ≤ M ≤ 10^5
1 ≤ a_i,b_i ≤ N
a_i ≠ b_i







InputInput is given from Standard Input in the following format:
N M
a_1 b_1
:
a_M b_M





OutputPrint YES if there exists a tree that has the property mentioned by Takahashi; print NO otherwise.






Sample Input 14 4
1 2
2 4
1 3
3 4





Sample Output 1YES

For example, Takahashi's graph has the property mentioned by him if it has the following edges: 1-2, 1-3 and 1-4.
In this case, the number written at every edge will become 2.





Sample Input 25 5
1 2
3 5
5 1
3 4
2 3





Sample Output 2NO


",Unplanned Queries,"Tree, Parity, Counting, Implementation, Graph Theory",0.7,46,30
699,"
Score : 500 points


Problem StatementThere is an apple tree that bears apples of N colors. The N colors of these apples are numbered 1 to N, and there are a_i apples of Color i.
You and Lunlun the dachshund alternately perform the following operation (starting from you):

Choose one or more apples from the tree and eat them. Here, the apples chosen at the same time must all have different colors.

The one who eats the last apple from the tree will be declared winner. If both you and Lunlun play optimally, which will win?




Constraints
1 \leq N \leq 10^5
1 \leq a_i \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
a_1
a_2
:
a_N





OutputIf you will win, print first; if Lunlun will win, print second.






Sample Input 12
1
2





Sample Output 1first

Let Color 1 be red, and Color 2 be blue. In this case, the tree bears one red apple and two blue apples.
You should eat the red apple in your first turn. Lunlun is then forced to eat one of the blue apples, and you can win by eating the other in your next turn.
Note that you are also allowed to eat two apples in your first turn, one red and one blue (not a winning move, though).





Sample Input 23
100000
30000
20000





Sample Output 2second


",Harlequin,"Parity, Bruteforcing, Boolean Operations On Geometric Objects",0.812,25,16
700,"
Score : 400 points


Problem StatementWe have a board with a 2 \times N grid.
Snuke covered the board with N dominoes without overlaps.
Here, a domino can cover a 1 \times 2 or 2 \times 1 square.
Then, Snuke decided to paint these dominoes using three colors: red, cyan and green.
Two dominoes that are adjacent by side should be painted by different colors.
Here, it is not always necessary to use all three colors.
Find the number of such ways to paint the dominoes, modulo 1000000007.
The arrangement of the dominoes is given to you as two strings S_1 and S_2 in the following manner:

Each domino is represented by a different English letter (lowercase or uppercase).
The j-th character in S_i represents the domino that occupies the square at the i-th row from the top and j-th column from the left.





Constraints
1 \leq N \leq 52
|S_1| = |S_2| = N
S_1 and S_2 consist of lowercase and uppercase English letters.
S_1 and S_2 represent a valid arrangement of dominoes.







InputInput is given from Standard Input in the following format:
N
S_1
S_2





OutputPrint the number of such ways to paint the dominoes, modulo 1000000007.






Sample Input 13
aab
ccb





Sample Output 16

There are six ways as shown below:






Sample Input 21
Z
Z





Sample Output 23

Note that it is not always necessary to use all the colors.





Sample Input 352
RvvttdWIyyPPQFFZZssffEEkkaSSDKqcibbeYrhAljCCGGJppHHn
RLLwwdWIxxNNQUUXXVVMMooBBaggDKqcimmeYrhAljOOTTJuuzzn





Sample Output 3958681902


",Coloring Dominoes,"String, Bruteforcing, Combinatorics, Arithmetic, Dyanmic Programming",0.69,42,29
701,"
Score : 400 points


Problem StatementSnuke has a large collection of cards. Each card has an integer between 1 and N, inclusive, written on it.
He has A_i cards with an integer i.
Two cards can form a pair if the absolute value of the difference of the integers written on them is at most 1.
Snuke wants to create the maximum number of pairs from his cards, on the condition that no card should be used in multiple pairs. Find the maximum number of pairs that he can create.




Constraints
1 ≦ N ≦ 10^5
0 ≦ A_i ≦ 10^9 (1 ≦ i ≦ N)
All input values are integers.







InputThe input is given from Standard Input in the following format:
N
A_1
:
A_N





OutputPrint the maximum number of pairs that Snuke can create.






Sample Input 14
4
0
3
2





Sample Output 14

For example, Snuke can create the following four pairs: (1,1),(1,1),(3,4),(3,4).





Sample Input 28
2
0
1
6
0
8
2
1





Sample Output 29


",Simplified mahjong,"Greedy Algorithm, Arithmetic, Bruteforcing, Array",0.175,181,47
702,"
Score : 200 points


Problem StatementYou are given a image with a height of H pixels and a width of W pixels.
Each pixel is represented by a lowercase English letter.
The pixel at the i-th row from the top and j-th column from the left is a_{ij}.
Put a box around this image and output the result. The box should consist of # and have a thickness of 1.




Constraints
1 ≤ H, W ≤ 100
a_{ij} is a lowercase English letter.







InputInput is given from Standard Input in the following format:
H W
a_{11} ... a_{1W}
:
a_{H1} ... a_{HW}





OutputPrint the image surrounded by a box that consists of # and has a thickness of 1.






Sample Input 12 3
abc
arc





Sample Output 1#####
#abc#
#arc#
#####






Sample Input 21 1
z





Sample Output 2###
#z#
###


",Picture Frame,"Bruteforcing, String, Array",0.773,218,144
703,"
Score : 100 points


Problem StatementRingo is giving a present to Snuke.
Ringo has found out that Snuke loves yakiniku (a Japanese term meaning grilled meat. yaki: grilled, niku: meat). He supposes that Snuke likes grilled things starting with YAKI in Japanese, and does not like other things.
You are given a string S representing the Japanese name of Ringo's present to Snuke. Determine whether S starts with YAKI.




Constraints
1 \leq |S| \leq 10
S consists of uppercase English letters.







InputInput is given from Standard Input in the following format:
S





OutputIf S starts with YAKI, print Yes; otherwise, print No.






Sample Input 1YAKINIKU





Sample Output 1Yes

YAKINIKU starts with YAKI.





Sample Input 2TAKOYAKI





Sample Output 2No

TAKOYAKI (a Japanese snack. tako: octopus) does not start with YAKI.





Sample Input 3YAK





Sample Output 3No


",Snuke's favorite YAKINIKU,"String, Implementation",0.667,104,60
704,"
Score : 400 points


Problem StatementYou are given N integers; the i-th of them is A_i.
Find the maximum possible sum of the absolute differences between the adjacent elements after arranging these integers in a row in any order you like.




Constraints
2 \leq N \leq 10^5
1 \leq A_i \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
A_1
:
A_N





OutputPrint the maximum possible sum of the absolute differences between the adjacent elements after arranging the given integers in a row in any order you like.






Sample Input 15
6
8
1
2
3





Sample Output 121

When the integers are arranged as 3,8,1,6,2, the sum of the absolute differences between the adjacent elements is |3 - 8| + |8 - 1| + |1 - 6| + |6 - 2| = 21. This is the maximum possible sum.





Sample Input 26
3
1
4
1
5
9





Sample Output 225






Sample Input 33
5
5
1





Sample Output 38


",Align,"Sorting, Greedy Algorithm, Arithmetic, Parity",0.257,83,24
705,"
Score : 300 points


Problem StatementYou are given an integer N.
Find a triple of positive integers h, n and w such that 4/N = 1/h + 1/n + 1/w.
If there are multiple solutions, any of them will be accepted.




Constraints
It is guaranteed that, for the given integer N, there exists a solution such that h,n,w \leq 3500.







InputsInput is given from Standard Input in the following format:
N





OutputsPrint a triple of positive integers h, n and w that satisfies the condition, in the following format:
h n w







Sample Input 12





Sample Output 11 2 2

4/2 = 1/1 + 1/2 + 1/2.





Sample Input 23485





Sample Output 2872 1012974 1539173474040

It is allowed to use an integer exceeding 3500 in a solution.





Sample Input 34664





Sample Output 33498 3498 3498


",4/N,"Bruteforcing, Arithmetic, Mathematics, Backtracking",0.481,53,24
706,"
Score : 400 points


Problem StatementYou start with the number 0 and you want to reach the number N.
You can change the number, paying a certain amount of coins, with the following operations:

Multiply the number by 2, paying A coins.
Multiply the number by 3, paying B coins.
Multiply the number by 5, paying C coins.
Increase or decrease the number by 1, paying D coins.

You can perform these operations in arbitrary order and an arbitrary number of times.
What is the minimum number of coins you need to reach N?
You have to solve T testcases.




Constraints
1 \le T \le 10
1 \le N \le 10^{18}
1 \le A, B, C, D \le 10^9
All numbers N, A, B, C, D are integers.







InputThe input is given from Standard Input. The first line of the input is
T

Then, T lines follow describing the T testcases.
Each of the T lines has the format
N A B C D





OutputFor each testcase, print the answer on Standard Output followed by a newline.






Sample Input 15
11 1 2 4 8
11 1 2 2 8
32 10 8 5 4
29384293847243 454353412 332423423 934923490 1
900000000000000000 332423423 454353412 934923490 987654321





Sample Output 120
19
26
3821859835
23441258666

For the first testcase, a sequence of moves that achieves the minimum cost of 20 is:

Initially x = 0.
Pay 8 to increase by 1 (x = 1).
Pay 1 to multiply by 2 (x = 2).
Pay 1 to multiply by 2 (x = 4).
Pay 2 to multiply by 3 (x = 12).
Pay 8 to decrease by 1 (x = 11).

For the second testcase, a sequence of moves that achieves the minimum cost of 19 is:

Initially x = 0.
Pay 8 to increase by 1 (x = 1).
Pay 1 to multiply by 2 (x = 2).
Pay 2 to multiply by 5 (x = 10).
Pay 8 to increase by 1 (x = 11).


",Pay to Win,"Memoization, Arithmetic, Recursion, Graph Traversal",0.324,82,20
707,"
Score: 500 points


Problem Statement
Does there exist an undirected graph with N vertices satisfying the following conditions?

The graph is simple and connected.
The vertices are numbered 1, 2, ..., N.
Let M be the number of edges in the graph. The edges are numbered 1, 2, ..., M, the length of each edge is 1, and Edge i connects Vertex u_i and Vertex v_i.
There are exactly K pairs of vertices (i,\ j)\ (i < j) such that the shortest distance between them is 2.

If there exists such a graph, construct an example.




Constraints
All values in input are integers.
2 \leq N \leq 100
0 \leq K \leq \frac{N(N - 1)}{2}







Input
Input is given from Standard Input in the following format:
N K





OutputIf there does not exist an undirected graph with N vertices satisfying the conditions, print -1.
If there exists such a graph, print an example in the following format (refer to Problem Statement for what the symbols stand for):
M
u_1 v_1
:
u_M v_M

If there exist multiple graphs satisfying the conditions, any of them will be accepted.






Sample Input 15 3





Sample Output 15
4 3
1 2
3 1
4 5
2 3

This graph has three pairs of vertices such that the shortest distance between them is 2: (1,\ 4), (2,\ 4), and (3,\ 5). Thus, the condition is satisfied.





Sample Input 25 8





Sample Output 2-1

There is no graph satisfying the conditions.

",Friendships,"Graph Theory, Combinatorics, Greedy Algorithm, Bruteforcing, Mathematics",0.28,71,23
708,"
Score : 400 points


Problem StatementThere are N squares arranged in a row, numbered 1, 2, ..., N from left to right.
You are given a string S of length N consisting of . and #. If the i-th character of S is #, Square i contains a rock; if the i-th character of S is ., Square i is empty.
In the beginning, Snuke stands on Square A, and Fnuke stands on Square B.
You can repeat the following operation any number of times:

Choose Snuke or Fnuke, and make him jump one or two squares to the right. The destination must be one of the squares, and it must not contain a rock or the other person.

You want to repeat this operation so that Snuke will stand on Square C and Fnuke will stand on Square D.
Determine whether this is possible.




Constraints
4 \leq N \leq 200\ 000
S is a string of length N consisting of . and #.
1 \leq A, B, C, D \leq N
Square A, B, C and D do not contain a rock.
A, B, C and D are all different.
A < B
A < C
B < D







InputInput is given from Standard Input in the following format:
N A B C D
S





OutputPrint Yes if the objective is achievable, and No if it is not.






Sample Input 17 1 3 6 7
.#..#..





Sample Output 1Yes

The objective is achievable by, for example, moving the two persons as follows. (A and B represent Snuke and Fnuke, respectively.)
A#B.#..

A#.B#..

.#AB#..

.#A.#B.

.#.A#B.

.#.A#.B

.#..#AB






Sample Input 27 1 3 7 6
.#..#..





Sample Output 2No






Sample Input 315 1 3 15 13
...#.#...#.#...





Sample Output 3Yes


",Kenken Race,"String, Sliding Window, Boolean Operations On Geometric Objects, Greedy Algorithm",0.191,292,51
709,"
Score : 700 points


Problem StatementYou are given a simple connected undirected graph with N vertices and M edges. The vertices are numbered 1 to N, and the i-th edge connects Vertex A_i and Vertex B_i.
Takahashi will assign one of the two possible directions to each of the edges in the graph to make a directed graph.
Determine if it is possible to make a directed graph with an even number of edges going out from every vertex. If the answer is yes, construct one such graph.




NotesAn undirected graph is said to be simple when it contains no self-loops or multiple edges.




Constraints
2 \leq N \leq 10^5
N-1 \leq M \leq 10^5
1 \leq A_i,B_i \leq N (1\leq i\leq M)
The given graph is simple and connected.







InputInput is given from Standard Input in the following format:
N M
A_1 B_1
:
A_M B_M





OutputIf it is impossible to assign directions to satisfy the requirement, print -1.
Otherwise, print an assignment of directions that satisfies the requirement, in the following format:
C_1 D_1
:
C_M D_M

Here each pair (C_i, D_i) means that there is an edge directed from Vertex C_i to Vertex D_i. The edges may be printed in any order.






Sample Input 14 4
1 2
2 3
3 4
4 1





Sample Output 11 2
1 4
3 2
3 4

After this assignment of directions, Vertex 1 and 3 will each have two outgoing edges, and Vertex 2 and 4 will each have zero outgoing edges.





Sample Input 25 5
1 2
2 3
3 4
2 5
4 5





Sample Output 2-1


",Even Degrees,"Graph Theory, Disjoint Set, Minimum Spanning Tree, Depth-first Search, Parity, Backtracking",0.35,56,9
710,"
Score : 700 points


Problem StatementYou are given an integer N. Determine if there exists a tree with 2N vertices numbered 1 to 2N satisfying the following condition, and show one such tree if the answer is yes.

Assume that, for each integer i between 1 and N (inclusive), Vertex i and N+i have the weight i. Then, for each integer i between 1 and N, the bitwise XOR of the weights of the vertices on the path between Vertex i and N+i (including themselves) is i.





Constraints
N is an integer.
1 \leq N \leq 10^{5}







InputInput is given from Standard Input in the following format:
N





OutputIf there exists a tree satisfying the condition in the statement, print Yes; otherwise, print No.
Then, if such a tree exists, print the 2N-1 edges of such a tree in the subsequent 2N-1 lines, in the following format:
a_{1} b_{1}
\vdots
a_{2N-1} b_{2N-1}

Here each pair (a_i, b_i) means that there is an edge connecting Vertex a_i and b_i. The edges may be printed in any order.






Sample Input 13





Sample Output 1Yes
1 2
2 3
3 4
4 5
5 6


The sample output represents the following graph:









Sample Input 21





Sample Output 2No


There is no tree satisfying the condition.


",Skolem XOR Tree,"Bit Set, Tree, Divide And Conquer, Disjoint Set, Array, Graph Theory",0.0,14,4
711,"
Score : 200 points


Problem StatementEvi has N integers a_1,a_2,..,a_N. His objective is to have N equal integers by transforming some of them.
He may transform each integer at most once. Transforming an integer x into another integer y costs him (x-y)^2 dollars. Even if a_i=a_j (i≠j), he has to pay the cost separately for transforming each of them (See Sample 2).
Find the minimum total cost to achieve his objective.




Constraints
1≦N≦100
-100≦a_i≦100







InputThe input is given from Standard Input in the following format:
N
a_1 a_2 ... a_N





OutputPrint the minimum total cost to achieve Evi's objective.






Sample Input 12
4 8





Sample Output 18

Transforming the both into 6s will cost (4-6)^2+(8-6)^2=8 dollars, which is the minimum.





Sample Input 23
1 1 3





Sample Output 23

Transforming the all into 2s will cost (1-2)^2+(1-2)^2+(3-2)^2=3 dollars. Note that Evi has to pay (1-2)^2 dollar separately for transforming each of the two 1s.





Sample Input 33
4 2 5





Sample Output 35

Leaving the 4 as it is and transforming the 2 and the 5 into 4s will achieve the total cost of (2-4)^2+(5-4)^2=5 dollars, which is the minimum.





Sample Input 44
-100 -100 -100 -100





Sample Output 40

Without transforming anything, Evi's objective is already achieved. Thus, the necessary cost is 0.

",Be Together,"Bruteforcing, Mathematics, Segment Tree",0.648,206,114
712,"
Score : 400 points


Problem StatementGiven a string t, we will call it unbalanced if and only if the length of t is at least 2, and more than half of the letters in t are the same. For example, both voodoo and melee are unbalanced, while neither noon nor a is.
You are given a string s consisting of lowercase letters. Determine if there exists a (contiguous) substring of s that is unbalanced. If the answer is positive, show a position where such a substring occurs in s.




Constraints
2 ≦ |s| ≦ 10^5
s consists of lowercase letters.





Partial Score
200 points will be awarded for passing the test set satisfying 2 ≦ N ≦ 100.







InputThe input is given from Standard Input in the following format:
s





OutputIf there exists no unbalanced substring of s, print -1 -1.
If there exists an unbalanced substring of s, let one such substring be s_a s_{a+1} ... s_{b} (1 ≦ a < b ≦ |s|), and print a b. If there exists more than one such substring, any of them will be accepted.






Sample Input 1needed





Sample Output 12 5

The string s_2 s_3 s_4 s_5 = eede is unbalanced. There are also other unbalanced substrings. For example, the output 2 6 will also be accepted.





Sample Input 2atcoder





Sample Output 2-1 -1

The string atcoder contains no unbalanced substring.

",Unbalanced,"Sliding Window, String, Greedy Algorithm, Bruteforcing",0.227,171,53
713,"
Score: 600 points


Problem Statement
Takahashi and Aoki are training for long-distance races in an infinitely long straight course running from west to east.
They start simultaneously at the same point and moves as follows towards the east:

Takahashi runs A_1 meters per minute for the first T_1 minutes,  then runs at A_2 meters per minute for the subsequent T_2 minutes, and alternates between these two modes forever.
Aoki runs B_1 meters per minute for the first T_1 minutes,  then runs at B_2 meters per minute for the subsequent T_2 minutes, and alternates between these two modes forever.

How many times will Takahashi and Aoki meet each other, that is, come to the same point? We do not count the start of the run. If they meet infinitely many times, report that fact.




Constraints

1 \leq T_i \leq 100000
1 \leq A_i \leq 10^{10}
1 \leq B_i \leq 10^{10}
A_1 \neq B_1
A_2 \neq B_2
All values in input are integers.







Input
Input is given from Standard Input in the following format:
T_1 T_2
A_1 A_2
B_1 B_2





Output
Print the number of times Takahashi and Aoki will meet each other.
If they meet infinitely many times, print infinity instead.  






Sample Input 11 2
10 10
12 4





Sample Output 11

They will meet just once, \frac{4}{3} minutes after they start, at \frac{40}{3} meters from where they start.





Sample Input 2100 1
101 101
102 1





Sample Output 2infinity

They will meet 101, 202, 303, 404, 505, 606, ... minutes after they start, that is, they will meet infinitely many times.





Sample Input 312000 15700
3390000000 3810000000
5550000000 2130000000





Sample Output 3113

The values in input may not fit into a 32-bit integer type.

",Interval Running,"Mathematics, Arithmetic, Boolean Operations On Geometric Objects, Binary Search",0.381,43,15
714,"
Score : 600 points


Problem Statement
There are N slimes standing on a number line.
The i-th slime from the left is at position x_i.
It is guaruanteed that 1 \leq x_1 < x_2 < \ldots < x_N \leq 10^{9}.
Niwango will perform N-1 operations. The i-th operation consists of the following procedures:

Choose an integer k between 1 and N-i (inclusive) with equal probability.
Move the k-th slime from the left, to the position of the neighboring slime to the right.
Fuse the two slimes at the same position into one slime.

Find the total distance traveled by the slimes multiplied by (N-1)! (we can show that this value is an integer), modulo (10^{9}+7). If a slime is born by a fuse and that slime moves, we count it as just one slime.




Constraints

2 \leq N \leq 10^{5}
1 \leq x_1 < x_2 < \ldots < x_N \leq 10^{9}
x_i is an integer.





Subtasks

400 points will be awarded for passing the test cases satisfying N \leq 2000.







Input
Input is given from Standard Input in the following format:
N
x_1 x_2 \ldots x_N





Output
Print the answer.






Sample Input 13
1 2 3





Sample Output 15


With probability \frac{1}{2}, the leftmost slime is chosen in the first operation, in which case the total distance traveled is 2.
With probability \frac{1}{2}, the middle slime is chosen in the first operation, in which case the total distance traveled is 3.
The answer is the expected total distance traveled, 2.5, multiplied by 2!, which is 5.






Sample Input 212
161735902 211047202 430302156 450968417 628894325 707723857 731963982 822804784 880895728 923078537 971407775 982631932





Sample Output 2750927044


Find the expected value multiplied by (N-1)!, modulo (10^9+7).


",Fusing Slimes,"Arithmetic, Mathematics, Probability Theory, Prefix sum, Bruteforcing, Number Theory",0.214,30,6
715,"
Score : 100 points


Problem StatementLet N be a positive integer.
You are given a string s of length N - 1, consisting of < and >.
Find the number of permutations (p_1, p_2, \ldots, p_N) of (1, 2, \ldots, N) that satisfy the following condition, modulo 10^9 + 7:

For each i (1 \leq i \leq N - 1), p_i < p_{i + 1} if the i-th character in s is <, and p_i > p_{i + 1} if the i-th character in s is >.





Constraints
N is an integer.
2 \leq N \leq 3000
s is a string of length N - 1.
s consists of < and >.







InputInput is given from Standard Input in the following format:
N
s





OutputPrint the number of permutations that satisfy the condition, modulo 10^9 + 7.






Sample Input 14
<><





Sample Output 15

There are five permutations that satisfy the condition, as follows:

(1, 3, 2, 4)
(1, 4, 2, 3)
(2, 3, 1, 4)
(2, 4, 1, 3)
(3, 4, 1, 2)






Sample Input 25
<<<<





Sample Output 21

There is one permutation that satisfies the condition, as follows:

(1, 2, 3, 4, 5)






Sample Input 320
>>>><>>><>><>>><<>>





Sample Output 3217136290

Be sure to print the number modulo 10^9 + 7.

",Permutation,"Dyanmic Programming, Prefix sum, Combinatorics, Arithmetic",0.645,42,29
716,"
Score : 100 points


Problem StatementThere is a tree with N vertices, numbered 1, 2, \ldots, N.
For each i (1 \leq i \leq N - 1), the i-th edge connects Vertex x_i and y_i.
Taro has decided to paint each vertex in white or black.
Here, it is not allowed to paint two adjacent vertices both in black.
Find the number of ways in which the vertices can be painted, modulo 10^9 + 7.




Constraints
All values in input are integers.
1 \leq N \leq 10^5
1 \leq x_i, y_i \leq N
The given graph is a tree.







InputInput is given from Standard Input in the following format:
N
x_1 y_1
x_2 y_2
:
x_{N - 1} y_{N - 1}





OutputPrint the number of ways in which the vertices can be painted, modulo 10^9 + 7.






Sample Input 13
1 2
2 3





Sample Output 15

There are five ways to paint the vertices, as follows:






Sample Input 24
1 2
1 3
1 4





Sample Output 29

There are nine ways to paint the vertices, as follows:






Sample Input 31





Sample Output 32






Sample Input 410
8 5
10 8
6 5
1 5
4 8
2 10
3 6
9 2
1 7





Sample Output 4157


",Independent Set,"Graph Theory, Depth-first Search, Dynamic Programming On Trees, Mathematics, Arithmetic",0.522,155,72
717,"
Score : 600 points


Problem StatementThe squirrel Chokudai has N acorns.
One day, he decides to do some trades in multiple precious metal exchanges to make more acorns.
His plan is as follows:

Get out of the nest with N acorns in his hands.
Go to Exchange A and do some trades.
Go to Exchange B and do some trades.
Go to Exchange A and do some trades.
Go back to the nest.

In Exchange X (X = A, B), he can perform the following operations any integer number of times (possibly zero) in any order:

Lose g_{X} acorns and gain 1 gram of gold.
Gain g_{X} acorns and lose 1 gram of gold.
Lose s_{X} acorns and gain 1 gram of silver.
Gain s_{X} acorns and lose 1 gram of silver.
Lose b_{X} acorns and gain 1 gram of bronze.
Gain b_{X} acorns and lose 1 gram of bronze.

Naturally, he cannot perform an operation that would leave him with a negative amount of acorns, gold, silver, or bronze.
What is the maximum number of acorns that he can bring to the nest?
Note that gold, silver, or bronze brought to the nest would be worthless because he is just a squirrel.




Constraints
1 \leq N \leq 5000
1 \leq g_{X} \leq 5000
1 \leq s_{X} \leq 5000
1 \leq b_{X} \leq 5000
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
g_A s_A b_A
g_B s_B b_B





OutputPrint the maximum number of acorns that Chokudai can bring to the nest.






Sample Input 123
1 1 1
2 1 1





Sample Output 146

He can bring 46 acorns to the nest, as follows:

In Exchange A, trade 23 acorns for 23 grams of gold. {acorns, gold, silver, bronze}={ 0,23,0,0 }
In Exchange B, trade 23 grams of gold for 46 acorns. {acorns, gold, silver, bronze}={ 46,0,0,0 }
In Exchange A, trade nothing. {acorns, gold, silver, bronze}={ 46,0,0,0 }

He cannot have 47 or more acorns, so the answer is 46.

",Squirrel Merchant,"Knapsack, Mathematics, Graph Traversal, Greedy Algorithm",0.167,24,5
718,"
Score : 700 points


Problem StatementToday, Snuke will eat B pieces of black chocolate and W pieces of white chocolate for an afternoon snack.
He will repeat the following procedure until there is no piece left:

Choose black or white with equal probability, and eat a piece of that color if it exists.

For each integer i from 1 to B+W (inclusive), find the probability that the color of the i-th piece to be eaten is black.
It can be shown that these probabilities are rational, and we ask you to print them modulo 10^9 + 7, as described in Notes.




NotesWhen you print a rational number, first write it as a fraction \frac{y}{x}, where x, y are integers and x is not divisible by 10^9 + 7
(under the constraints of the problem, such representation is always possible).
Then, you need to print the only integer z between 0 and 10^9 + 6, inclusive, that satisfies xz \equiv y \pmod{10^9 + 7}.




Constraints
All values in input are integers.
1 \leq B,W \leq 10^{5}







InputInput is given from Standard Input in the following format:
B W





OutputPrint the answers in B+W lines. In the i-th line, print the probability that the color of the i-th piece to be eaten is black, modulo 10^{9}+7.






Sample Input 12 1





Sample Output 1500000004
750000006
750000006


There are three possible orders in which Snuke eats the pieces:
white, black, black
black, white, black
black, black, white


with probabilities \frac{1}{2}, \frac{1}{4}, \frac{1}{4}, respectively. Thus, the probabilities of eating a black piece first, second and third are \frac{1}{2},\frac{3}{4} and \frac{3}{4}, respectively.






Sample Input 23 2





Sample Output 2500000004
500000004
625000005
187500002
187500002


They are \frac{1}{2},\frac{1}{2},\frac{5}{8},\frac{11}{16} and \frac{11}{16}, respectively.






Sample Input 36 9





Sample Output 3500000004
500000004
500000004
500000004
500000004
500000004
929687507
218750002
224609377
303710940
633300786
694091802
172485353
411682132
411682132


",Black or White,"Combinatorics, Arithmetic, Precomputation, Prefix sum, Probability Theory",0.667,3,2
719,"
Score : 500 points


Problem StatementYou are given an integer N. Determine if there exists a tuple of subsets of \{1,2,...N\}, (S_1,S_2,...,S_k), that satisfies the following conditions:

Each of the integers 1,2,...,N is contained in exactly two of the sets S_1,S_2,...,S_k.
Any two of the sets S_1,S_2,...,S_k have exactly one element in common.

If such a tuple exists, construct one such tuple.




Constraints
1 \leq N \leq 10^5
N is an integer.







InputInput is given from Standard Input in the following format:
N





OutputIf a tuple of subsets of \{1,2,...N\} that satisfies the conditions does not exist, print No.
If such a tuple exists, print Yes first, then print such subsets in the following format:
k
|S_1| S_{1,1} S_{1,2} ... S_{1,|S_1|}
:
|S_k| S_{k,1} S_{k,2} ... S_{k,|S_k|}

where S_i={S_{i,1},S_{i,2},...,S_{i,|S_i|}}.
If there are multiple such tuples, any of them will be accepted.






Sample Input 13





Sample Output 1Yes
3
2 1 2
2 3 1
2 2 3

It can be seen that (S_1,S_2,S_3)=(\{1,2\},\{3,1\},\{2,3\}) satisfies the conditions.





Sample Input 24





Sample Output 2No


",Crossing,"Mathematics, Implementation, Bruteforcing, Constructive",0.417,28,11
720,"
Score : 400 points


Problem StatementSnuke lives in another world, where slimes are real creatures and kept by some people.
Slimes come in N colors. Those colors are conveniently numbered 1 through N.
Snuke currently has no slime. His objective is to have slimes of all the colors together.
Snuke can perform the following two actions:


Select a color i (1≤i≤N), such that he does not currently have a slime in color i, and catch a slime in color i. This action takes him a_i seconds.


Cast a spell, which changes the color of all the slimes that he currently has. The color of a slime in color i (1≤i≤N-1) will become color i+1, and the color of a slime in color N will become color 1. This action takes him x seconds.


Find the minimum time that Snuke needs to have slimes in all N colors.




Constraints
2≤N≤2,000
a_i are integers.
1≤a_i≤10^9
x is an integer.
1≤x≤10^9







InputThe input is given from Standard Input in the following format:
N x
a_1 a_2 ... a_N





OutputFind the minimum time that Snuke needs to have slimes in all N colors.






Sample Input 12 10
1 100





Sample Output 112

Snuke can act as follows:

Catch a slime in color 1. This takes 1 second.
Cast the spell. The color of the slime changes: 1 → 2. This takes 10 seconds.
Catch a slime in color 1. This takes 1 second.






Sample Input 23 10
100 1 100





Sample Output 223

Snuke can act as follows:

Catch a slime in color 2. This takes 1 second.
Cast the spell. The color of the slime changes: 2 → 3. This takes 10 seconds.
Catch a slime in color 2. This takes 1 second.
Cast the soell. The color of each slime changes: 3 → 1, 2 → 3. This takes 10 seconds.
Catch a slime in color 2. This takes 1 second.






Sample Input 34 10
1 2 3 4





Sample Output 310

Snuke can act as follows:

Catch a slime in color 1. This takes 1 second.
Catch a slime in color 2. This takes 2 seconds.
Catch a slime in color 3. This takes 3 seconds.
Catch a slime in color 4. This takes 4 seconds.


",Colorful Slimes,"Arithmetic, Bruteforcing, Data Structure, Array, Greedy Algorithm",0.237,95,20
721,"
Score : 500 points


Problem StatementRng has a connected undirected graph with N vertices.
Currently, there are M edges in the graph, and the i-th edge connects Vertices A_i and B_i.
Rng will add new edges to the graph by repeating the following operation:

Operation: Choose u and v (u \neq v) such that Vertex v can be reached by traversing exactly three edges from Vertex u, and add an edge connecting Vertices u and v. It is not allowed to add an edge if there is already an edge connecting Vertices u and v.

Find the maximum possible number of edges that can be added.




Constraints
2 \leq N \leq 10^5
1 \leq M \leq 10^5
1 \leq A_i,B_i \leq N
The graph has no self-loops or multiple edges.
The graph is connected.







InputInput is given from Standard Input in the following format:
N M
A_1 B_1
A_2 B_2
:
A_M B_M





OutputFind the maximum possible number of edges that can be added.






Sample Input 16 5
1 2
2 3
3 4
4 5
5 6





Sample Output 14

If we add edges as shown below, four edges can be added, and no more.






Sample Input 25 5
1 2
2 3
3 1
5 4
5 1





Sample Output 25

Five edges can be added, for example, as follows:

Add an edge connecting Vertex 5 and Vertex 3.
Add an edge connecting Vertex 5 and Vertex 2.
Add an edge connecting Vertex 4 and Vertex 1.
Add an edge connecting Vertex 4 and Vertex 2.
Add an edge connecting Vertex 4 and Vertex 3.


",3 Steps,"Graph Theory, Depth-first Search, Bipartite Graph, Combinatorics",0.333,45,12
722,"
Score : 800 points


Problem StatementThere is a pond with a rectangular shape.
The pond is divided into a grid with H rows and W columns of squares.
We will denote the square at the i-th row from the top and j-th column from the left by (i,\ j).
Some of the squares in the pond contains a lotus leaf floating on the water.
On one of those leaves, S, there is a frog trying to get to another leaf T.
The state of square (i,\ j) is given to you by a character a_{ij}, as follows:

. : A square without a leaf.
o : A square with a leaf floating on the water.
S : A square with the leaf S.
T : A square with the leaf T.

The frog will repeatedly perform the following action to get to the leaf T: ""jump to a leaf that is in the same row or the same column as the leaf where the frog is currently located.""
Snuke is trying to remove some of the leaves, other than S and T, so that the frog cannot get to the leaf T.
Determine whether this objective is achievable. If it is achievable, find the minimum necessary number of leaves to remove.




Constraints
2 ≤ H, W ≤ 100
a_{ij} is ., o, S or T.
There is exactly one S among a_{ij}.
There is exactly one T among a_{ij}.







InputInput is given from Standard Input in the following format:
H W
a_{11} ... a_{1W}
:
a_{H1} ... a_{HW}





OutputIf the objective is achievable, print the minimum necessary number of leaves to remove.
Otherwise, print -1 instead.






Sample Input 13 3
S.o
.o.
o.T





Sample Output 12

Remove the upper-right and lower-left leaves.





Sample Input 23 4
S...
.oo.
...T





Sample Output 20






Sample Input 34 3
.S.
.o.
.o.
.T.





Sample Output 3-1






Sample Input 410 10
.o...o..o.
....o.....
....oo.oo.
..oooo..o.
....oo....
..o..o....
o..o....So
o....T....
....o.....
........oo





Sample Output 45


",Lotus Leaves,"Graph Theory, Maximum Flow, Grid Graph",0.333,18,4
723,"
Score : 700 points


Problem StatementN hotels are located on a straight line. The coordinate of the i-th hotel (1 \leq i \leq N) is x_i.
Tak the traveler has the following two personal principles:

He never travels a distance of more than L in a single day.
He never sleeps in the open. That is, he must stay at a hotel at the end of a day.

You are given Q queries. The j-th (1 \leq j \leq Q) query is described by two distinct integers a_j and b_j.
For each query, find the minimum number of days that Tak needs to travel from the a_j-th hotel to the b_j-th hotel following his principles.
It is guaranteed that he can always travel from the a_j-th hotel to the b_j-th hotel, in any given input.




Constraints
2 \leq N \leq 10^5
1 \leq L \leq 10^9
1 \leq Q \leq 10^5
1 \leq x_i < x_2 < ... < x_N \leq 10^9
x_{i+1} - x_i \leq L
1 \leq a_j,b_j \leq N
a_j \neq b_j
N,\,L,\,Q,\,x_i,\,a_j,\,b_j are integers.





Partial Score
200 points will be awarded for passing the test set satisfying N \leq 10^3 and Q \leq 10^3.







InputThe input is given from Standard Input in the following format:
N
x_1 x_2 ... x_N
L
Q
a_1 b_1
a_2 b_2
:
a_Q b_Q





OutputPrint Q lines.
The j-th line (1 \leq j \leq Q) should contain the minimum number of days that Tak needs to travel from the a_j-th hotel to the b_j-th hotel.






Sample Input 19
1 3 6 13 15 18 19 29 31
10
4
1 8
7 3
6 7
8 5





Sample Output 14
2
1
2

For the 1-st query, he can travel from the 1-st hotel to the 8-th hotel in 4 days, as follows:

Day 1: Travel from the 1-st hotel to the 2-nd hotel. The distance traveled is 2.
Day 2: Travel from the 2-nd hotel to the 4-th hotel. The distance traveled is 10.
Day 3: Travel from the 4-th hotel to the 7-th hotel. The distance traveled is 6.
Day 4: Travel from the 7-th hotel to the 8-th hotel. The distance traveled is 10.


",Tak and Hotels,"Binary Search, Tree, Greedy Algorithm, Data Structure",0.278,76,14
724,"
Score : 600 points


Problem Statement
We have a tree with N vertices numbered 1 to N. The i-th edge in this tree connects Vertex a_i and b_i.
For each k=1, ..., N, solve the problem below:

Consider writing a number on each vertex in the tree in the following manner:
First, write 1 on Vertex k.
Then, for each of the numbers 2, ..., N in this order, write the number on the vertex chosen as follows:
Choose a vertex that still does not have a number written on it and is adjacent to a vertex with a number already written on it. If there are multiple such vertices, choose one of them at random.




Find the number of ways in which we can write the numbers on the vertices, modulo (10^9+7).





Constraints

2 \leq N \leq 2 \times 10^5
1 \leq a_i,b_i \leq N
The given graph is a tree.







Input
Input is given from Standard Input in the following format:
N
a_1 b_1
:
a_{N-1} b_{N-1}





Output
For each k=1, 2, ..., N in this order, print a line containing the answer to the problem.






Sample Input 13
1 2
1 3





Sample Output 12
1
1

The graph in this input is as follows:

For k=1, there are two ways in which we can write the numbers on the vertices, as follows:

Writing 1, 2, 3 on Vertex 1, 2, 3, respectively
Writing 1, 3, 2 on Vertex 1, 2, 3, respectively






Sample Input 22
1 2





Sample Output 21
1

The graph in this input is as follows:






Sample Input 35
1 2
2 3
3 4
3 5





Sample Output 32
8
12
3
3

The graph in this input is as follows:






Sample Input 48
1 2
2 3
3 4
3 5
3 6
6 7
6 8





Sample Output 440
280
840
120
120
504
72
72

The graph in this input is as follows:


",Distributing Integers,"Depth-first Search, Dynamic Programming On Trees, Tree, Combinatorics, Arithmetic, Modular Multiplicative Inverse",0.412,38,16
725,"
Score : 400 points


Problem StatementThere are K blue balls and N-K red balls. The balls of the same color cannot be distinguished. Snuke and Takahashi are playing with these balls.
First, Snuke will arrange the N balls in a row from left to right.
Then, Takahashi will collect only the K blue balls. In one move, he can collect any number of consecutive blue balls. He will collect all the blue balls in the fewest moves possible.
How many ways are there for Snuke to arrange the N balls in a row so that Takahashi will need exactly i moves to collect all the blue balls? Compute this number modulo 10^9+7 for each i such that 1 \leq i \leq K.




Constraints
1 \leq K \leq N \leq 2000







InputInput is given from Standard Input in the following format:
N K





OutputPrint K lines. The i-th line (1 \leq i \leq K) should contain the number of ways to arrange the N balls so that Takahashi will need exactly i moves to collect all the blue balls, modulo 10^9+7.






Sample Input 15 3





Sample Output 13
6
1

There are three ways to arrange the balls so that Takahashi will need exactly one move: (B, B, B, R, R), (R, B, B, B, R), and (R, R, B, B, B). (R and B stands for red and blue, respectively).
There are six ways to arrange the balls so that Takahashi will need exactly two moves: (B, B, R, B, R), (B, B, R, R, B), (R, B, B, R, B), (R, B, R, B, B), (B, R, B, B, R), and (B, R, R, B, B).
There is one way to arrange the balls so that Takahashi will need exactly three moves: (B, R, B, R, B).





Sample Input 22000 3





Sample Output 21998
3990006
327341989

Be sure to print the numbers of arrangements modulo 10^9+7.

",Blue and Red Balls,"Combinatorics, Arithmetic, Mathematics, Bruteforcing",0.25,188,49
726,"
Score : 500 points


Problem StatementKen loves ken-ken-pa (Japanese version of hopscotch). Today, he will play it on a directed graph G.
G consists of N vertices numbered 1 to N, and M edges. The i-th edge points from Vertex u_i to Vertex v_i.
First, Ken stands on Vertex S. He wants to reach Vertex T by repeating ken-ken-pa. In one ken-ken-pa, he does the following exactly three times: follow an edge pointing from the vertex on which he is standing.
Determine if he can reach Vertex T by repeating ken-ken-pa. If the answer is yes, find the minimum number of ken-ken-pa needed to reach Vertex T. Note that visiting Vertex T in the middle of a ken-ken-pa does not count as reaching Vertex T by repeating ken-ken-pa.




Constraints
2 \leq N \leq 10^5
0 \leq M \leq \min(10^5, N (N-1))
1 \leq u_i, v_i \leq N(1 \leq i \leq M)
u_i \neq v_i (1 \leq i \leq M)
If i \neq j, (u_i, v_i) \neq (u_j, v_j).
1 \leq S, T \leq N
S \neq T







InputInput is given from Standard Input in the following format:
N M
u_1 v_1
:
u_M v_M
S T





OutputIf Ken cannot reach Vertex T from Vertex S by repeating ken-ken-pa, print -1.
If he can, print the minimum number of ken-ken-pa needed to reach vertex T.






Sample Input 14 4
1 2
2 3
3 4
4 1
1 3





Sample Output 12

Ken can reach Vertex 3 from Vertex 1 in two ken-ken-pa, as follows: 1 \rightarrow 2 \rightarrow 3 \rightarrow 4 in the first ken-ken-pa, then 4 \rightarrow 1 \rightarrow 2 \rightarrow 3 in the second ken-ken-pa. This is the minimum number of ken-ken-pa needed.





Sample Input 23 3
1 2
2 3
3 1
1 2





Sample Output 2-1

Any number of ken-ken-pa will bring Ken back to Vertex 1, so he cannot reach Vertex 2, though he can pass through it in the middle of a ken-ken-pa.





Sample Input 32 0
1 2





Sample Output 3-1

Vertex S and Vertex T may be disconnected.





Sample Input 46 8
1 2
2 3
3 4
4 5
5 1
1 4
1 5
4 6
1 6





Sample Output 42


",Hopscotch Addict,"Graph Theory, Breadth-first Search, Arithmetic",0.448,69,23
727,"
Score : 100 points


Problem StatementIn programming, hexadecimal notation is often used.
In hexadecimal notation, besides the ten digits 0, 1, ..., 9, the six letters A, B, C, D, E and F are used to represent the values 10, 11, 12, 13, 14 and 15, respectively.
In this problem, you are given two letters X and Y. Each X and Y is A, B, C, D, E or F.
When X and Y are seen as hexadecimal numbers, which is larger?




Constraints
Each X and Y is A, B, C, D, E or F.







InputInput is given from Standard Input in the following format:
X Y





OutputIf X is smaller, print <; if Y is smaller, print >; if they are equal, print =.






Sample Input 1A B





Sample Output 1<

10 < 11.





Sample Input 2E C





Sample Output 2>

14 > 12.





Sample Input 3F F





Sample Output 3=

15 = 15.

",HEX,"String, Implementation",0.737,208,133
728,"
Score : 100 points


Problem StatementYou are given three integers, A, B and C.
Among them, two are the same, but the remaining one is different from the rest.
For example, when A=5,B=7,C=5, A and C are the same, but B is different.
Find the one that is different from the rest among the given three integers.  




Constraints
-100 \leq A,B,C \leq 100 
A, B and C are integers.
The input satisfies the condition in the statement.







InputInput is given from Standard Input in the following format:  
A B C





OutputAmong A, B and C, print the integer that is different from the rest.






Sample Input 15 7 5





Sample Output 17

This is the same case as the one in the statement.





Sample Input 21 1 7





Sample Output 27

In this case, C is the one we seek.





Sample Input 3-100 100 100





Sample Output 3-100


",One out of Three,Implementation,0.819,180,125
729,"
Score : 100 points


Problem StatementWe have a sandglass that runs for X seconds. The sand drops from the upper bulb at a rate of 1 gram per second. That is, the upper bulb initially contains X grams of sand.
How many grams of sand will the upper bulb contains after t seconds?




Constraints
1≤X≤10^9
1≤t≤10^9
X and t are integers.







InputThe input is given from Standard Input in the following format:
X t





OutputPrint the number of sand in the upper bulb after t second.






Sample Input 1100 17





Sample Output 183

17 out of the initial 100 grams of sand will be consumed, resulting in 83 grams.





Sample Input 248 58





Sample Output 20

All 48 grams of sand will be gone, resulting in 0 grams.





Sample Input 31000000000 1000000000





Sample Output 30


",Sandglass2,"Arithmetic, Implementation, String",0.873,155,123
730,"
Score : 100 points


Problem StatementSnuke lives at position x on a number line.
On this line, there are two stores A and B, respectively at position a and b, that offer food for delivery.
Snuke decided to get food delivery from the closer of stores A and B.
Find out which store is closer to Snuke's residence.
Here, the distance between two points s and t on a number line is represented by |s-t|.




Constraints
1 \leq x \leq 1000
1 \leq a \leq 1000
1 \leq b \leq 1000
x, a and b are pairwise distinct.
The distances between Snuke's residence and stores A and B are different.







InputInput is given from Standard Input in the following format:
x a b





OutputIf store A is closer, print A; if store B is closer, print B.






Sample Input 15 2 7





Sample Output 1B

The distances between Snuke's residence and stores A and B are 3 and 2, respectively.
Since store B is closer, print B.





Sample Input 21 999 1000





Sample Output 2A


",Meal Delivery,"Arithmetic, Implementation",0.766,187,112
731,"
Score : 100 points


Problem StatementSnuke is giving cookies to his three goats.
He has two cookie tins. One contains A cookies, and the other contains B cookies. He can thus give A cookies, B cookies or A+B cookies to his goats (he cannot open the tins).
Your task is to determine whether Snuke can give cookies to his three goats so that each of them can have the same number of cookies.




Constraints
1 \leq A,B \leq 100
Both A and B are integers.







InputInput is given from Standard Input in the following format:
A B





OutputIf it is possible to give cookies so that each of the three goats can have the same number of cookies, print Possible; otherwise, print Impossible.






Sample Input 14 5





Sample Output 1Possible

If Snuke gives nine cookies, each of the three goats can have three cookies.





Sample Input 21 1





Sample Output 2Impossible

Since there are only two cookies, the three goats cannot have the same number of cookies no matter what Snuke gives to them.

",Sharing Cookies,"Arithmetic, Implementation",0.635,220,116
732,"
Score : 100 points


Problem StatementSnuke is buying a bicycle.
The bicycle of his choice does not come with a bell, so he has to buy one separately.
He has very high awareness of safety, and decides to buy two bells, one for each hand.
The store sells three kinds of bells for the price of a, b and c yen (the currency of Japan), respectively.
Find the minimum total price of two different bells.




Constraints
1 \leq a,b,c \leq 10000
a, b and c are integers.







InputInput is given from Standard Input in the following format:
a b c





OutputPrint the minimum total price of two different bells.






Sample Input 1700 600 780





Sample Output 11300


Buying a 700-yen bell and a 600-yen bell costs 1300 yen.
Buying a 700-yen bell and a 780-yen bell costs 1480 yen.
Buying a 600-yen bell and a 780-yen bell costs 1380 yen.

The minimum among these is 1300 yen.





Sample Input 210000 10000 10000





Sample Output 220000

Buying any two bells costs 20000 yen.

",ringring,"Enumeration, Sorting, Greedy Algorithm",0.738,196,131
733,"
Score : 100 points


Problem StatementYou are given a three-digit positive integer N.
Determine whether N is a palindromic number.
Here, a palindromic number is an integer that reads the same backward as forward in decimal notation.




Constraints
100≤N≤999
N is an integer.







InputInput is given from Standard Input in the following format:  
N





OutputIf N is a palindromic number, print Yes; otherwise, print No.






Sample Input 1575





Sample Output 1Yes

N=575 is also 575 when read backward, so it is a palindromic number. You should print Yes.





Sample Input 2123





Sample Output 2No

N=123 becomes 321 when read backward, so it is not a palindromic number. You should print No.





Sample Input 3812





Sample Output 3No


",Palindromic Number,"String, Arithmetic, Implementation",0.744,182,124
734,"
Score : 100 points


Problem StatementThere is a hotel with the following accommodation fee:

X yen (the currency of Japan) per night, for the first K nights
Y yen per night, for the (K+1)-th and subsequent nights

Tak is staying at this hotel for N consecutive nights.
Find his total accommodation fee.




Constraints
1 \leq N, K \leq 10000
1 \leq Y < X \leq 10000
N,\,K,\,X,\,Y are integers.







InputThe input is given from Standard Input in the following format:
N
K
X
Y





OutputPrint Tak's total accommodation fee.






Sample Input 15
3
10000
9000





Sample Output 148000

The accommodation fee is as follows:

10000 yen for the 1-st night
10000 yen for the 2-nd night
10000 yen for the 3-rd night
9000 yen for the 4-th night
9000 yen for the 5-th night

Thus, the total is 48000 yen.





Sample Input 22
3
10000
9000





Sample Output 220000


",Tak and Hotels (ABC Edit),"Implementation, Arithmetic",0.715,299,189
735,"
Score : 500 points


Problem StatementWe have N camels numbered 1,2,\ldots,N.
Snuke has decided to make them line up in a row.
The happiness of Camel i will be L_i if it is among the K_i frontmost camels, and R_i otherwise.
Snuke wants to maximize the total happiness of the camels. Find the maximum possible total happiness of the camel.
Solve this problem for each of the T test cases given.




Constraints
All values in input are integers.
1 \leq T \leq 10^5
1 \leq N \leq 2 \times 10^{5}
1 \leq K_i \leq N
1 \leq L_i, R_i \leq 10^9
The sum of values of N in each input file is at most 2 \times 10^5.







InputInput is given from Standard Input in the following format:
T
\mathrm{case}_1
\vdots
\mathrm{case}_T

Each case is given in the following format:
N
K_1 L_1 R_1
\vdots
K_N L_N R_N





OutputPrint T lines. The i-th line should contain the answer to the i-th test case.






Sample Input 13
2
1 5 10
2 15 5
3
2 93 78
1 71 59
3 57 96
19
19 23 16
5 90 13
12 85 70
19 67 78
12 16 60
18 48 28
5 4 24
12 97 97
4 57 87
19 91 74
18 100 76
7 86 46
9 100 57
3 76 73
6 84 93
1 6 84
11 75 94
19 15 3
12 11 34





Sample Output 125
221
1354


In the first test case, it is optimal to line up the camels in the order 2, 1.
Camel 1 is not the frontmost camel, so its happiness will be 10.
Camel 2 is among the two frontmost camels, so its happiness will be 15.


In the second test case, it is optimal to line up the camels in the order 2, 1, 3.
Camel 1 is among the two frontmost camels, so its happiness will be 93.
Camel 2 is the frontmost camel, so its happiness will be 71.
Camel 3 is among the three frontmost camels, so its happiness will be 57.




",Camel Train,"Sorting, Greedy Algorithm, Priority Queue, Segment Tree, Two-pointer",0.357,62,22
736,"
Score: 600 points


Problem Statement
M-kun is a brilliant air traffic controller.
On the display of his radar, there are N airplanes numbered 1, 2, ..., N, all flying at the same altitude.
Each of the airplanes flies at a constant speed of 0.1 per second in a constant direction. The current coordinates of the airplane numbered i are (X_i, Y_i), and the direction of the airplane is as follows:

if U_i is U, it flies in the positive y direction;
if U_i is R, it flies in the positive x direction;
if U_i is D, it flies in the negative y direction;
if U_i is L, it flies in the negative x direction.

To help M-kun in his work, determine whether there is a pair of airplanes that will collide with each other if they keep flying as they are now.
If there is such a pair, find the number of seconds after which the first collision will happen.
We assume that the airplanes are negligibly small so that two airplanes only collide when they reach the same coordinates simultaneously.




Constraints

1 \leq N \leq 200000
0 \leq X_i, Y_i \leq 200000
U_i is U, R, D, or L.
The current positions of the N airplanes, (X_i, Y_i), are all distinct.
N, X_i, and Y_i are integers.







Input
Input is given from Standard Input in the following format:
N
X_1 Y_1 U_1
X_2 Y_2 U_2
X_3 Y_3 U_3
:
X_N Y_N U_N





Output
If there is a pair of airplanes that will collide with each other if they keep flying as they are now, print an integer representing the number of seconds after which the first collision will happen.
If there is no such pair, print SAFE.






Sample Input 12
11 1 U
11 47 D





Sample Output 1230

If the airplanes keep flying as they are now, two airplanes numbered 1 and 2 will reach the coordinates (11, 24) simultaneously and collide.  





Sample Input 24
20 30 U
30 20 R
20 10 D
10 20 L





Sample Output 2SAFE

No pair of airplanes will collide.





Sample Input 38
168 224 U
130 175 R
111 198 D
121 188 L
201 116 U
112 121 R
145 239 D
185 107 L





Sample Output 3100


",Air Safety,"Sorting, Set / Map, Hashing, Geometry; 3d, Two-pointer, Boolean Operations On Geometric Objects, Data Structure",0.435,51,20
737,"
Score: 500 points


Problem Statement
New AtCoder City has an infinite grid of streets, as follows:

At the center of the city stands a clock tower. Let (0, 0) be the coordinates of this point.
A straight street, which we will call East-West Main Street, runs east-west and passes the clock tower. It corresponds to the x-axis in the two-dimensional coordinate plane.
There are also other infinitely many streets parallel to East-West Main Street, with a distance of 1 between them. They correspond to the lines \ldots, y = -2, y = -1, y = 1, y = 2, \ldots in the two-dimensional coordinate plane.
A straight street, which we will call North-South Main Street, runs north-south and passes the clock tower. It corresponds to the y-axis in the two-dimensional coordinate plane.
There are also other infinitely many streets parallel to North-South Main Street, with a distance of 1 between them. They correspond to the lines \ldots, x = -2, x = -1, x = 1, x = 2, \ldots in the two-dimensional coordinate plane.

There are N residential areas in New AtCoder City. The i-th area is located at the intersection with the coordinates (X_i, Y_i) and has a population of P_i. Each citizen in the city lives in one of these areas.
The city currently has only two railroads, stretching infinitely, one along East-West Main Street and the other along North-South Main Street.
M-kun, the mayor, thinks that they are not enough for the commuters, so he decides to choose K streets and build a railroad stretching infinitely along each of those streets.
Let the walking distance of each citizen be the distance from his/her residential area to the nearest railroad.
M-kun wants to build railroads so that the sum of the walking distances of all citizens, S, is minimized.
For each K = 0, 1, 2, \dots, N, what is the minimum possible value of S after building railroads?




Constraints

1 \leq N \leq 15
-10 \ 000 \leq X_i \leq 10 \ 000
-10 \ 000 \leq Y_i \leq 10 \ 000
1 \leq P_i \leq 1 \ 000 \ 000
The locations of the N residential areas, (X_i, Y_i), are all distinct.
All values in input are integers.







Input
Input is given from Standard Input in the following format:
N
X_1 Y_1 P_1
X_2 Y_2 P_2
 :  :  :
X_N Y_N P_N





Output
Print the answer in N+1 lines.
The i-th line (i = 1, \ldots, N+1) should contain the minimum possible value of S after building railroads for the case K = i-1.






Sample Input 13
1 2 300
3 3 600
1 4 800





Sample Output 12900
900
0
0

When K = 0, the residents of Area 1, 2, and 3 have to walk the distances of 1, 3, and 1, respectively, to reach a railroad.
Thus, the sum of the walking distances of all citizens, S, is 1 \times 300 + 3 \times 600 + 1 \times 800 = 2900.
When K = 1, if we build a railroad along the street corresponding to the line y = 4 in the coordinate plane, the walking distances of the citizens of Area 1, 2, and 3 become 1, 1, and 0, respectively.
Then, S = 1 \times 300 + 1 \times 600 + 0 \times 800 = 900.
We have many other options for where we build the railroad, but none of them makes S less than 900.
When K = 2, if we build a railroad along the street corresponding to the lines x = 1 and x = 3 in the coordinate plane, all citizens can reach a railroad with the walking distance of 0, so S = 0. We can also have S = 0 when K = 3.
The figure below shows the optimal way to build railroads for the cases K = 0, 1, 2.
The street painted blue represents the roads along which we build railroads.






Sample Input 25
3 5 400
5 3 700
5 5 1000
5 7 700
7 5 400





Sample Output 213800
1600
0
0
0
0

The figure below shows the optimal way to build railroads for the cases K = 1, 2.






Sample Input 36
2 5 1000
5 2 1100
5 5 1700
-2 -5 900
-5 -2 600
-5 -5 2200





Sample Output 326700
13900
3200
1200
0
0
0

The figure below shows the optimal way to build railroads for the case K = 3.






Sample Input 48
2 2 286017
3 1 262355
2 -2 213815
1 -3 224435
-2 -2 136860
-3 -1 239338
-2 2 217647
-1 3 141903





Sample Output 42576709
1569381
868031
605676
366338
141903
0
0
0

The figure below shows the optimal way to build railroads for the case K = 4.


",M's Solution,"Bitmask, Memoization, Enumeration, Dyanmic Programming, Sorting, Geometry; 3d, Mathematics",0.32,47,17
738,"
Score : 700 points


Problem StatementLimak can repeatedly remove one of the first two characters of a string,
    for example abcxyx \rightarrow acxyx \rightarrow cxyx \rightarrow cyx.
You are given N different strings S_1, S_2, \ldots, S_N.
Among N \cdot (N-1) / 2 pairs (S_i, S_j),
    in how many pairs could Limak obtain one string from the other?




Constraints
2 \leq N \leq 200\,000
S_i consists of lowercase English letters a-z.
S_i \neq S_j
1 \leq |S_i|
|S_1| + |S_2| + \ldots + |S_N| \leq 10^6







InputInput is given from Standard Input in the following format.
N
S_1
S_2
\vdots
S_N





OutputPrint the number of unordered pairs (S_i, S_j)
    where i \neq j and Limak can obtain one string from the other.






Sample Input 13
abcxyx
cyx
abc





Sample Output 11

The only good pair is (abcxyx, cyx).





Sample Input 26
b
a
abc
c
d
ab





Sample Output 25

There are five good pairs: (b, abc), (a, abc), (abc, c), (b, ab), (a, ab).

",First Second,"String, Sorting, Trie, Bitmask, Counting",0.28,60,19
739,"
Score : 100 points


Problem StatementYou are given an array a_0, a_1, ..., a_{N-1} of length N. Process Q queries of the following types.

0 p x: a_p \gets a_p + x
1 l r: Print \sum_{i = l}^{r - 1}{a_i}.





Constraints
1 \leq N, Q \leq 500,000
0 \leq a_i, x \leq 10^9
0 \leq p < N
0 \leq l_i < r_i \leq N
All values in Input are integer.







InputInput is given from Standard Input in the following format:
N Q
a_0 a_1 ... a_{N - 1}
\textrm{Query}_0
\textrm{Query}_1
:
\textrm{Query}_{Q - 1}





OutputFor each query of the latter type, print the answer.






Sample Input 15 5
1 2 3 4 5
1 0 5
1 2 4
0 3 10
1 0 5
1 0 3





Sample Output 115
7
25
6


",Fenwick Tree,"Binary Indexed Tree, Prefix sum, Segment Tree",0.625,50,33
740,"
Score : 600 points


Problem StatementThere is a grid with N rows and N columns of squares. Let (i, j) be the square at the i-th row from the top and the j-th column from the left.
Each of the central (N-2) \times (N-2) squares in the grid has a black stone on it.
Each of the 2N - 1 squares on the bottom side and the right side has a white stone on it.
Q queries are given. We ask you to process them in order.
There are two kinds of queries. Their input format and description are as follows:

1 x: Place a white stone on (1, x). After that, for each black stone between (1, x) and the first white stone you hit if you go down from (1, x), replace it with a white stone.
2 x: Place a white stone on (x, 1). After that, for each black stone between (x, 1) and the first white stone you hit if you go right from (x, 1), replace it with a white stone.

How many black stones are there on the grid after processing all Q queries?




Constraints
3 \leq N \leq 2\times 10^5
0 \leq Q \leq \min(2N-4,2\times 10^5)
2 \leq x \leq N-1
Queries are pairwise distinct.







InputInput is given from Standard Input in the following format:
N Q
Query_1
\vdots
Query_Q





OutputPrint how many black stones there are on the grid after processing all Q queries.






Sample Input 15 5
1 3
2 3
1 4
2 2
1 2





Sample Output 11

After each query, the grid changes in the following way:






Sample Input 2200000 0





Sample Output 239999200004






Sample Input 3176527 15
1 81279
2 22308
2 133061
1 80744
2 44603
1 170938
2 139754
2 15220
1 172794
1 159290
2 156968
1 56426
2 77429
1 97459
2 71282





Sample Output 331159505795


",Simplified Reversi,"Segment Tree With Lazy Propagation, Segment Tree, Value / Coordinate Compression, Greedy Algorithm, Arithmetic",0.714,55,35
741,"
Score : 100 points


Problem StatementYou are given a grid of N rows and M columns. The square at the i-th row and j-th column will be denoted as (i,j).
Some of the squares contain an object. All the remaining squares are empty.
The state of the grid is represented by strings S_1,S_2,\cdots,S_N. The square (i,j) contains an object if S_{i,j}= # and is empty if S_{i,j}= ..
Consider placing 1 \times 2 tiles on the grid. Tiles can be placed vertically or horizontally to cover two adjacent empty squares.
Tiles must not stick out of the grid, and no two different tiles may intersect. Tiles cannot occupy the square with an object.
Calculate the maximum number of tiles that can be placed and any configulation that acheives the maximum.




Constraints
1 \leq N \leq 100
1 \leq M \leq 100
S_i is a string with length M consists of # and ..







InputInput is given from Standard Input in the following format:
N M
S_1
S_2
\vdots
S_N





OutputOn the first line, print the maximum number of tiles that can be placed.
On the next N lines, print a configulation that achieves the maximum.
Precisely, output the strings t_1,t_2,\cdots,t_N constructed by the following way.

t_i is initialized to S_i.
For each (i,j), if there is a tile that occupies (i,j) and (i+1,j), change t_{i,j}:=v, t_{i+1,j}:=^.
For each (i,j), if there is a tile that occupies (i,j) and (i,j+1), change t_{i,j}:=>, t_{i,j+1}:=<.

See samples for further information.
You may print any configulation that maximizes the number of tiles.






Sample Input 13 3
#..
..#
...





Sample Output 13
#><
vv#
^^.

The following output is also treated as a correct answer.
3
#><
v.#
^><


",Maxflow,"Bipartite Graph, Graph Theory, Maximum Flow, Grid Graph, Graph Traversal, Divide And Conquer",0.111,38,19
742,"
Score : 100 points


Problem StatementYou are given a grid of N rows and M columns. The square at the i-th row and j-th column will be denoted as (i,j).
A nonnegative integer A_{i,j} is written for each square (i,j).
You choose some of the squares so that each row and column contains at most K chosen squares.
Under this constraint, calculate the maximum value of the sum of the integers written on the chosen squares.
Additionally, calculate a way to choose squares that acheives the maximum.




Constraints
1 \leq N \leq 50
1 \leq K \leq N
0 \leq A_{i,j} \leq 10^9
All values in Input are integer.







InputInput is given from Standard Input in the following format:
N K
A_{1,1} A_{1,2} \cdots A_{1,N}
A_{2,1} A_{2,2} \cdots A_{2,N}
\vdots
A_{N,1} A_{N,2} \cdots A_{N,N}





OutputOn the first line, print the maximum value of the sum of the integers written on the chosen squares.
On the next N lines, print a way that achieves the maximum.
Precisely, output the strings t_1,t_2,\cdots,t_N, that satisfies t_{i,j}=X if you choose (i,j) and t_{i,j}=. otherwise.
You may print any way to choose squares that maximizes the sum.






Sample Input 13 1
5 3 2
1 4 8
7 6 9





Sample Output 119
X..
..X
.X.






Sample Input 23 2
10 10 1
10 10 1
1 1 10





Sample Output 250
XX.
XX.
..X


",MinCostFlow,"Bipartite Graph, Graph Theory, Maximum Flow, Shortest Path, Graph Traversal",0.667,22,16
743,"
Score : 100 points


Problem StatementYou are given two integer arrays a_0, a_1, ..., a_{N - 1} and b_0, b_1, ..., b_{M - 1}. Calculate the array c_0, c_1, ..., c_{(N - 1) + (M - 1)}, defined by c_i = \sum_{j = 0}^i a_j b_{i - j} \bmod 998244353.




Constraints
1 \leq N, M \leq 524288
0 \leq a_i, b_i < 998244353
All values in Input are integer.







InputInput is given from Standard Input in the following format:
N M
a_0 a_1 ... a_{N-1}
b_0 b_1 ... b_{M-1}





OutputPrint the answer in the following format:
c_0 c_1 ... c_{(N - 1) + (M - 1)}







Sample Input 14 5
1 2 3 4
5 6 7 8 9





Sample Output 15 16 34 60 70 70 59 36






Sample Input 21 1
10000000
10000000





Sample Output 2871938225


",Convolution,"Fast Fourier Transform, Arithmetic, Bitmask, Exponentiation By Squaring",0.778,26,16
744,"
Score : 100 points


Problem StatementYou are given a directed graph with N vertices and M edges, not necessarily simple. The i-th edge is oriented from the vertex a_i to the vertex b_i.
Divide this graph into strongly connected components and print them in their topological order.




Constraints
1 \leq N \leq 500,000
1 \leq M \leq 500,000
0 \leq a_i, b_i < N







InputInput is given from Standard Input in the following format:
N M
a_0 b_0
a_1 b_1
:
a_{M - 1} b_{M - 1}





OutputPrint 1+K lines, where K is the number of strongly connected components.
Print K on the first line. 
Print the information of each strongly connected component in next K lines in the following format, where l is the number of vertices in the strongly connected component and v_i is the index of the vertex in it.
l v_0 v_1 ... v_{l-1}

Here, for each edge (a_i, b_i), b_i should not appear in earlier line than a_i.
If there are multiple correct output, print any of them.






Sample Input 16 7
1 4
5 2
3 0
5 5
4 1
0 3
4 2





Sample Output 14
1 5
2 4 1
1 2
2 3 0


",SCC,"Depth-first Search, Strongly Connected Component, Graph Theory, Topological Sorting, Sorting",1.0,24,20
745,"
Score : 100 points


Problem StatementYou are given a string of length N. Calculate the number of distinct substrings of S.




Constraints
1 \leq N \leq 500,000
S consists of lowercase English letters.







InputInput is given from Standard Input in the following format:
S





OutputPrint the answer.






Sample Input 1abcbcba





Sample Output 121






Sample Input 2mississippi





Sample Output 253






Sample Input 3ababacaca





Sample Output 333






Sample Input 4aaaaa





Sample Output 45


",Number of Substrings,"Suffix Array And Lcp Array, Sorting, Prefix sum, Arithmetic",0.833,18,16
746,"
Score : 100 points


Problem StatementConsider placing N flags on a line. Flags are numbered through 1 to N.
Flag i can be placed on the coordinate X_i or Y_i.
For any two different flags, the distance between them should be at least D.
Decide whether it is possible to place all N flags. If it is possible, print such a configulation.




Constraints
1 \leq N \leq 1000
0 \leq D \leq 10^9
0 \leq X_i < Y_i \leq 10^9
All values in Input are integer.







InputInput is given from Standard Input in the following format:
N D
X_1 Y_1
X_2 Y_2
\vdots
X_N Y_N





OutputPrint No if it is impossible to place N flags.
If it is possible, print Yes first.
After that, print N lines. i-th line of them should contain the coodinate of flag i.






Sample Input 13 2
1 4
2 5
0 6





Sample Output 1Yes
4
2
0






Sample Input 23 3
1 4
2 5
0 6





Sample Output 2No


",Two SAT,"2-sat, Strongly Connected Component, Bruteforcing, Boolean Operations On Geometric Objects",0.833,13,11
747,"
Score : 600 points


Problem StatementThere is a board with N rows and M columns.
The information of this board is represented by N strings S_1,S_2,\ldots,S_N.
Specifically, the state of the square at the i-th row from the top and the j-th column from the left is represented as follows:

S_{i,j}=. : the square is empty.
S_{i,j}=# : an obstacle is placed on the square.
S_{i,j}=o : a piece is placed on the square.

Yosupo repeats the following operation:

Choose a piece and move it to its right adjecent square or its down adjacent square.
Moving a piece to squares with another piece or an obstacle is prohibited.
Moving a piece out of the board is also prohibited.

Yosupo wants to perform the operation as many times as possible.
Find the maximum possible number of operations.




Constraints
1 \leq N \leq 50
1 \leq M \leq 50
S_i is a string of length M consisting of ., # and o.
1 \leq ( the number of pieces )\leq 100.
In other words, the number of pairs (i, j) that satisfy S_{i,j}=o is between 1 and 100, both inclusive.







InputInput is given from Standard Input in the following format:
N M
S_1
S_2
\vdots
S_N





OutputPrint the maximum possible number of operations in a line.






Sample Input 13 3
o..
...
o.#





Sample Output 14

Yosupo can perform operations 4 times as follows:
o..      .o.      ..o      ...      ...
...  ->  ...  ->  ...  ->  ..o  ->  ..o
o.#      o.#      o.#      o.#      .o#






Sample Input 29 10
.#....o#..
.#..#..##o
.....#o.##
.###.#o..o
#.#...##.#
..#..#.###
#o.....#..
....###..o
o.......o#





Sample Output 224


",Moving Pieces,"Breadth-first Search, Graph Theory, Maximum Flow, Shortest Path, Maximum Flow",0.417,27,13
748,"
Score : 100 points


Problem StatementIn this problem, you should process T testcases.
For each testcase, you are given four integers N, M, A, B.
Calculate \sum_{i = 0}^{N - 1} floor((A \times i + B) / M).




Constraints
1 \leq T \leq 100,000
1 \leq N, M \leq 10^9
0 \leq A, B < M







InputInput is given from Standard Input in the following format:
T
N_0 M_0 A_0 B_0
N_1 M_1 A_1 B_1
:
N_{T - 1} M_{T - 1} A_{T - 1} B_{T - 1}





OutputPrint the answer for each testcase.






Sample Input 15
4 10 6 3
6 5 4 3
1 1 0 0
31415 92653 58979 32384
1000000000 1000000000 999999999 999999999





Sample Output 13
13
0
314095480
499999999500000000


",Floor Sum,"Divide And Conquer, Arithmetic, Mathematics",0.8,15,12
749,"
Score : 800 points


Problem StatementYou are given a string S consisting of lowercase English letters.
Determine whether we can turn S into a palindrome by repeating the operation of swapping two adjacent characters. If it is possible, find the minimum required number of operations.




Constraints
1 \leq |S| \leq 2 × 10^5
S consists of lowercase English letters.







InputInput is given from Standard Input in the following format:
S





OutputIf we cannot turn S into a palindrome, print -1. Otherwise, print the minimum required number of operations.






Sample Input 1eel





Sample Output 11

We can turn S into a palindrome by the following operation:

Swap the 2-nd and 3-rd characters. S is now ele.






Sample Input 2ataatmma





Sample Output 24

We can turn S into a palindrome by the following operation:

Swap the 5-th and 6-th characters. S is now ataamtma.
Swap the 4-th and 5-th characters. S is now atamatma.
Swap the 3-rd and 4-th characters. S is now atmaatma.
Swap the 2-nd and 3-rd characters. S is now amtaatma.






Sample Input 3snuke





Sample Output 3-1

We cannot turn S into a palindrome.

",Papple Sort,"Counting, Two-pointer, String, Array, Binary Indexed Tree, Sorting, Boolean Operations On Geometric Objects",0.167,20,3
750,"
Score : 100 points


Problem StatementYou are given an array a_0, a_1, ..., a_{N-1} of length N. Process Q queries of the following types.

0 l r b c: For each i = l, l+1, \dots, {r - 1}, set a_i \gets b \times a_i + c.
1 l r: Print \sum_{i = l}^{r - 1} a_i \bmod 998244353.





Constraints
1 \leq N, Q \leq 500000
0 \leq a_i, c < 998244353
1 \leq b < 998244353
0 \leq l < r \leq N
All values in Input are integer.







InputInput is given from Standard Input in the following format:
N Q
a_0 a_1 ... a_{N - 1}
\textrm{Query}_0
\textrm{Query}_1
:
\textrm{Query}_{Q - 1}





OutputFor each query of the latter type, print the answer.






Sample Input 15 7
1 2 3 4 5
1 0 5
0 2 4 100 101
1 0 3
0 1 3 102 103
1 2 5
0 2 5 104 105
1 0 5





Sample Output 115
404
41511
4317767


",Range Affine Range Sum,"Segment Tree, Segment Tree With Lazy Propagation, Arithmetic",0.125,57,15
751,"
Score : 100 points


Problem StatementYou are given a binary array A=(A_1,A_2,\cdots,A_N) of length N. 
Process Q queries of the following types. The i-th query is represented by three integers T_i,L_i,R_i.

T_i=1: Replace the value of A_j with 1-A_j for each L_i \leq j \leq R_i.
T_i=2: Calculate the inversion(*) of the array A_{L_i},A_{L_i+1},\cdots,A_{R_i}．

Note：The inversion of the array x_1,x_2,\cdots,x_k is the number of the pair of integers i,j with 1 \leq i < j \leq k, x_i > x_j.




Constraints
1 \leq N \leq 2 \times 10^5
0 \leq A_i \leq 1
1 \leq Q \leq 2 \times 10^5
1 \leq T_i \leq 2
1 \leq L_i \leq R_i \leq N
All values in Input are integer.







InputInput is given from Standard Input in the following format:
N Q
A_1 A_2 \cdots A_N
T_1 L_1 R_1
T_2 L_2 R_2
\vdots
T_Q L_Q R_Q





OutputFor each query with T_i=2, print the answer.






Sample Input 15 5
0 1 0 0 1
2 1 5
1 3 4
2 2 5
1 1 3
2 1 2





Sample Output 12
0
1


First query: Print 2, which is the inversion of (A_1,A_2,A_3,A_4,A_5)=(0,1,0,0,1).
Second query: Replace the value of A_3 and A_4 with 1 and 1, respectively.
Third query: Print 0, which is the inversion of (A_2,A_3,A_4,A_5)=(1,1,1,1).
Fourth query: Replace the value of A_1, A_2 and A_4 with 1, 0 and 0, respectively.
Fifth query: Print 1, which is the inversion of (A_1,A_2)=(1,0).


",Lazy Segment Tree,"Segment Tree, Segment Tree With Lazy Propagation, Counting, Divide And Conquer, Combinatorics",0.571,23,11
752,"
Score : 500 points


Problem StatementYou have a string A = A_1 A_2 ... A_n consisting of lowercase English letters.
You can choose any two indices i and j such that 1 \leq i \leq j \leq n and reverse substring A_i A_{i+1} ... A_j.
You can perform this operation at most once.
How many different strings can you obtain?




Constraints
1 \leq |A| \leq 200,000
A consists of lowercase English letters.







InputInput is given from Standard Input in the following format:
A





OutputPrint the number of different strings you can obtain by reversing any substring in A at most once.






Sample Input 1aatt





Sample Output 15

You can obtain aatt (don't do anything), atat (reverse A[2..3]), atta (reverse A[2..4]), ttaa (reverse A[1..4]) and taat (reverse A[1..3]).





Sample Input 2xxxxxxxxxx





Sample Output 21

Whatever substring you reverse, you'll always get xxxxxxxxxx.





Sample Input 3abracadabra





Sample Output 344


",Reverse and Compare,"Combinatorics, Counting, Arithmetic, Mathematics",0.395,90,35
753,"
Score : 500 points


Problem StatementAn adult game master and N children are playing a game on an ice rink.
The game consists of K rounds.
In the i-th round, the game master announces:

Form groups consisting of A_i children each!

Then the children who are still in the game form as many groups of A_i children as possible.
One child may belong to at most one group.
Those who are left without a group leave the game. The others proceed to the next round.
Note that it's possible that nobody leaves the game in some round.
In the end, after the K-th round, there are exactly two children left, and they are declared the winners.
You have heard the values of A_1, A_2, ..., A_K. You don't know N, but you want to estimate it.
Find the smallest and the largest possible number of children in the game before the start, or determine that no valid values of N exist.




Constraints
1 \leq K \leq 10^5
2 \leq A_i \leq 10^9
All input values are integers.







InputInput is given from Standard Input in the following format:
K
A_1 A_2 ... A_K





OutputPrint two integers representing the smallest and the largest possible value of N, respectively,
or a single integer -1 if the described situation is impossible.






Sample Input 14
3 4 3 2





Sample Output 16 8

For example, if the game starts with 6 children, then it proceeds as follows:

In the first round, 6 children form 2 groups of 3 children, and nobody leaves the game.
In the second round, 6 children form 1 group of 4 children, and 2 children leave the game.
In the third round, 4 children form 1 group of 3 children, and 1 child leaves the game.
In the fourth round, 3 children form 1 group of 2 children, and 1 child leaves the game.

The last 2 children are declared the winners.





Sample Input 25
3 4 100 3 2





Sample Output 2-1

This situation is impossible.
In particular, if the game starts with less than 100 children, everyone leaves after the third round.





Sample Input 310
2 2 2 2 2 2 2 2 2 2





Sample Output 32 3


",Ice Rink Game,"Implementation, Arithmetic, Segment Tree With Lazy Propagation, Binary Search, Mathematics",0.357,93,22
754,"
Score : 400 points


Problem StatementMountaineers Mr. Takahashi and Mr. Aoki recently trekked across a certain famous mountain range.
The mountain range consists of N mountains, extending from west to east in a straight line as Mt. 1, Mt. 2, ..., Mt. N.
Mr. Takahashi traversed the range from the west and Mr. Aoki from the east.  
The height of Mt. i is h_i, but they have forgotten the value of each h_i.
Instead, for each i (1 ≤ i ≤ N), they recorded the maximum height of the mountains climbed up to the time they reached the peak of Mt. i (including Mt. i).
Mr. Takahashi's record is T_i and Mr. Aoki's record is A_i.  
We know that the height of each mountain h_i is a positive integer.
Compute the number of the possible sequences of the mountains' heights, modulo 10^9 + 7.
Note that the records may be incorrect and thus there may be no possible sequence of the mountains' heights.
In such a case, output 0.




Constraints
1 ≤ N ≤ 10^5
1 ≤ T_i ≤ 10^9
1 ≤ A_i ≤ 10^9
T_i ≤ T_{i+1} (1 ≤ i ≤ N - 1)
A_i ≥ A_{i+1} (1 ≤ i ≤ N - 1)







InputThe input is given from Standard Input in the following format:
N
T_1 T_2 ... T_N
A_1 A_2 ... A_N





OutputPrint the number of possible sequences of the mountains' heights, modulo 10^9 + 7.






Sample Input 15
1 3 3 3 3
3 3 2 2 2





Sample Output 14

The possible sequences of the mountains' heights are:

1, 3, 2, 2, 2 
1, 3, 2, 1, 2 
1, 3, 1, 2, 2 
1, 3, 1, 1, 2 

for a total of four sequences.





Sample Input 25
1 1 1 2 2
3 2 1 1 1





Sample Output 20

The records are contradictory, since Mr. Takahashi recorded 2 as the highest peak after climbing all the mountains but Mr. Aoki recorded 3.





Sample Input 310
1 3776 3776 8848 8848 8848 8848 8848 8848 8848
8848 8848 8848 8848 8848 8848 8848 8848 3776 5





Sample Output 3884111967

Don't forget to compute the number modulo 10^9 + 7.





Sample Input 41
17
17





Sample Output 41

Some mountain ranges consist of only one mountain.

",Two Alpinists,"Array, Backtracking, Arithmetic, Greedy Algorithm, 2-sat",0.324,105,27
755,"
Score : 500 points


Problem StatementThere is a rooted tree (see Notes) with N vertices numbered 1 to N.
Each of the vertices, except the root, has a directed edge coming from its parent.
Note that the root may not be Vertex 1.
Takahashi has added M new directed edges to this graph.
Each of these M edges, u \rightarrow v, extends from some vertex u to its descendant v.
You are given the directed graph with N vertices and N-1+M edges after Takahashi added edges.
More specifically, you are given N-1+M pairs of integers, (A_1, B_1), ..., (A_{N-1+M}, B_{N-1+M}), which represent that the i-th edge extends from Vertex A_i to Vertex B_i.
Restore the original rooted tree.




NotesFor ""tree"" and other related terms in graph theory, see the article in Wikipedia, for example.




Constraints
3 \leq N
1 \leq M
N + M \leq 10^5
1 \leq A_i, B_i \leq N
A_i \neq B_i
If i \neq j, (A_i, B_i) \neq (A_j, B_j).
The graph in input can be obtained by adding M edges satisfying the condition in the problem statement to a rooted tree with N vertices.







InputInput is given from Standard Input in the following format:
N M
A_1 B_1
:
A_{N-1+M} B_{N-1+M}





OutputPrint N lines.
In the i-th line, print 0 if Vertex i is the root of the original tree, and otherwise print the integer representing the parent of Vertex i in the original tree.
Note that it can be shown that the original tree is uniquely determined.






Sample Input 13 1
1 2
1 3
2 3





Sample Output 10
1
2

The graph in this input is shown below:

It can be seen that this graph is obtained by adding the edge 1 \rightarrow 3 to the rooted tree 1 \rightarrow 2 \rightarrow 3.





Sample Input 26 3
2 1
2 3
4 1
4 2
6 1
2 6
4 6
6 5





Sample Output 26
4
2
0
6
2


",Restore the Tree,"Directed Acyclic Graph, Topological Sorting, Graph Traversal, Tree, Graph Theory",0.421,62,15
756,"
Score : 400 points


Problem StatementOn a planet far, far away, M languages are spoken. They are conveniently numbered 1 through M.
For CODE FESTIVAL 20XX held on this planet, N participants gathered from all over the planet.
The i-th (1≦i≦N) participant can speak K_i languages numbered L_{i,1}, L_{i,2}, ..., L_{i,{}K_i}.
Two participants A and B can communicate with each other if and only if one of the following conditions is satisfied:

There exists a language that both A and B can speak.
There exists a participant X that both A and B can communicate with.

Determine whether all N participants can communicate with all other participants.




Constraints
2≦N≦10^5
1≦M≦10^5
1≦K_i≦M
(The sum of all K_i)≦10^5
1≦L_{i,j}≦M
L_{i,1}, L_{i,2}, ..., L_{i,{}K_i} are pairwise distinct.





Partial Score
200 points will be awarded for passing the test set satisfying the following: N≦1000, M≦1000 and (The sum of all K_i)≦1000.
Additional 200 points will be awarded for passing the test set without additional constraints.







InputThe input is given from Standard Input in the following format:
N M
K_1 L_{1,1} L_{1,2} ... L_{1,{}K_1}
K_2 L_{2,1} L_{2,2} ... L_{2,{}K_2}
:
K_N L_{N,1} L_{N,2} ... L_{N,{}K_N}





OutputIf all N participants can communicate with all other participants, print YES. Otherwise, print NO.






Sample Input 14 6
3 1 2 3
2 4 2
2 4 6
1 6





Sample Output 1YES

Any two participants can communicate with each other, as follows:

Participants 1 and 2: both can speak language 2.
Participants 2 and 3: both can speak language 4.
Participants 1 and 3: both can communicate with participant 2.
Participants 3 and 4: both can speak language 6.
Participants 2 and 4: both can communicate with participant 3.
Participants 1 and 4: both can communicate with participant 2.

Note that there can be languages spoken by no participant.





Sample Input 24 4
2 1 2
2 1 2
1 3
2 4 3





Sample Output 2NO

For example, participants 1 and 3 cannot communicate with each other.

",Interpretation,"Disjoint Set, Graph Theory",0.75,20,13
757,"
Score : 600 points


Problem StatementSnuke got an integer sequence of length N from his mother, as a birthday present. The i-th (1 ≦ i ≦ N) element of the sequence is a_i. The elements are pairwise distinct.
He is sorting this sequence in increasing order.
With supernatural power, he can perform the following two operations on the sequence in any order:

Operation 1: choose 2 consecutive elements, then reverse the order of those elements.
Operation 2: choose 3 consecutive elements, then reverse the order of those elements.

Snuke likes Operation 2, but not Operation 1. Find the minimum number of Operation 1 that he has to perform in order to sort the sequence in increasing order.




Constraints
1 ≦ N ≦ 10^5
0 ≦ A_i ≦ 10^9
If i ≠ j, then A_i ≠ A_j.
All input values are integers.







InputThe input is given from Standard Input in the following format:
N
A_1
:
A_N





OutputPrint the minimum number of times Operation 1 that Snuke has to perform.






Sample Input 14
2
4
3
1





Sample Output 11

The given sequence can be sorted as follows:

First, reverse the order of the last three elements. The sequence is now: 2,1,3,4.
Then, reverse the order of the first two elements. The sequence is now: 1,2,3,4.

In this sequence of operations, Operation 1 is performed once. It is not possible to sort the sequence with less number of Operation 1, thus the answer is 1.





Sample Input 25
10
8
5
3
2





Sample Output 20


",BBuBBBlesort!,"Sorting, Value / Coordinate Compression, Permutation Cycle Decomposition, Parity, Counting, Binary Search",0.714,55,30
758,"
Score : 600 points


Problem StatementThere are 2N people numbered 1 through 2N.
The height of Person i is h_i.
How many ways are there to make N pairs of people such that the following conditions are satisfied?
Compute the answer modulo 998,244,353.

Each person is contained in exactly one pair.
For each pair, the heights of the two people in the pair are different.

Two ways are considered different if for some p and q, Person p and Person q are paired in one way and not in the other.




Constraints
1 \leq N \leq 50,000
1 \leq h_i \leq 100,000
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
h_1
:
h_{2N}





OutputPrint the answer.






Sample Input 12
1
1
2
3





Sample Output 12

There are two ways:

Form the pair (Person 1, Person 3) and the pair (Person 2, Person 4).
Form the pair (Person 1, Person 4) and the pair (Person 2, Person 3).






Sample Input 25
30
10
20
40
20
10
10
30
50
60





Sample Output 2516


",Heights and Pairs,"Sorting, Counting, Combinatorics, Divide And Conquer, Fast Fourier Transform, Priority Queue, Inclusion And Exclusion, Arithmetic",0.4,33,24
759,"
Score : 800 points


Problem StatementThere are N squares arranged in a row, numbered 1 to N from left to right. Takahashi will stack building blocks on these squares, on which there are no blocks yet.
He wants to stack blocks on the squares evenly, so he will repeat the following operation until there are H blocks on every square:

Let M and m be the maximum and minimum numbers of blocks currently stacked on a square, respectively. Choose a square on which m blocks are stacked (if there are multiple such squares, choose any one of them), and add a positive number of blocks on that square so that there will be at least M and at most M + D blocks on that square.

Tell him how many ways there are to have H blocks on every square by repeating this operation. Since there can be extremely many ways, print the number modulo 10^9+7.




Constraints
2 \leq N \leq 10^6
1 \leq D \leq H \leq 10^6
All values in input are integers.







InputInput is given from Standard Input in the following format:
N H D





OutputPrint the number of ways to have H blocks on every square, modulo 10^9+7.






Sample Input 12 2 1





Sample Output 16

The possible transitions of (the number of blocks on Square 1, the number of blocks on Square 2) are as follows:


(0, 0) -> (0, 1) -> (1, 1) -> (1, 2) -> (2, 2)


(0, 0) -> (0, 1) -> (1, 1) -> (2, 1) -> (2, 2)


(0, 0) -> (0, 1) -> (2, 1) -> (2, 2)


(0, 0) -> (1, 0) -> (1, 1) -> (1, 2) -> (2, 2)


(0, 0) -> (1, 0) -> (1, 1) -> (2, 1) -> (2, 2)


(0, 0) -> (1, 0) -> (1, 2) -> (2, 2)


Thus, there are six ways to have two blocks on every square.





Sample Input 22 30 15





Sample Output 294182806






Sample Input 331415 9265 3589





Sample Output 3312069529

Be sure to print the number modulo 10^9+7.

",Balanced Piles,"Dyanmic Programming, Prefix sum, Arithmetic, Combinatorics, Recursion, Sliding Window",1.0,1,1
760,"
Score : 400 points


Problem StatementLet \mathrm{popcount}(n) be the number of 1s in the binary representation of n.
For example, \mathrm{popcount}(3) = 2, \mathrm{popcount}(7) = 3, and \mathrm{popcount}(0) = 0.
Let f(n) be the number of times the following operation will be done when we repeat it until n becomes 0: ""replace n with the remainder when n is divided by \mathrm{popcount}(n)."" (It can be proved that, under the constraints of this problem, n always becomes 0 after a finite number of operations.)
For example, when n=7, it becomes 0 after two operations, as follows:

\mathrm{popcount}(7)=3, so we divide 7 by 3 and replace it with the remainder, 1.
\mathrm{popcount}(1)=1, so we divide 1 by 1 and replace it with the remainder, 0.

You are given an integer X with N digits in binary.
For each integer i such that 1 \leq i \leq N, let X_i be what X becomes when the i-th bit from the top is inverted.
Find f(X_1), f(X_2), \ldots, f(X_N).




Constraints
1 \leq N \leq 2 \times 10^5
X is an integer with N digits in binary, possibly with leading zeros.







InputInput is given from Standard Input in the following format:
N
X





OutputPrint N lines. The i-th line should contain the value f(X_i).






Sample Input 13
011





Sample Output 12
1
1


X_1 = 7, which will change as follows: 7 \rightarrow 1 \rightarrow 0. Thus, f(7) = 2.
X_2 = 1, which will change as follows: 1 \rightarrow 0. Thus, f(1) = 1.
X_3 = 2, which will change as follows: 2 \rightarrow 0. Thus, f(2) = 1.






Sample Input 223
00110111001011011001110





Sample Output 22
1
2
2
1
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
1
3


",Anything Goes to Zero,"Arithmetic, Bitmask, Precomputation, Memoization, Number Theory, Recursion",0.131,407,74
761,"
Score : 800 points


Problem StatementYou are given an integer sequence x of length N.
Determine if there exists an integer sequence a that satisfies all of the following conditions, and if it exists, construct an instance of a.

a is N^2 in length, containing N copies of each of the integers 1, 2, ..., N.
For each 1 ≤ i ≤ N, the i-th occurrence of the integer i from the left in a is the x_i-th element of a from the left.





Constraints
1 ≤ N ≤ 500
1 ≤ x_i ≤ N^2
All x_i are distinct.







InputThe input is given from Standard Input in the following format:
N
x_1 x_2 ... x_N





OutputIf there does not exist an integer sequence a that satisfies all the conditions, print No.
If there does exist such an sequence a, print Yes in the first line, then print an instance of a in the second line, with spaces inbetween.






Sample Input 13
1 5 9





Sample Output 1Yes
1 1 1 2 2 2 3 3 3

For example, the second occurrence of the integer 2 from the left in a in the output is the fifth element of a from the left.
Similarly, the condition is satisfied for the integers 1 and 3.





Sample Input 22
4 1





Sample Output 2No


",K-th K,"Greedy Algorithm, Priority Queue, Array, Sorting, Simulation",0.571,12,5
762,"
Score : 300 points


Problem StatementYou are given a string s.
Among the different substrings of s, print the K-th lexicographically smallest one.
A substring of s is a string obtained by taking out a non-empty contiguous part in s.
For example, if s = ababc, a, bab and ababc are substrings of s, while ac, z and an empty string are not.
Also, we say that substrings are different when they are different as strings.
Let X = x_{1}x_{2}...x_{n} and Y = y_{1}y_{2}...y_{m} be two distinct strings. X is lexicographically larger than Y if and only if Y is a prefix of X or x_{j} > y_{j} where j is the smallest integer such that x_{j} \neq y_{j}.




Constraints
1 ≤ |s| ≤ 5000
s consists of lowercase English letters.
1 ≤ K ≤ 5
s has at least K different substrings.





Partial Score
200 points will be awarded as a partial score for passing the test set satisfying |s| ≤ 50.







InputInput is given from Standard Input in the following format:
s
K





OutputPrint the K-th lexicographically smallest substring of K.






Sample Input 1aba
4





Sample Output 1b

s has five substrings: a, b, ab, ba and aba.
Among them, we should print the fourth smallest one, b.
Note that we do not count a twice.





Sample Input 2atcoderandatcodeer
5





Sample Output 2andat






Sample Input 3z
1





Sample Output 3z


",K-th Substring,"String, Set / Map, Hashing, Sorting, Suffix Array And Lcp Array, Priority Queue",0.629,71,32
763,"
Score : 500 points


Problem StatementThere are N towns on a line running east-west.
The towns are numbered 1 through N, in order from west to east.
Each point on the line has a one-dimensional coordinate, and a point that is farther east has a greater coordinate value.
The coordinate of town i is X_i.
You are now at town 1, and you want to visit all the other towns.
You have two ways to travel:


Walk on the line.
Your fatigue level increases by A each time you travel a distance of 1, regardless of direction.


Teleport to any location of your choice.
Your fatigue level increases by B, regardless of the distance covered.


Find the minimum possible total increase of your fatigue level when you visit all the towns in these two ways.




Constraints
All input values are integers.
2≤N≤10^5
1≤X_i≤10^9
For all i(1≤i≤N-1), X_i<X_{i+1}.
1≤A≤10^9
1≤B≤10^9







InputThe input is given from Standard Input in the following format:
N A B
X_1 X_2 ... X_N





OutputPrint the minimum possible total increase of your fatigue level when you visit all the towns.






Sample Input 14 2 5
1 2 5 7





Sample Output 111

From town 1, walk a distance of 1 to town 2, then teleport to town 3, then walk a distance of 2 to town 4.
The total increase of your fatigue level in this case is 2×1+5+2×2=11, which is the minimum possible value.





Sample Input 27 1 100
40 43 45 105 108 115 124





Sample Output 284

From town 1, walk all the way to town 7.
The total increase of your fatigue level in this case is 84, which is the minimum possible value.





Sample Input 37 1 2
24 35 40 68 72 99 103





Sample Output 312

Visit all the towns in any order by teleporting six times.
The total increase of your fatigue level in this case is 12, which is the minimum possible value.

",Walk and Teleport,"Greedy Algorithm, Array, Arithmetic, Boolean Operations On Geometric Objects",0.769,38,26
764,"
Score : 600 points


Problem StatementThere is an infinitely large pond, which we consider as a number line.
In this pond, there are N lotuses floating at coordinates 0, 1, 2, ..., N-2 and N-1.
On the lotus at coordinate i, an integer s_i is written.
You are standing on the lotus at coordinate 0. You will play a game that proceeds as follows:

1. Choose positive integers A and B. Your score is initially 0.
2. Let x be your current coordinate, and y = x+A. The lotus at coordinate x disappears, and you move to coordinate y.
If y = N-1, the game ends.
If y \neq N-1 and there is a lotus floating at coordinate y, your score increases by s_y.
If y \neq N-1 and there is no lotus floating at coordinate y, you drown. Your score decreases by 10^{100} points, and the game ends.


3. Let x be your current coordinate, and y = x-B. The lotus at coordinate x disappears, and you move to coordinate y.
If y = N-1, the game ends.
If y \neq N-1 and there is a lotus floating at coordinate y, your score increases by s_y.
If y \neq N-1 and there is no lotus floating at coordinate y, you drown. Your score decreases by 10^{100} points, and the game ends.


4. Go back to step 2.

You want to end the game with as high a score as possible.
What is the score obtained by the optimal choice of A and B?




Constraints
3 \leq N \leq 10^5
-10^9 \leq s_i \leq 10^9
s_0=s_{N-1}=0
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
s_0 s_1 ...... s_{N-1}





OutputPrint the score obtained by the optimal choice of A and B.






Sample Input 15
0 2 5 1 0





Sample Output 13

If you choose A = 3 and B = 2, the game proceeds as follows:

Move to coordinate 0 + 3 = 3. Your score increases by s_3 = 1.
Move to coordinate 3 - 2 = 1. Your score increases by s_1 = 2.
Move to coordinate 1 + 3 = 4. The game ends with a score of 3.

There is no way to end the game with a score of 4 or higher, so the answer is 3. Note that you cannot land the lotus at coordinate 2 without drowning later.





Sample Input 26
0 10 -7 -4 -13 0





Sample Output 20

The optimal strategy here is to land the final lotus immediately by choosing A = 5 (the value of B does not matter).





Sample Input 311
0 -4 0 -99 31 14 -15 -39 43 18 0





Sample Output 359


",Frog Jump,"Arithmetic, Number Theory, Two-pointer, Greedy Algorithm, Mathematics",0.111,47,7
765,"
Score : 1400 points


Problem StatementGiven are a positive integer N and a sequence of length 2^N consisting of 0s and 1s: A_0,A_1,\ldots,A_{2^N-1}.
Determine whether there exists a closed curve C that satisfies the condition below for all 2^N sets S \subseteq \{0,1,\ldots,N-1 \}. If the answer is yes, construct one such closed curve.

Let x = \sum_{i \in S} 2^i and B_S be the set of points \{ (i+0.5,0.5) | i \in S \}.
If there is a way to continuously move the closed curve C without touching B_S so that every point on the closed curve has a negative y-coordinate, A_x = 1.
If there is no such way, A_x = 0.

For instruction on printing a closed curve, see Output below.




NotesC is said to be a closed curve if and only if:

C is a continuous function from [0,1] to \mathbb{R}^2 such that C(0) = C(1).

We say that a closed curve C can be continuously moved without touching a set of points X so that it becomes a closed curve D if and only if:

There exists a function f : [0,1] \times [0,1] \rightarrow \mathbb{R}^2 that satisfies all of the following.
f is continuous.
f(0,t) = C(t).
f(1,t) = D(t).
f(x,t) \notin X.







Constraints
1 \leq N \leq 8
A_i = 0,1 \quad (0 \leq i \leq 2^N-1)
A_0 = 1







InputInput is given from Standard Input in the following format:
N
A_0A_1 \cdots A_{2^N-1}





OutputIf there is no closed curve that satisfies the condition, print Impossible.
If such a closed curve exists, print Possible in the first line.
Then, print one such curve in the following format:
L
x_0 y_0
x_1 y_1
:
x_L y_L

This represents the closed polyline that passes (x_0,y_0),(x_1,y_1),\ldots,(x_L,y_L) in this order.
Here, all of the following must be satisfied:

0 \leq x_i \leq N, 0 \leq y_i \leq 1, and x_i, y_i are integers. (0 \leq i \leq L)
|x_i-x_{i+1}| + |y_i-y_{i+1}| = 1. (0 \leq i \leq L-1)
(x_0,y_0) = (x_L,y_L).

Additionally, the length of the closed curve L must satisfy 0 \leq L \leq 250000.
It can be proved that, if there is a closed curve that satisfies the condition in Problem Statement, there is also a closed curve that can be expressed in this format.






Sample Input 11
10





Sample Output 1Possible
4
0 0
0 1
1 1
1 0
0 0

When S = \emptyset, we can move this curve so that every point on it has a negative y-coordinate.

When S = \{0\}, we cannot do so.






Sample Input 22
1000





Sample Output 2Possible
6
1 0
2 0
2 1
1 1
0 1
0 0
1 0

The output represents the following curve:






Sample Input 32
1001





Sample Output 3Impossible






Sample Input 41
11





Sample Output 4Possible
0
1 1


",Topology,"Bitmask, Backtracking, Geometry; 3d, Depth-first Search, Boolean Operations On Geometric Objects",0.0,10,1
766,"
Score : 800 points


Problem StatementGiven is a string S, where each character is 0, 1, or ?.
Consider making a string S' by replacing each occurrence of ? with 0 or 1 (we can choose the character for each ? independently).
Let us define the unbalancedness of S' as follows:

(The unbalancedness of S') = \max \{ The absolute difference between the number of occurrences of 0 and 1 between the l-th and r-th character of S (inclusive) :\ 1 \leq l \leq r \leq |S|\}

Find the minimum possible unbalancedness of S'.




Constraints
1 \leq |S| \leq 10^6
Each character of S is 0, 1, or ?.







InputInput is given from Standard Input in the following format:
S





OutputPrint the minimum possible unbalancedness of S'.






Sample Input 10??





Sample Output 11

We can make S'= 010 and achieve the minimum possible unbalancedness of 1.





Sample Input 20??0





Sample Output 22






Sample Input 3??00????0??0????0?0??00??1???11?1?1???1?11?111???1





Sample Output 34


",01 Unbalanced,"Prefix sum, Greedy Algorithm, Set / Map, Binary Search, Simulation, Segment Tree",0.167,10,2
767,"
Score : 700 points


Problem StatementWe have a rooted binary tree with N vertices, where the vertices are numbered 1 to N.
Vertex 1 is the root, and the parent of Vertex i (i \geq 2) is Vertex \left[ \frac{i}{2} \right].
Each vertex has one item in it. The item in Vertex i has a value of V_i and a weight of W_i.
Now, process the following query Q times:

Given are a vertex v of the tree and a positive integer L.
  Let us choose some (possibly none) of the items in v and the ancestors of v so that their total weight is at most L.
  Find the maximum possible total value of the chosen items.

Here, Vertex u is said to be an ancestor of Vertex v when u is an indirect parent of v, that is, there exists a sequence of vertices w_1,w_2,\ldots,w_k (k\geq 2) where w_1=v, w_k=u, and w_{i+1} is the parent of w_i for each i.




Constraints
All values in input are integers.
1 \leq N < 2^{18}
1 \leq Q \leq 10^5
1 \leq V_i \leq 10^5
1 \leq W_i \leq 10^5
For the values v and L given in each query, 1 \leq v \leq N and 1 \leq L \leq 10^5.







InputLet v_i and L_i be the values v and L given in the i-th query.
Then, Input is given from Standard Input in the following format:
N
V_1 W_1
:
V_N W_N
Q
v_1 L_1
:
v_Q L_Q





OutputFor each integer i from 1 through Q,
the i-th line should contain the response to the i-th query.






Sample Input 13
1 2
2 3
3 4
3
1 1
2 5
3 5





Sample Output 10
3
3

In the first query, we are given only one choice: the item with (V, W)=(1,2). Since L = 1, we cannot actually choose it, so our response should be 0.
In the second query, we are given two choices: the items with (V, W)=(1,2) and (V, W)=(2,3). Since L = 5, we can choose both of them, so our response should be 3.





Sample Input 215
123 119
129 120
132 112
126 109
118 103
115 109
102 100
130 120
105 105
132 115
104 102
107 107
127 116
121 104
121 115
8
8 234
9 244
10 226
11 227
12 240
13 237
14 206
15 227





Sample Output 2256
255
250
247
255
259
223
253


",Knapsack Queries on a tree,"Tree, Graph Theory, Knapsack, Bitmask, Bruteforcing, Divide And Conquer, Two-pointer, Memoization",0.071,41,4
768,"
Score : 800 points


Problem StatementGiven are N pairwise distinct non-negative integers A_1,A_2,\ldots,A_N.
Find the number of ways to choose a set of between 1 and K numbers (inclusive) from the given numbers so that the following two conditions are satisfied:

The bitwise AND of the chosen numbers is S.
The bitwise OR of the chosen numbers is T.





Constraints
1 \leq N \leq 50
1 \leq K \leq N
0 \leq A_i < 2^{18}
0 \leq S < 2^{18}
0 \leq T < 2^{18}
A_i \neq A_j (1 \leq i < j \leq N)







InputInput is given from Standard Input in the following format:
N K S T
A_1 A_2 ... A_N





OutputPrint the answer.






Sample Input 13 3 0 3
1 2 3





Sample Output 12

The conditions are satisfied when we choose \{1,2\} or \{1,2,3\}.





Sample Input 25 3 1 7
3 4 9 1 5





Sample Output 22






Sample Input 35 4 0 15
3 4 9 1 5





Sample Output 33


",O(rand),"Bitmask, Boolean Operations On Geometric Objects, Inclusion And Exclusion, Combinatorics, Sorting, Enumeration",0.5,2,1
769,"
Score : 600 points


Problem StatementWe have a grid with A horizontal rows and B vertical columns, with the squares painted white. On this grid, we will repeatedly apply the following operation:

Assume that the grid currently has a horizontal rows and b vertical columns. Choose ""vertical"" or ""horizontal"".
If we choose ""vertical"", insert one row at the top of the grid, resulting in an (a+1) \times b grid.
If we choose ""horizontal"", insert one column at the right end of the grid, resulting in an a \times (b+1) grid.


Then, paint one of the added squares black, and the other squares white.

Assume the grid eventually has C horizontal rows and D vertical columns. Find the number of ways in which the squares can be painted in the end, modulo 998244353.




Constraints
1 \leq A \leq C \leq 3000
1 \leq B \leq D \leq 3000
A, B, C, and D are integers.







InputInput is given from Standard Input in the following format:
A B C D





OutputPrint the number of ways in which the squares can be painted in the end, modulo 998244353.






Sample Input 11 1 2 2





Sample Output 13

Any two of the three squares other than the bottom-left square can be painted black.





Sample Input 22 1 3 4





Sample Output 265






Sample Input 331 41 59 265





Sample Output 3387222020


",Extension,"Dyanmic Programming, Combinatorics, Arithmetic, Inclusion And Exclusion, Dynamic Programming",0.667,41,23
770,"
Score : 800 points


Problem StatementGiven is a string S consisting of 0 and 1. Find the number of strings, modulo 998244353, that can result from applying the following operation on S between 0 and K times (inclusive):

Choose a pair of integers i, j (1\leq i < j\leq |S|) such that the i-th and j-th characters of S are 0 and 1, respectively. Remove the j-th character from S and insert it to the immediate left of the i-th character.





Constraints
1 \leq |S| \leq 300
0 \leq K \leq 10^9
S consists of 0 and 1.







InputInput is given from Standard Input in the following format:
S K





OutputFind the number of strings, modulo 998244353, that can result from applying the operation on S between 0 and K times (inclusive).






Sample Input 10101 1





Sample Output 14

Four strings, 0101, 0110, 1001, and 1010, can result.





Sample Input 201100110 2





Sample Output 214






Sample Input 31101010010101101110111100011011111011000111101110101010010101010101 20





Sample Output 3113434815


",Shift,"Dyanmic Programming, Combinatorics, Bitmask, Arithmetic, Bruteforcing, Backtracking",0.833,7,6
771,"


Problem StatementAtCoder currently hosts three types of contests: ABC, ARC, and AGC. As the number of users has grown, in order to meet the needs of more users, AtCoder has decided to increase the number of contests to 26 types, from AAC to AZC. For convenience, we number these 26 types as type 1 through type 26. AtCoder wants to schedule contests for D days so that user satisfaction is as high as possible. For every day, AtCoder will hold exactly one contest, and each contest will end on that day. The satisfaction is calculated as follows.

The satisfaction at the beginning of day 1 is 0. Satisfaction can be negative.
Holding contests increases satisfaction. The amount of increase will vary depending on a variety of factors. Specifically, we know in advance that holding a contest of type i on day d will increase the satisfaction by s_{d,i}.
If a particular type of contest is not held for a while, the satisfaction decreases. Each contest type i has an integer c_i, and at the end of each day d=1,2,...,D, the satisfaction decreases as follows. Let \mathrm{last}(d,i) be the last day before day d (including d) on which a contest of type i was held. If contests of type i have never been held yet, we define \mathrm{last}(d,i)=0. At the end of day d, the satisfaction decreases by \sum _{i=1}^{26}c_i \times (d-\mathrm{last}(d,i)).

Please schedule contests on behalf of AtCoder.
If the satisfaction at the end of day D is S, you will get a score of \max(10^6 + S, 0).
There are 50 test cases, and the score of a submission is the total scores for each test case.
You can make submissions multiple times, and the highest score among your submissions will be your score.




Constraints
D = 365
Each c_i is an integer satisfying 0\leq c_i \leq 100.
Each s_{d,i} is an integer satisfying 0\leq s_{d,i} \leq 20000.







InputInput is given from Standard Input in the following format:
D
c_1 c_2 \cdots c_{26}
s_{1,1} s_{1,2} \cdots s_{1,26}
\vdots
s_{D,1} s_{D,2} \cdots s_{D,26}





OutputLet t_d (1\leq t_d \leq 26) be the type of the contest that will be held at day d.
Print D integers t_d to Standard Output in the following format:
t_1
t_2
\vdots
t_D

Any output that does not follow the above format may result in 0 pointsWA for that test case.




Input GenerationEach integer c_i and s_{d,i} is generated independently and uniformly at random from the integers in the range described in the problem statement.






Sample Input 15
86 90 69 51 2 96 71 47 88 34 45 46 89 34 31 38 97 84 41 80 14 4 50 83 7 82
19771 12979 18912 10432 10544 12928 13403 3047 10527 9740 8100 92 2856 14730 1396 15905 6534 4650 11469 3628 8433 2994 10899 16396 18355 11424
6674 17707 13855 16407 12232 2886 11908 1705 5000 1537 10440 10711 4917 10770 17272 15364 19277 18094 3929 3705 7169 6159 18683 15410 9092 4570
6878 4239 19925 1799 375 9563 3445 5658 19857 11401 6997 6498 19933 3848 2426 2146 19745 16880 17773 18359 3921 14172 16730 11157 5439 256
8633 15862 15303 10749 18499 7792 10317 5901 9395 11433 3514 3959 5202 19850 19469 9790 5653 784 18500 10552 17975 16615 7852 197 8471 7452
19855 17918 7990 10572 4333 438 9140 9104 12622 4985 12319 4028 19922 12132 16259 17476 2976 547 19195 19830 16285 4806 4471 9457 2864 2192





Sample Output 11
17
13
14
13

Note that this example is a small one for checking the problem specification. It does not satisfy the constraint D=365 and is never actually given as a test case. The final satisfaction with this output is 79325, so the score is 1079325.
Input generator, score calculator, and visualizer




Beginner's GuideIf you don't know what to do, proceed to problem B or C.

",AtCoder Contest Scheduling,"Greedy Algorithm, Heuristics, Dyanmic Programming, Bit Set, Two-pointer, Mathematics, Data Structure",0.688,287,218
772,"
Score : 100 points


Problem StatementA balance scale tips to the left if L>R, where L is the total weight of the masses on the left pan and R is the total weight of the masses on the right pan. Similarly, it balances if L=R, and tips to the right if L<R.
Takahashi placed a mass of weight A and a mass of weight B on the left pan of a balance scale, and placed a mass of weight C and a mass of weight D on the right pan.
Print Left if the balance scale tips to the left; print Balanced if it balances; print Right if it tips to the right.




Constraints
1\leq A,B,C,D \leq 10
All input values are integers.







InputInput is given from Standard Input in the following format:
A B C D





OutputPrint Left if the balance scale tips to the left; print Balanced if it balances; print Right if it tips to the right.






Sample Input 13 8 7 1





Sample Output 1Left

The total weight of the masses on the left pan is 11, and the total weight of the masses on the right pan is 8. Since 11>8, we should print Left.





Sample Input 23 4 5 2





Sample Output 2Balanced

The total weight of the masses on the left pan is 7, and the total weight of the masses on the right pan is 7. Since 7=7, we should print Balanced.





Sample Input 31 7 6 4





Sample Output 3Right

The total weight of the masses on the left pan is 8, and the total weight of the masses on the right pan is 10. Since 8<10, we should print Right.

",Libra,"Implementation, Arithmetic, Boolean Operations On Geometric Objects",0.773,155,121
773,"
Score : 100 points


Problem StatementWe have a 3×3 square grid, where each square contains a lowercase English letters.
The letter in the square at the i-th row from the top and j-th column from the left is c_{ij}.
Print the string of length 3 that can be obtained by concatenating the letters in the squares on the diagonal connecting the top-left and bottom-right corner of the grid, from the top-left to bottom-right.




Constraints
Input consists of lowercase English letters.







InputInput is given from Standard Input in the following format:
c_{11}c_{12}c_{13}
c_{21}c_{22}c_{23}
c_{31}c_{32}c_{33}





OutputPrint the string of length 3 that can be obtained by concatenating the letters on the diagonal connecting the top-left and bottom-right corner of the grid, from the top-left to bottom-right.






Sample Input 1ant
obe
rec





Sample Output 1abc

The letters in the squares on the diagonal connecting the top-left and bottom-right corner of the grid are a, b and c from top-right to bottom-left. Concatenate these letters and print abc.





Sample Input 2edu
cat
ion





Sample Output 2ean


",Diagonal String,"String, Array",0.831,182,136
774,"
Score : 200 points


Problem StatementWe have a long seat of width X centimeters.
There are many people who wants to sit here. A person sitting on the seat will always occupy an interval of length Y centimeters.
We would like to seat as many people as possible, but they are all very shy, and there must be a gap of length at least Z centimeters between two people, and between the end of the seat and a person.
At most how many people can sit on the seat?




Constraints
All input values are integers.
1 \leq X, Y, Z \leq 10^5
Y+2Z \leq X







InputInput is given from Standard Input in the following format:
X Y Z





OutputPrint the answer.






Sample Input 113 3 1





Sample Output 13

There is just enough room for three, as shown below:


Figure






Sample Input 212 3 1





Sample Output 22






Sample Input 3100000 1 1





Sample Output 349999






Sample Input 464146 123 456





Sample Output 4110






Sample Input 564145 123 456





Sample Output 5109


",ISU,"Arithmetic, Mathematics, Greedy Algorithm",0.784,180,130
775,"
Score : 100 points


Problem StatementYou are given two integers a and b.
Determine if a+b=15 or a\times b=15 or neither holds.
Note that a+b=15 and a\times b=15 do not hold at the same time.




Constraints
1 \leq a,b \leq 15
All values in input are integers.







InputInput is given from Standard Input in the following format:
a b





OutputIf a+b=15, print +;
if a\times b=15, print *;
if neither holds, print x.






Sample Input 14 11





Sample Output 1+

4+11=15.





Sample Input 23 5





Sample Output 2*

3\times 5=15.





Sample Input 31 1





Sample Output 3x

1+1=2 and 1\times 1=1, neither of which is 15.

",F,"Implementation, Arithmetic",0.803,123,77
776,"
Score : 200 points


Problem StatementYou are given a string S consisting of lowercase English letters.
We will write down this string, starting a new line after every w letters. Print the string obtained by concatenating the letters at the beginnings of these lines from top to bottom.




Constraints
1 \leq w \leq |S| \leq 1000
S consists of lowercase English letters.
w is an integer.







InputInput is given from Standard Input in the following format:
S
w





OutputPrint the desired string in one line.






Sample Input 1abcdefgh
3





Sample Output 1adg

When we write down abcdefgh, starting a new line after every three letters, we get the following:
abc
def
gh
Concatenating the letters at the beginnings of these lines, we obtain adg.





Sample Input 2lllll
1





Sample Output 2lllll






Sample Input 3souuundhound
2





Sample Output 3suudon


",Acrostic,"Arithmetic, String",0.824,97,73
777,"
Score : 200 points


Problem StatementLet w be a string consisting of lowercase letters.
We will call w beautiful if the following condition is satisfied:

Each lowercase letter of the English alphabet occurs even number of times in w.

You are given the string w. Determine if w is beautiful.




Constraints
1 \leq |w| \leq 100
w consists of lowercase letters (a-z).







InputThe input is given from Standard Input in the following format:
w





OutputPrint Yes if w is beautiful. Print No otherwise.






Sample Input 1abaccaba





Sample Output 1Yes

a occurs four times, b occurs twice, c occurs twice and the other letters occur zero times.





Sample Input 2hthth





Sample Output 2No


",Beautiful Strings,"Counting, Bruteforcing, Array, Arithmetic",0.793,259,179
778,"
Score : 200 points


Problem StatementAlice, Bob and Charlie are playing Card Game for Three, as below:

At first, each of the three players has a deck consisting of some number of cards. Each card has a letter a, b or c written on it. The orders of the cards in the decks cannot be rearranged.
The players take turns. Alice goes first.
If the current player's deck contains at least one card, discard the top card in the deck. Then, the player whose name begins with the letter on the discarded card, takes the next turn. (For example, if the card says a, Alice takes the next turn.)
If the current player's deck is empty, the game ends and the current player wins the game.

You are given the initial decks of the players.
More specifically, you are given three strings S_A, S_B and S_C. The i-th (1≦i≦|S_A|) letter in S_A is the letter on the i-th card in Alice's initial deck. S_B and S_C describes Bob's and Charlie's initial decks in the same way.
Determine the winner of the game.




Constraints
1≦|S_A|≦100
1≦|S_B|≦100
1≦|S_C|≦100
Each letter in S_A, S_B, S_C is a, b or c.







InputThe input is given from Standard Input in the following format:
S_A
S_B
S_C





OutputIf Alice will win, print A. If Bob will win, print B. If Charlie will win, print C.






Sample Input 1aca
accc
ca





Sample Output 1A

The game will progress as below:

Alice discards the top card in her deck, a. Alice takes the next turn.
Alice discards the top card in her deck, c. Charlie takes the next turn.
Charlie discards the top card in his deck, c. Charlie takes the next turn.
Charlie discards the top card in his deck, a. Alice takes the next turn.
Alice discards the top card in her deck, a. Alice takes the next turn.
Alice's deck is empty. The game ends and Alice wins the game.






Sample Input 2abcb
aacb
bccc





Sample Output 2C


",Card Game for Three (ABC Edit),"Simulation, String, Bruteforcing, Implementation, Dynamic Programming",0.704,256,155
779,"
Score : 200 points


Problem StatementYou are given two positive integers A and B. Compare the magnitudes of these numbers.




Constraints
1 ≤ A, B ≤ 10^{100}
Neither A nor B begins with a 0.







InputInput is given from Standard Input in the following format:
A
B





OutputPrint GREATER if A>B, LESS if A<B and EQUAL if A=B.






Sample Input 136
24





Sample Output 1GREATER

Since 36>24, print GREATER.





Sample Input 2850
3777





Sample Output 2LESS






Sample Input 39720246
22516266





Sample Output 3LESS






Sample Input 4123456789012345678901234567890
234567890123456789012345678901





Sample Output 4LESS


",Comparison,"String, Implementation, Bruteforcing",0.536,203,107
780,"
Score : 500 points


Problem StatementIn Takahashi Kingdom, which once existed, there are N cities, and some pairs of cities are connected bidirectionally by roads.
The following are known about the road network:

People traveled between cities only through roads. It was possible to reach any city from any other city, via intermediate cities if necessary.
Different roads may have had different lengths, but all the lengths were positive integers.

Snuke the archeologist found a table with N rows and N columns, A, in the ruin of Takahashi Kingdom.
He thought that it represented the shortest distances between the cities along the roads in the kingdom.
Determine whether there exists a road network such that for each u and v, the integer A_{u, v} at the u-th row and v-th column of A is equal to the length of the shortest path from City u to City v.
If such a network exist, find the shortest possible total length of the roads.




Constraints
1 \leq N \leq 300
If i ≠ j, 1 \leq A_{i, j} = A_{j, i} \leq 10^9.
A_{i, i} = 0







InputsInput is given from Standard Input in the following format:
N
A_{1, 1} A_{1, 2} ... A_{1, N}
A_{2, 1} A_{2, 2} ... A_{2, N}
...
A_{N, 1} A_{N, 2} ... A_{N, N}





OutputsIf there exists no network that satisfies the condition, print -1.
If it exists, print the shortest possible total length of the roads.






Sample Input 13
0 1 3
1 0 2
3 2 0





Sample Output 13

The network below satisfies the condition:

City 1 and City 2 is connected by a road of length 1.
City 2 and City 3 is connected by a road of length 2.
City 3 and City 1 is not connected by a road.






Sample Input 23
0 1 3
1 0 1
3 1 0





Sample Output 2-1

As there is a path of length 1 from City 1 to City 2 and City 2 to City 3, there is a path of length 2 from City 1 to City 3.
However, according to the table, the shortest distance between City 1 and City 3 must be 3.
Thus, we conclude that there exists no network that satisfies the condition.





Sample Input 35
0 21 18 11 28
21 0 13 10 26
18 13 0 23 13
11 10 23 0 17
28 26 13 17 0





Sample Output 382






Sample Input 43
0 1000000000 1000000000
1000000000 0 1000000000
1000000000 1000000000 0





Sample Output 43000000000


",Restoring Road Network,"Shortest Path, Mathematics, Bruteforcing, Strongly Connected Component, Graph Theory",0.704,42,27
781,"
Score : 500 points


Problem StatementLet N be a positive integer.
There is a numerical sequence of length 3N, a = (a_1, a_2, ..., a_{3N}).
Snuke is constructing a new sequence of length 2N, a', by removing exactly N elements from a without changing the order of the remaining elements.
Here, the score of a' is defined as follows: (the sum of the elements in the first half of a') - (the sum of the elements in the second half of a').
Find the maximum possible score of a'.




Constraints
1 ≤ N ≤ 10^5
a_i is an integer.
1 ≤ a_i ≤ 10^9





Partial Score
In the test set worth 300 points, N ≤ 1000.







InputInput is given from Standard Input in the following format:
N
a_1 a_2 ... a_{3N}





OutputPrint the maximum possible score of a'.






Sample Input 12
3 1 4 1 5 9





Sample Output 11

When a_2 and a_6 are removed, a' will be (3, 4, 1, 5), which has a score of (3 + 4) - (1 + 5) = 1.





Sample Input 21
1 2 3





Sample Output 2-1

For example, when a_1 are removed, a' will be (2, 3), which has a score of 2 - 3 = -1.





Sample Input 33
8 2 2 7 4 6 5 3 8





Sample Output 35

For example, when a_2, a_3 and a_9 are removed, a' will be (8, 7, 4, 6, 5, 3), which has a score of (8 + 7 + 4) - (6 + 5 + 3) = 5.

",3N Numbers,"Priority Queue, Prefix sum, Two-pointer",0.333,36,12
782,"
Score : 400 points


Problem StatementThere is a directed graph with N vertices and M edges.
The i-th edge (1≤i≤M) points from vertex a_i to vertex b_i, and has a weight c_i.
We will play the following single-player game using this graph and a piece.
Initially, the piece is placed at vertex 1, and the score of the player is set to 0.
The player can move the piece as follows:

When the piece is placed at vertex a_i, move the piece along the i-th edge to vertex b_i. After this move, the score of the player is increased by c_i.

The player can end the game only when the piece is placed at vertex N.
The given graph guarantees that it is possible to traverse from vertex 1 to vertex N.
When the player acts optimally to maximize the score at the end of the game, what will the score be?
If it is possible to increase the score indefinitely, print inf.




Constraints
2≤N≤1000 
1≤M≤min(N(N-1),2000) 
1≤a_i,b_i≤N (1≤i≤M) 
a_i≠b_i (1≤i≤M) 
a_i≠a_j or b_i≠b_j (1≤i<j≤M) 
-10^9≤c_i≤10^9 (1≤i≤M)
c_i is an integer.
In the given graph, there exists a path from vertex 1 to vertex N.







InputInput is given from Standard Input in the following format:  
N M  
a_1 b_1 c_1  
a_2 b_2 c_2
:  
a_M b_M c_M  





OutputPrint the maximum possible score at the end of the game, if it is finite. If it is possible to increase the score indefinitely, print inf.  






Sample Input 13 3
1 2 4
2 3 3
1 3 5





Sample Output 17

There are two ways to move the piece to vertex N=3:

vertex 1 → vertex 2 → vertex 3 : score 4+3=7
vertex 1 → vertex 3 : score 5

Thus, the maximum possible score at the end of the game is 7.





Sample Input 22 2
1 2 1
2 1 1





Sample Output 2inf

It is possible to increase the score indefinitely by alternating between vertex 1 and 2.





Sample Input 36 5
1 2 -1000000000
2 3 -1000000000
3 4 -1000000000
4 5 -1000000000
5 6 -1000000000





Sample Output 3-5000000000


",Score Attack,"Graph Theory, Directed Acyclic Graph, Shortest Path, Graph Traversal",0.217,167,20
783,"
Score : 600 points


Problem StatementA bracket sequence is a string that is one of the following:

An empty string;
The concatenation of (, A, and ) in this order, for some bracket sequence A ;
The concatenation of A and B in this order, for some non-empty bracket sequences A and B /

Given are N strings S_i. Can a bracket sequence be formed by concatenating all the N strings in some order?




Constraints
1 \leq N \leq 10^6
The total length of the strings S_i is at most 10^6.
S_i is a non-empty string consisting of ( and ).







InputInput is given from Standard Input in the following format:
N
S_1
:
S_N





OutputIf a bracket sequence can be formed by concatenating all the N strings in some order, print Yes; otherwise, print No.






Sample Input 12
)
(()





Sample Output 1Yes

Concatenating (() and ) in this order forms a bracket sequence.





Sample Input 22
)(
()





Sample Output 2No






Sample Input 34
((()))
((((((
))))))
()()()





Sample Output 3Yes






Sample Input 43
(((
)
)





Sample Output 4No


",Bracket Sequencing,"Greedy Algorithm, Sorting, Prefix sum, Stack, Divide And Conquer",0.057,209,22
784,"
Score : 400 points


Problem StatementThe ABC number of a string T is the number of triples of integers (i, j, k) that satisfy all of the following conditions:

1 ≤ i < j < k ≤ |T| (|T| is the length of T.)
T_i = A (T_i is the i-th character of T from the beginning.)
T_j = B
T_k = C

For example, when T = ABCBC, there are three triples of integers (i, j, k) that satisfy the conditions: (1, 2, 3), (1, 2, 5), (1, 4, 5). Thus, the ABC number of T is 3.
You are given a string S. Each character of S is A, B, C or ?.
Let Q be the number of occurrences of ? in S. We can make 3^Q strings by replacing each occurrence of ? in S with A, B or C. Find the sum of the ABC numbers of all these strings.
This sum can be extremely large, so print the sum modulo 10^9 + 7.




Constraints
3 ≤ |S| ≤ 10^5
Each character of S is A, B, C or ?.







InputInput is given from Standard Input in the following format:
S





OutputPrint the sum of the ABC numbers of all the 3^Q strings, modulo 10^9 + 7.






Sample Input 1A??C





Sample Output 18

In this case, Q = 2, and we can make 3^Q = 9 strings by by replacing each occurrence of ? with A, B or C. The ABC number of each of these strings is as follows:

AAAC: 0
AABC: 2
AACC: 0
ABAC: 1
ABBC: 2
ABCC: 2
ACAC: 0
ACBC: 1
ACCC: 0

The sum of these is 0 + 2 + 0 + 1 + 2 + 2 + 0 + 1 + 0 = 8, so we print 8 modulo 10^9 + 7, that is, 8.





Sample Input 2ABCBC





Sample Output 23

When Q = 0, we print the ABC number of S itself, modulo 10^9 + 7. This string is the same as the one given as an example in the problem statement, and its ABC number is 3.





Sample Input 3????C?????B??????A???????





Sample Output 3979596887

In this case, the sum of the ABC numbers of all the 3^Q strings is 2291979612924, and we should print this number modulo 10^9 + 7, that is, 979596887.

",We Love ABC,"Dyanmic Programming, Combinatorics, Arithmetic, String",0.583,54,24
785,"
Score : 400 points


Problem StatementFennec and Snuke are playing a board game.
On the board, there are N cells numbered 1 through N, and N-1 roads, each connecting two cells. Cell a_i is adjacent to Cell b_i through the i-th road. Every cell can be reached from every other cell by repeatedly traveling to an adjacent cell. In terms of graph theory, the graph formed by the cells and the roads is a tree.
Initially, Cell 1 is painted black, and Cell N is painted white. The other cells are not yet colored.
Fennec (who goes first) and Snuke (who goes second) alternately paint an uncolored cell.
More specifically, each player performs the following action in her/his turn:

Fennec: selects an uncolored cell that is adjacent to a black cell, and paints it black.
Snuke: selects an uncolored cell that is adjacent to a white cell, and paints it white.

A player loses when she/he cannot paint a cell. Determine the winner of the game when Fennec and Snuke play optimally.




Constraints
2 \leq N \leq 10^5
1 \leq a_i, b_i \leq N
The given graph is a tree.







InputInput is given from Standard Input in the following format:
N
a_1 b_1
:
a_{N-1} b_{N-1}





OutputIf Fennec wins, print Fennec; if Snuke wins, print Snuke.






Sample Input 17
3 6
1 2
3 1
7 4
5 7
1 4





Sample Output 1Fennec

For example, if Fennec first paints Cell 2 black, she will win regardless of Snuke's moves.





Sample Input 24
1 4
4 2
2 3





Sample Output 2Snuke


",Fennec VS. Snuke,"Graph Theory, Graph Traversal, Breadth-first Search, Geometry; 3d, Arithmetic",0.308,70,25
786,"
Score : 600 points


Problem StatementGiven are a sequence of N positive integers A_1, A_2, \ldots, A_N and another positive integer S.
For a non-empty subset T of the set \{1, 2, \ldots , N \}, let us define f(T) as follows:

f(T) is the number of different non-empty subsets \{x_1, x_2, \ldots , x_k \} of T such that A_{x_1}+A_{x_2}+\cdots +A_{x_k} = S.

Find the sum of f(T) over all 2^N-1 subsets T of \{1, 2, \ldots , N \}. Since the sum can be enormous, print it modulo 998244353.




Constraints
All values in input are integers.
1 \leq N \leq 3000
1 \leq S \leq 3000
1 \leq A_i \leq 3000







InputInput is given from Standard Input in the following format:
N S
A_1 A_2 ... A_N





OutputPrint the sum of f(T) modulo 998244353.






Sample Input 13 4
2 2 4





Sample Output 16

For each T, the value of f(T) is shown below. The sum of these values is 6.

f(\{1\}) = 0
f(\{2\}) = 0
f(\{3\}) = 1 (One subset \{3\} satisfies the condition.)
f(\{1, 2\}) = 1 (\{1, 2\})
f(\{2, 3\}) = 1 (\{3\})
f(\{1, 3\}) = 1 (\{3\})
f(\{1, 2, 3\}) = 2 (\{1, 2\}, \{3\})






Sample Input 25 8
9 9 9 9 9





Sample Output 20






Sample Input 310 10
3 1 4 1 5 9 2 6 5 3





Sample Output 33296


",Knapsack for All Subsets,"Dyanmic Programming, Combinatorics, Arithmetic, Bitmask",0.6,82,39
787,"
Score : 600 points


Problem StatementSnuke, a water strider, lives in a rectangular pond that can be seen as a grid with H east-west rows and W north-south columns. Let (i,j) be the square at the i-th row from the north and j-th column from the west.
Some of the squares have a lotus leaf on it and cannot be entered.
The square (i,j) has a lotus leaf on it if c_{ij} is @, and it does not if c_{ij} is ..
In one stroke, Snuke can move between 1 and K squares (inclusive) toward one of the four directions: north, east, south, and west.
The move may not pass through a square with a lotus leaf. Moving to such a square or out of the pond is also forbidden.
Find the minimum number of strokes Snuke takes to travel from the square (x_1,y_1) to (x_2,y_2).
If the travel from (x_1,y_1) to (x_2,y_2) is impossible, point out that fact.




Constraints
1 \leq H,W,K \leq 10^6
H \times W \leq 10^6
1 \leq x_1,x_2 \leq H
1 \leq y_1,y_2 \leq W
x_1 \neq x_2 or y_1 \neq y_2.
c_{i,j} is . or @.
c_{x_1,y_1} = .
c_{x_2,y_2} = .
All numbers in input are integers.







InputInput is given from Standard Input in the following format:
H W K
x_1 y_1 x_2 y_2
c_{1,1}c_{1,2} .. c_{1,W}
c_{2,1}c_{2,2} .. c_{2,W}
:
c_{H,1}c_{H,2} .. c_{H,W}





OutputPrint the minimum number of strokes Snuke takes to travel from the square (x_1,y_1) to (x_2,y_2), or print -1 if the travel is impossible.






Sample Input 13 5 2
3 2 3 4
.....
.@..@
..@..





Sample Output 15

Initially, Snuke is at the square (3,2).
He can reach the square (3, 4) by making five strokes as follows:


From (3, 2), go west one square to (3, 1).


From (3, 1), go north two squares to (1, 1).


From (1, 1), go east two squares to (1, 3).


From (1, 3), go east one square to (1, 4).


From (1, 4), go south two squares to (3, 4).







Sample Input 21 6 4
1 1 1 6
......





Sample Output 22






Sample Input 33 3 1
2 1 2 3
.@.
.@.
.@.





Sample Output 3-1


",Pond Skater,"Grid Graph, Breadth-first Search, Shortest Path, Segment Tree, Tree, Array, Backtracking",0.073,212,33
788,"
Score: 400 points


Problem Statement
In Takahashi Kingdom, there is a east-west railroad and N cities along it, numbered 1, 2, 3, ..., N from west to east.
A company called AtCoder Express possesses M trains, and the train i runs from City L_i to City R_i (it is possible that L_i = R_i).
Takahashi the king is interested in the following Q matters:

The number of the trains that runs strictly within the section from City p_i to City q_i, that is, the number of trains j such that p_i \leq L_j and R_j \leq q_i.

Although he is genius, this is too much data to process by himself. Find the answer for each of these Q queries to help him.




Constraints

N is an integer between 1 and 500 (inclusive).
M is an integer between 1 and 200 \ 000 (inclusive).
Q is an integer between 1 and 100 \ 000 (inclusive).
1 \leq L_i \leq R_i \leq N (1 \leq i \leq M)
1 \leq p_i \leq q_i \leq N (1 \leq i \leq Q)







Input
Input is given from Standard Input in the following format:
N M Q
L_1 R_1
L_2 R_2
:
L_M R_M
p_1 q_1
p_2 q_2
:
p_Q q_Q





Output
Print Q lines. The i-th line should contain the number of the trains that runs strictly within the section from City p_i to City q_i.






Sample Input 12 3 1
1 1
1 2
2 2
1 2





Sample Output 13

As all the trains runs within the section from City 1 to City 2, the answer to the only query is 3.





Sample Input 210 3 2
1 5
2 8
7 10
1 7
3 10





Sample Output 21
1

The first query is on the section from City 1 to 7. There is only one train that runs strictly within that section: Train 1.
The second query is on the section from City 3 to 10. There is only one train that runs strictly within that section: Train 3.





Sample Input 310 10 10
1 6
2 9
4 5
4 7
4 7
5 8
6 6
6 7
7 9
10 10
1 8
1 9
1 10
2 8
2 9
2 10
3 8
3 9
3 10
1 10





Sample Output 37
9
10
6
8
9
6
7
8
10


",AtCoder Express 2,"Prefix sum, Counting, Inclusion And Exclusion, Matrix, Precomputation",0.484,123,48
789,"
Score : 700 points


Problem StatementYou are given an integer L. Construct a directed graph that satisfies the conditions below. The graph may contain multiple edges between the same pair of vertices. It can be proved that such a graph always exists.

The number of vertices, N, is at most 20. The vertices are given ID numbers from 1 to N.
The number of edges, M, is at most 60. Each edge has an integer length between 0 and 10^6 (inclusive).
Every edge is directed from the vertex with the smaller ID to the vertex with the larger ID. That is, 1,2,...,N is one possible topological order of the vertices.
There are exactly L different paths from Vertex 1 to Vertex N. The lengths of these paths are all different, and they are integers between 0 and L-1.

Here, the length of a path is the sum of the lengths of the edges contained in that path, and two paths are considered different when the sets of the edges contained in those paths are different.




Constraints
2 \leq L \leq 10^6
L is an integer.







InputInput is given from Standard Input in the following format:
L





OutputIn the first line, print N and M, the number of the vertices and edges in your graph.
In the i-th of the following M lines, print three integers u_i,v_i and w_i, representing the starting vertex, the ending vertex and the length of the i-th edge.
If there are multiple solutions, any of them will be accepted.






Sample Input 14





Sample Output 18 10
1 2 0
2 3 0
3 4 0
1 5 0
2 6 0
3 7 0
4 8 0
5 6 1
6 7 1
7 8 1

In the graph represented by the sample output, there are four paths from Vertex 1 to N=8:

1 → 2 → 3 → 4 → 8 with length 0
1 → 2 → 3 → 7 → 8 with length 1
1 → 2 → 6 → 7 → 8 with length 2
1 → 5 → 6 → 7 → 8 with length 3

There are other possible solutions.





Sample Input 25





Sample Output 25 7
1 2 0
2 3 1
3 4 0
4 5 0
2 4 0
1 3 3
3 5 1


",All Your Paths are Different Lengths,"Bitmask, Directed Acyclic Graph, Graph Theory, Greedy Algorithm",0.333,29,9
790,"
Score: 400 points


Problem StatementAmidakuji is a traditional method of lottery in Japan.
To make an amidakuji, we first draw W parallel vertical lines, and then draw horizontal lines that connect them. The length of each vertical line is H+1 [cm], and the endpoints of the horizontal lines must be at 1, 2, 3, ..., or H [cm] from the top of a vertical line.
A valid amidakuji is an amidakuji that satisfies the following conditions:

No two horizontal lines share an endpoint.
The two endpoints of each horizontal lines must be at the same height.
A horizontal line must connect adjacent vertical lines.


Find the number of the valid amidakuji that satisfy the following condition, modulo 1\ 000\ 000\ 007: if we trace the path from the top of the leftmost vertical line to the bottom, always following horizontal lines when we encounter them, we reach the bottom of the K-th vertical line from the left.
For example, in the following amidakuji, we will reach the bottom of the fourth vertical line from the left.





Constraints
H is an integer between 1 and 100 (inclusive).
W is an integer between 1 and 8 (inclusive).
K is an integer between 1 and W (inclusive).







InputInput is given from Standard Input in the following format:
H W K





OutputPrint the number of the amidakuji that satisfy the condition, modulo 1\ 000\ 000\ 007.






Sample Input 11 3 2





Sample Output 11

Only the following one amidakuji satisfies the condition:






Sample Input 21 3 1





Sample Output 22

Only the following two amidakuji satisfy the condition:






Sample Input 32 3 3





Sample Output 31

Only the following one amidakuji satisfies the condition:






Sample Input 42 3 1





Sample Output 45

Only the following five amidakuji satisfy the condition:






Sample Input 57 1 1





Sample Output 51

As there is only one vertical line, we cannot draw any horizontal lines. Thus, there is only one amidakuji that satisfies the condition: the amidakuji with no horizontal lines.





Sample Input 615 8 5





Sample Output 6437760187

Be sure to print the answer modulo 1\ 000\ 000\ 007.

",Number of Amidakuji,"Bitmask, Dyanmic Programming, Combinatorics, Arithmetic, Enumeration",0.773,37,28
791,"
Score : 100 points


Problem StatementThere is a set A = \{ a_1, a_2, \ldots, a_N \} consisting of N positive integers.
Taro and Jiro will play the following game against each other.
Initially, we have a pile consisting of K stones.
The two players perform the following operation alternately, starting from Taro:

Choose an element x in A, and remove exactly x stones from the pile.

A player loses when he becomes unable to play.
Assuming that both players play optimally, determine the winner.




Constraints
All values in input are integers.
1 \leq N \leq 100
1 \leq K \leq 10^5
1 \leq a_1 < a_2 < \cdots < a_N \leq K







InputInput is given from Standard Input in the following format:
N K
a_1 a_2 \ldots a_N





OutputIf Taro will win, print First; if Jiro will win, print Second.






Sample Input 12 4
2 3





Sample Output 1First

If Taro removes three stones, Jiro cannot make a move.
Thus, Taro wins.





Sample Input 22 5
2 3





Sample Output 2Second

Whatever Taro does in his operation, Jiro wins, as follows:

If Taro removes two stones, Jiro can remove three stones to make Taro unable to make a move.
If Taro removes three stones, Jiro can remove two stones to make Taro unable to make a move.






Sample Input 32 7
2 3





Sample Output 3First

Taro should remove two stones. Then, whatever Jiro does in his operation, Taro wins, as follows:

If Jiro removes two stones, Taro can remove three stones to make Jiro unable to make a move.
If Jiro removes three stones, Taro can remove two stones to make Jiro unable to make a move.






Sample Input 43 20
1 2 3





Sample Output 4Second






Sample Input 53 21
1 2 3





Sample Output 5First






Sample Input 61 100000
1





Sample Output 6Second


",Stones,"Dyanmic Programming, Game Theory, Mathematics, Array",0.735,258,160
792,"
Score : 100 points


Problem StatementThere are N slimes lining up in a row.
Initially, the i-th slime from the left has a size of a_i.
Taro is trying to combine all the slimes into a larger slime.
He will perform the following operation repeatedly until there is only one slime:

Choose two adjacent slimes, and combine them into a new slime. The new slime has a size of x + y, where x and y are the sizes of the slimes before combining them. Here, a cost of x + y is incurred. The positional relationship of the slimes does not change while combining slimes.

Find the minimum possible total cost incurred.




Constraints
All values in input are integers.
2 \leq N \leq 400
1 \leq a_i \leq 10^9







InputInput is given from Standard Input in the following format:
N
a_1 a_2 \ldots a_N





OutputPrint the minimum possible total cost incurred.






Sample Input 14
10 20 30 40





Sample Output 1190

Taro should do as follows (slimes being combined are shown in bold):

(10, 20, 30, 40) → (30, 30, 40)
(30, 30, 40) → (60, 40)
(60, 40) → (100)






Sample Input 25
10 10 10 10 10





Sample Output 2120

Taro should do, for example, as follows:

(10, 10, 10, 10, 10) → (20, 10, 10, 10)
(20, 10, 10, 10) → (20, 20, 10)
(20, 20, 10) → (20, 30)
(20, 30) → (50)






Sample Input 33
1000000000 1000000000 1000000000





Sample Output 35000000000

The answer may not fit into a 32-bit integer type.





Sample Input 46
7 6 8 6 1 1





Sample Output 468

Taro should do, for example, as follows:

(7, 6, 8, 6, 1, 1) → (7, 6, 8, 6, 2)
(7, 6, 8, 6, 2) → (7, 6, 8, 8)
(7, 6, 8, 8) → (13, 8, 8)
(13, 8, 8) → (13, 16)
(13, 16) → (29)


",Slimes,"Dyanmic Programming, Prefix sum, Dynamic Programming, Mathematics, Dynamic Programming, Arithmetic",0.643,191,119
793,"
Score : 400 points


Problem StatementJoisino the magical girl has decided to turn every single digit that exists on this world into 1.
Rewriting a digit i with j (0≤i,j≤9) costs c_{i,j} MP (Magic Points).
She is now standing before a wall. The wall is divided into HW squares in H rows and W columns, and at least one square contains a digit between 0 and 9 (inclusive).
You are given A_{i,j} that describes the square at the i-th row from the top and j-th column from the left, as follows:

If A_{i,j}≠-1, the square contains a digit A_{i,j}.
If A_{i,j}=-1, the square does not contain a digit.

Find the minimum total amount of MP required to turn every digit on this wall into 1 in the end.




Constraints
1≤H,W≤200
1≤c_{i,j}≤10^3 (i≠j)
c_{i,j}=0 (i=j)
-1≤A_{i,j}≤9
All input values are integers.
There is at least one digit on the wall.







InputInput is given from Standard Input in the following format:
H W
c_{0,0} ... c_{0,9}
:
c_{9,0} ... c_{9,9}
A_{1,1} ... A_{1,W}
:
A_{H,1} ... A_{H,W}





OutputPrint the minimum total amount of MP required to turn every digit on the wall into 1 in the end.






Sample Input 12 4
0 9 9 9 9 9 9 9 9 9
9 0 9 9 9 9 9 9 9 9
9 9 0 9 9 9 9 9 9 9
9 9 9 0 9 9 9 9 9 9
9 9 9 9 0 9 9 9 9 2
9 9 9 9 9 0 9 9 9 9
9 9 9 9 9 9 0 9 9 9
9 9 9 9 9 9 9 0 9 9
9 9 9 9 2 9 9 9 0 9
9 2 9 9 9 9 9 9 9 0
-1 -1 -1 -1
8 1 1 8





Sample Output 112

To turn a single 8 into 1, it is optimal to first turn 8 into 4, then turn 4 into 9, and finally turn 9 into 1, costing 6 MP.
The wall contains two 8s, so the minimum total MP required is 6×2=12.





Sample Input 25 5
0 999 999 999 999 999 999 999 999 999
999 0 999 999 999 999 999 999 999 999
999 999 0 999 999 999 999 999 999 999
999 999 999 0 999 999 999 999 999 999
999 999 999 999 0 999 999 999 999 999
999 999 999 999 999 0 999 999 999 999
999 999 999 999 999 999 0 999 999 999
999 999 999 999 999 999 999 0 999 999
999 999 999 999 999 999 999 999 0 999
999 999 999 999 999 999 999 999 999 0
1 1 1 1 1
1 1 1 1 1
1 1 1 1 1
1 1 1 1 1
1 1 1 1 1





Sample Output 20

Note that she may not need to change any digit.





Sample Input 33 5
0 4 3 6 2 7 2 5 3 3
4 0 5 3 7 5 3 7 2 7
5 7 0 7 2 9 3 2 9 1
3 6 2 0 2 4 6 4 2 3
3 5 7 4 0 6 9 7 6 7
9 8 5 2 2 0 4 7 6 5
5 4 6 3 2 3 0 5 4 3
3 6 2 3 4 2 4 0 8 9
4 6 5 4 3 5 3 2 0 8
2 1 3 4 5 7 8 6 4 0
3 5 2 6 1
2 5 3 2 1
6 9 2 5 6





Sample Output 347


",Wall,"Floyd-warshall, Array, Bruteforcing, Dyanmic Programming, Grid Graph",0.741,94,60
794,"
Score : 400 points


Problem StatementWe have a grid with H rows and W columns. The square at the i-th row and the j-th column will be called Square (i,j).
The integers from 1 through H×W are written throughout the grid, and the integer written in Square (i,j) is A_{i,j}.
You, a magical girl, can teleport a piece placed on Square (i,j) to Square (x,y) by consuming |x-i|+|y-j| magic points.
You now have to take Q practical tests of your ability as a magical girl.
The i-th test will be conducted as follows:


Initially, a piece is placed on the square where the integer L_i is written.


Let x be the integer written in the square occupied by the piece. Repeatedly move the piece to the square where the integer x+D is written, as long as x is not R_i. The test ends when x=R_i.


Here, it is guaranteed that R_i-L_i is a multiple of D.


For each test, find the sum of magic points consumed during that test.




Constraints
1 \leq H,W \leq 300
1 \leq D \leq H×W
1 \leq A_{i,j} \leq H×W
A_{i,j} \neq A_{x,y} ((i,j) \neq (x,y))
1 \leq Q \leq 10^5
1 \leq L_i \leq R_i \leq H×W
(R_i-L_i) is a multiple of D.







InputInput is given from Standard Input in the following format:
H W D
A_{1,1} A_{1,2} ... A_{1,W}
:
A_{H,1} A_{H,2} ... A_{H,W}
Q
L_1 R_1
:
L_Q R_Q





OutputFor each test, print the sum of magic points consumed during that test.
Output should be in the order the tests are conducted.






Sample Input 13 3 2
1 4 3
2 5 7
8 9 6
1
4 8





Sample Output 15



4 is written in Square (1,2).


6 is written in Square (3,3).


8 is written in Square (3,1).


Thus, the sum of magic points consumed during the first test is (|3-1|+|3-2|)+(|3-3|+|1-3|)=5.





Sample Input 24 2 3
3 7
1 4
5 2
6 8
2
2 2
2 2





Sample Output 20
0

Note that there may be a test where the piece is not moved at all, and there may be multiple identical tests.





Sample Input 35 5 4
13 25 7 15 17
16 22 20 2 9
14 11 12 1 19
10 6 23 8 18
3 21 5 24 4
3
13 13
2 10
13 13





Sample Output 30
5
0


",Practical Skill Test,"Array, Geometry; 3d, Prefix sum, Precomputation, Bruteforcing",0.233,217,54
795,"
Score : 300 points


Problem StatementAs a token of his gratitude, Takahashi has decided to give his mother an integer sequence.
The sequence A needs to satisfy the conditions below:

A consists of integers between X and Y (inclusive).
For each 1\leq i \leq |A|-1, A_{i+1} is a multiple of A_i and strictly greater than A_i.

Find the maximum possible length of the sequence.




Constraints
1 \leq X \leq Y \leq 10^{18}
All input values are integers.







InputInput is given from Standard Input in the following format:
X Y





OutputPrint the maximum possible length of the sequence.






Sample Input 13 20





Sample Output 13

The sequence 3,6,18 satisfies the conditions.





Sample Input 225 100





Sample Output 23






Sample Input 3314159265 358979323846264338





Sample Output 331


",Multiple Gift,"Bruteforcing, Greedy Algorithm, Arithmetic",0.775,65,41
796,"
Score : 200 points


Problem StatementTakahashi lives in another world. There are slimes (creatures) of 10000 colors in this world. Let us call these colors Color 1, 2, ..., 10000.
Takahashi has N slimes, and they are standing in a row from left to right. The color of the i-th slime from the left is a_i.
If two slimes of the same color are adjacent, they will start to combine themselves. Because Takahashi likes smaller slimes, he has decided to change the colors of some of the slimes with his magic.
Takahashi can change the color of one slime to any of the 10000 colors by one spell.
How many spells are required so that no slimes will start to combine themselves?




Constraints
2 \leq N \leq 100
1 \leq a_i \leq N
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
a_1 a_2 ... a_N





OutputPrint the minimum number of spells required.






Sample Input 15
1 1 2 2 2





Sample Output 12

For example, if we change the color of the second slime from the left to 4, and the color of the fourth slime to 5, the colors of the slimes will be 1, 4, 2, 5, 2, which satisfy the condition.





Sample Input 23
1 2 1





Sample Output 20

Although the colors of the first and third slimes are the same, they are not adjacent, so no spell is required.





Sample Input 35
1 1 1 1 1





Sample Output 32

For example, if we change the colors of the second and fourth slimes from the left to 2, the colors of the slimes will be 1, 2, 1, 2, 1, which satisfy the condition.





Sample Input 414
1 2 2 3 3 3 4 4 4 4 1 2 3 4





Sample Output 44


",Colorful Slimes 2,"Greedy Algorithm, Array, Arithmetic",0.841,118,88
797,"
Score : 200 points


Problem StatementIt is November 18 now in Japan. By the way, 11 and 18 are adjacent Lucas numbers.
You are given an integer N. Find the N-th Lucas number.
Here, the i-th Lucas number L_i is defined as follows:

L_0=2
L_1=1
L_i=L_{i-1}+L_{i-2} (i≥2)





Constraints
1≤N≤86
It is guaranteed that the answer is less than 10^{18}.
N is an integer.







InputInput is given from Standard Input in the following format:
N





OutputPrint the N-th Lucas number.






Sample Input 15





Sample Output 111


L_0=2
L_1=1
L_2=L_0+L_1=3
L_3=L_1+L_2=4
L_4=L_2+L_3=7
L_5=L_3+L_4=11

Thus, the 5-th Lucas number is 11.





Sample Input 286





Sample Output 2939587134549734843


",Lucas Number,"Dyanmic Programming, Mathematics, Bruteforcing, Array",0.581,219,125
798,"
Score : 200 points


Problem StatementThere are N rabbits, numbered 1 through N.
The i-th (1≤i≤N) rabbit likes rabbit a_i.
Note that no rabbit can like itself, that is, a_i≠i.
For a pair of rabbits i and j (i＜j), we call the pair (i，j) a friendly pair if the following condition is met.

Rabbit i likes rabbit j and rabbit j likes rabbit i.

Calculate the number of the friendly pairs.




Constraints
2≤N≤10^5
1≤a_i≤N
a_i≠i







InputThe input is given from Standard Input in the following format:
N
a_1 a_2 ... a_N





OutputPrint the number of the friendly pairs.






Sample Input 14
2 1 4 3





Sample Output 12

There are two friendly pairs: (1，2) and (3，4).





Sample Input 23
2 3 1





Sample Output 20

There are no friendly pairs.





Sample Input 35
5 5 5 5 1





Sample Output 31

There is one friendly pair: (1，5).

",Friendly Rabbits,"Array, Bruteforcing, Graph Theory, Counting, Implementation",0.844,103,73
799,"
Score : 300 points


Problem StatementTak has N cards. On the i-th (1 \leq i \leq N) card is written an integer x_i.
He is selecting one or more cards from these N cards, so that the average of the integers written on the selected cards is exactly A.
In how many ways can he make his selection?




Constraints
1 \leq N \leq 50
1 \leq A \leq 50
1 \leq x_i \leq 50
N,\,A,\,x_i are integers.





Partial Score
200 points will be awarded for passing the test set satisfying 1 \leq N \leq 16.







InputThe input is given from Standard Input in the following format:
N A
x_1 x_2 ... x_N





OutputPrint the number of ways to select cards such that the average of the written integers is exactly A.






Sample Input 14 8
7 9 8 9





Sample Output 15


The following are the 5 ways to select cards such that the average is 8:
Select the 3-rd card.
Select the 1-st and 2-nd cards.
Select the 1-st and 4-th cards.
Select the 1-st, 2-nd and 3-rd cards.
Select the 1-st, 3-rd and 4-th cards.








Sample Input 23 8
6 6 9





Sample Output 20






Sample Input 38 5
3 6 2 8 7 6 5 9





Sample Output 319






Sample Input 433 3
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3





Sample Output 48589934591


The answer may not fit into a 32-bit integer.


",Tak and Cards,"Dyanmic Programming, Dynamic Programming, Combinatorics, Graph Theory, Arithmetic",0.308,126,48
800,"
Score : 500 points


Problem StatementFor integers b (b \geq 2) and n (n \geq 1), let the function f(b,n) be defined as follows:

f(b,n) = n, when n < b
f(b,n) = f(b,\,{\rm floor}(n / b)) + (n \ {\rm mod} \ b), when n \geq b

Here, {\rm floor}(n / b) denotes the largest integer not exceeding n / b,
and n \ {\rm mod} \ b denotes the remainder of n divided by b.
Less formally, f(b,n) is equal to the sum of the digits of n written in base b.
For example, the following hold:

f(10,\,87654)=8+7+6+5+4=30
f(100,\,87654)=8+76+54=138

You are given integers n and s.
Determine if there exists an integer b (b \geq 2) such that f(b,n)=s.
If the answer is positive, also find the smallest such b.




Constraints
1 \leq n \leq 10^{11}
1 \leq s \leq 10^{11}
n,\,s are integers.







InputThe input is given from Standard Input in the following format:
n
s





OutputIf there exists an integer b (b \geq 2) such that f(b,n)=s, print the smallest such b.
If such b does not exist, print -1 instead.






Sample Input 187654
30





Sample Output 110






Sample Input 287654
138





Sample Output 2100






Sample Input 387654
45678





Sample Output 3-1






Sample Input 431415926535
1





Sample Output 431415926535






Sample Input 51
31415926535





Sample Output 5-1


",Digit Sum,"Recursion, Arithmetic, Number Theory, Mathematics, Greedy Algorithm",0.2,43,9
801,"
Score : 400 points


Problem StatementWe have a grid with H rows and W columns. At first, all cells were painted white.
Snuke painted N of these cells. The i-th ( 1 \leq i \leq N ) cell he painted is the cell at the a_i-th row and b_i-th column.
Compute the following:

For each integer j ( 0 \leq j \leq 9 ), how many subrectangles of size 3×3 of the grid contains exactly j black cells, after Snuke painted N cells?





Constraints
3 \leq H \leq 10^9
3 \leq W \leq 10^9
0 \leq N \leq min(10^5,H×W)
1 \leq a_i \leq H (1 \leq i \leq N)
1 \leq b_i \leq W (1 \leq i \leq N)
(a_i, b_i) \neq (a_j, b_j) (i \neq j)







InputThe input is given from Standard Input in the following format:
H W N
a_1 b_1
:
a_N b_N





OutputPrint 10 lines.
The (j+1)-th ( 0 \leq j \leq 9 ) line should contain the number of the subrectangles of size 3×3 of the grid that contains exactly j black cells.






Sample Input 14 5 8
1 1
1 4
1 5
2 3
3 1
3 2
3 4
4 4





Sample Output 10
0
0
2
4
0
0
0
0
0


There are six subrectangles of size 3×3. Two of them contain three black cells each, and the remaining four contain four black cells each.





Sample Input 210 10 20
1 1
1 4
1 9
2 5
3 10
4 2
4 7
5 9
6 4
6 6
6 7
7 1
7 3
7 7
8 1
8 5
8 10
9 2
10 4
10 9





Sample Output 24
26
22
10
2
0
0
0
0
0






Sample Input 31000000000 1000000000 0





Sample Output 3999999996000000004
0
0
0
0
0
0
0
0
0


",Snuke's Coloring,"Set / Map, Bruteforcing, Geometry; 3d, Counting, Implementation",0.227,47,14
802,"
Score : 100 points


Problem StatementYou are given four digits N_1, N_2, N_3 and N_4. Determine if these can be arranged into the sequence of digits ""1974"".




Constraints
0 \leq N_1, N_2, N_3, N_4 \leq 9
N_1, N_2, N_3 and N_4 are integers.







InputInput is given from Standard Input in the following format:
N_1 N_2 N_3 N_4





OutputIf N_1, N_2, N_3 and N_4 can be arranged into the sequence of digits ""1974"", print YES; if they cannot, print NO.






Sample Input 11 7 9 4





Sample Output 1YES

We can get 1974 by swapping N_2 and N_3.





Sample Input 21 9 7 4





Sample Output 2YES

We already have 1974 before doing anything.





Sample Input 31 2 9 1





Sample Output 3NO






Sample Input 44 9 0 8





Sample Output 4NO


",Beginning,"Sorting, Array, Boolean Operations On Geometric Objects, Implementation",0.678,111,56
803,"
Score : 300 points


Problem StatementSnuke and Raccoon have a heap of N cards. The i-th card from the top has the integer a_i written on it.
They will share these cards.
First, Snuke will take some number of cards from the top of the heap, then Raccoon will take all the remaining cards.
Here, both Snuke and Raccoon have to take at least one card.
Let the sum of the integers on Snuke's cards and Raccoon's cards be x and y, respectively.
They would like to minimize |x-y|.
Find the minimum possible value of |x-y|.




Constraints
2 \leq N \leq 2 \times 10^5
-10^{9} \leq a_i \leq 10^{9}
a_i is an integer.







InputInput is given from Standard Input in the following format:
N
a_1 a_2 ... a_{N}





OutputPrint the answer.






Sample Input 16
1 2 3 4 5 6





Sample Output 11

If Snuke takes four cards from the top, and Raccoon takes the remaining two cards, x=10, y=11, and thus |x-y|=1. This is the minimum possible value.





Sample Input 22
10 -10





Sample Output 220

Snuke can only take one card from the top, and Raccoon can only take the remaining one card. In this case, x=10, y=-10, and thus |x-y|=20.

",Splitting Pile,"Prefix sum, Bruteforcing, Arithmetic, Greedy Algorithm",0.356,233,73
804,"
Score : 500 points


Problem StatementThere is an apple tree that bears apples of N colors. The N colors of these apples are numbered 1 to N, and there are a_i apples of Color i.
You and Lunlun the dachshund alternately perform the following operation (starting from you):

Choose one or more apples from the tree and eat them. Here, the apples chosen at the same time must all have different colors.

The one who eats the last apple from the tree will be declared winner. If both you and Lunlun play optimally, which will win?




Constraints
1 \leq N \leq 10^5
1 \leq a_i \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
a_1
a_2
:
a_N





OutputIf you will win, print first; if Lunlun will win, print second.






Sample Input 12
1
2





Sample Output 1first

Let Color 1 be red, and Color 2 be blue. In this case, the tree bears one red apple and two blue apples.
You should eat the red apple in your first turn. Lunlun is then forced to eat one of the blue apples, and you can win by eating the other in your next turn.
Note that you are also allowed to eat two apples in your first turn, one red and one blue (not a winning move, though).





Sample Input 23
100000
30000
20000





Sample Output 2second


",Harlequin,"Parity, Bruteforcing, Boolean Operations On Geometric Objects",0.467,24,11
805,"
Score: 500 points


Problem Statement
N programmers are going to participate in the preliminary stage of DDCC 20XX. Due to the size of the venue, however, at most 9 contestants can participate in the finals.
The preliminary stage consists of several rounds, which will take place as follows:

All the N contestants will participate in the first round.
When X contestants participate in some round, the number of contestants advancing to the next round will be decided as follows:
The organizer will choose two consecutive digits in the decimal notation of X, and replace them with the sum of these digits. The number resulted will be the number of contestants advancing to the next round.
For example, when X = 2378, the number of contestants advancing to the next round will be 578 (if 2 and 3 are chosen), 2108 (if 3 and 7 are chosen), or 2315 (if 7 and 8 are chosen).
When X = 100, the number of contestants advancing to the next round will be 10, no matter which two digits are chosen.


The preliminary stage ends when 9 or fewer contestants remain.

Ringo, the chief organizer, wants to hold as many rounds as possible.
Find the maximum possible number of rounds in the preliminary stage.
Since the number of contestants, N, can be enormous, it is given to you as two integer sequences d_1, \ldots, d_M and c_1, \ldots, c_M, which means the following: the decimal notation of N consists of c_1 + c_2 + \ldots + c_M digits, whose first c_1 digits are all d_1, the following c_2 digits are all d_2, \ldots, and the last c_M digits are all d_M.




Constraints

1 \leq M \leq 200000
0 \leq d_i \leq 9
d_1 \neq 0
d_i \neq d_{i+1}
c_i \geq 1
2 \leq c_1 + \ldots + c_M \leq 10^{15}







Input
Input is given from Standard Input in the following format:
M
d_1 c_1
d_2 c_2
:
d_M c_M





Output
Print the maximum possible number of rounds in the preliminary stage.






Sample Input 12
2 2
9 1





Sample Output 13

In this case, N = 229 contestants will participate in the first round. One possible progression of the preliminary stage is as follows:

229 contestants participate in Round 1, 49 contestants participate in Round 2, 13 contestants participate in Round 3, and 4 contestants advance to the finals.

Here, three rounds take place in the preliminary stage, which is the maximum possible number.  





Sample Input 23
1 1
0 8
7 1





Sample Output 29

In this case, 1000000007 will participate in the first round.  

",Digit Sum Replace,"Arithmetic, Mathematics, Greedy Algorithm",0.263,50,19
806,"
Score : 100 points


Problem StatementThere are N men and N women, both numbered 1, 2, \ldots, N.
For each i, j (1 \leq i, j \leq N), the compatibility of Man i and Woman j is given as an integer a_{i, j}.
If a_{i, j} = 1, Man i and Woman j are compatible; if a_{i, j} = 0, they are not.
Taro is trying to make N pairs, each consisting of a man and a woman who are compatible.
Here, each man and each woman must belong to exactly one pair.
Find the number of ways in which Taro can make N pairs, modulo 10^9 + 7.




Constraints
All values in input are integers.
1 \leq N \leq 21
a_{i, j} is 0 or 1.







InputInput is given from Standard Input in the following format:
N
a_{1, 1} \ldots a_{1, N}
:
a_{N, 1} \ldots a_{N, N}





OutputPrint the number of ways in which Taro can make N pairs, modulo 10^9 + 7.






Sample Input 13
0 1 1
1 0 1
1 1 1





Sample Output 13

There are three ways to make pairs, as follows ((i, j) denotes a pair of Man i and Woman j):

(1, 2), (2, 1), (3, 3)
(1, 2), (2, 3), (3, 1)
(1, 3), (2, 1), (3, 2)






Sample Input 24
0 1 0 0
0 0 0 1
1 0 0 0
0 0 1 0





Sample Output 21

There is one way to make pairs, as follows:

(1, 2), (2, 4), (3, 1), (4, 3)






Sample Input 31
0





Sample Output 30






Sample Input 421
0 0 0 0 0 0 0 1 1 0 1 1 1 1 0 0 0 1 0 0 1
1 1 1 0 0 1 0 0 0 1 0 0 0 0 1 1 1 0 1 1 0
0 0 1 1 1 1 0 1 1 0 0 1 0 0 1 1 0 0 0 1 1
0 1 1 0 1 1 0 1 0 1 0 0 1 0 0 0 0 0 1 1 0
1 1 0 0 1 0 1 0 0 1 1 1 1 0 0 0 0 0 0 0 0
0 1 1 0 1 1 1 0 1 1 1 0 0 0 1 1 1 1 0 0 1
0 1 0 0 0 1 0 1 0 0 0 1 1 1 0 0 1 1 0 1 0
0 0 0 0 1 1 0 0 1 1 0 0 0 0 0 1 1 1 1 1 1
0 0 1 0 0 1 0 0 1 0 1 1 0 0 1 0 1 0 1 1 1
0 0 0 0 1 1 0 0 1 1 1 0 0 0 0 1 1 0 0 0 1
0 1 1 0 1 1 0 0 1 1 0 0 0 1 1 1 1 0 1 1 0
0 0 1 0 0 1 1 1 1 0 1 1 0 1 1 1 0 0 0 0 1
0 1 1 0 0 1 1 1 1 0 0 0 1 0 1 1 0 1 0 1 1
1 1 1 1 1 0 0 0 0 1 0 0 1 1 0 1 1 1 0 0 1
0 0 0 1 1 0 1 1 1 1 0 0 0 0 0 0 1 1 1 1 1
1 0 1 1 0 1 0 1 0 0 1 0 0 1 1 0 1 0 1 1 0
0 0 1 1 0 0 1 1 0 0 1 1 0 0 1 1 1 1 0 0 1
0 0 0 1 0 0 1 1 0 1 0 1 0 1 1 0 0 1 1 0 1
0 0 0 0 1 1 1 0 1 0 1 1 1 0 1 1 0 0 1 1 0
1 1 0 1 1 0 0 1 1 0 1 1 0 1 1 1 1 1 0 1 0
1 0 0 1 1 0 1 1 1 1 1 0 1 0 1 1 0 0 0 0 0





Sample Output 4102515160

Be sure to print the number modulo 10^9 + 7.

",Matching,"Dynamic Programming Using Bitfield, Enumeration, Graph Theory, Arithmetic, Dyanmic Programming",0.588,153,89
807,"
Score : 100 points


Problem StatementFind the number of integers between 1 and K (inclusive) satisfying the following condition, modulo 10^9 + 7:

The sum of the digits in base ten is a multiple of D.





Constraints
All values in input are integers.
1 \leq K < 10^{10000}
1 \leq D \leq 100







InputInput is given from Standard Input in the following format:
K
D





OutputPrint the number of integers satisfying the condition, modulo 10^9 + 7.






Sample Input 130
4





Sample Output 16

Those six integers are: 4, 8, 13, 17, 22 and 26.





Sample Input 21000000009
1





Sample Output 22

Be sure to print the number modulo 10^9 + 7.





Sample Input 398765432109876543210
58





Sample Output 3635270834


",Digit Sum,"Digit Dp, Arithmetic, Dynamic Programming",0.5,110,52
808,"
Score : 100 points


Problem StatementThere are N stones, numbered 1, 2, \ldots, N.
For each i (1 \leq i \leq N), the height of Stone i is h_i.
Here, h_1 < h_2 < \cdots < h_N holds.
There is a frog who is initially on Stone 1.
He will repeat the following action some number of times to reach Stone N:

If the frog is currently on Stone i, jump to one of the following: Stone i + 1, i + 2, \ldots, N. Here, a cost of (h_j - h_i)^2 + C is incurred, where j is the stone to land on.

Find the minimum possible total cost incurred before the frog reaches Stone N.




Constraints
All values in input are integers.
2 \leq N \leq 2 \times 10^5
1 \leq C \leq 10^{12}
1 \leq h_1 < h_2 < \cdots < h_N \leq 10^6







InputInput is given from Standard Input in the following format:
N C
h_1 h_2 \ldots h_N





OutputPrint the minimum possible total cost incurred.






Sample Input 15 6
1 2 3 4 5





Sample Output 120

If we follow the path 1 → 3 → 5, the total cost incurred would be ((3 - 1)^2 + 6) + ((5 - 3)^2 + 6) = 20.





Sample Input 22 1000000000000
500000 1000000





Sample Output 21250000000000

The answer may not fit into a 32-bit integer type.





Sample Input 38 5
1 3 4 5 10 11 12 13





Sample Output 362

If we follow the path 1 → 2 → 4 → 5 → 8, the total cost incurred would be ((3 - 1)^2 + 5) + ((5 - 3)^2 + 5) + ((10 - 5)^2 + 5) + ((13 - 10)^2 + 5) = 62.

",Frog 3,"Dyanmic Programming, Arithmetic, Convex Hull Trick, Segment Tree, Monotonic Stack",0.357,46,19
809,"
Score : 100 points


Problem StatementThere are N blocks, numbered 1, 2, \ldots, N.
For each i (1 \leq i \leq N), Block i has a weight of w_i, a solidness of s_i and a value of v_i.
Taro has decided to build a tower by choosing some of the N blocks and stacking them vertically in some order.
Here, the tower must satisfy the following condition:

For each Block i contained in the tower, the sum of the weights of the blocks stacked above it is not greater than s_i.

Find the maximum possible sum of the values of the blocks contained in the tower.




Constraints
All values in input are integers.
1 \leq N \leq 10^3
1 \leq w_i, s_i \leq 10^4
1 \leq v_i \leq 10^9







InputInput is given from Standard Input in the following format:
N
w_1 s_1 v_1
w_2 s_2 v_2
:
w_N s_N v_N





OutputPrint the maximum possible sum of the values of the blocks contained in the tower.






Sample Input 13
2 2 20
2 1 30
3 1 40





Sample Output 150

If Blocks 2, 1 are stacked in this order from top to bottom, this tower will satisfy the condition, with the total value of 30 + 20 = 50.





Sample Input 24
1 2 10
3 1 10
2 4 10
1 6 10





Sample Output 240

Blocks 1, 2, 3, 4 should be stacked in this order from top to bottom.





Sample Input 35
1 10000 1000000000
1 10000 1000000000
1 10000 1000000000
1 10000 1000000000
1 10000 1000000000





Sample Output 35000000000

The answer may not fit into a 32-bit integer type.





Sample Input 48
9 5 7
6 2 7
5 7 3
7 8 8
1 9 6
3 3 3
4 1 7
4 5 5





Sample Output 422

We should, for example, stack Blocks 5, 6, 8, 4 in this order from top to bottom.

",Tower,"Dyanmic Programming, Sorting, Bitmask, Greedy Algorithm",0.4,43,15
810,"
Score : 100 points


Problem StatementThere is a tree with N vertices, numbered 1, 2, \ldots, N.
For each i (1 \leq i \leq N - 1), the i-th edge connects Vertex x_i and y_i.
Taro has decided to paint each vertex in white or black, so that any black vertex can be reached from any other black vertex by passing through only black vertices.
You are given a positive integer M.
For each v (1 \leq v \leq N), answer the following question:

Assuming that Vertex v has to be black, find the number of ways in which the vertices can be painted, modulo M.





Constraints
All values in input are integers.
1 \leq N \leq 10^5
2 \leq M \leq 10^9
1 \leq x_i, y_i \leq N
The given graph is a tree.







InputInput is given from Standard Input in the following format:
N M
x_1 y_1
x_2 y_2
:
x_{N - 1} y_{N - 1}





OutputPrint N lines.
The v-th (1 \leq v \leq N) line should contain the answer to the following question:

Assuming that Vertex v has to be black, find the number of ways in which the vertices can be painted, modulo M.







Sample Input 13 100
1 2
2 3





Sample Output 13
4
3

There are seven ways to paint the vertices, as shown in the figure below.
Among them, there are three ways such that Vertex 1 is black, four ways such that Vertex 2 is black and three ways such that Vertex 3 is black.






Sample Input 24 100
1 2
1 3
1 4





Sample Output 28
5
5
5






Sample Input 31 100





Sample Output 31






Sample Input 410 2
8 5
10 8
6 5
1 5
4 8
2 10
3 6
9 2
1 7





Sample Output 40
0
1
1
1
0
1
0
1
1

Be sure to print the answers modulo M.

",Subtree,"Dynamic Programming On Trees, Depth-first Search, Tree, Combinatorics, Binary Indexed Tree, Offline Queries",0.389,40,18
811,"
Score : 100 points


Problem StatementThere are N rabbits, numbered 1, 2, \ldots, N.
For each i, j (1 \leq i, j \leq N), the compatibility of Rabbit i and j is described by an integer a_{i, j}.
Here, a_{i, i} = 0 for each i (1 \leq i \leq N), and a_{i, j} = a_{j, i} for each i and j (1 \leq i, j \leq N).
Taro is dividing the N rabbits into some number of groups.
Here, each rabbit must belong to exactly one group.
After grouping, for each i and j (1 \leq i < j \leq N), Taro earns a_{i, j} points if Rabbit i and j belong to the same group.
Find Taro's maximum possible total score.




Constraints
All values in input are integers.
1 \leq N \leq 16
|a_{i, j}| \leq 10^9
a_{i, i} = 0
a_{i, j} = a_{j, i}







InputInput is given from Standard Input in the following format:
N
a_{1, 1} \ldots a_{1, N}
:
a_{N, 1} \ldots a_{N, N}





OutputPrint Taro's maximum possible total score.






Sample Input 13
0 10 20
10 0 -100
20 -100 0





Sample Output 120

The rabbits should be divided as \{1, 3\}, \{2\}.





Sample Input 22
0 -10
-10 0





Sample Output 20

The rabbits should be divided as \{1\}, \{2\}.





Sample Input 34
0 1000000000 1000000000 1000000000
1000000000 0 1000000000 1000000000
1000000000 1000000000 0 -1
1000000000 1000000000 -1 0





Sample Output 34999999999

The rabbits should be divided as \{1, 2, 3, 4\}.
Note that the answer may not fit into a 32-bit integer type.





Sample Input 416
0 5 -4 -5 -8 -4 7 2 -4 0 7 0 2 -3 7 7
5 0 8 -9 3 5 2 -7 2 -7 0 -1 -4 1 -1 9
-4 8 0 -9 8 9 3 1 4 9 6 6 -6 1 8 9
-5 -9 -9 0 -7 6 4 -1 9 -3 -5 0 1 2 -4 1
-8 3 8 -7 0 -5 -9 9 1 -9 -6 -3 -8 3 4 3
-4 5 9 6 -5 0 -6 1 -2 2 0 -5 -2 3 1 2
7 2 3 4 -9 -6 0 -2 -2 -9 -3 9 -2 9 2 -5
2 -7 1 -1 9 1 -2 0 -6 0 -6 6 4 -1 -7 8
-4 2 4 9 1 -2 -2 -6 0 8 -6 -2 -4 8 7 7
0 -7 9 -3 -9 2 -9 0 8 0 0 1 -3 3 -6 -6
7 0 6 -5 -6 0 -3 -6 -6 0 0 5 7 -1 -5 3
0 -1 6 0 -3 -5 9 6 -2 1 5 0 -2 7 -8 0
2 -4 -6 1 -8 -2 -2 4 -4 -3 7 -2 0 -9 7 1
-3 1 1 2 3 3 9 -1 8 3 -1 7 -9 0 -6 -8
7 -1 8 -4 4 1 2 -7 7 -6 -5 -8 7 -6 0 -9
7 9 9 1 3 2 -5 8 7 -6 3 0 1 -8 -9 0





Sample Output 4132


",Grouping,"Bitmask, Dyanmic Programming, Precomputation, Arithmetic",0.767,43,32
812,"
Score : 600 points


Problem Statement
We have a tree with N vertices numbered 1 to N. The i-th edge in this tree connects Vertex a_i and b_i.
Additionally, each vertex is painted in a color, and the color of Vertex i is c_i. Here, the color of each vertex is represented by an integer between 1 and N (inclusive). The same integer corresponds to the same color; different integers correspond to different colors.
For each k=1, 2, ..., N, solve the following problem:

Find the number of simple paths that visit a vertex painted in the color k one or more times.

Note: The simple paths from Vertex u to v and from v to u are not distinguished.




Constraints

1 \leq N \leq 2 \times 10^5
1 \leq c_i \leq N
1 \leq a_i,b_i \leq N
The given graph is a tree.
All values in input are integers.







Input
Input is given from Standard Input in the following format:
N
c_1 c_2 ... c_N
a_1 b_1
:
a_{N-1} b_{N-1}





Output
Print the answers for k = 1, 2, ..., N in order, each in its own line.






Sample Input 13
1 2 1
1 2
2 3





Sample Output 15
4
0

Let P_{i,j} denote the simple path connecting Vertex i and j.
There are 5 simple paths that visit a vertex painted in the color 1 one or more times:
P_{1,1}\,,\,
P_{1,2}\,,\,
P_{1,3}\,,\,
P_{2,3}\,,\,
P_{3,3} 
There are 4 simple paths that visit a vertex painted in the color 2 one or more times:
P_{1,2}\,,\,
P_{1,3}\,,\,
P_{2,2}\,,\,
P_{2,3} 
There are no simple paths that visit a vertex painted in the color 3 one or more times.  





Sample Input 21
1





Sample Output 21






Sample Input 32
1 2
1 2





Sample Output 32
2






Sample Input 45
1 2 3 4 5
1 2
2 3
3 4
3 5





Sample Output 45
8
10
5
5






Sample Input 58
2 7 2 5 4 1 7 5
3 1
1 2
2 7
4 5
5 6
6 8
7 8





Sample Output 518
15
0
14
23
0
23
0


",path pass i,"Depth-first Search, Tree, Graph Theory, Binary Indexed Tree, Segment Tree, Inclusion And Exclusion",0.5,6,4
813,"
Score: 500 points


Problem Statement
We have caught N sardines. The deliciousness and fragrantness of the i-th sardine is A_i and B_i, respectively.
We will choose one or more of these sardines and put them into a cooler. However, two sardines on bad terms cannot be chosen at the same time.
The i-th and j-th sardines (i \neq j) are on bad terms if and only if A_i \cdot A_j + B_i \cdot B_j = 0.
In how many ways can we choose the set of sardines to put into the cooler? Since the count can be enormous, print it modulo 1000000007.




Constraints

All values in input are integers.
1 \leq N \leq 2 \times 10^5
-10^{18} \leq A_i, B_i \leq 10^{18}







Input
Input is given from Standard Input in the following format:
N
A_1 B_1
:
A_N B_N





Output
Print the count modulo 1000000007.






Sample Input 13
1 2
-1 1
2 -1





Sample Output 15

There are five ways to choose the set of sardines, as follows:

The 1-st
The 1-st and 2-nd
The 2-nd
The 2-nd and 3-rd
The 3-rd






Sample Input 210
3 2
3 2
-1 1
2 -1
-3 -9
-8 12
7 7
8 1
8 2
8 4





Sample Output 2479


",∙ (Bullet),"Number Theory, Mathematics, Hashing, Combinatorics, Bitmask, Arithmetic",0.087,206,25
814,"
Score : 100 points


Problem StatementThere is a grid with H horizontal rows and W vertical columns.
Let (i, j) denote the square at the i-th row from the top and the j-th column from the left.
In the grid, N Squares (r_1, c_1), (r_2, c_2), \ldots, (r_N, c_N) are wall squares, and the others are all empty squares.
It is guaranteed that Squares (1, 1) and (H, W) are empty squares.
Taro will start from Square (1, 1) and reach (H, W) by repeatedly moving right or down to an adjacent empty square.
Find the number of Taro's paths from Square (1, 1) to (H, W), modulo 10^9 + 7.




Constraints
All values in input are integers.
2 \leq H, W \leq 10^5
1 \leq N \leq 3000
1 \leq r_i \leq H
1 \leq c_i \leq W
Squares (r_i, c_i) are all distinct.
Squares (1, 1) and (H, W) are empty squares.







InputInput is given from Standard Input in the following format:
H W N
r_1 c_1
r_2 c_2
:
r_N c_N





OutputPrint the number of Taro's paths from Square (1, 1) to (H, W), modulo 10^9 + 7.






Sample Input 13 4 2
2 2
1 4





Sample Output 13

There are three paths as follows:






Sample Input 25 2 2
2 1
4 2





Sample Output 20

There may be no paths.





Sample Input 35 5 4
3 1
3 5
1 3
5 3





Sample Output 324






Sample Input 4100000 100000 1
50000 50000





Sample Output 4123445622

Be sure to print the count modulo 10^9 + 7.

",Grid 2,"Combinatorics, Dyanmic Programming, Inclusion And Exclusion, Arithmetic, Sorting, Precomputation",0.533,36,13
815,"
Score : 200 points


Problem StatementWe have an integer sequence A, whose length is N.
Find the number of the non-empty contiguous subsequences of A whose sums are 0.
Note that we are counting the ways to take out subsequences.
That is, even if the contents of some two subsequences are the same, they are counted individually if they are taken from different positions.




Constraints
1 \leq N \leq 2 \times 10^5
-10^9 \leq A_i \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
A_1 A_2 ... A_N





OutputFind the number of the non-empty contiguous subsequences of A whose sum is 0.






Sample Input 16
1 3 -4 2 2 -2





Sample Output 13

There are three contiguous subsequences whose sums are 0: (1,3,-4), (-4,2,2) and (2,-2).





Sample Input 27
1 -1 1 -1 1 -1 1





Sample Output 212

In this case, some subsequences that have the same contents but are taken from different positions are counted individually.
For example, three occurrences of (1, -1) are counted.





Sample Input 35
1 -2 3 -4 5





Sample Output 30

There are no contiguous subsequences whose sums are 0.

",Zero-Sum Ranges,"Prefix sum, Set / Map, Hashing, Sorting, Combinatorics",0.289,222,49
816,"
Score : 500 points


Problem StatementSnuke has two boards, each divided into a grid with N rows and N columns.
For both of these boards, the square at the i-th row from the top and the j-th column from the left is called Square (i,j).
There is a lowercase English letter written in each square on the first board. The letter written in Square (i,j) is S_{i,j}. On the second board, nothing is written yet.
Snuke will write letters on the second board, as follows:

First, choose two integers A and B ( 0 \leq A, B < N ).
Write one letter in each square on the second board.
Specifically, write the letter written in Square ( i+A, j+B ) on the first board into Square (i,j) on the second board.
Here, the k-th row is also represented as the (N+k)-th row, and the k-th column is also represented as the (N+k)-th column.

After this operation, the second board is called a good board when, for every i and j ( 1 \leq i, j \leq N ), the letter in Square (i,j) and the letter in Square (j,i) are equal.
Find the number of the ways to choose integers A and B ( 0 \leq A, B < N ) such that the second board is a good board.




Constraints
1 \leq N \leq 300
S_{i,j} ( 1 \leq i, j \leq N ) is a lowercase English letter.







InputInput is given from Standard Input in the following format:
N
S_{1,1}S_{1,2}..S_{1,N}
S_{2,1}S_{2,2}..S_{2,N}
:
S_{N,1}S_{N,2}..S_{N,N}





OutputPrint the number of the ways to choose integers A and B ( 0 \leq A, B < N ) such that the second board is a good board.






Sample Input 12
ab
ca





Sample Output 12

For each pair of A and B, the second board will look as shown below:

The second board is a good board when (A,B) = (0,1) or (A,B) = (1,0), thus the answer is 2.





Sample Input 24
aaaa
aaaa
aaaa
aaaa





Sample Output 216

Every possible choice of A and B makes the second board good.





Sample Input 35
abcde
fghij
klmno
pqrst
uvwxy





Sample Output 30

No possible choice of A and B makes the second board good.

",Find Symmetries,"Arithmetic, Bruteforcing, Geometry; 3d, Array",0.538,40,21
817,"
Score : 600 points


Problem Statement
There is an arithmetic progression with L terms: s_0, s_1, s_2, ... , s_{L-1}.
The initial term is A, and the common difference is B. That is, s_i = A + B \times i holds.
Consider the integer obtained by concatenating the terms written in base ten without leading zeros. For example, the sequence 3, 7, 11, 15, 19 would be concatenated into 37111519. What is the remainder when that integer is divided by M?




Constraints

All values in input are integers.
1 \leq L, A, B < 10^{18}
2 \leq M \leq 10^9
All terms in the arithmetic progression are less than 10^{18}.







InputInput is given from Standard Input in the following format:
L A B M





Output
Print the remainder when the integer obtained by concatenating the terms is divided by M.






Sample Input 15 3 4 10007





Sample Output 15563

Our arithmetic progression is 3, 7, 11, 15, 19, so the answer is 37111519 mod 10007, that is, 5563.





Sample Input 24 8 1 1000000





Sample Output 2891011






Sample Input 3107 10000000000007 1000000000000007 998244353





Sample Output 339122908


",Takahashi's Basics in Education and Learning,"Arithmetic, Exponentiation By Squaring, Binary Search, Mathematics, Prefix sum",0.0,15,0
818,"
Score : 400 points


Problem StatementLet f(A, B) be the exclusive OR of A, A+1, ..., B. Find f(A, B).

What is exclusive OR?
The bitwise exclusive OR of integers c_1, c_2, ..., c_n (let us call it y) is defined as follows:

When y is written in base two, the digit in the 2^k's place (k \geq 0) is 1 if, the number of integers among c_1, c_2, ...c_m whose binary representations have 1 in the 2^k's place, is odd, and 0 if that count is even.

For example, the exclusive OR of 3 and 5 is 6. (When written in base two: the exclusive OR of 011 and 101 is 110.)
",XOR World,"Boolean Operations On Geometric Objects, Prefix sum, Arithmetic, Mathematics",0.338,138,49
819,"
Score: 400 points


Problem Statement
The Patisserie AtCoder sells cakes with number-shaped candles.
There are X, Y and Z kinds of cakes with 1-shaped, 2-shaped and 3-shaped candles, respectively.
Each cake has an integer value called deliciousness, as follows:

The deliciousness of the cakes with 1-shaped candles are A_1, A_2, ..., A_X.
The deliciousness of the cakes with 2-shaped candles are B_1, B_2, ..., B_Y.
The deliciousness of the cakes with 3-shaped candles are C_1, C_2, ..., C_Z.

Takahashi decides to buy three cakes, one for each of the three shapes of the candles, to celebrate ABC 123.
There are X \times Y \times Z such ways to choose three cakes.
We will arrange these X \times Y \times Z ways in descending order of the sum of the deliciousness of the cakes.
Print the sums of the deliciousness of the cakes for the first, second, ..., K-th ways in this list.




Constraints

1 \leq X \leq 1 \ 000
1 \leq Y \leq 1 \ 000
1 \leq Z \leq 1 \ 000
1 \leq K \leq \min(3 \ 000, X \times Y \times Z)
1 \leq A_i \leq 10 \ 000 \ 000 \ 000
1 \leq B_i \leq 10 \ 000 \ 000 \ 000
1 \leq C_i \leq 10 \ 000 \ 000 \ 000
All values in input are integers.







Input
Input is given from Standard Input in the following format:
X Y Z K
A_1 \ A_2 \ A_3 \ ... \ A_X
B_1 \ B_2 \ B_3 \ ... \ B_Y
C_1 \ C_2 \ C_3 \ ... \ C_Z





Output
Print K lines. The i-th line should contain the i-th value stated in the problem statement.






Sample Input 12 2 2 8
4 6
1 5
3 8





Sample Output 119
17
15
14
13
12
10
8

There are 2 \times 2 \times 2 = 8 ways to choose three cakes, as shown below in descending order of the sum of the deliciousness of the cakes:

(A_2, B_2, C_2): 6 + 5 + 8 = 19
(A_1, B_2, C_2): 4 + 5 + 8 = 17
(A_2, B_1, C_2): 6 + 1 + 8 = 15
(A_2, B_2, C_1): 6 + 5 + 3 = 14
(A_1, B_1, C_2): 4 + 1 + 8 = 13
(A_1, B_2, C_1): 4 + 5 + 3 = 12
(A_2, B_1, C_1): 6 + 1 + 3 = 10
(A_1, B_1, C_1): 4 + 1 + 3 = 8






Sample Input 23 3 3 5
1 10 100
2 20 200
1 10 100





Sample Output 2400
310
310
301
301

There may be multiple combinations of cakes with the same sum of the deliciousness. For example, in this test case, the sum of A_1, B_3, C_3 and the sum of A_3, B_3, C_1 are both 301.
However, they are different ways of choosing cakes, so 301 occurs twice in the output.





Sample Input 310 10 10 20
7467038376 5724769290 292794712 2843504496 3381970101 8402252870 249131806 6310293640 6690322794 6082257488
1873977926 2576529623 1144842195 1379118507 6003234687 4925540914 3902539811 3326692703 484657758 2877436338
4975681328 8974383988 2882263257 7690203955 514305523 6679823484 4263279310 585966808 3752282379 620585736





Sample Output 323379871545
22444657051
22302177772
22095691512
21667941469
21366963278
21287912315
21279176669
21160477018
21085311041
21059876163
21017997739
20703329561
20702387965
20590247696
20383761436
20343962175
20254073196
20210218542
20150096547

Note that the input or output may not fit into a 32-bit integer type.

",Cake 123,"Sorting, Enumeration, Priority Queue, Graph Traversal, Binary Search, Bruteforcing",0.222,226,42
820,"
Score : 300 points


Problem StatementThere are N sightseeing spots on the x-axis, numbered 1, 2, ..., N.
Spot i is at the point with coordinate A_i.
It costs |a - b| yen (the currency of Japan) to travel from a point with coordinate a to another point with coordinate b along the axis.
You planned a trip along the axis.
In this plan, you first depart from the point with coordinate 0, then visit the N spots in the order they are numbered, and finally return to the point with coordinate 0.
However, something came up just before the trip, and you no longer have enough time to visit all the N spots, so you decided to choose some i and cancel the visit to Spot i.
You will visit the remaining spots as planned in the order they are numbered.
You will also depart from and return to the point with coordinate 0 at the beginning and the end, as planned.
For each i = 1, 2, ..., N, find the total cost of travel during the trip when the visit to Spot i is canceled.




Constraints
2 \leq N \leq 10^5
-5000 \leq A_i \leq 5000 (1 \leq i \leq N)
All input values are integers.







InputInput is given from Standard Input in the following format:
N
A_1 A_2 ... A_N





OutputPrint N lines.
In the i-th line, print the total cost of travel during the trip when the visit to Spot i is canceled.






Sample Input 13
3 5 -1





Sample Output 112
8
10

Spot 1, 2 and 3 are at the points with coordinates 3, 5 and -1, respectively.
For each i, the course of the trip and the total cost of travel when the visit to Spot i is canceled, are as follows:

For i = 1, the course of the trip is 0 \rightarrow 5 \rightarrow -1 \rightarrow 0 and the total cost of travel is 5 + 6 + 1 = 12 yen.
For i = 2, the course of the trip is 0 \rightarrow 3 \rightarrow -1 \rightarrow 0 and the total cost of travel is 3 + 4 + 1 = 8 yen.
For i = 3, the course of the trip is 0 \rightarrow 3 \rightarrow 5 \rightarrow 0 and the total cost of travel is 3 + 2 + 5 = 10 yen.






Sample Input 25
1 1 1 2 0





Sample Output 24
4
4
2
4






Sample Input 36
-679 -2409 -3258 3095 -3291 -4462





Sample Output 321630
21630
19932
8924
21630
19288


",Traveling Plan,"Prefix sum, Arithmetic, Array, Bruteforcing, Mathematics",0.698,61,39
821,"
Score : 300 points


Problem StatementA railroad running from west to east in Atcoder Kingdom is now complete.
There are N stations on the railroad, numbered 1 through N from west to east.
Tomorrow, the opening ceremony of the railroad will take place.
On this railroad, for each integer i such that 1≤i≤N-1, there will be trains that run from Station i to Station i+1 in C_i seconds. No other trains will be operated.
The first train from Station i to Station i+1 will depart Station i S_i seconds after the ceremony begins. Thereafter, there will be a train that departs Station i every F_i seconds.
Here, it is guaranteed that F_i divides S_i.
That is, for each Time t satisfying S_i≤t and t％F_i=0, there will be a train that departs Station i t seconds after the ceremony begins and arrives at Station i+1 t+C_i seconds after the ceremony begins, where A％B denotes A modulo B, and there will be no other trains.
For each i, find the earliest possible time we can reach Station N if we are at Station i when the ceremony begins, ignoring the time needed to change trains.




Constraints
1≤N≤500
1≤C_i≤100
1≤S_i≤10^5
1≤F_i≤10
S_i％F_i=0
All input values are integers.







InputInput is given from Standard Input in the following format:
N
C_1 S_1 F_1
:
C_{N-1} S_{N-1} F_{N-1}





OutputPrint N lines. Assuming that we are at Station i (1≤i≤N) when the ceremony begins, if the earliest possible time we can reach Station N is x seconds after the ceremony begins, the i-th line should contain x.






Sample Input 13
6 5 1
1 10 1





Sample Output 112
11
0

We will travel from Station 1 as follows:

5 seconds after the beginning: take the train to Station 2.
11 seconds: arrive at Station 2.
11 seconds: take the train to Station 3.
12 seconds: arrive at Station 3.

We will travel from Station 2 as follows:

10 seconds: take the train to Station 3.
11 seconds: arrive at Station 3.

Note that we should print 0 for Station 3.





Sample Input 24
12 24 6
52 16 4
99 2 2





Sample Output 2187
167
101
0






Sample Input 34
12 13 1
44 17 17
66 4096 64





Sample Output 34162
4162
4162
0


",Special Trains,"Bruteforcing, Arithmetic, Simulation, Greedy Algorithm",0.6,103,64
822,"
Score : 300 points


Problem StatementTakahashi has N balls. Initially, an integer A_i is written on the i-th ball.
He would like to rewrite the integer on some balls so that there are at most K different integers written on the N balls.
Find the minimum number of balls that Takahashi needs to rewrite the integers on them.




Constraints
1 \leq K \leq N \leq 200000
1 \leq A_i \leq N
All input values are integers.







InputInput is given from Standard Input in the following format:
N K
A_1 A_2 ... A_N





OutputPrint the minimum number of balls that Takahashi needs to rewrite the integers on them.






Sample Input 15 2
1 1 2 2 5





Sample Output 11

For example, if we rewrite the integer on the fifth ball to 2, there are two different integers written on the balls: 1 and 2.
On the other hand, it is not possible to rewrite the integers on zero balls so that there are at most two different integers written on the balls, so we should print 1.





Sample Input 24 4
1 1 2 2





Sample Output 20

Already in the beginning, there are two different integers written on the balls, so we do not need to rewrite anything.





Sample Input 310 3
5 1 3 2 4 1 1 2 3 4





Sample Output 33


",Not so Diverse,"Set / Map, Sorting, Greedy Algorithm, Priority Queue",0.75,58,32
823,"
Score : 300 points


Problem StatementYou are given an undirected connected graph with N vertices and M edges that does not contain self-loops and double edges.
The i-th edge (1 \leq i \leq M) connects Vertex a_i and Vertex b_i.  
An edge whose removal disconnects the graph is called a bridge.
Find the number of the edges that are bridges among the M edges.  




Notes
A self-loop is an edge i such that a_i=b_i (1 \leq i \leq M).
Double edges are a pair of edges i,j such that a_i=a_j and b_i=b_j (1 \leq i<j \leq M).
An undirected graph is said to be connected when there exists a path between every pair of vertices.





Constraints
2 \leq N \leq 50
N-1 \leq M \leq min(N(N−1)⁄2,50)
1 \leq a_i<b_i \leq N
The given graph does not contain self-loops and double edges.
The given graph is connected.







InputInput is given from Standard Input in the following format:  
N M  
a_1 b_1  
a_2 b_2
:  
a_M b_M





OutputPrint the number of the edges that are bridges among the M edges.






Sample Input 17 7
1 3
2 7
3 4
4 5
4 6
5 6
6 7





Sample Output 14

The figure below shows the given graph:



The edges shown in red are bridges. There are four of them.





Sample Input 23 3
1 2
1 3
2 3





Sample Output 20

It is possible that there is no bridge.





Sample Input 36 5
1 2
2 3
3 4
4 5
5 6





Sample Output 35

It is possible that every edge is a bridge.

",Bridge,"Graph Theory, Depth-first Search, Breadth-first Search, Graph Traversal, Disjoint Set",0.698,93,60
824,"
Score : 300 points


Problem StatementTakahashi, Nakahashi and Hikuhashi have integers A, B and C, respectively.
After repeating the following operation K times, find the integer Takahashi will get minus the integer Nakahashi will get:

Each of them simultaneously calculate the sum of the integers that the other two people have, then replace his own integer with the result.

However, if the absolute value of the answer exceeds 10^{18}, print Unfair instead.




Constraints
1 \leq A,B,C \leq 10^9
0 \leq K \leq 10^{18}
All values in input are integers.







InputInput is given from Standard Input in the following format:
A B C K





OutputPrint the integer Takahashi will get minus the integer Nakahashi will get, after repeating the following operation K times.
If the absolute value of the answer exceeds 10^{18}, print Unfair instead.






Sample Input 11 2 3 1





Sample Output 11

After one operation, Takahashi, Nakahashi and Hikuhashi have 5, 4 and 3, respectively. We should print 5-4=1.





Sample Input 22 3 2 0





Sample Output 2-1






Sample Input 31000000000 1000000000 1000000000 1000000000000000000





Sample Output 30


",Fairness,"Arithmetic, Mathematics, Implementation",0.514,155,62
825,"
Score : 300 points


Problem StatementGotou just received a dictionary. However, he doesn't recognize the language used in the dictionary. He did some analysis on the dictionary and realizes that the dictionary contains all possible diverse words in lexicographical order.
A word is called diverse if and only if it is a nonempty string of English lowercase letters and all letters in the word are distinct. For example, atcoder, zscoder and agc are diverse words while gotou and connect aren't diverse words.
Given a diverse word S, determine the next word that appears after S in the dictionary, i.e. the lexicographically smallest diverse word that is lexicographically larger than S, or determine that it doesn't exist.
Let X = x_{1}x_{2}...x_{n} and Y = y_{1}y_{2}...y_{m} be two distinct strings. X is lexicographically larger than Y if and only if Y is a prefix of X or x_{j} > y_{j} where j is the smallest integer such that x_{j} \neq y_{j}.




Constraints
1 \leq |S| \leq 26
S is a diverse word.







InputInput is given from Standard Input in the following format:
S





OutputPrint the next word that appears after S in the dictionary, or -1 if it doesn't exist.






Sample Input 1atcoder





Sample Output 1atcoderb

atcoderb is the lexicographically smallest diverse word that is lexicographically larger than atcoder. Note that atcoderb is lexicographically smaller than b.





Sample Input 2abc





Sample Output 2abcd






Sample Input 3zyxwvutsrqponmlkjihgfedcba





Sample Output 3-1

This is the lexicographically largest diverse word, so the answer is -1.





Sample Input 4abcdefghijklmnopqrstuvwzyx





Sample Output 4abcdefghijklmnopqrstuvx


",Diverse Word,"Greedy Algorithm, Array, Counting, String",0.289,127,32
826,"
Score : 400 points


Problem StatementFind the largest integer that can be formed with exactly N matchsticks, under the following conditions:

Every digit in the integer must be one of the digits A_1, A_2, ..., A_M (1 \leq A_i \leq 9).
The number of matchsticks used to form digits 1, 2, 3, 4, 5, 6, 7, 8, 9 should be 2, 5, 5, 4, 5, 6, 3, 7, 6, respectively.





Constraints
All values in input are integers.
2 \leq N \leq 10^4
1 \leq M \leq 9
1 \leq A_i \leq 9
A_i are all different.
There exists an integer that can be formed by exactly N matchsticks under the conditions.







InputInput is given from Standard Input in the following format:
N M
A_1 A_2 ... A_M





OutputPrint the largest integer that can be formed with exactly N matchsticks under the conditions in the problem statement.






Sample Input 120 4
3 7 8 4





Sample Output 1777773

The integer 777773 can be formed with 3 + 3 + 3 + 3 + 3 + 5 = 20 matchsticks, and this is the largest integer that can be formed by 20 matchsticks under the conditions.





Sample Input 2101 9
9 8 7 6 5 4 3 2 1





Sample Output 271111111111111111111111111111111111111111111111111

The output may not fit into a 64-bit integer type.





Sample Input 315 3
5 4 6





Sample Output 3654


",Match Matching,"Dyanmic Programming, String, Array",0.333,84,26
827,"
Score : 300 points


Problem StatementWe have N sticks with negligible thickness.
The length of the i-th stick is A_i.
Snuke wants to select four different sticks from these sticks and form a rectangle (including a square), using the sticks as its sides.
Find the maximum possible area of the rectangle.




Constraints
4 \leq N \leq 10^5
1 \leq A_i \leq 10^9
A_i is an integer.







InputInput is given from Standard Input in the following format:
N
A_1 A_2 ... A_N





OutputPrint the maximum possible area of the rectangle.
If no rectangle can be formed, print 0.






Sample Input 16
3 1 2 4 2 1





Sample Output 12

1 \times 2 rectangle can be formed.





Sample Input 24
1 2 3 4





Sample Output 20

No rectangle can be formed.





Sample Input 310
3 3 3 3 4 4 4 5 5 5





Sample Output 320


",Make a Rectangle,"Counting, Sorting, Greedy Algorithm, Bruteforcing",0.161,172,44
828,"
Score : 400 points


Problem StatementYou are given an integer N. Find the number of strings of length N that satisfy the following conditions, modulo 10^9+7:

The string does not contain characters other than A, C, G and T.
The string does not contain AGC as a substring.
The condition above cannot be violated by swapping two adjacent characters once.





NotesA substring of a string T is a string obtained by removing zero or more characters from the beginning and the end of T.
For example, the substrings of ATCODER include TCO, AT, CODER, ATCODER and  (the empty string), but not AC.




Constraints
3 \leq N \leq 100







InputInput is given from Standard Input in the following format:
N





OutputPrint the number of strings of length N that satisfy the following conditions, modulo 10^9+7.






Sample Input 13





Sample Output 161

There are 4^3 = 64 strings of length 3 that do not contain characters other than A, C, G and T. Among them, only AGC, ACG and GAC violate the condition, so the answer is 64 - 3 = 61.





Sample Input 24





Sample Output 2230






Sample Input 3100





Sample Output 3388130742

Be sure to print the number of strings modulo 10^9+7.

",We Like AGC,"Dyanmic Programming, String, Arithmetic, Dynamic Programming",0.84,37,24
829,"
Score : 300 points


Problem StatementEvery day, N passengers arrive at Takahashi Airport.
The i-th passenger arrives at time T_i.
Every passenger arrived at Takahashi airport travels to the city by bus. Each bus can accommodate up to C passengers.
Naturally, a passenger cannot take a bus that departs earlier than the airplane arrives at the airport.
Also, a passenger will get angry if he/she is still unable to take a bus K units of time after the arrival of the airplane.
For that reason, it is necessary to arrange buses so that the i-th passenger can take a bus departing at time between T_i and T_i + K (inclusive).
When setting the departure times for buses under this condition, find the minimum required number of buses.
Here, the departure time for each bus does not need to be an integer, and there may be multiple buses that depart at the same time.




Constraints
2 \leq N \leq 100000
1 \leq C \leq 10^9
1 \leq K \leq 10^9
1 \leq T_i \leq 10^9
C, K and T_i are integers.







InputThe input is given from Standard Input in the following format:
N C K
T_1
T_2
:
T_N





OutputPrint the minimum required number of buses.






Sample Input 15 3 5
1
2
3
6
12





Sample Output 13

For example, the following three buses are enough:

A bus departing at time 4.5, that carries the passengers arriving at time 2 and 3.
A bus departing at time 6, that carries the passengers arriving at time 1 and 6.
A bus departing at time 12, that carries the passenger arriving at time 12.






Sample Input 26 3 3
7
6
2
8
10
6





Sample Output 23


",Airport Bus,"Sorting, Greedy Algorithm, Two-pointer",0.557,142,56
830,"
Score : 400 points


Problem StatementSnuke found N strange creatures.
Each creature has a fixed color and size. The color and size of the i-th creature are represented by i and A_i, respectively.
Every creature can absorb another creature whose size is at most twice the size of itself.
When a creature of size A and color B absorbs another creature of size C and color D (C \leq 2 \times A), they will merge into one creature of size A+C and color B.
Here, depending on the sizes of two creatures, it is possible that both of them can absorb the other.
Snuke has been watching these creatures merge over and over and ultimately become one creature.
Find the number of the possible colors of this creature.




Constraints
2 \leq N \leq 100000
1 \leq A_i \leq 10^9
A_i is an integer.







InputThe input is given from Standard Input in the following format:
N
A_1 A_2 … A_N





OutputPrint the number of the possible colors of the last remaining creature after the N creatures repeatedly merge and ultimately become one creature.






Sample Input 13
3 1 4





Sample Output 12

The possible colors of the last remaining creature are colors 1 and 3.
For example, when the creature of color 3 absorbs the creature of color 2, then the creature of color 1 absorbs the creature of color 3, the color of the last remaining creature will be color 1.





Sample Input 25
1 1 1 1 1





Sample Output 25

There may be multiple creatures of the same size.





Sample Input 36
40 1 30 2 7 20





Sample Output 34


",Colorful Creatures,"Sorting, Greedy Algorithm, Prefix sum, Bruteforcing",0.568,92,44
831,"
Score : 400 points


Problem StatementOn a two-dimensional plane, there are N red points and N blue points.
The coordinates of the i-th red point are (a_i, b_i), and the coordinates of the i-th blue point are (c_i, d_i).
A red point and a blue point can form a friendly pair when, the x-coordinate of the red point is smaller than that of the blue point, and the y-coordinate of the red point is also smaller than that of the blue point.
At most how many friendly pairs can you form? Note that a point cannot belong to multiple pairs.




Constraints
All input values are integers.
1 \leq N \leq 100
0 \leq a_i, b_i, c_i, d_i < 2N
a_1, a_2, ..., a_N, c_1, c_2, ..., c_N are all different.
b_1, b_2, ..., b_N, d_1, d_2, ..., d_N are all different.







InputInput is given from Standard Input in the following format:
N
a_1 b_1
a_2 b_2
:
a_N b_N
c_1 d_1
c_2 d_2
:
c_N d_N





OutputPrint the maximum number of friendly pairs.






Sample Input 13
2 0
3 1
1 3
4 2
0 4
5 5





Sample Output 12

For example, you can pair (2, 0) and (4, 2), then (3, 1) and (5, 5).





Sample Input 23
0 0
1 1
5 2
2 3
3 4
4 5





Sample Output 22

For example, you can pair (0, 0) and (2, 3), then (1, 1) and (3, 4).





Sample Input 32
2 2
3 3
0 0
1 1





Sample Output 30

It is possible that no pair can be formed.





Sample Input 45
0 0
7 3
2 2
4 8
1 6
8 5
6 9
5 4
9 1
3 7





Sample Output 45






Sample Input 55
0 0
1 1
5 5
6 6
7 7
2 2
3 3
4 4
8 8
9 9





Sample Output 54


",2D Plane 2N Points,"Sorting, Greedy Algorithm, Bruteforcing, Set / Map, Priority Queue",0.417,117,37
832,"
Score : 600 points


Problem StatementRingo Mart, a convenience store, sells apple juice.
On the opening day of Ringo Mart, there were A cans of juice in stock in the morning.
Snuke buys B cans of juice here every day in the daytime.
Then, the manager checks the number of cans of juice remaining in stock every night.
If there are C or less cans, D new cans will be added to the stock by the next morning.
Determine if Snuke can buy juice indefinitely, that is, there is always B or more cans of juice in stock when he attempts to buy them.
Nobody besides Snuke buy juice at this store.
Note that each test case in this problem consists of T queries.




Constraints
1 \leq T \leq 300
1 \leq A, B, C, D \leq 10^{18}
All values in input are integers.







InputInput is given from Standard Input in the following format:
T
A_1 B_1 C_1 D_1
A_2 B_2 C_2 D_2
:
A_T B_T C_T D_T

In the i-th query, A = A_i, B = B_i, C = C_i, D = D_i.




OutputPrint T lines. The i-th line should contain Yes if Snuke can buy apple juice indefinitely in the i-th query; No otherwise.






Sample Input 114
9 7 5 9
9 7 6 9
14 10 7 12
14 10 8 12
14 10 9 12
14 10 7 11
14 10 8 11
14 10 9 11
9 10 5 10
10 10 5 10
11 10 5 10
16 10 5 10
1000000000000000000 17 14 999999999999999985
1000000000000000000 17 15 999999999999999985





Sample Output 1No
Yes
No
Yes
Yes
No
No
Yes
No
Yes
Yes
No
No
Yes

In the first query, the number of cans of juice in stock changes as follows: (D represents daytime and N represents night.)
9
→ 2
→ 11
→ 4
→ 13
→ 6
→ 6
→ x
In the second query, the number of cans of juice in stock changes as follows:
9
→ 2
→ 11
→ 4
→ 13
→ 6
→ 15
→ 8
→ 8
→ 1
→ 10
→ 3
→ 12
→ 5
→ 14
→ 7
→ 7
→ 0
→ 9
→ 2
→ 11
→ …
and so on, thus Snuke can buy juice indefinitely.





Sample Input 224
1 2 3 4
1 2 4 3
1 3 2 4
1 3 4 2
1 4 2 3
1 4 3 2
2 1 3 4
2 1 4 3
2 3 1 4
2 3 4 1
2 4 1 3
2 4 3 1
3 1 2 4
3 1 4 2
3 2 1 4
3 2 4 1
3 4 1 2
3 4 2 1
4 1 2 3
4 1 3 2
4 2 1 3
4 2 3 1
4 3 1 2
4 3 2 1





Sample Output 2No
No
No
No
No
No
Yes
Yes
No
No
No
No
Yes
Yes
Yes
No
No
No
Yes
Yes
Yes
No
No
No


",rng_10s,"Number Theory, Arithmetic, Mathematics",0.226,176,23
833,"
Score : 300 points


Problem StatementThere are 3N participants in AtCoder Group Contest.
The strength of the i-th participant is represented by an integer a_i.
They will form N teams, each consisting of three participants.
No participant may belong to multiple teams.
The strength of a team is defined as the second largest strength among its members.
For example, a team of participants of strength 1, 5, 2 has a strength 2, and a team of three participants of strength 3, 2, 3 has a strength 3.
Find the maximum possible sum of the strengths of N teams.




Constraints
1 ≤ N ≤ 10^5
1 ≤ a_i ≤ 10^{9}
a_i are integers.







InputInput is given from Standard Input in the following format:
N
a_1 a_2 ... a_{3N}





OutputPrint the answer.






Sample Input 12
5 2 8 5 1 5





Sample Output 110

The following is one formation of teams that maximizes the sum of the strengths of teams:

Team 1: consists of the first, fourth and fifth participants.
Team 2: consists of the second, third and sixth participants.






Sample Input 210
1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000





Sample Output 210000000000

The sum of the strengths can be quite large.

",AtCoder Group Contest,"Sorting, Greedy Algorithm, Array, Arithmetic",0.471,144,67
834,"
Score : 300 points


Problem StatementYou are taking a computer-based examination. The examination consists of N questions, and the score allocated to the i-th question is s_i. Your answer to each question will be judged as either ""correct"" or ""incorrect"", and your grade will be the sum of the points allocated to questions that are answered correctly. When you finish answering the questions, your answers will be immediately judged and your grade will be displayed... if everything goes well.
However, the examination system is actually flawed, and if your grade is a multiple of 10, the system displays 0 as your grade. Otherwise, your grade is displayed correctly. In this situation, what is the maximum value that can be displayed as your grade?




Constraints
All input values are integers.
1 ≤ N ≤ 100
1 ≤ s_i ≤ 100







InputInput is given from Standard Input in the following format:
N
s_1
s_2
:
s_N





OutputPrint the maximum value that can be displayed as your grade.






Sample Input 13
5
10
15





Sample Output 125

Your grade will be 25 if the 10-point and 15-point questions are answered correctly and the 5-point question is not, and this grade will be displayed correctly. Your grade will become 30 if the 5-point question is also answered correctly, but this grade will be incorrectly displayed as 0.





Sample Input 23
10
10
15





Sample Output 235

Your grade will be 35 if all the questions are answered correctly, and this grade will be displayed correctly.





Sample Input 33
10
20
30





Sample Output 30

Regardless of whether each question is answered correctly or not, your grade will be a multiple of 10 and displayed as 0.

",Bugged,"Arithmetic, Greedy Algorithm, Sorting, Dyanmic Programming, Bruteforcing",0.484,82,25
835,"
Score : 100 points


Problem StatementWe conducted a survey on newspaper subscriptions.
More specifically, we asked each of the N respondents the following two questions:

Question 1: Are you subscribing to Newspaper X?
Question 2: Are you subscribing to Newspaper Y?

As the result, A respondents answered ""yes"" to Question 1, and B respondents answered ""yes"" to Question 2.
What are the maximum possible number and the minimum possible number of respondents subscribing to both newspapers X and Y?
Write a program to answer this question.




Constraints
1 \leq N \leq 100
0 \leq A \leq N
0 \leq B \leq N
All values in input are integers.







InputInput is given from Standard Input in the following format:
N A B





OutputPrint the maximum possible number and the minimum possible number of respondents subscribing to both newspapers, in this order, with a space in between.






Sample Input 110 3 5





Sample Output 13 0

In this sample, out of the 10 respondents, 3 answered they are subscribing to Newspaper X, and 5 answered they are subscribing to Newspaper Y.
Here, the number of respondents subscribing to both newspapers is at most 3 and at least 0.





Sample Input 210 7 5





Sample Output 25 2

In this sample, out of the 10 respondents, 7 answered they are subscribing to Newspaper X, and 5 answered they are subscribing to Newspaper Y.
Here, the number of respondents subscribing to both newspapers is at most 5 and at least 2.





Sample Input 3100 100 100





Sample Output 3100 100


",Subscribers,"Set / Map, Boolean Operations On Geometric Objects, Mathematics",0.632,119,50
836,"
Score : 600 points


Problem StatementSnuke stands on a number line. He has L ears, and he will walk along the line continuously under the following conditions:

He never visits a point with coordinate less than 0, or a point with coordinate greater than L.
He starts walking at a point with integer coordinate, and also finishes walking at a point with integer coordinate.
He only changes direction at a point with integer coordinate.

Each time when Snuke passes a point with coordinate i-0.5, where i is an integer, he put a stone in his i-th ear.
After Snuke finishes walking, Ringo will repeat the following operations in some order so that, for each i, Snuke's i-th ear contains A_i stones:

Put a stone in one of Snuke's ears.
Remove a stone from one of Snuke's ears.

Find the minimum number of operations required when Ringo can freely decide how Snuke walks.




Constraints
1 \leq L \leq 2\times 10^5
0 \leq A_i \leq 10^9(1\leq i\leq L)
All values in input are integers.







InputInput is given from Standard Input in the following format:
L
A_1
:
A_L





OutputPrint the minimum number of operations required when Ringo can freely decide how Snuke walks.






Sample Input 14
1
0
2
3





Sample Output 11

Assume that Snuke walks as follows:

He starts walking at coordinate 3 and finishes walking at coordinate 4, visiting coordinates 3,4,3,2,3,4 in this order.

Then, Snuke's four ears will contain 0,0,2,3 stones, respectively.
Ringo can satisfy the requirement by putting one stone in the first ear.





Sample Input 28
2
0
0
2
1
3
4
1





Sample Output 23






Sample Input 37
314159265
358979323
846264338
327950288
419716939
937510582
0





Sample Output 31


",Ears,"Dyanmic Programming, String, Parity, Constructive, Dynamic Programming, Mathematics",0.348,35,11
837,"
Score : 400 points


Problem StatementOne day, Snuke was given a permutation of length N, a_1, a_2, ..., a_N, from his friend.
Find the following:





Constraints
1 ≦ N ≦ 200,000
(a_1, a_2, ..., a_N) is a permutation of (1, 2, ..., N).







InputThe input is given from Standard Input in the following format:
N
a_1 a_2 ... a_N





OutputPrint the answer.
Note that the answer may not fit into a 32-bit integer.






Sample Input 13
2 1 3





Sample Output 19






Sample Input 24
1 3 2 4





Sample Output 219






Sample Input 38
5 4 8 1 2 6 7 3





Sample Output 385


",Minimum Sum,"Binary Search Tree, Counting, Monotonic Stack, Bruteforcing, Arithmetic",0.375,63,19
838,"
Score : 400 points


Problem StatementYou are given a string S of length N consisting of ( and ). Your task is to insert some number of ( and ) into S to obtain a correct bracket sequence.
Here, a correct bracket sequence is defined as follows:  

() is a correct bracket sequence.
If X is a correct bracket sequence, the concatenation of (, X and ) in this order is also a correct bracket sequence.
If X and Y are correct bracket sequences, the concatenation of X and Y in this order is also a correct bracket sequence.
Every correct bracket sequence can be derived from the rules above.

Find the shortest correct bracket sequence that can be obtained. If there is more than one such sequence, find the lexicographically smallest one.




Constraints
The length of S is N.
1 ≤ N ≤ 100
S consists of ( and ).







InputInput is given from Standard Input in the following format:
N
S





OutputPrint the lexicographically smallest string among the shortest correct bracket sequences that can be obtained by inserting some number of ( and ) into S.






Sample Input 13
())





Sample Output 1(())






Sample Input 26
)))())





Sample Output 2(((()))())






Sample Input 38
))))((((





Sample Output 3(((())))(((())))


",Insertion,"Greedy Algorithm, String, Counting",0.614,125,63
839,"
Score : 300 points


Problem StatementIroha is very particular about numbers. There are K digits that she dislikes: D_1, D_2, ..., D_K.
She is shopping, and now paying at the cashier.
Her total is N yen (the currency of Japan), thus she has to hand at least N yen to the cashier (and possibly receive the change).
However, as mentioned before, she is very particular about numbers. When she hands money to the cashier, the decimal notation of the amount must not contain any digits that she dislikes. Under this condition, she will hand the minimum amount of money.
Find the amount of money that she will hand to the cashier.




Constraints
 1 ≦ N < 10000
 1 ≦ K < 10
 0 ≦ D_1 < D_2 < … < D_K≦9
\{D_1,D_2,...,D_K\} ≠ \{1,2,3,4,5,6,7,8,9\}







InputThe input is given from Standard Input in the following format:
N K
D_1 D_2 … D_K





OutputPrint the amount of money that Iroha will hand to the cashier.






Sample Input 11000 8
1 3 4 5 6 7 8 9





Sample Output 12000

She dislikes all digits except 0 and 2.
The smallest integer equal to or greater than N=1000 whose decimal notation contains only 0 and 2, is 2000.





Sample Input 29999 1
0





Sample Output 29999


",Iroha's Obsession,"Bruteforcing, Arithmetic, Set / Map, String",0.436,94,33
840,"
Score : 400 points


Problem StatementGiven a string t, we will call it unbalanced if and only if the length of t is at least 2, and more than half of the letters in t are the same. For example, both voodoo and melee are unbalanced, while neither noon nor a is.
You are given a string s consisting of lowercase letters. Determine if there exists a (contiguous) substring of s that is unbalanced. If the answer is positive, show a position where such a substring occurs in s.




Constraints
2 ≦ |s| ≦ 10^5
s consists of lowercase letters.





Partial Score
200 points will be awarded for passing the test set satisfying 2 ≦ N ≦ 100.







InputThe input is given from Standard Input in the following format:
s





OutputIf there exists no unbalanced substring of s, print -1 -1.
If there exists an unbalanced substring of s, let one such substring be s_a s_{a+1} ... s_{b} (1 ≦ a < b ≦ |s|), and print a b. If there exists more than one such substring, any of them will be accepted.






Sample Input 1needed





Sample Output 12 5

The string s_2 s_3 s_4 s_5 = eede is unbalanced. There are also other unbalanced substrings. For example, the output 2 6 will also be accepted.





Sample Input 2atcoder





Sample Output 2-1 -1

The string atcoder contains no unbalanced substring.

",Unbalanced,"Sliding Window, String, Greedy Algorithm, Bruteforcing",0.3,94,35
841,"
Score : 200 points


Problem StatementYou are given an image A composed of N rows and N columns of pixels, and a template image B composed of M rows and M columns of pixels.
A pixel is the smallest element of an image, and in this problem it is a square of size 1×1.
Also, the given images are binary images, and the color of each pixel is either white or black.  
In the input, every pixel is represented by a character: . corresponds to a white pixel, and # corresponds to a black pixel.
The image A is given as N strings A_1,...,A_N.
The j-th character in the string A_i corresponds to the pixel at the i-th row and j-th column of the image A (1≦i,j≦N).
Similarly, the template image B is given as M strings B_1,...,B_M.
The j-th character in the string B_i corresponds to the pixel at the i-th row and j-th column of the template image B (1≦i,j≦M).  
Determine whether the template image B is contained in the image A when only parallel shifts can be applied to the images.  




Constraints
1≦M≦N≦50 
A_i is a string of length N consisting of # and ..
B_i is a string of length M consisting of # and ..







InputThe input is given from Standard Input in the following format:
N M
A_1
A_2
:  
A_N
B_1
B_2
:  
B_M





OutputPrint Yes if the template image B is contained in the image A. Print No otherwise.






Sample Input 13 2
#.#
.#.
#.#
#.
.#





Sample Output 1Yes

The template image B is identical to the upper-left 2 × 2 subimage and the lower-right 2 × 2 subimage of A. Thus, the output should be Yes.





Sample Input 24 1
....
....
....
....
#





Sample Output 2No

The template image B, composed of a black pixel, is not contained in the image A composed of white pixels.

",Template Matching,"Bruteforcing, Array",0.366,373,118
842,"
Score : 400 points


Problem StatementYou are given N non-negative integers A_1, A_2, ..., A_N and another non-negative integer K.
For a integer X between 0 and K (inclusive), let f(X) = (X XOR A_1) + (X XOR A_2) + ... + (X XOR A_N).
Here, for non-negative integers a and b, a XOR b denotes the bitwise exclusive OR of a and b.
Find the maximum value of f.

What is XOR?
The bitwise exclusive OR of a and b, X, is defined as follows:

When X is written in base two, the digit in the 2^k's place (k \geq 0) is 1 if, when written in base two, exactly one of A and B has 1 in the 2^k's place, and 0 otherwise.

For example, 3 XOR 5 = 6. (When written in base two: 011 XOR 101 = 110.)
",XXOR,"Bitmask, Greedy Algorithm, Bit Set, Arithmetic",0.1,262,44
843,"
Score : 400 points


Problem StatementWe say that a odd number N is similar to 2017 when both N and (N+1)/2 are prime.
You are given Q queries.
In the i-th query, given two odd numbers l_i and r_i, find the number of odd numbers x similar to 2017 such that l_i ≤ x ≤ r_i.




Constraints
1≤Q≤10^5
1≤l_i≤r_i≤10^5
l_i and r_i are odd.
All input values are integers.







InputInput is given from Standard Input in the following format:
Q
l_1 r_1
:
l_Q r_Q





OutputPrint Q lines. The i-th line (1≤i≤Q) should contain the response to the i-th query.






Sample Input 11
3 7





Sample Output 12


3 is similar to 2017, since both 3 and (3+1)/2=2 are prime.
5 is similar to 2017, since both 5 and (5+1)/2=3 are prime.
7 is not similar to 2017, since (7+1)/2=4 is not prime, although 7 is prime.

Thus, the response to the first query should be 2.





Sample Input 24
13 13
7 11
7 11
2017 2017





Sample Output 21
0
0
1

Note that 2017 is also similar to 2017.





Sample Input 36
1 53
13 91
37 55
19 51
73 91
13 49





Sample Output 34
4
1
1
1
2


",2017-like Number,"Sieve Of Eratosthenes, Arithmetic, Number Theory, Prefix sum, Segment Tree, Bruteforcing",0.403,190,74
844,"
Score : 400 points


Problem StatementYou are given N items.
The value of the i-th item (1 \leq i \leq N) is v_i.
Your have to select at least A and at most B of these items.
Under this condition, find the maximum possible arithmetic mean of the values of selected items.
Additionally, find the number of ways to select items so that the mean of the values of selected items is maximized.  




Constraints
1 \leq N \leq 50
1 \leq A,B \leq N
1 \leq v_i \leq 10^{15}
Each v_i is an integer.







InputThe input is given from Standard Input in the following format:
N A B
v_1
v_2
...
v_N





OutputPrint two lines.
The first line should contain the maximum possible arithmetic mean of the values of selected items. The output should be considered correct if the absolute or relative error is at most 10^{-6}.
The second line should contain the number of ways to select items so that the mean of the values of selected items is maximized.






Sample Input 15 2 2
1 2 3 4 5





Sample Output 14.500000
1

The mean of the values of selected items will be maximized when selecting the fourth and fifth items. Hence, the first line of the output should contain 4.5.
There is no other way to select items so that the mean of the values will be 4.5, and thus the second line of the output should contain 1.





Sample Input 24 2 3
10 20 10 10





Sample Output 215.000000
3

There can be multiple ways to select items so that the mean of the values will be maximized.





Sample Input 35 1 5
1000000000000000 999999999999999 999999999999998 999999999999997 999999999999996





Sample Output 31000000000000000.000000
1


",Maximum Average Sets,"Sorting, Combinatorics, Counting, Arithmetic",0.2,126,17
845,"
Score : 400 points


Problem StatementThere are N islands and M bridges.
The i-th bridge connects the A_i-th and B_i-th islands bidirectionally.
Initially, we can travel between any two islands using some of these bridges.
However, the results of a survey show that these bridges will all collapse because of aging, in the order from the first bridge to the M-th bridge.
Let the inconvenience be the number of pairs of islands (a, b) (a < b) such that we are no longer able to travel between the a-th and b-th islands using some of the bridges remaining.
For each i (1 \leq i \leq M), find the inconvenience just after the i-th bridge collapses.




Constraints
All values in input are integers.
2 \leq N \leq 10^5
1 \leq M \leq 10^5
1 \leq A_i < B_i \leq N
All pairs (A_i, B_i) are distinct.
The inconvenience is initially 0.







InputInput is given from Standard Input in the following format:
N M
A_1 B_1
A_2 B_2
\vdots
A_M B_M





OutputIn the order i = 1, 2, ..., M, print the inconvenience just after the i-th bridge collapses.
Note that the answer may not fit into a 32-bit integer type.






Sample Input 14 5
1 2
3 4
1 3
2 3
1 4





Sample Output 10
0
4
5
6

For example, when the first to third bridges have collapsed, the inconvenience is 4 since we can no longer travel between the pairs (1, 2), (1, 3), (2, 4) and (3, 4).





Sample Input 26 5
2 3
1 2
5 6
3 4
4 5





Sample Output 28
9
12
14
15






Sample Input 32 1
1 2





Sample Output 31


",Decayed Bridges,"Graph Theory, Offline Queries, Disjoint Set, Combinatorics, Array",0.273,132,41
846,"
Score : 400 points


Problem StatementThere are N towns in the State of Atcoder, connected by M bidirectional roads.
The i-th road connects Town A_i and B_i and has a length of C_i.
Joisino is visiting R towns in the state, r_1,r_2,..,r_R (not necessarily in this order).
She will fly to the first town she visits, and fly back from the last town she visits, but for the rest of the trip she will have to travel by road.
If she visits the towns in the order that minimizes the distance traveled by road, what will that distance be?




Constraints
2≤N≤200
1≤M≤N×(N-1)/2
2≤R≤min(8,N) (min(8,N) is the smaller of 8 and N.)
r_i≠r_j (i≠j)
1≤A_i,B_i≤N, A_i≠B_i
(A_i,B_i)≠(A_j,B_j),(A_i,B_i)≠(B_j,A_j) (i≠j)
1≤C_i≤100000
Every town can be reached from every town by road.
All input values are integers.







InputInput is given from Standard Input in the following format:
N M R
r_1 ... r_R
A_1 B_1 C_1
:
A_M B_M C_M





OutputPrint the distance traveled by road if Joisino visits the towns in the order that minimizes it.






Sample Input 13 3 3
1 2 3
1 2 1
2 3 1
3 1 4





Sample Output 12

For example, if she visits the towns in the order of 1, 2, 3, the distance traveled will be 2, which is the minimum possible.





Sample Input 23 3 2
1 3
2 3 2
1 3 6
1 2 2





Sample Output 24

The shortest distance between Towns 1 and 3 is 4. Thus, whether she visits Town 1 or 3 first, the distance traveled will be 4.





Sample Input 34 6 3
2 3 4
1 2 4
2 3 3
4 3 1
1 4 1
4 2 2
3 1 6





Sample Output 33


",joisino's travel,"Graph Theory, Floyd-warshall, Backtracking, Bruteforcing, Depth-first Search, Mathematics",0.431,134,52
847,"
Score: 400 points


Problem Statement
Print a sequence a_1, a_2, ..., a_N whose length is N that satisfies the following conditions:

a_i (1 \leq i \leq N) is a prime number at most 55 555.
The values of a_1, a_2, ..., a_N are all different.
In every choice of five different integers from a_1, a_2, ..., a_N, the sum of those integers is a composite number.

If there are multiple such sequences, printing any of them is accepted.




Notes
An integer N not less than 2 is called a prime number if it cannot be divided evenly by any integers except 1 and N, and called a composite number otherwise.




Constraints

N is an integer between 5 and 55 (inclusive).







Input
Input is given from Standard Input in the following format:
N





Output
Print N numbers a_1, a_2, a_3, ..., a_N in a line, with spaces in between.






Sample Input 15





Sample Output 13 5 7 11 31

Let us see if this output actually satisfies the conditions.
First, 3, 5, 7, 11 and 31 are all different, and all of them are prime numbers.
The only way to choose five among them is to choose all of them, whose sum is a_1+a_2+a_3+a_4+a_5=57, which is a composite number.
There are also other possible outputs, such as 2 3 5 7 13, 11 13 17 19 31 and 7 11 5 31 3.  





Sample Input 26





Sample Output 22 3 5 7 11 13


2, 3, 5, 7, 11, 13 are all different prime numbers.
2+3+5+7+11=28 is a composite number.
2+3+5+7+13=30 is a composite number.
2+3+5+11+13=34 is a composite number.
2+3+7+11+13=36 is a composite number.
2+5+7+11+13=38 is a composite number.
3+5+7+11+13=39 is a composite number.

Thus, the sequence 2 3 5 7 11 13 satisfies the conditions.  





Sample Input 38





Sample Output 32 5 7 13 19 37 67 79


",Five  Five Everywhere,"Sieve Of Eratosthenes, Arithmetic, Set / Map, Combinatorics, Bruteforcing",0.458,183,55
848,"
Score : 600 points


Problem StatementYou are given a string S of length 2N consisting of lowercase English letters.
There are 2^{2N} ways to color each character in S red or blue. Among these ways, how many satisfy the following condition?

The string obtained by reading the characters painted red from left to right is equal to the string obtained by reading the characters painted blue from right to left.





Constraints
1 \leq N \leq 18
The length of S is 2N.
S consists of lowercase English letters.







InputInput is given from Standard Input in the following format:
N
S





OutputPrint the number of ways to paint the string that satisfy the condition.






Sample Input 14
cabaacba





Sample Output 14

There are four ways to paint the string, as follows:

cabaacba
cabaacba
cabaacba
cabaacba






Sample Input 211
mippiisssisssiipsspiim





Sample Output 2504






Sample Input 34
abcdefgh





Sample Output 30






Sample Input 418
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa





Sample Output 49075135300

The answer may not be representable as a 32-bit integer.

",String Coloring,"Bitmask, String, Set / Map, Combinatorics, Divide And Conquer",0.812,23,17
849,"
Score : 300 points


Problem StatementLet us define the beauty of a sequence (a_1,... ,a_n) as the number of pairs of two adjacent elements in it whose absolute differences are d.
For example, when d=1, the beauty of the sequence (3, 2, 3, 10, 9) is 3.
There are a total of n^m sequences of length m where each element is an integer between 1 and n (inclusive).
Find the beauty of each of these n^m sequences, and print the average of those values.




Constraints
0 \leq d < n \leq 10^9
2 \leq m \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
n m d





OutputPrint the average of the beauties of the sequences of length m where each element is an integer between 1 and n.
The output will be judged correct if the absolute or relative error is at most 10^{-6}.






Sample Input 12 3 1





Sample Output 11.0000000000

The beauty of (1,1,1) is 0.
The beauty of (1,1,2) is 1.
The beauty of (1,2,1) is 2.
The beauty of (1,2,2) is 1.
The beauty of (2,1,1) is 1.
The beauty of (2,1,2) is 2.
The beauty of (2,2,1) is 1.
The beauty of (2,2,2) is 0.
The answer is the average of these values: (0+1+2+1+1+2+1+0)/8=1.





Sample Input 21000000000 180707 0





Sample Output 20.0001807060


",Ordinary Beauty,"Probability Theory, Combinatorics, Arithmetic, Boolean Operations On Geometric Objects",0.511,107,40
850,"
Score : 400 points


Problem StatementKenkoooo is planning a trip in Republic of Snuke.
In this country, there are n cities and m trains running.
The cities are numbered 1 through n, and the i-th train connects City u_i and v_i bidirectionally.
Any city can be reached from any city by changing trains.
Two currencies are used in the country: yen and snuuk.
Any train fare can be paid by both yen and snuuk.
The fare of the i-th train is a_i yen if paid in yen, and b_i snuuk if paid in snuuk.
In a city with a money exchange office, you can change 1 yen into 1 snuuk.
However, when you do a money exchange, you have to change all your yen into snuuk.
That is, if Kenkoooo does a money exchange when he has X yen, he will then have X snuuk.
Currently, there is a money exchange office in every city, but the office in City i will shut down in i years and can never be used in and after that year.
Kenkoooo is planning to depart City s with 10^{15} yen in his pocket and head for City t, and change his yen into snuuk in some city while traveling.
It is acceptable to do the exchange in City s or City t.
Kenkoooo would like to have as much snuuk as possible when he reaches City t by making the optimal choices for the route to travel and the city to do the exchange.
For each i=0,...,n-1, find the maximum amount of snuuk that Kenkoooo has when he reaches City t if he goes on a trip from City s to City t after i years.
You can assume that the trip finishes within the year.




Constraints
2 \leq n \leq 10^5
1 \leq m \leq 10^5
1 \leq s,t \leq n
s \neq t
1 \leq u_i < v_i \leq n
1 \leq a_i,b_i \leq 10^9
If i\neq j, then u_i \neq u_j  or v_i \neq v_j.
Any city can be reached from any city by changing trains.
All values in input are integers.







InputInput is given from Standard Input in the following format:
n m s t
u_1 v_1 a_1 b_1
:
u_m v_m a_m b_m





OutputPrint n lines.
In the i-th line, print the maximum amount of snuuk that Kenkoooo has when he reaches City t if he goes on a trip from City s to City t after i-1 years.






Sample Input 14 3 2 3
1 4 1 100
1 2 1 10
1 3 20 1





Sample Output 1999999999999998
999999999999989
999999999999979
999999999999897

After 0 years, it is optimal to do the exchange in City 1.
After 1 years, it is optimal to do the exchange in City 2.
Note that City 1 can still be visited even after the exchange office is closed.
Also note that, if it was allowed to keep 1 yen when do the exchange in City 2 and change the remaining yen into snuuk, we could reach City 3 with 999999999999998 snuuk, but this is NOT allowed.
After 2 years, it is optimal to do the exchange in City 3.
After 3 years, it is optimal to do the exchange in City 4.
Note that the same train can be used multiple times.





Sample Input 28 12 3 8
2 8 685087149 857180777
6 7 298270585 209942236
2 4 346080035 234079976
2 5 131857300 22507157
4 8 30723332 173476334
2 6 480845267 448565596
1 4 181424400 548830121
4 5 57429995 195056405
7 8 160277628 479932440
1 6 475692952 203530153
3 5 336869679 160714712
2 7 389775999 199123879





Sample Output 2999999574976994
999999574976994
999999574976994
999999574976994
999999574976994
999999574976994
999999574976994
999999574976994


",Saving Snuuk,"Graph Theory, Dijkstra's, Priority Queue, Graph Traversal, Array, Arithmetic",0.462,51,14
851,"
Score : 600 points


Problem StatementKenkoooo found a simple connected graph.
The vertices are numbered 1 through n.
The i-th edge connects Vertex u_i and v_i, and has a fixed integer s_i.
Kenkoooo is trying to write a positive integer in each vertex so that the following condition is satisfied:

For every edge i, the sum of the positive integers written in Vertex u_i and v_i is equal to s_i.

Find the number of such ways to write positive integers in the vertices.




Constraints
2 \leq n \leq 10^5
1 \leq m \leq 10^5
1 \leq u_i < v_i \leq n
2 \leq s_i \leq 10^9
If i\neq j, then u_i \neq u_j  or v_i \neq v_j.
The graph is connected.
All values in input are integers.







InputInput is given from Standard Input in the following format:
n m
u_1 v_1 s_1
:
u_m v_m s_m





OutputPrint the number of ways to write positive integers in the vertices so that the condition is satisfied.






Sample Input 13 3
1 2 3
2 3 5
1 3 4





Sample Output 11

The condition will be satisfied if we write 1,2 and 3 in vertices 1,2 and 3, respectively.
There is no other way to satisfy the condition, so the answer is 1.





Sample Input 24 3
1 2 6
2 3 7
3 4 5





Sample Output 23

Let a,b,c and d be the numbers to write in vertices 1,2,3 and 4, respectively.
There are three quadruples (a,b,c,d) that satisfy the condition:

(a,b,c,d)=(1,5,2,3)
(a,b,c,d)=(2,4,3,2)
(a,b,c,d)=(3,3,4,1)






Sample Input 38 7
1 2 1000000000
2 3 2
3 4 1000000000
4 5 2
5 6 1000000000
6 7 2
7 8 1000000000





Sample Output 30


",+ Graph,"Depth-first Search, Disjoint Set, Mathematics, Sorting, Graph Theory",0.3,21,7
852,"
Score : 300 points


Problem StatementSnuke has an integer sequence A of length N.
He will freely choose an integer b.
Here, he will get sad if A_i and b+i are far from each other.
More specifically, the sadness of Snuke is calculated as follows:

abs(A_1 - (b+1)) + abs(A_2 - (b+2)) + ... + abs(A_N - (b+N))

Here, abs(x) is a function that returns the absolute value of x.
Find the minimum possible sadness of Snuke.




Constraints
1 \leq N \leq 2 \times 10^5
1 \leq A_i \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
A_1 A_2 ... A_N





OutputPrint the minimum possible sadness of Snuke.






Sample Input 15
2 2 3 5 5





Sample Output 12

If we choose b=0, the sadness of Snuke would be abs(2-(0+1))+abs(2-(0+2))+abs(3-(0+3))+abs(5-(0+4))+abs(5-(0+5))=2.
Any choice of b does not make the sadness of Snuke less than 2, so the answer is 2.





Sample Input 29
1 2 3 4 5 6 7 8 9





Sample Output 20






Sample Input 36
6 5 4 3 2 1





Sample Output 318






Sample Input 47
1 1 1 1 2 3 4





Sample Output 46


",Linear Approximation,"Array, Sorting, Arithmetic",0.375,131,42
853,"
Score : 600 points


Problem StatementSnuke has an integer sequence A of length N.
He will make three cuts in A and divide it into four (non-empty) contiguous subsequences B, C, D and E.
The positions of the cuts can be freely chosen.
Let P,Q,R,S be the sums of the elements in B,C,D,E, respectively.
Snuke is happier when the absolute difference of the maximum and the minimum among P,Q,R,S is smaller.
Find the minimum possible absolute difference of the maximum and the minimum among P,Q,R,S.




Constraints
4 \leq N \leq 2 \times 10^5
1 \leq A_i \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
A_1 A_2 ... A_N





OutputFind the minimum possible absolute difference of the maximum and the minimum among P,Q,R,S.






Sample Input 15
3 2 4 1 2





Sample Output 12

If we divide A as B,C,D,E=(3),(2),(4),(1,2), then P=3,Q=2,R=4,S=1+2=3.
Here, the maximum and the minimum among P,Q,R,S are 4 and 2, with the absolute difference of 2.
We cannot make the absolute difference of the maximum and the minimum less than 2, so the answer is 2.





Sample Input 210
10 71 84 33 6 47 23 25 52 64





Sample Output 236






Sample Input 37
1 2 3 1000000000 4 5 6





Sample Output 3999999994


",Equal Cut,"Prefix sum, Binary Search, Two-pointer, Sliding Window, Bruteforcing, Mathematics",0.5,47,17
854,"
Score : 400 points


Problem StatementWe have a permutation of the integers from 1 through N, p_1, p_2, .., p_N.
We also have M pairs of two integers between 1 and N (inclusive), represented as (x_1,y_1), (x_2,y_2), .., (x_M,y_M).
AtCoDeer the deer is going to perform the following operation on p as many times as desired so that the number of i (1 ≤ i ≤ N) such that p_i = i is maximized:

Choose j such that 1 ≤ j ≤ M, and swap p_{x_j} and p_{y_j}.

Find the maximum possible number of i such that p_i = i after operations.




Constraints
2 ≤ N ≤ 10^5
1 ≤ M ≤ 10^5
p is a permutation of integers from 1 through N.
1 ≤ x_j,y_j ≤ N
x_j ≠ y_j
If i ≠ j, \{x_i,y_i\} ≠ \{x_j,y_j\}.
All values in input are integers.







InputInput is given from Standard Input in the following format:
N M
p_1 p_2 .. p_N
x_1 y_1
x_2 y_2
:
x_M y_M





OutputPrint the maximum possible number of i such that p_i = i after operations.






Sample Input 15 2
5 3 1 4 2
1 3
5 4





Sample Output 12

If we perform the operation by choosing j=1, p becomes 1 3 5 4 2, which is optimal, so the answer is 2.





Sample Input 23 2
3 2 1
1 2
2 3





Sample Output 23

If we perform the operation by, for example, choosing j=1, j=2, j=1 in this order, p becomes 1 2 3, which is obviously optimal.
Note that we may choose the same j any number of times.





Sample Input 310 8
5 3 6 8 7 10 9 1 2 4
3 1
4 1
5 9
2 5
6 5
3 5
8 9
7 9





Sample Output 38






Sample Input 45 1
1 2 3 4 5
1 5





Sample Output 45

We do not have to perform the operation. 

",Equals,"Graph Theory, Disjoint Set, Combinatorics, Set / Map",0.48,42,20
855,"
Score : 600 points


Problem StatementYou are given an integer sequence A of length N and an integer K.
You will perform the following operation on this sequence Q times:

Choose a contiguous subsequence of length K, then remove the smallest element among the K elements contained in the chosen subsequence (if there are multiple such elements, choose one of them as you like).

Let X and Y be the values of the largest and smallest element removed in the Q operations. You would like X-Y to be as small as possible.
Find the smallest possible value of X-Y when the Q operations are performed optimally.




Constraints
1 \leq N \leq 2000
1 \leq K \leq N
1 \leq Q \leq N-K+1
1 \leq A_i \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N K Q
A_1 A_2 ... A_N





OutputPrint the smallest possible value of X-Y.






Sample Input 15 3 2
4 3 1 5 2





Sample Output 11

In the first operation, whichever contiguous subsequence of length 3 we choose, the minimum element in it is 1.
Thus, the first operation removes A_3=1 and now we have A=(4,3,5,2).
In the second operation, it is optimal to choose (A_2,A_3,A_4)=(3,5,2) as the contiguous subsequence of length 3 and remove A_4=2.
In this case, the largest element removed is 2, and the smallest is 1, so their difference is 2-1=1.





Sample Input 210 1 6
1 1 2 3 5 8 13 21 34 55





Sample Output 27






Sample Input 311 7 5
24979445 861648772 623690081 433933447 476190629 262703497 211047202 971407775 628894325 731963982 822804784





Sample Output 3451211184


",Range Minimum Queries,"Sorting, Sliding Window, Two-pointer, Binary Search, Greedy Algorithm, Array, Priority Queue",0.474,39,13
856,"
Score : 300 points


Problem StatementThere is a grid with infinitely many rows and columns. In this grid, there is a rectangular region with consecutive N rows and M columns, and a card is placed in each square in this region.
The front and back sides of these cards can be distinguished, and initially every card faces up.
We will perform the following operation once for each square contains a card:

For each of the following nine squares, flip the card in it if it exists: the target square itself and the eight squares that shares a corner or a side with the target square.

It can be proved that, whether each card faces up or down after all the operations does not depend on the order the operations are performed.
Find the number of cards that face down after all the operations.




Constraints
1 \leq N,M \leq 10^9
All input values are integers.







InputInput is given from Standard Input in the following format:
N M





OutputPrint the number of cards that face down after all the operations.






Sample Input 12 2





Sample Output 10

We will flip every card in any of the four operations. Thus, after all the operations, all cards face up.





Sample Input 21 7





Sample Output 25

After all the operations, all cards except at both ends face down.





Sample Input 3314 1592





Sample Output 3496080


",Flip Flip  and Flip......,"Parity, Combinatorics, Boolean Operations On Geometric Objects, Arithmetic",0.145,217,68
857,"
Score : 400 points


Problem StatementThere is a grid with N rows and N columns of squares. Let (i,j) be the square at the i-th row from the top and the j-th column from the left.
These squares have to be painted in one of the C colors from Color 1 to Color C. Initially, (i,j) is painted in Color c_{i,j}.
We say the grid is a good grid when the following condition is met for all i,j,x,y satisfying 1 \leq i,j,x,y \leq N:

If (i+j) \% 3=(x+y) \% 3, the color of (i,j) and the color of (x,y) are the same.
If (i+j) \%  3 \neq (x+y) \% 3, the color of (i,j) and the color of (x,y) are different.

Here, X \% Y represents X modulo Y.
We will repaint zero or more squares so that the grid will be a good grid.
For a square, the wrongness when the color of the square is X before repainting and Y after repainting, is D_{X,Y}.
Find the minimum possible sum of the wrongness of all the squares.




Constraints
1 \leq N \leq 500
3 \leq C \leq 30
1 \leq D_{i,j} \leq 1000 (i \neq j),D_{i,j}=0 (i=j)
1 \leq c_{i,j} \leq C
All values in input are integers.







InputInput is given from Standard Input in the following format:
N C
D_{1,1} ... D_{1,C}
:
D_{C,1} ... D_{C,C}
c_{1,1} ... c_{1,N}
:
c_{N,1} ... c_{N,N}





OutputIf the minimum possible sum of the wrongness of all the squares is x, print x.






Sample Input 12 3
0 1 1
1 0 1
1 4 0
1 2
3 3





Sample Output 13


Repaint (1,1) to Color 2. The wrongness of (1,1) becomes D_{1,2}=1.
Repaint (1,2) to Color 3. The wrongness of (1,2) becomes D_{2,3}=1.
Repaint (2,2) to Color 1. The wrongness of (2,2) becomes D_{3,1}=1.

In this case, the sum of the wrongness of all the squares is 3.
Note that D_{i,j} \neq D_{j,i} is possible.





Sample Input 24 3
0 12 71
81 0 53
14 92 0
1 1 2 1
2 1 1 2
2 2 1 3
1 1 2 2





Sample Output 2428


",Good Grid,"Arithmetic, Counting, Bruteforcing, Combinatorics, Precomputation, Backtracking",0.457,72,32
858,"
Score : 400 points


Problem StatementWe have a grid with H rows and W columns of squares.
Snuke is painting these squares in colors 1, 2, ..., N.
Here, the following conditions should be satisfied:

For each i (1 ≤ i ≤ N), there are exactly a_i squares painted in Color i. Here, a_1 + a_2 + ... + a_N = H W.
For each i (1 ≤ i ≤ N), the squares painted in Color i are 4-connected. That is, every square painted in Color i can be reached from every square painted in Color i by repeatedly traveling to a horizontally or vertically adjacent square painted in Color i.

Find a way to paint the squares so that the conditions are satisfied.
It can be shown that a solution always exists.




Constraints
1 ≤ H, W ≤ 100
1 ≤ N ≤ H W
a_i ≥ 1
a_1 + a_2 + ... + a_N = H W







InputInput is given from Standard Input in the following format:
H W
N
a_1 a_2 ... a_N





OutputPrint one way to paint the squares that satisfies the conditions.
Output in the following format:
c_{1 1} ... c_{1 W}
:
c_{H 1} ... c_{H W}

Here, c_{i j} is the color of the square at the i-th row from the top and j-th column from the left.






Sample Input 12 2
3
2 1 1





Sample Output 11 1
2 3

Below is an example of an invalid solution:
1 2
3 1

This is because the squares painted in Color 1 are not 4-connected.





Sample Input 23 5
5
1 2 3 4 5





Sample Output 21 4 4 4 3
2 5 4 5 3
2 5 5 5 3






Sample Input 31 1
1
1





Sample Output 31


",Grid Coloring,"Greedy Algorithm, Grid Graph, Array",0.722,63,40
859,"
Score : 500 points


Problem StatementYou are given a string S consisting of 0 and 1.
Find the maximum integer K not greater than |S| such that we can turn all the characters of S into 0 by repeating the following operation some number of times.

Choose a contiguous segment [l,r] in S whose length is at least K (that is, r-l+1\geq K must be satisfied). For each integer i such that l\leq i\leq r, do the following: if S_i is 0, replace it with 1; if S_i is 1, replace it with 0.





Constraints
1\leq |S|\leq 10^5
S_i(1\leq i\leq N) is either 0 or 1.







InputInput is given from Standard Input in the following format:
S





OutputPrint the maximum integer K such that we can turn all the characters of S into 0 by repeating the operation some number of times.






Sample Input 1010





Sample Output 12

We can turn all the characters of S into 0 by the following operations:

Perform the operation on the segment S[1,3] with length 3. S is now 101.
Perform the operation on the segment S[1,2] with length 2. S is now 011.
Perform the operation on the segment S[2,3] with length 2. S is now 000.






Sample Input 2100000000





Sample Output 28






Sample Input 300001111





Sample Output 34


",Wide Flip,"String, Greedy Algorithm, Parity",0.25,55,9
860,"
Score : 500 points


Problem StatementIn Takahashi Kingdom, which once existed, there are N cities, and some pairs of cities are connected bidirectionally by roads.
The following are known about the road network:

People traveled between cities only through roads. It was possible to reach any city from any other city, via intermediate cities if necessary.
Different roads may have had different lengths, but all the lengths were positive integers.

Snuke the archeologist found a table with N rows and N columns, A, in the ruin of Takahashi Kingdom.
He thought that it represented the shortest distances between the cities along the roads in the kingdom.
Determine whether there exists a road network such that for each u and v, the integer A_{u, v} at the u-th row and v-th column of A is equal to the length of the shortest path from City u to City v.
If such a network exist, find the shortest possible total length of the roads.




Constraints
1 \leq N \leq 300
If i ≠ j, 1 \leq A_{i, j} = A_{j, i} \leq 10^9.
A_{i, i} = 0







InputsInput is given from Standard Input in the following format:
N
A_{1, 1} A_{1, 2} ... A_{1, N}
A_{2, 1} A_{2, 2} ... A_{2, N}
...
A_{N, 1} A_{N, 2} ... A_{N, N}





OutputsIf there exists no network that satisfies the condition, print -1.
If it exists, print the shortest possible total length of the roads.






Sample Input 13
0 1 3
1 0 2
3 2 0





Sample Output 13

The network below satisfies the condition:

City 1 and City 2 is connected by a road of length 1.
City 2 and City 3 is connected by a road of length 2.
City 3 and City 1 is not connected by a road.






Sample Input 23
0 1 3
1 0 1
3 1 0





Sample Output 2-1

As there is a path of length 1 from City 1 to City 2 and City 2 to City 3, there is a path of length 2 from City 1 to City 3.
However, according to the table, the shortest distance between City 1 and City 3 must be 3.
Thus, we conclude that there exists no network that satisfies the condition.





Sample Input 35
0 21 18 11 28
21 0 13 10 26
18 13 0 23 13
11 10 23 0 17
28 26 13 17 0





Sample Output 382






Sample Input 43
0 1000000000 1000000000
1000000000 0 1000000000
1000000000 1000000000 0





Sample Output 43000000000


",Restoring Road Network,"Graph Theory, Mathematics, Bruteforcing, Matrix, Counting",0.556,33,16
861,"
Score : 300 points


Problem StatementWhen l is an odd number, the median of l numbers a_1, a_2, ..., a_l is the (\frac{l+1}{2})-th largest value among a_1, a_2, ..., a_l.
You are given N numbers X_1, X_2, ..., X_N, where N is an even number.
For each i = 1, 2, ..., N, let the median of X_1, X_2, ..., X_N excluding X_i, that is, the median of X_1, X_2, ..., X_{i-1}, X_{i+1}, ..., X_N be B_i.
Find B_i for each i = 1, 2, ..., N.




Constraints
2 \leq N \leq 200000
N is even.
1 \leq X_i \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
X_1 X_2 ... X_N





OutputPrint N lines.
The i-th line should contain B_i.






Sample Input 14
2 4 4 3





Sample Output 14
3
3
4


Since the median of X_2, X_3, X_4 is 4, B_1 = 4.
Since the median of X_1, X_3, X_4 is 3, B_2 = 3.
Since the median of X_1, X_2, X_4 is 3, B_3 = 3.
Since the median of X_1, X_2, X_3 is 4, B_4 = 4.






Sample Input 22
1 2





Sample Output 22
1






Sample Input 36
5 5 4 4 3 3





Sample Output 34
4
4
4
4
4


",Many Medians,"Sorting, Array, Mathematics, Boolean Operations On Geometric Objects, Bruteforcing",0.75,41,26
862,"
Score : 600 points


Problem StatementYou are given an integer sequence of length n+1, a_1,a_2,...,a_{n+1}, which consists of the n integers 1,...,n.
It is known that each of the n integers 1,...,n appears at least once in this sequence.
For each integer k=1,...,n+1, find the number of the different subsequences (not necessarily contiguous) of the given sequence with length k, modulo 10^9+7.




Notes

If the contents of two subsequences are the same, they are not separately counted even if they originate from different positions in the original sequence.


A subsequence of a sequence a with length k is a sequence obtained by selecting k of the elements of a and arranging them without changing their relative order. For example, the sequences 1,3,5 and 1,2,3 are subsequences of 1,2,3,4,5, while 3,1,2 and 1,10,100 are not.






Constraints
1 \leq n \leq 10^5
1 \leq a_i \leq n
Each of the integers 1,...,n appears in the sequence.
n and a_i are integers.







InputInput is given from Standard Input in the following format:
n
a_1 a_2 ... a_{n+1}





OutputPrint n+1 lines.
The k-th line should contain the number of the different subsequences of the given sequence with length k, modulo 10^9+7.






Sample Input 13
1 2 1 3





Sample Output 13
5
4
1

There are three subsequences with length 1: 1 and 2 and 3.
There are five subsequences with length 2: 1,1 and 1,2 and 1,3 and 2,1 and 2,3.
There are four subsequences with length 3: 1,1,3 and 1,2,1 and 1,2,3 and 2,1,3.
There is one subsequence with length 4: 1,2,1,3.





Sample Input 21
1 1





Sample Output 21
1

There is one subsequence with length 1: 1.
There is one subsequence with length 2: 1,1.





Sample Input 332
29 19 7 10 26 32 27 4 11 20 2 8 16 23 5 14 6 12 17 22 18 30 28 24 15 1 25 3 13 21 19 31 9





Sample Output 332
525
5453
40919
237336
1107568
4272048
13884156
38567100
92561040
193536720
354817320
573166440
818809200
37158313
166803103
166803103
37158313
818809200
573166440
354817320
193536720
92561040
38567100
13884156
4272048
1107568
237336
40920
5456
528
33
1

Be sure to print the numbers modulo 10^9+7.

",11,"Two-pointer, Combinatorics, Arithmetic, Exponentiation By Squaring, Precomputation, Inclusion And Exclusion",0.412,38,10
863,"
Score : 500 points


Problem StatementLet N be a positive integer.
There is a numerical sequence of length 3N, a = (a_1, a_2, ..., a_{3N}).
Snuke is constructing a new sequence of length 2N, a', by removing exactly N elements from a without changing the order of the remaining elements.
Here, the score of a' is defined as follows: (the sum of the elements in the first half of a') - (the sum of the elements in the second half of a').
Find the maximum possible score of a'.




Constraints
1 ≤ N ≤ 10^5
a_i is an integer.
1 ≤ a_i ≤ 10^9





Partial Score
In the test set worth 300 points, N ≤ 1000.







InputInput is given from Standard Input in the following format:
N
a_1 a_2 ... a_{3N}





OutputPrint the maximum possible score of a'.






Sample Input 12
3 1 4 1 5 9





Sample Output 11

When a_2 and a_6 are removed, a' will be (3, 4, 1, 5), which has a score of (3 + 4) - (1 + 5) = 1.





Sample Input 21
1 2 3





Sample Output 2-1

For example, when a_1 are removed, a' will be (2, 3), which has a score of 2 - 3 = -1.





Sample Input 33
8 2 2 7 4 6 5 3 8





Sample Output 35

For example, when a_2, a_3 and a_9 are removed, a' will be (8, 7, 4, 6, 5, 3), which has a score of (8 + 7 + 4) - (6 + 5 + 3) = 5.

",3N Numbers,"Priority Queue, Prefix sum, Sliding Window, Greedy Algorithm, Two-pointer",0.316,45,18
864,"
Score : 400 points


Problem StatementSnuke has decided to play a game using cards.
He has a deck consisting of N cards. On the i-th card from the top, an integer A_i is written.
He will perform the operation described below zero or more times, so that the values written on the remaining cards will be pairwise distinct. Find the maximum possible number of remaining cards. Here, N is odd, which guarantees that at least one card can be kept.
Operation: Take out three arbitrary cards from the deck. Among those three cards, eat two: one with the largest value, and another with the smallest value. Then, return the remaining one card to the deck.




Constraints
3 ≦ N ≦ 10^{5}
N is odd.
1 ≦ A_i ≦ 10^{5}
A_i is an integer.







InputThe input is given from Standard Input in the following format:
N
A_1 A_2 A_3 ... A_{N}





OutputPrint the answer.






Sample Input 15
1 2 1 3 7





Sample Output 13

One optimal solution is to perform the operation once, taking out two cards with 1 and one card with 2. One card with 1 and another with 2 will be eaten, and the remaining card with 1 will be returned to deck. Then, the values written on the remaining cards in the deck will be pairwise distinct: 1, 3 and 7.





Sample Input 215
1 3 5 2 1 3 2 8 8 6 2 6 11 1 1





Sample Output 27


",Card Eater,"Counting, Greedy Algorithm, Parity, Bruteforcing, Boolean Operations On Geometric Objects",0.8,41,31
865,"
Score : 300 points


Problem StatementYou are given three integers A, B and C. Find the minimum number of operations required to make A, B and C all equal by repeatedly performing the following two kinds of operations in any order:

Choose two among A, B and C, then increase both by 1.
Choose one among A, B and C, then increase it by 2.

It can be proved that we can always make A, B and C all equal by repeatedly performing these operations.




Constraints
0 \leq A,B,C \leq 50
All values in input are integers.







InputInput is given from Standard Input in the following format:
A B C





OutputPrint the minimum number of operations required to make A, B and C all equal.






Sample Input 12 5 4





Sample Output 12

We can make A, B and C all equal by the following operations:

Increase A and C by 1. Now, A, B, C are 3, 5, 5, respectively.
Increase A by 2. Now, A, B, C are 5, 5, 5, respectively.






Sample Input 22 6 3





Sample Output 25






Sample Input 331 41 5





Sample Output 323


",Same Integers,"Boolean Operations On Geometric Objects, Arithmetic, Greedy Algorithm, Sorting",0.806,42,32
866,"
Score : 300 points


Problem StatementWe have a 2 \times N grid. We will denote the square at the i-th row and j-th column (1 \leq i \leq 2, 1 \leq j \leq N) as (i, j).
You are initially in the top-left square, (1, 1).
You will travel to the bottom-right square, (2, N), by repeatedly moving right or down.
The square (i, j) contains A_{i, j} candies.
You will collect all the candies you visit during the travel.
The top-left and bottom-right squares also contain candies, and you will also collect them.
At most how many candies can you collect when you choose the best way to travel?




Constraints
1 \leq N \leq 100
1 \leq A_{i, j} \leq 100 (1 \leq i \leq 2, 1 \leq j \leq N)







InputInput is given from Standard Input in the following format:
N
A_{1, 1} A_{1, 2} ... A_{1, N}
A_{2, 1} A_{2, 2} ... A_{2, N}





OutputPrint the maximum number of candies that can be collected.






Sample Input 15
3 2 2 4 1
1 2 2 2 1





Sample Output 114

The number of collected candies will be maximized when you:

move right three times, then move down once, then move right once.






Sample Input 24
1 1 1 1
1 1 1 1





Sample Output 25

You will always collect the same number of candies, regardless of how you travel.





Sample Input 37
3 3 4 5 4 5 3
5 3 4 4 2 3 2





Sample Output 329






Sample Input 41
2
3





Sample Output 45


",Candies,"Prefix sum, Bruteforcing, Greedy Algorithm",0.792,40,27
867,"
Score : 300 points


Problem StatementAtCoDeer the deer is going on a trip in a two-dimensional plane.
In his plan, he will depart from point (0, 0) at time 0, then for each i between 1 and N (inclusive), he will visit point (x_i,y_i) at time t_i.
If AtCoDeer is at point (x, y) at time t, he can be at one of the following points at time t+1: (x+1,y), (x-1,y), (x,y+1) and (x,y-1).
Note that he cannot stay at his place.
Determine whether he can carry out his plan.




Constraints
1 ≤ N ≤ 10^5
0 ≤ x_i ≤ 10^5
0 ≤ y_i ≤ 10^5
1 ≤ t_i ≤ 10^5
t_i < t_{i+1} (1 ≤ i ≤ N-1)
All input values are integers.







InputInput is given from Standard Input in the following format:
N
t_1 x_1 y_1
t_2 x_2 y_2
:
t_N x_N y_N





OutputIf AtCoDeer can carry out his plan, print Yes; if he cannot, print No.






Sample Input 12
3 1 2
6 1 1





Sample Output 1Yes

For example, he can travel as follows: (0,0), (0,1), (1,1), (1,2), (1,1), (1,0), then (1,1).





Sample Input 21
2 100 100





Sample Output 2No

It is impossible to be at (100,100) two seconds after being at (0,0).





Sample Input 32
5 1 1
100 1 1





Sample Output 3No


",Traveling,"Greedy Algorithm, Geometry; 3d, Bruteforcing, Parity, Boolean Operations On Geometric Objects",0.577,60,27
868,"
Score : 400 points


Problem StatementYou are given a permutation p_1,p_2,...,p_N consisting of 1,2,..,N.
You can perform the following operation any number of times (possibly zero):
Operation: Swap two adjacent elements in the permutation.
You want to have p_i ≠ i for all 1≤i≤N.
Find the minimum required number of operations to achieve this.




Constraints
2≤N≤10^5
p_1,p_2,..,p_N is a permutation of 1,2,..,N.







InputThe input is given from Standard Input in the following format:
N
p_1 p_2 .. p_N





OutputPrint the minimum required number of operations






Sample Input 15
1 4 3 5 2





Sample Output 12

Swap 1 and 4, then swap 1 and 3. p is now 4,3,1,5,2 and satisfies the condition.
This is the minimum possible number, so the answer is 2.





Sample Input 22
1 2





Sample Output 21

Swapping 1 and 2 satisfies the condition.





Sample Input 32
2 1





Sample Output 30

The condition is already satisfied initially.





Sample Input 49
1 2 4 9 5 8 7 3 6





Sample Output 43


",Derangement,"Permutation Cycle Decomposition, Array, Greedy Algorithm, Bruteforcing, Bitmask",0.656,61,30
869,"
Score : 300 points


Problem StatementThere are N candles placed on a number line.
The i-th candle from the left is placed on coordinate x_i.
Here, x_1 < x_2 < ... < x_N holds.
Initially, no candles are burning.
Snuke decides to light K of the N candles.
Now, he is at coordinate 0.
He can move left and right along the line with speed 1.
He can also light a candle when he is at the same position as the candle, in negligible time.
Find the minimum time required to light K candles.




Constraints
1 \leq N \leq 10^5
1 \leq K \leq N
x_i is an integer.
|x_i| \leq 10^8
x_1 < x_2 < ... < x_N







InputInput is given from Standard Input in the following format:
N K
x_1 x_2 ... x_N





OutputPrint the minimum time required to light K candles.






Sample Input 15 3
-30 -10 10 20 50





Sample Output 140

He should move and light candles as follows:

Move from coordinate 0 to -10.
Light the second candle from the left.
Move from coordinate -10 to 10.
Light the third candle from the left.
Move from coordinate 10 to 20.
Light the fourth candle from the left.






Sample Input 23 2
10 20 30





Sample Output 220






Sample Input 31 1
0





Sample Output 30


There may be a candle placed at coordinate 0.






Sample Input 48 5
-9 -7 -4 -3 1 2 3 4





Sample Output 410


",Candles,"Sliding Window, Arithmetic, Greedy Algorithm, Bruteforcing",0.545,39,21
870,"
Score : 500 points


Problem StatementYou are given a sequence (P_1,P_2,...,P_N) which is a permutation of the integers from 1 through N.
You would like to sort this sequence in ascending order by repeating the following operation:

Choose an element in the sequence and move it to the beginning or the end of the sequence.

Find the minimum number of operations required.
It can be proved that it is actually possible to sort the sequence using this operation.




Constraints
1 \leq N \leq 2\times 10^5
(P_1,P_2,...,P_N) is a permutation of  (1,2,...,N).
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
P_1
:
P_N





OutputPrint the minimum number of operations required.






Sample Input 14
1
3
2
4





Sample Output 12

For example, the sequence can be sorted in ascending order as follows:

Move 2 to the beginning. The sequence is now (2,1,3,4).
Move 1 to the beginning. The sequence is now (1,2,3,4).






Sample Input 26
3
2
5
1
4
6





Sample Output 24






Sample Input 38
6
3
1
2
7
4
8
5





Sample Output 35


",Backfront,"Permutation Cycle Decomposition, Dynamic Programming, Array, Bruteforcing, Greedy Algorithm",0.275,105,25
871,"
Score : 300 points


Problem StatementYou are given a string S of length N and another string T of length M.
These strings consist of lowercase English letters.
A string X is called a good string when the following conditions are all met:

Let L be the length of X. L is divisible by both N and M.
Concatenating the 1-st, (\frac{L}{N}+1)-th, (2 \times \frac{L}{N}+1)-th, ..., ((N-1)\times\frac{L}{N}+1)-th characters of X, without changing the order, results in S.
Concatenating the 1-st, (\frac{L}{M}+1)-th, (2 \times \frac{L}{M}+1)-th, ..., ((M-1)\times\frac{L}{M}+1)-th characters of X, without changing the order, results in T.

Determine if there exists a good string. If it exists, find the length of the shortest such string.




Constraints
1 \leq N,M \leq 10^5
S and T consist of lowercase English letters.
|S|=N
|T|=M







InputInput is given from Standard Input in the following format:
N M
S
T





OutputIf a good string does not exist, print -1; if it exists, print the length of the shortest such string.






Sample Input 13 2
acp
ae





Sample Output 16

For example, the string accept is a good string.
There is no good string shorter than this, so the answer is 6.





Sample Input 26 3
abcdef
abc





Sample Output 2-1






Sample Input 315 9
dnsusrayukuaiia
dujrunuma





Sample Output 345


",Two Abbreviations,"Euclidean Algorithm, Mathematics, Arithmetic, String, Bruteforcing",0.333,213,50
872,"
Score : 200 points


Problem StatementA string is called a KEYENCE string when it can be changed to keyence by removing its contiguous substring (possibly empty) only once.
Given a string S consisting of lowercase English letters, determine if S is a KEYENCE string.




Constraints
The length of S is between 7 and 100 (inclusive).
S consists of lowercase English letters.







InputInput is given from Standard Input in the following format:
S





OutputIf S is a KEYENCE string, print YES; otherwise, print NO.






Sample Input 1keyofscience





Sample Output 1YES

keyence is an abbreviation of key of science.





Sample Input 2mpyszsbznf





Sample Output 2NO






Sample Input 3ashlfyha





Sample Output 3NO






Sample Input 4keyence





Sample Output 4YES


",KEYENCE String,"String, Bruteforcing, Implementation",0.407,142,46
873,"
Score : 400 points


Problem StatementA university student, Takahashi, has to take N examinations and pass all of them.
Currently, his readiness for the i-th examination is A_{i}, and according to his investigation, it is known that he needs readiness of at least B_{i} in order to pass the i-th examination.
Takahashi thinks that he may not be able to pass all the examinations, and he has decided to ask a magician, Aoki, to change the readiness for as few examinations as possible so that he can pass all of them, while not changing the total readiness.
For Takahashi, find the minimum possible number of indices i such that A_i and C_i are different, for a sequence C_1, C_2, ..., C_{N} that satisfies the following conditions:

The sum of the sequence A_1, A_2, ..., A_{N} and the sum of the sequence C_1, C_2, ..., C_{N} are equal.
For every i, B_i \leq C_i holds.

If such a sequence C_1, C_2, ..., C_{N} cannot be constructed, print -1.




Constraints
1 \leq N \leq 10^5
1 \leq A_i \leq 10^9
1 \leq B_i \leq 10^9
A_i and B_i are integers.







InputInput is given from Standard Input in the following format:
N
A_1 A_2 ... A_{N}
B_1 B_2 ... B_{N}





OutputPrint the minimum possible number of indices i such that A_i and C_i are different, for a sequence C_1, C_2, ..., C_{N} that satisfies the conditions.
If such a sequence C_1, C_2, ..., C_{N} cannot be constructed, print -1.






Sample Input 13
2 3 5
3 4 1





Sample Output 13

(A_1, A_2, A_3) = (2, 3, 5) and (B_1, B_2, B_3) = (3, 4, 1). If nothing is done, he cannot pass the first and second exams.
The minimum possible number of indices i such that A_i and C_i are different, 3, is achieved when:

(C_1, C_2, C_3) = (3, 5, 2)






Sample Input 23
2 3 3
2 2 1





Sample Output 20

In this case, he has to do nothing in order to pass all the exams.





Sample Input 33
17 7 1
25 6 14





Sample Output 3-1

In this case, no matter what is done, he cannot pass all the exams.





Sample Input 412
757232153 372327760 440075441 195848680 354974235 458054863 463477172 740174259 615762794 632963102 529866931 64991604
74164189 98239366 465611891 362739947 147060907 118867039 63189252 78303147 501410831 110823640 122948912 572905212





Sample Output 45


",Exam and Wizard,"Sorting, Greedy Algorithm, Prefix sum, Array, Mathematics",0.558,72,39
874,"
Score : 400 points


Problem StatementTakahashi had a pair of two positive integers not exceeding N, (a,b), which he has forgotten.
He remembers that the remainder of a divided by b was greater than or equal to K.
Find the number of possible pairs that he may have had.




Constraints
1 \leq N \leq 10^5
0 \leq K \leq N-1
All input values are integers.







InputInput is given from Standard Input in the following format:
N K





OutputPrint the number of possible pairs that he may have had.






Sample Input 15 2





Sample Output 17

There are seven possible pairs: (2,3),(5,3),(2,4),(3,4),(2,5),(3,5) and (4,5).





Sample Input 210 0





Sample Output 2100






Sample Input 331415 9265





Sample Output 3287927211


",Remainder Reminder,"Arithmetic, Combinatorics, Bruteforcing, Data Structures",0.273,135,32
875,"
Score : 600 points


Problem StatementConsider the following arithmetic progression with n terms:

x, x + d, x + 2d, \ldots, x + (n-1)d

What is the product of all terms in this sequence?
Compute the answer modulo 1\ 000\ 003.
You are given Q queries of this form.
In the i-th query, compute the answer in case x = x_i, d = d_i, n = n_i.




Constraints
1 \leq Q \leq 10^5
0 \leq x_i, d_i \leq 1\ 000\ 002
1 \leq n_i \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
Q
x_1 d_1 n_1
:
x_Q d_Q n_Q





OutputPrint Q lines.
In the i-th line, print the answer for the i-th query.






Sample Input 12
7 2 4
12345 67890 2019





Sample Output 19009
916936

For the first query, the answer is 7 \times 9 \times 11 \times 13 = 9009.
Don't forget to compute the answer modulo 1\ 000\ 003.

",Product of Arithmetic Progression,"Arithmetic, Number Theory, Exponentiation By Squaring, Precomputation, Modular Multiplicative Inverse",0.071,26,3
876,"
Score : 300 points


Problem StatementWe have N clocks. The hand of the i-th clock (1≤i≤N) rotates through 360° in exactly T_i seconds.
Initially, the hand of every clock stands still, pointing directly upward.
Now, Dolphin starts all the clocks simultaneously.
In how many seconds will the hand of every clock point directly upward again?




Constraints
1≤N≤100 
1≤T_i≤10^{18} 
All input values are integers.  
The correct answer is at most 10^{18} seconds.







InputInput is given from Standard Input in the following format:  
N
T_1
:  
T_N





OutputPrint the number of seconds after which the hand of every clock point directly upward again.






Sample Input 12
2
3





Sample Output 16

We have two clocks. The time when the hand of each clock points upward is as follows:

Clock 1: 2, 4, 6, ... seconds after the beginning
Clock 2: 3, 6, 9, ... seconds after the beginning

Therefore, it takes 6 seconds until the hands of both clocks point directly upward.





Sample Input 25
2
5
10
1000000000000000000
1000000000000000000





Sample Output 21000000000000000000


",Multiple Clocks,"Euclidean Algorithm, Mathematics, Dynamic Programming, Arithmetic",0.495,200,85
877,"
Score : 300 points


Problem StatementTak has N cards. On the i-th (1 \leq i \leq N) card is written an integer x_i.
He is selecting one or more cards from these N cards, so that the average of the integers written on the selected cards is exactly A.
In how many ways can he make his selection?




Constraints
1 \leq N \leq 50
1 \leq A \leq 50
1 \leq x_i \leq 50
N,\,A,\,x_i are integers.





Partial Score
200 points will be awarded for passing the test set satisfying 1 \leq N \leq 16.







InputThe input is given from Standard Input in the following format:
N A
x_1 x_2 ... x_N





OutputPrint the number of ways to select cards such that the average of the written integers is exactly A.






Sample Input 14 8
7 9 8 9





Sample Output 15


The following are the 5 ways to select cards such that the average is 8:
Select the 3-rd card.
Select the 1-st and 2-nd cards.
Select the 1-st and 4-th cards.
Select the 1-st, 2-nd and 3-rd cards.
Select the 1-st, 3-rd and 4-th cards.








Sample Input 23 8
6 6 9





Sample Output 20






Sample Input 38 5
3 6 2 8 7 6 5 9





Sample Output 319






Sample Input 433 3
3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3





Sample Output 48589934591


The answer may not fit into a 32-bit integer.


",Tak and Cards,"Dyanmic Programming, Dynamic Programming, Combinatorics",0.241,68,20
878,"
Score : 300 points


Problem StatementAtCoDeer the deer is seeing a quick report of election results on TV.
Two candidates are standing for the election: Takahashi and Aoki.
The report shows the ratio of the current numbers of votes the two candidates have obtained, but not the actual numbers of votes.
AtCoDeer has checked the report N times, and when he checked it for the i-th (1≦i≦N) time, the ratio was T_i:A_i.
It is known that each candidate had at least one vote when he checked the report for the first time.
Find the minimum possible total number of votes obtained by the two candidates when he checked the report for the N-th time.
It can be assumed that the number of votes obtained by each candidate never decreases.




Constraints
1≦N≦1000
1≦T_i,A_i≦1000 (1≦i≦N)
T_i and A_i (1≦i≦N) are coprime.
It is guaranteed that the correct answer is at most 10^{18}.







InputThe input is given from Standard Input in the following format:
N
T_1 A_1
T_2 A_2
:
T_N A_N





OutputPrint the minimum possible total number of votes obtained by Takahashi and Aoki when AtCoDeer checked the report for the N-th time.






Sample Input 13
2 3
1 1
3 2





Sample Output 110

When the numbers of votes obtained by the two candidates change as 2,3 → 3,3 → 6,4, the total number of votes at the end is 10, which is the minimum possible number.





Sample Input 24
1 1
1 1
1 5
1 100





Sample Output 2101

It is possible that neither candidate obtained a vote between the moment when he checked the report, and the moment when he checked it for the next time.





Sample Input 35
3 10
48 17
31 199
231 23
3 2





Sample Output 36930


",AtCoDeer and Election Report,"Greedy Algorithm, Arithmetic, Bruteforcing, Mathematics",0.27,187,47
879,"
Score : 300 points


Problem StatementJoisino is planning to open a shop in a shopping street.
Each of the five weekdays is divided into two periods, the morning and the evening. For each of those ten periods, a shop must be either open during the whole period, or closed during the whole period. Naturally, a shop must be open during at least one of those periods.
There are already N stores in the street, numbered 1 through N.
You are given information of the business hours of those shops, F_{i,j,k}. If F_{i,j,k}=1, Shop i is open during Period k on Day j (this notation is explained below); if F_{i,j,k}=0, Shop i is closed during that period. Here, the days of the week are denoted as follows. Monday: Day 1, Tuesday: Day 2, Wednesday: Day 3, Thursday: Day 4, Friday: Day 5. Also, the morning is denoted as Period 1, and the afternoon is denoted as Period 2.
Let c_i be the number of periods during which both Shop i and Joisino's shop are open. Then, the profit of Joisino's shop will be P_{1,c_1}+P_{2,c_2}+...+P_{N,c_N}.
Find the maximum possible profit of Joisino's shop when she decides whether her shop is open during each period, making sure that it is open during at least one period.




Constraints
1≤N≤100
0≤F_{i,j,k}≤1
For every integer i such that 1≤i≤N, there exists at least one pair (j,k) such that F_{i,j,k}=1.
-10^7≤P_{i,j}≤10^7
All input values are integers.







InputInput is given from Standard Input in the following format:
N
F_{1,1,1} F_{1,1,2} ... F_{1,5,1} F_{1,5,2}
:
F_{N,1,1} F_{N,1,2} ... F_{N,5,1} F_{N,5,2}
P_{1,0} ... P_{1,10}
:
P_{N,0} ... P_{N,10}





OutputPrint the maximum possible profit of Joisino's shop.






Sample Input 11
1 1 0 1 0 0 0 1 0 1
3 4 5 6 7 8 9 -2 -3 4 -2





Sample Output 18

If her shop is open only during the periods when Shop 1 is opened, the profit will be 8, which is the maximum possible profit.





Sample Input 22
1 1 1 1 1 0 0 0 0 0
0 0 0 0 0 1 1 1 1 1
0 -2 -2 -2 -2 -2 -1 -1 -1 -1 -1
0 -2 -2 -2 -2 -2 -1 -1 -1 -1 -1





Sample Output 2-2

Note that a shop must be open during at least one period, and the profit may be negative.





Sample Input 33
1 1 1 1 1 1 0 0 1 1
0 1 0 1 1 1 1 0 1 0
1 0 1 1 0 1 0 1 0 1
-8 6 -2 -8 -8 4 8 7 -6 2 2
-9 2 0 1 7 -5 0 -2 -6 5 5
6 -6 7 -9 6 -5 8 0 -9 -7 -7





Sample Output 323


",Shopping Street,"Bitmask, Bruteforcing, Array, Mathematics",0.692,75,47
880,"
Score : 300 points


Problem StatementThere are N boxes arranged in a row.
Initially, the i-th box from the left contains a_i candies.
Snuke can perform the following operation any number of times:

Choose a box containing at least one candy, and eat one of the candies in the chosen box.

His objective is as follows:

Any two neighboring boxes contain at most x candies in total.

Find the minimum number of operations required to achieve the objective.




Constraints
2 ≤ N ≤ 10^5
0 ≤ a_i ≤ 10^9
0 ≤ x ≤ 10^9







InputThe input is given from Standard Input in the following format:
N x
a_1 a_2 ... a_N





OutputPrint the minimum number of operations required to achieve the objective.






Sample Input 13 3
2 2 2





Sample Output 11

Eat one candy in the second box.
Then, the number of candies in each box becomes (2, 1, 2).





Sample Input 26 1
1 6 1 2 0 4





Sample Output 211

For example, eat six candies in the second box, two in the fourth box, and three in the sixth box.
Then, the number of candies in each box becomes (1, 0, 1, 0, 0, 1).





Sample Input 35 9
3 1 4 1 5





Sample Output 30

The objective is already achieved without performing operations.





Sample Input 42 0
5 5





Sample Output 410

All the candies need to be eaten.

",Boxes and Candies,"Greedy Algorithm, Array, Arithmetic",0.35,43,18
881,"
Score : 300 points


Problem StatementSnuke has N dogs and M monkeys. He wants them to line up in a row.
As a Japanese saying goes, these dogs and monkeys are on bad terms. (""ken'en no naka"", literally ""the relationship of dogs and monkeys"", means a relationship of mutual hatred.) Snuke is trying to reconsile them, by arranging the animals so that there are neither two adjacent dogs nor two adjacent monkeys.
How many such arrangements there are? Find the count modulo 10^9+7 (since animals cannot understand numbers larger than that).
Here, dogs and monkeys are both distinguishable. Also, two arrangements that result from reversing each other are distinguished.




Constraints
1 ≤ N,M ≤ 10^5







InputInput is given from Standard Input in the following format:
N M





OutputPrint the number of possible arrangements, modulo 10^9+7.






Sample Input 12 2





Sample Output 18

We will denote the dogs by A and B, and the monkeys by C and D. There are eight possible arrangements: ACBD, ADBC, BCAD, BDAC, CADB, CBDA, DACB and DBCA.





Sample Input 23 2





Sample Output 212






Sample Input 31 8





Sample Output 30






Sample Input 4100000 100000





Sample Output 4530123477


",Reconciled?,"Arithmetic, Permutation Cycle Decomposition, Boolean Operations On Geometric Objects",0.63,96,54
882,"
Score : 100 points


Problem StatementYou are given positive integers X and Y.
If there exists a positive integer not greater than 10^{18} that is a multiple of X but not a multiple of Y, choose one such integer and print it.
If it does not exist, print -1.




Constraints
1 ≤ X,Y ≤ 10^9
X and Y are integers.







InputInput is given from Standard Input in the following format:
X Y





OutputPrint a positive integer not greater than 10^{18} that is a multiple of X but not a multiple of Y, or print -1 if it does not exist.






Sample Input 18 6





Sample Output 116

For example, 16 is a multiple of 8 but not a multiple of 6.





Sample Input 23 3





Sample Output 2-1

A multiple of 3 is a multiple of 3.

",Two Integers,"Arithmetic, Implementation",0.596,106,49
883,"
Score : 300 points


Problem StatementIn Takahashi Kingdom, there is an archipelago of N islands, called Takahashi Islands.
For convenience, we will call them Island 1, Island 2, ..., Island N.
There are M kinds of regular boat services between these islands.
Each service connects two islands. The i-th service connects Island a_i and Island b_i.
Cat Snuke is on Island 1 now, and wants to go to Island N.
However, it turned out that there is no boat service from Island 1 to Island N, so he wants to know whether it is possible to go to Island N by using two boat services.
Help him.




Constraints
3 ≤ N ≤ 200 000
1 ≤ M ≤ 200 000
1 ≤ a_i < b_i ≤ N
(a_i, b_i) \neq (1, N)
If i \neq j, (a_i, b_i) \neq (a_j, b_j).







InputInput is given from Standard Input in the following format:
N M
a_1 b_1
a_2 b_2
:
a_M b_M





OutputIf it is possible to go to Island N by using two boat services, print POSSIBLE; otherwise, print IMPOSSIBLE.






Sample Input 13 2
1 2
2 3





Sample Output 1POSSIBLE






Sample Input 24 3
1 2
2 3
3 4





Sample Output 2IMPOSSIBLE

You have to use three boat services to get to Island 4.





Sample Input 3100000 1
1 99999





Sample Output 3IMPOSSIBLE






Sample Input 45 5
1 3
4 5
2 3
2 4
1 4





Sample Output 4POSSIBLE

You can get to Island 5 by using two boat services: Island 1 -> Island 4 -> Island 5.

",Cat Snuke and a Voyage,"Set / Map, Graph Theory, Boolean Operations On Geometric Objects",0.718,78,43
884,"
Score : 300 points


Problem StatementYou are given an integer sequence of length N, a_1,a_2,...,a_N.
For each 1≤i≤N, you have three choices: add 1 to a_i, subtract 1 from a_i or do nothing.
After these operations, you select an integer X and count the number of i such that a_i=X.
Maximize this count by making optimal choices.




Constraints
1≤N≤10^5
0≤a_i<10^5 (1≤i≤N)
a_i is an integer.







InputThe input is given from Standard Input in the following format:
N
a_1 a_2 .. a_N





OutputPrint the maximum possible number of i such that a_i=X.






Sample Input 17
3 1 4 1 5 9 2





Sample Output 14

For example, turn the sequence into 2,2,3,2,6,9,2 and select X=2 to obtain 4, the maximum possible count.





Sample Input 210
0 1 2 3 4 5 6 7 8 9





Sample Output 23






Sample Input 31
99999





Sample Output 31


",Together,"Counting, Array, Set / Map, Bruteforcing, Implementation",0.686,79,32
885,"
Score : 300 points


Problem StatementYou've come to your favorite store Infinitesco to buy some ice tea.
The store sells ice tea in bottles of different volumes at different costs.
Specifically, a 0.25-liter bottle costs Q yen, a 0.5-liter bottle costs H yen, a 1-liter bottle costs S yen, and a 2-liter bottle costs D yen.
The store has an infinite supply of bottles of each type.
You want to buy exactly N liters of ice tea. How many yen do you have to spend?




Constraints
1 \leq Q, H, S, D \leq 10^8
1 \leq N \leq 10^9
All input values are integers.







InputInput is given from Standard Input in the following format:
Q H S D
N





OutputPrint the smallest number of yen you have to spend to buy exactly N liters of ice tea.






Sample Input 120 30 70 90
3





Sample Output 1150

Buy one 2-liter bottle and two 0.5-liter bottles. You'll get 3 liters for 90 + 30 + 30 = 150 yen.





Sample Input 210000 1000 100 10
1





Sample Output 2100

Even though a 2-liter bottle costs just 10 yen, you need only 1 liter.
Thus, you have to buy a 1-liter bottle for 100 yen.





Sample Input 310 100 1000 10000
1





Sample Output 340

Now it's better to buy four 0.25-liter bottles for 10 + 10 + 10 + 10 = 40 yen.





Sample Input 412345678 87654321 12345678 87654321
123456789





Sample Output 41524157763907942


",Ice Tea Store,"Greedy Algorithm, Arithmetic, Boolean Operations On Geometric Objects",0.6,108,55
886,"
Score : 300 points


Problem StatementThere is a box containing N balls. The i-th ball has the integer A_i written on it.
Snuke can perform the following operation any number of times:

Take out two balls from the box. Then, return them to the box along with a new ball, on which the absolute difference of the integers written on the two balls is written.

Determine whether it is possible for Snuke to reach the state where the box contains a ball on which the integer K is written.




Constraints
1 \leq N \leq 10^5
1 \leq A_i \leq 10^9
1 \leq K \leq 10^9
All input values are integers.







InputInput is given from Standard Input in the following format:
N K
A_1 A_2 ... A_N





OutputIf it is possible for Snuke to reach the state where the box contains a ball on which the integer K is written, print POSSIBLE; if it is not possible, print IMPOSSIBLE.






Sample Input 13 7
9 3 4





Sample Output 1POSSIBLE

First, take out the two balls 9 and 4, and return them back along with a new ball, abs(9-4)=5.
Next, take out 3 and 5, and return them back along with abs(3-5)=2.
Finally, take out 9 and 2, and return them back along with abs(9-2)=7.
Now we have 7 in the box, and the answer is therefore POSSIBLE.





Sample Input 23 5
6 9 3





Sample Output 2IMPOSSIBLE

No matter what we do, it is not possible to have 5 in the box. The answer is therefore IMPOSSIBLE.





Sample Input 34 11
11 3 7 15





Sample Output 3POSSIBLE

The box already contains 11 before we do anything. The answer is therefore POSSIBLE.





Sample Input 45 12
10 2 8 6 4





Sample Output 4IMPOSSIBLE


",Getting Difference,"Euclidean Algorithm, Number Theory, Arithmetic, Boolean Operations On Geometric Objects",0.529,144,49
887,"
Score : 200 points


Problem StatementThere are N bags of biscuits. The i-th bag contains A_i biscuits.
Takaki will select some of these bags and eat all of the biscuits inside.
Here, it is also possible to select all or none of the bags.
He would like to select bags so that the total number of biscuits inside is congruent to P modulo 2.
How many such ways to select bags there are?




Constraints
1 \leq N \leq 50
P = 0 or 1
1 \leq A_i \leq 100







InputInput is given from Standard Input in the following format:
N P
A_1 A_2 ... A_N





OutputPrint the number of ways to select bags so that the total number of biscuits inside is congruent to P modulo 2.






Sample Input 12 0
1 3





Sample Output 12

There are two ways to select bags so that the total number of biscuits inside is congruent to 0 modulo 2:

Select neither bag. The total number of biscuits is 0.
Select both bags. The total number of biscuits is 4.






Sample Input 21 1
50





Sample Output 20






Sample Input 33 0
1 1 1





Sample Output 34

Two bags are distinguished even if they contain the same number of biscuits.





Sample Input 445 1
17 55 85 55 74 20 90 67 40 70 39 89 91 50 16 24 14 43 24 66 25 9 89 71 41 16 53 13 61 15 85 72 62 67 42 26 36 66 4 87 59 91 4 25 26





Sample Output 417592186044416


",Biscuits,"Combinatorics, Parity, Counting, Arithmetic",0.609,79,41
888,"
Score : 500 points


Problem StatementThere is an integer sequence A of length N.
Find the number of the pairs of integers l and r (1 \leq l \leq r \leq N) that satisfy the following condition:

A_l\ xor\ A_{l+1}\ xor\ ...\ xor\ A_r = A_l\ +\ A_{l+1}\ +\ ...\ +\ A_r

Here, xor denotes the bitwise exclusive OR.

Definition of XOR
The XOR of integers c_1, c_2, ..., c_m is defined as follows:

Let the XOR be X. In the binary representation of X, the digit in the 2^k's place (0 \leq k; k is an integer) is 1 if there are an odd number of integers among c_1, c_2, ...c_m whose binary representation has 1 in the 2^k's place, and 0 if that number is even.

For example, let us compute the XOR of 3 and 5. The binary representation of 3 is 011, and the binary representation of 5 is 101, thus the XOR has the binary representation 110, that is, the XOR is 6.
",Xor Sum 2,"Two-pointer, Boolean Operations On Geometric Objects, Prefix sum, Enumeration, Arithmetic",0.219,83,13
889,"
Score: 400 points


Problem Statement
Chokudai made a rectangular cake for contestants in DDCC 2020 Finals.
The cake has H - 1 horizontal notches and W - 1 vertical notches, which divide the cake into H \times W equal sections. K of these sections has a strawberry on top of each of them.
The positions of the strawberries are given to you as H \times W characters s_{i, j} (1 \leq i \leq H, 1 \leq j \leq W). If s_{i, j} is #, the section at the i-th row from the top and the j-th column from the left contains a strawberry; if s_{i, j} is ., the section does not contain one. There are exactly K occurrences of #s.
Takahashi wants to cut this cake into K pieces and serve them to the contestants. Each of these pieces must satisfy the following conditions:

Has a rectangular shape.
Contains exactly one strawberry.

One possible way to cut the cake is shown below:

Find one way to cut the cake and satisfy the condition. We can show that this is always possible, regardless of the number and positions of the strawberries.  




Constraints

1 \leq H \leq 300
1 \leq W \leq 300
1 \leq K \leq H \times W
s_{i, j} is # or ..
There are exactly K occurrences of # in s.







Input
Input is given from Standard Input in the following format:
H W K
s_{1, 1} s_{1, 2} \cdots s_{1, W}
s_{2, 1} s_{2, 2} \cdots s_{2, W}
:
s_{H, 1} s_{H, 2} \cdots s_{H, W}





Output
Assign the numbers 1, 2, 3, \dots, K to the K pieces obtained after the cut, in any order. Then, let a_{i, j} be the number representing the piece containing the section at the i-th row from the top and the j-th column from the left of the cake. Output should be in the following format:
a_{1, 1} \ a_{1, 2} \ \cdots \ a_{1, W}
a_{2, 1} \ a_{2, 2} \ \cdots \ a_{2, W}
:
a_{H, 1} \ a_{H, 2} \ \cdots \ a_{H, W}

If multiple solutions exist, any of them will be accepted.






Sample Input 13 3 5
#.#
.#.
#.#





Sample Output 11 2 2
1 3 4
5 5 4

One way to cut this cake is shown below:
 





Sample Input 23 7 7
#...#.#
..#...#
.#..#..





Sample Output 21 1 2 2 3 4 4
6 6 2 2 3 5 5
6 6 7 7 7 7 7

One way to cut this cake is shown below:  
 





Sample Input 313 21 106
.....................
.####.####.####.####.
..#.#..#.#.#....#....
..#.#..#.#.#....#....
..#.#..#.#.#....#....
.####.####.####.####.
.....................
.####.####.####.####.
....#.#..#....#.#..#.
.####.#..#.####.#..#.
.#....#..#.#....#..#.
.####.####.####.####.
.....................





Sample Output 312 12 23 34 45 45 60 71 82 93 93 2 13 24 35 35 17 28 39 50 50
12 12 23 34 45 45 60 71 82 93 93 2 13 24 35 35 17 28 39 50 50
12 12 56 89 89 89 60 104 82 31 31 46 13 24 35 35 61 61 39 50 50
12 12 67 67 100 100 60 9 9 42 42 57 13 24 6 72 72 72 72 72 72
12 12 78 5 5 5 20 20 20 53 68 68 90 24 6 83 83 83 83 83 83
16 16 27 38 49 49 64 75 86 97 79 79 90 101 6 94 94 105 10 21 21
16 16 27 38 49 49 64 75 86 97 79 79 90 101 6 94 94 105 10 21 21
32 32 43 54 65 65 80 11 106 95 22 22 33 44 55 55 70 1 96 85 85
32 32 43 54 76 76 91 11 106 84 84 4 99 66 66 66 81 1 96 74 74
14 14 3 98 87 87 102 11 73 73 73 4 99 88 77 77 92 92 63 63 63
25 25 3 98 87 87 7 29 62 62 62 15 99 88 77 77 103 19 30 52 52
36 36 47 58 69 69 18 29 40 51 51 26 37 48 59 59 8 19 30 41 41
36 36 47 58 69 69 18 29 40 51 51 26 37 48 59 59 8 19 30 41 41


",Strawberry Cakes,"Grid Graph, Greedy Algorithm, Graph Traversal, String, Array",0.548,49,26
890,"
Score : 600 points


Problem StatementThere are N holes in a two-dimensional plane. The coordinates of the i-th hole are (x_i,y_i).
Let R=10^{10^{10^{10}}}. Ringo performs the following operation:

Randomly choose a point from the interior of a circle of radius R centered at the origin, and put Snuke there. Snuke will move to the hole with the smallest Euclidean distance from the point, and fall into that hole. If there are multiple such holes, the hole with the smallest index will be chosen.

For every i (1 \leq i \leq N), find the probability that Snuke falls into the i-th hole.
Here, the operation of randomly choosing a point from the interior of a circle of radius R is defined as follows:

Pick two real numbers x and y independently according to uniform distribution on [-R,R].
If x^2+y^2\leq R^2, the point (x,y) is chosen. Otherwise, repeat picking the real numbers x,y until the condition is met.





Constraints
2 \leq N \leq 100
|x_i|,|y_i| \leq 10^6(1\leq i\leq N)
All given points are pairwise distinct.
All input values are integers.







InputInput is given from Standard Input in the following format:
N
x_1 y_1
:
x_N y_N





OutputPrint N real numbers. The i-th real number must represent the probability that Snuke falls into the i-th hole.
The output will be judged correct when, for all output values, the absolute or relative error is at most 10^{-5}.






Sample Input 12
0 0
1 1





Sample Output 10.5
0.5

If Ringo put Snuke in the region x+y\leq 1, Snuke will fall into the first hole. The probability of this happening is very close to 0.5.
Otherwise, Snuke will fall into the second hole, the probability of which happening is also very close to 0.5.





Sample Input 25
0 0
2 8
4 5
2 6
3 10





Sample Output 20.43160120892732328768
0.03480224363653196956
0.13880483535586193855
0.00000000000000000000
0.39479171208028279727


",Holes,"Convex Hull Trick, Geometry; 3d, Arithmetic, Geometry; 3d, Sorting",0.636,18,8
891,"
Score : 800 points


Problem StatementSig has built his own keyboard. Designed for ultimate simplicity, this keyboard only has 3 keys on it: the 0 key, the 1 key and the backspace key.
To begin with, he is using a plain text editor with this keyboard. This editor always displays one string (possibly empty). Just after the editor is launched, this string is empty. When each key on the keyboard is pressed, the following changes occur to the string:

The 0 key: a letter 0 will be inserted to the right of the string.
The 1 key: a letter 1 will be inserted to the right of the string.
The backspace key: if the string is empty, nothing happens. Otherwise, the rightmost letter of the string is deleted.

Sig has launched the editor, and pressed these keys N times in total. As a result, the editor displays a string s. Find the number of such ways to press the keys, modulo 10^9 + 7.




Constraints
1 ≦ N ≦ 5000
1 ≦ |s| ≦ N
s consists of the letters 0 and 1.





Partial Score
400 points will be awarded for passing the test set satisfying 1 ≦ N ≦ 300.







InputThe input is given from Standard Input in the following format:
N
s





OutputPrint the number of the ways to press the keys N times in total such that the editor displays the string s in the end, modulo 10^9+7.






Sample Input 13
0





Sample Output 15

We will denote the backspace key by B. The following 5 ways to press the keys will cause the editor to display the string 0 in the end: 00B, 01B, 0B0, 1B0, BB0. In the last way, nothing will happen when the backspace key is pressed.





Sample Input 2300
1100100





Sample Output 2519054663






Sample Input 35000
01000001011101000100001101101111011001000110010101110010000





Sample Output 3500886057


",Unhappy Hacking,"Dyanmic Programming, Arithmetic, Combinatorics",0.125,23,6
892,"
Score : 300 points


Problem StatementAs a token of his gratitude, Takahashi has decided to give his mother an integer sequence.
The sequence A needs to satisfy the conditions below:

A consists of integers between X and Y (inclusive).
For each 1\leq i \leq |A|-1, A_{i+1} is a multiple of A_i and strictly greater than A_i.

Find the maximum possible length of the sequence.




Constraints
1 \leq X \leq Y \leq 10^{18}
All input values are integers.







InputInput is given from Standard Input in the following format:
X Y





OutputPrint the maximum possible length of the sequence.






Sample Input 13 20





Sample Output 13

The sequence 3,6,18 satisfies the conditions.





Sample Input 225 100





Sample Output 23






Sample Input 3314159265 358979323846264338





Sample Output 331


",Multiple Gift,"Greedy Algorithm, Bruteforcing, Arithmetic",0.712,141,79
893,"
Score : 400 points


Problem StatementTakahashi had a pair of two positive integers not exceeding N, (a,b), which he has forgotten.
He remembers that the remainder of a divided by b was greater than or equal to K.
Find the number of possible pairs that he may have had.




Constraints
1 \leq N \leq 10^5
0 \leq K \leq N-1
All input values are integers.







InputInput is given from Standard Input in the following format:
N K





OutputPrint the number of possible pairs that he may have had.






Sample Input 15 2





Sample Output 17

There are seven possible pairs: (2,3),(5,3),(2,4),(3,4),(2,5),(3,5) and (4,5).





Sample Input 210 0





Sample Output 2100






Sample Input 331415 9265





Sample Output 3287927211


",Remainder Reminder,"Arithmetic, Bruteforcing, Counting, Boolean Operations On Geometric Objects",0.583,40,23
894,"
Score : 700 points


Problem StatementDetermine if there exists a sequence obtained by permuting 1,2,...,N that satisfies the following conditions:

The length of its longest increasing subsequence is A.
The length of its longest decreasing subsequence is B.

If it exists, construct one such sequence.




NotesA subsequence of a sequence P is a sequence that can be obtained by extracting some of the elements in P without changing the order.
A longest increasing subsequence of a sequence P is a sequence with the maximum length among the subsequences of P that are monotonically increasing.
Similarly, a longest decreasing subsequence of a sequence P is a sequence with the maximum length among the subsequences of P that are monotonically decreasing.




Constraints
1 \leq N,A,B \leq 3\times 10^5
All input values are integers.







InputInput is given from Standard Input in the following format:
N A B





OutputIf there are no sequences that satisfy the conditions, print -1.
Otherwise, print N integers. The i-th integer should be the i-th element of the sequence that you constructed.






Sample Input 15 3 2





Sample Output 12 4 1 5 3

One longest increasing subsequence of this sequence is {2,4,5}, and one longest decreasing subsequence of it is {4,3}.





Sample Input 27 7 1





Sample Output 21 2 3 4 5 6 7






Sample Input 3300000 300000 300000





Sample Output 3-1


",LISDL,"Combinatorics, Greedy Algorithm, Constructive, Divide And Conquer, Array, Mathematics",0.222,42,8
895,"
Score : 400 points


Problem StatementOn a two-dimensional plane, there are N red points and N blue points.
The coordinates of the i-th red point are (a_i, b_i), and the coordinates of the i-th blue point are (c_i, d_i).
A red point and a blue point can form a friendly pair when, the x-coordinate of the red point is smaller than that of the blue point, and the y-coordinate of the red point is also smaller than that of the blue point.
At most how many friendly pairs can you form? Note that a point cannot belong to multiple pairs.




Constraints
All input values are integers.
1 \leq N \leq 100
0 \leq a_i, b_i, c_i, d_i < 2N
a_1, a_2, ..., a_N, c_1, c_2, ..., c_N are all different.
b_1, b_2, ..., b_N, d_1, d_2, ..., d_N are all different.







InputInput is given from Standard Input in the following format:
N
a_1 b_1
a_2 b_2
:
a_N b_N
c_1 d_1
c_2 d_2
:
c_N d_N





OutputPrint the maximum number of friendly pairs.






Sample Input 13
2 0
3 1
1 3
4 2
0 4
5 5





Sample Output 12

For example, you can pair (2, 0) and (4, 2), then (3, 1) and (5, 5).





Sample Input 23
0 0
1 1
5 2
2 3
3 4
4 5





Sample Output 22

For example, you can pair (0, 0) and (2, 3), then (1, 1) and (3, 4).





Sample Input 32
2 2
3 3
0 0
1 1





Sample Output 30

It is possible that no pair can be formed.





Sample Input 45
0 0
7 3
2 2
4 8
1 6
8 5
6 9
5 4
9 1
3 7





Sample Output 45






Sample Input 55
0 0
1 1
5 5
6 6
7 7
2 2
3 3
4 4
8 8
9 9





Sample Output 54


",2D Plane 2N Points,"Sorting, Greedy Algorithm, Two-pointer, Data Structures",0.588,40,16
896,"
Score : 500 points


Problem StatementYou are given two integer sequences, each of length N: a_1, ..., a_N and b_1, ..., b_N.
There are N^2 ways to choose two integers i and j such that 1 \leq i, j \leq N. For each of these N^2 pairs, we will compute a_i + b_j and write it on a sheet of paper.
That is, we will write N^2 integers in total.
Compute the XOR of these N^2 integers.

Definition of XOR
The XOR of integers c_1, c_2, ..., c_m is defined as follows:

Let the XOR be X. In the binary representation of X, the digit in the 2^k's place (0 \leq k; k is an integer) is 1 if there are an odd number of integers among c_1, c_2, ...c_m whose binary representation has 1 in the 2^k's place, and 0 if that number is even.

For example, let us compute the XOR of 3 and 5. The binary representation of 3 is 011, and the binary representation of 5 is 101, thus the XOR has the binary representation 110, that is, the XOR is 6.
",Two Sequences,"Boolean Operations On Geometric Objects, Arithmetic, Binary Search, Sorting, Counting, Bitmask",0.0,20,4
897,"
Score : 700 points


Problem StatementYou have an integer sequence of length N: a_1, a_2, ..., a_N.
You repeatedly perform the following operation until the length of the sequence becomes 1:

First, choose an element of the sequence.
If that element is at either end of the sequence, delete the element.
If that element is not at either end of the sequence, replace the element with the sum of the two elements that are adjacent to it. Then, delete those two elements.

You would like to maximize the final element that remains in the sequence.
Find the maximum possible value of the final element, and the way to achieve it.




Constraints
All input values are integers.
2 \leq N \leq 1000
|a_i| \leq 10^9







InputInput is given from Standard Input in the following format:
N
a_1 a_2 ... a_N





Output
In the first line, print the maximum possible value of the final element in the sequence.
In the second line, print the number of operations that you perform.
In the (2+i)-th line, if the element chosen in the i-th operation is the x-th element from the left in the sequence at that moment, print x.
If there are multiple ways to achieve the maximum value of the final element, any of them may be printed.







Sample Input 15
1 4 3 7 5





Sample Output 111
3
1
4
2

The sequence would change as follows:

After the first operation: 4, 3, 7, 5
After the second operation: 4, 3, 7
After the third operation: 11(4+7)






Sample Input 24
100 100 -1 100





Sample Output 2200
2
3
1


After the first operation: 100, 200(100+100)
After the second operation: 200






Sample Input 36
-1 -2 -3 1 2 3





Sample Output 34
3
2
1
2


After the first operation: -4, 1, 2, 3
After the second operation: 1, 2, 3
After the third operation: 4






Sample Input 49
1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000





Sample Output 45000000000
4
2
2
2
2


",Both Sides Merger,"Greedy Algorithm, Parity, Dynamic Programming, Constructive, Array, Boolean Operations On Geometric Objects",0.0,19,2
898,"
Score : 500 points


Problem Statement""Teishi-zushi"", a Japanese restaurant, is a plain restaurant with only one round counter. The outer circumference of the counter is C meters. Customers cannot go inside the counter.
Nakahashi entered Teishi-zushi, and he was guided to the counter. Now, there are N pieces of sushi (vinegared rice with seafood and so on) on the counter. The distance measured clockwise from the point where Nakahashi is standing to the point where the i-th sushi is placed, is x_i meters. Also, the i-th sushi has a nutritive value of v_i kilocalories.
Nakahashi can freely walk around the circumference of the counter. When he reach a point where a sushi is placed, he can eat that sushi and take in its nutrition (naturally, the sushi disappears). However, while walking, he consumes 1 kilocalories per meter.
Whenever he is satisfied, he can leave the restaurant from any place (he does not have to return to the initial place). On balance, at most how much nutrition can he take in before he leaves? That is, what is the maximum possible value of the total nutrition taken in minus the total energy consumed? Assume that there are no other customers, and no new sushi will be added to the counter. Also, since Nakahashi has plenty of nutrition in his body, assume that no matter how much he walks and consumes energy, he never dies from hunger.




Constraints
1 ≤ N ≤ 10^5
2 ≤ C ≤ 10^{14}
1 ≤ x_1 < x_2 < ... < x_N < C
1 ≤ v_i ≤ 10^9
All values in input are integers.





Subscores
300 points will be awarded for passing the test set satisfying N ≤ 100.







InputInput is given from Standard Input in the following format:
N C
x_1 v_1
x_2 v_2
:
x_N v_N





OutputIf Nakahashi can take in at most c kilocalories on balance before he leaves the restaurant, print c.






Sample Input 13 20
2 80
9 120
16 1





Sample Output 1191

There are three sushi on the counter with a circumference of 20 meters. If he walks two meters clockwise from the initial place, he can eat a sushi of 80 kilocalories. If he walks seven more meters clockwise, he can eat a sushi of 120 kilocalories. If he leaves now, the total nutrition taken in is 200 kilocalories, and the total energy consumed is 9 kilocalories, thus he can take in 191 kilocalories on balance, which is the largest possible value.





Sample Input 23 20
2 80
9 1
16 120





Sample Output 2192

The second and third sushi have been swapped. Again, if he walks two meters clockwise from the initial place, he can eat a sushi of 80 kilocalories. If he walks six more meters counterclockwise this time, he can eat a sushi of 120 kilocalories. If he leaves now, the total nutrition taken in is 200 kilocalories, and the total energy consumed is 8 kilocalories, thus he can take in 192 kilocalories on balance, which is the largest possible value.





Sample Input 31 100000000000000
50000000000000 1





Sample Output 30

Even though the only sushi is so far that it does not fit into a 32-bit integer, its nutritive value is low, thus he should immediately leave without doing anything.





Sample Input 415 10000000000
400000000 1000000000
800000000 1000000000
1900000000 1000000000
2400000000 1000000000
2900000000 1000000000
3300000000 1000000000
3700000000 1000000000
3800000000 1000000000
4000000000 1000000000
4100000000 1000000000
5200000000 1000000000
6600000000 1000000000
8000000000 1000000000
9300000000 1000000000
9700000000 1000000000





Sample Output 46500000000

All these sample inputs above are included in the test set for the partial score.

",Static Sushi,"Prefix sum, Sorting, Dyanmic Programming, Two-pointer, Greedy Algorithm, Array",0.261,73,17
899,"
Score : 800 points


Problem StatementThere are N squares lining up in a row, numbered 1 through N from left to right.
Initially, all squares are white.
We also have N-1 painting machines, numbered 1 through N-1.
When operated, Machine i paints Square i and i+1 black.
Snuke will operate these machines one by one.
The order in which he operates them is represented by a permutation of (1, 2, ..., N-1), P, which means that the i-th operated machine is Machine P_i.
Here, the score of a permutation P is defined as the number of machines that are operated before all the squares are painted black for the first time, when the machines are operated in the order specified by P.
Snuke has not decided what permutation P to use, but he is interested in the scores of possible permutations.
Find the sum of the scores over all possible permutations for him.
Since this can be extremely large, compute the sum modulo 10^9+7.




Constraints
2 \leq N \leq 10^6







InputInput is given from Standard Input in the following format:
N





OutputPrint the sum of the scores over all possible permutations, modulo 10^9+7.






Sample Input 14





Sample Output 116

There are six possible permutations as P.
Among them, P = (1, 3, 2) and P = (3, 1, 2) have a score of 2, and the others have a score of 3.
Thus, the answer is 2 \times 2 + 3 \times 4 = 16.





Sample Input 22





Sample Output 21

There is only one possible permutation: P = (1), which has a score of 1.





Sample Input 35





Sample Output 384






Sample Input 4100000





Sample Output 4341429644


",Painting Machines,"Combinatorics, Arithmetic, Precomputation, Mathematics",0.571,8,5
900,"
Score : 500 points


Problem StatementThere is an integer sequence A of length N.
Find the number of the pairs of integers l and r (1 \leq l \leq r \leq N) that satisfy the following condition:

A_l\ xor\ A_{l+1}\ xor\ ...\ xor\ A_r = A_l\ +\ A_{l+1}\ +\ ...\ +\ A_r

Here, xor denotes the bitwise exclusive OR.

Definition of XOR
The XOR of integers c_1, c_2, ..., c_m is defined as follows:

Let the XOR be X. In the binary representation of X, the digit in the 2^k's place (0 \leq k; k is an integer) is 1 if there are an odd number of integers among c_1, c_2, ...c_m whose binary representation has 1 in the 2^k's place, and 0 if that number is even.

For example, let us compute the XOR of 3 and 5. The binary representation of 3 is 011, and the binary representation of 5 is 101, thus the XOR has the binary representation 110, that is, the XOR is 6.
",Xor Sum 2,"Two-pointer, Bitmask, Prefix sum, Counting, Greedy Algorithm",0.378,71,24
901,"
Score : 700 points


Problem StatementTakahashi has a tower which is divided into N layers.
Initially, all the layers are uncolored. Takahashi is going to paint some of the layers in red, green or blue to make a beautiful tower.
He defines the beauty of the tower as follows:

The beauty of the tower is the sum of the scores of the N layers, where the score of a layer is A if the layer is painted red, A+B if the layer is painted green, B if the layer is painted blue, and 0 if the layer is uncolored.

Here, A and B are positive integer constants given beforehand. Also note that a layer may not be painted in two or more colors.
Takahashi is planning to paint the tower so that the beauty of the tower becomes exactly K.
How many such ways are there to paint the tower? Find the count modulo 998244353.
Two ways to paint the tower are considered different when there exists a layer that is painted in different colors, or a layer that is painted in some color in one of the ways and not in the other.




Constraints
1 ≤ N ≤ 3×10^5
1 ≤ A,B ≤ 3×10^5
0 ≤ K ≤ 18×10^{10}
All values in the input are integers.







InputInput is given from Standard Input in the following format:
N A B K





OutputPrint the number of the ways to paint tiles, modulo 998244353.






Sample Input 14 1 2 5





Sample Output 140

In this case, a red layer worth 1 points, a green layer worth 3 points and the blue layer worth 2 points. The beauty of the tower is 5 when we have one of the following sets of painted layers:

1 green, 1 blue
1 red, 2 blues
2 reds, 1 green
3 reds, 1 blue

The total number of the ways to produce them is 40.





Sample Input 22 5 6 0





Sample Output 21

The beauty of the tower is 0 only when all the layers are uncolored. Thus, the answer is 1.





Sample Input 390081 33447 90629 6391049189





Sample Output 3577742975


",RGB Coloring,"Arithmetic, Combinatorics, Precomputation, Bruteforcing",0.276,88,19
902,"
Score : 500 points


Problem StatementLet S(n) denote the sum of the digits in the decimal notation of n.
For example, S(123) = 1 + 2 + 3 = 6.
We will call an integer n a Snuke number when, for all positive integers m such that m > n, \frac{n}{S(n)} \leq \frac{m}{S(m)} holds.
Given an integer K, list the K smallest Snuke numbers.




Constraints
1 \leq K
The K-th smallest Snuke number is not greater than 10^{15}.







InputInput is given from Standard Input in the following format:
K





OutputPrint K lines. The i-th line should contain the i-th smallest Snuke number.






Sample Input 110





Sample Output 11
2
3
4
5
6
7
8
9
19


",Snuke Numbers,"Greedy Algorithm, Arithmetic, Mathematics, Constructive",0.0,57,4
903,"
Score : 700 points


Problem StatementIn the State of Takahashi in AtCoderian Federation, there are N cities, numbered 1, 2, ..., N.
M bidirectional roads connect these cities.
The i-th road connects City A_i and City B_i.
Every road connects two distinct cities.
Also, for any two cities, there is at most one road that directly connects them.
One day, it was decided that the State of Takahashi would be divided into two states, Taka and Hashi.
After the division, each city in Takahashi would belong to either Taka or Hashi.
It is acceptable for all the cities to belong Taka, or for all the cities to belong Hashi.
Here, the following condition should be satisfied:

Any two cities in the same state, Taka or Hashi, are directly connected by a road.

Find the minimum possible number of roads whose endpoint cities belong to the same state.
If it is impossible to divide the cities into Taka and Hashi so that the condition is satisfied, print -1.




Constraints
2 \leq N \leq 700
0 \leq M \leq N(N-1)/2
1 \leq A_i \leq N
1 \leq B_i \leq N
A_i \neq B_i
If i \neq j, at least one of the following holds: A_i \neq A_j and B_i \neq B_j.
If i \neq j, at least one of the following holds: A_i \neq B_j and B_i \neq A_j.







InputInput is given from Standard Input in the following format:
N M
A_1 B_1
A_2 B_2
:
A_M B_M





OutputPrint the answer.






Sample Input 15 5
1 2
1 3
3 4
3 5
4 5





Sample Output 14

For example, if the cities 1, 2 belong to Taka and the cities 3, 4, 5 belong to Hashi, the condition is satisfied.
Here, the number of roads whose endpoint cities belong to the same state, is 4.





Sample Input 25 1
1 2





Sample Output 2-1

In this sample, the condition cannot be satisfied regardless of which cities belong to each state.





Sample Input 34 3
1 2
1 3
2 3





Sample Output 33






Sample Input 410 39
7 2
7 1
5 6
5 8
9 10
2 8
8 7
3 10
10 1
8 10
2 3
7 4
3 9
4 10
3 4
6 1
6 7
9 5
9 7
6 9
9 4
4 6
7 5
8 3
2 5
9 2
10 7
8 6
8 9
7 3
5 3
4 5
6 3
2 10
5 10
4 2
6 2
8 4
10 6





Sample Output 421


",Independence,"Graph Theory, Graph Traversal, Bipartite Graph, Counting, Dyanmic Programming, Combinatorics",0.3,23,4
904,"


Problem StatementWe have N boxes, numbered 1 through N. At first, box 1 contains one red ball, and each of the other boxes contains one white ball.
Snuke will perform the following M operations, one by one. In the i-th operation, he randomly picks one ball from box x_i, then he puts it into box y_i.
Find the number of boxes that may contain the red ball after all operations are performed.




Constraints
2≤N≤10^5
1≤M≤10^5
1≤x_i,y_i≤N
x_i≠y_i
Just before the i-th operation is performed, box x_i contains at least 1 ball.







InputThe input is given from Standard Input in the following format:
N M
x_1 y_1
:
x_M y_M





OutputPrint the number of boxes that may contain the red ball after all operations are performed.






Sample Input 13 2
1 2
2 3





Sample Output 12

Just after the first operation, box 1 is empty, box 2 contains one red ball and one white ball, and box 3 contains one white ball.
Now, consider the second operation. If Snuke picks the red ball from box 2, the red ball will go into box 3. If he picks the white ball instead, the red ball will stay in box 2.
Thus, the number of boxes that may contain the red ball after all operations, is 2.





Sample Input 23 3
1 2
2 3
2 3





Sample Output 21

All balls will go into box 3.





Sample Input 34 4
1 2
2 3
4 1
3 4





Sample Output 33


",Box and Ball,"Bitmask, Simulation, Greedy Algorithm, Counting",0.585,70,39
905,"
Score : 300 points


Problem StatementYou have N bamboos. The lengths (in centimeters) of these are l_1, l_2, ..., l_N, respectively.
Your objective is to use some of these bamboos (possibly all) to obtain three bamboos of length A, B, C. For that, you can use the following three kinds of magics any number:

Extension Magic: Consumes 1 MP (magic point). Choose one bamboo and increase its length by 1.
Shortening Magic: Consumes 1 MP. Choose one bamboo of length at least 2 and decrease its length by 1.
Composition Magic: Consumes 10 MP. Choose two bamboos and combine them into one bamboo. The length of this new bamboo is equal to the sum of the lengths of the two bamboos combined. (Afterwards, further magics can be used on this bamboo.)

At least how much MP is needed to achieve the objective?




Constraints
3 \leq N \leq 8
1 \leq C < B < A \leq 1000
1 \leq l_i \leq 1000
All values in input are integers.







InputInput is given from Standard Input in the following format:
N A B C
l_1
l_2
:
l_N





OutputPrint the minimum amount of MP needed to achieve the objective.






Sample Input 15 100 90 80
98
40
30
21
80





Sample Output 123

We are obtaining three bamboos of lengths 100, 90, 80 from five bamboos 98, 40, 30, 21, 80. We already have a bamboo of length 80, and we can obtain bamboos of lengths 100, 90 by using the magics as follows at the total cost of 23 MP, which is optimal.

Use Extension Magic twice on the bamboo of length 98 to obtain a bamboo of length 100. (MP consumed: 2)
Use Composition Magic on the bamboos of lengths 40, 30 to obtain a bamboo of length 70. (MP consumed: 10)
Use Shortening Magic once on the bamboo of length 21 to obtain a bamboo of length 20. (MP consumed: 1)
Use Composition Magic on the bamboo of length 70 obtained in step 2 and the bamboo of length 20 obtained in step 3 to obtain a bamboo of length 90. (MP consumed: 10)






Sample Input 28 100 90 80
100
100
90
90
90
80
80
80





Sample Output 20

If we already have all bamboos of the desired lengths, the amount of MP needed is 0. As seen here, we do not necessarily need to use all the bamboos.





Sample Input 38 1000 800 100
300
333
400
444
500
555
600
666





Sample Output 3243


",Synthetic Kadomatsu,"Bruteforcing, Bitmask, Combinatorics, Greedy Algorithm, Arithmetic, Implementation",0.667,96,65
906,"
Score : 700 points


Problem Statement10^{10^{10}} participants, including Takahashi, competed in two programming contests.
In each contest, all participants had distinct ranks from first through 10^{10^{10}}-th.
The score of a participant is the product of his/her ranks in the two contests.
Process the following Q queries:

In the i-th query, you are given two positive integers A_i and B_i. Assuming that Takahashi was ranked A_i-th in the first contest and B_i-th in the second contest, find the maximum possible number of participants whose scores are smaller than Takahashi's.





Constraints
1 \leq Q \leq 100
1\leq A_i,B_i\leq 10^9(1\leq i\leq Q)
All values in input are integers.







InputInput is given from Standard Input in the following format:
Q
A_1 B_1
:
A_Q B_Q





OutputFor each query, print the maximum possible number of participants whose scores are smaller than Takahashi's.






Sample Input 18
1 4
10 5
3 3
4 11
8 9
22 40
8 36
314159265 358979323





Sample Output 11
12
4
11
14
57
31
671644785

Let us denote a participant who was ranked x-th in the first contest and y-th in the second contest as (x,y).
In the first query, (2,1) is a possible candidate of a participant whose score is smaller than Takahashi's. There are never two or more participants whose scores are smaller than Takahashi's, so we should print 1.

",Worst Case,"Arithmetic, Mathematics, Binary Search, Numerical Analysis",0.3,23,4
907,"
Score : 100 points


Problem StatementGiven an integer N not less than 3, find the sum of the interior angles of a regular polygon with N sides.
Print the answer in degrees, but do not print units.




Constraints
3 \leq N \leq 100







InputInput is given from Standard Input in the following format:
N





OutputPrint an integer representing the sum of the interior angles of a regular polygon with N sides.






Sample Input 13





Sample Output 1180

The sum of the interior angles of a regular triangle is 180 degrees.





Sample Input 2100





Sample Output 217640


",Sum of Interior Angles,"Arithmetic, Mathematics",0.864,108,83
908,"
Score : 200 points


Problem StatementTakahashi is competing in a sumo tournament.
The tournament lasts for 15 days, during which he performs in one match per day.
If he wins 8 or more matches, he can also participate in the next tournament.
The matches for the first k days have finished.
You are given the results of Takahashi's matches as a string S consisting of o and x.
If the i-th character in S is o, it means that Takahashi won the match on the i-th day; if that character is x, it means that Takahashi lost the match on the i-th day.
Print YES if there is a possibility that Takahashi can participate in the next tournament, and print NO if there is no such possibility.




Constraints
1 \leq k \leq 15
S is a string of length k consisting of o and x.







InputInput is given from Standard Input in the following format:
S





OutputPrint YES if there is a possibility that Takahashi can participate in the next tournament, and print NO otherwise.






Sample Input 1oxoxoxoxoxoxox





Sample Output 1YES

Takahashi has 7 wins and 7 losses before the last match. If he wins that match, he will have 8 wins.





Sample Input 2xxxxxxxx





Sample Output 2NO


",Sumo,"String, Counting, Arithmetic, Implementation",0.816,119,87
909,"
Score : 400 points


Problem StatementYou are going out for a walk, when you suddenly encounter N monsters. Each monster has a parameter called health, and the health of the i-th monster is h_i at the moment of encounter. A monster will vanish immediately when its health drops to 0 or below.
Fortunately, you are a skilled magician, capable of causing explosions that damage monsters. In one explosion, you can damage monsters as follows:

Select an alive monster, and cause an explosion centered at that monster. The health of the monster at the center of the explosion will decrease by A, and the health of each of the other monsters will decrease by B. Here, A and B are predetermined parameters, and A > B holds.

At least how many explosions do you need to cause in order to vanish all the monsters?




Constraints
All input values are integers.
1 ≤ N ≤ 10^5
1 ≤ B < A ≤ 10^9
1 ≤ h_i ≤ 10^9







InputInput is given from Standard Input in the following format:
N A B
h_1
h_2
:
h_N





OutputPrint the minimum number of explosions that needs to be caused in order to vanish all the monsters.






Sample Input 14 5 3
8
7
4
2





Sample Output 12

You can vanish all the monsters in two explosion, as follows:

First, cause an explosion centered at the monster with 8 health. The healths of the four monsters become 3, 4, 1 and -1, respectively, and the last monster vanishes.
Second, cause an explosion centered at the monster with 4 health remaining. The healths of the three remaining monsters become 0, -1 and -2, respectively, and all the monsters are now vanished.






Sample Input 22 10 4
20
20





Sample Output 24

You need to cause two explosions centered at each monster, for a total of four.





Sample Input 35 2 1
900000000
900000000
1000000000
1000000000
1000000000





Sample Output 3800000000


",Widespread,"Binary Search, Greedy Algorithm, Arithmetic, Array, Sorting",0.341,93,27
910,"
Score : 300 points


Problem StatementYou are given two integer sequences of length N: a_1,a_2,..,a_N and b_1,b_2,..,b_N.
Determine if we can repeat the following operation zero or more times so that the sequences a and b become equal.
Operation: Choose two integers i and j (possibly the same) between 1 and N (inclusive), then perform the following two actions simultaneously:

Add 2 to a_i.
Add 1 to b_j.





Constraints
1 ≤ N ≤ 10 000
0 ≤ a_i,b_i ≤ 10^9 (1 ≤ i ≤ N)
All input values are integers.







InputInput is given from Standard Input in the following format:
N
a_1 a_2 .. a_N
b_1 b_2 .. b_N





OutputIf we can repeat the operation zero or more times so that the sequences a and b become equal, print Yes; otherwise, print No.






Sample Input 13
1 2 3
5 2 2





Sample Output 1Yes

For example, we can perform three operations as follows to do our job:

First operation: i=1 and j=2. Now we have a = \{3,2,3\}, b = \{5,3,2\}.
Second operation: i=1 and j=2. Now we have a = \{5,2,3\}, b = \{5,4,2\}.
Third operation: i=2 and j=3. Now we have a = \{5,4,3\}, b = \{5,4,3\}.






Sample Input 25
3 1 4 1 5
2 7 1 8 2





Sample Output 2No






Sample Input 35
2 7 1 8 2
3 1 4 1 5





Sample Output 3No


",Two Arrays,"Arithmetic, Greedy Algorithm, Bruteforcing, Boolean Operations On Geometric Objects",0.085,171,30
911,"
Score : 400 points


Problem StatementWe have a sequence of length N, a = (a_1, a_2, ..., a_N).
Each a_i is a positive integer.
Snuke's objective is to permute the element in a so that the following condition is satisfied:

For each 1 ≤ i ≤ N - 1, the product of a_i and a_{i + 1} is a multiple of 4.

Determine whether Snuke can achieve his objective.




Constraints
2 ≤ N ≤ 10^5
a_i is an integer.
1 ≤ a_i ≤ 10^9







InputInput is given from Standard Input in the following format:
N
a_1 a_2 ... a_N





OutputIf Snuke can achieve his objective, print Yes; otherwise, print No.






Sample Input 13
1 10 100





Sample Output 1Yes

One solution is (1, 100, 10).





Sample Input 24
1 2 3 4





Sample Output 2No

It is impossible to permute a so that the condition is satisfied.





Sample Input 33
1 4 1





Sample Output 3Yes

The condition is already satisfied initially.





Sample Input 42
1 1





Sample Output 4No






Sample Input 56
2 7 1 8 2 8





Sample Output 5Yes


",4-adjacent,"Counting, Mathematics, Greedy Algorithm, Boolean Operations On Geometric Objects",0.451,168,64
912,"
Score : 200 points


Problem Statement
Niwango-kun is an employee of Dwango Co., Ltd.
One day, he is asked to generate a thumbnail from a video a user submitted.
To generate a thumbnail, he needs to select a frame of the video according to the following procedure:

Get an integer N and N integers a_0, a_1, ..., a_{N-1} as inputs. N denotes the number of the frames of the video, and each a_i denotes the representation of the i-th frame of the video.
Select t-th frame whose representation a_t is nearest to the average of all frame representations.
If there are multiple such frames, select the frame with the smallest index.

Find the index t of the frame he should select to generate a thumbnail.




Constraints

1 \leq N \leq 100
1 \leq a_i \leq 100
All numbers given in input are integers







Input
Input is given from Standard Input in the following format:
N
a_{0} a_{1} ... a_{N-1}





Output
Print the answer.






Sample Input 1
3
1 2 3





Sample Output 1
1

Since the average of frame representations is 2, Niwango-kun needs to select the index 1, whose representation is 2, that is, the nearest value to the average.





Sample Input 2
4
2 5 2 5





Sample Output 2
0

The average of frame representations is 3.5.
In this case, every frame has the same distance from its representation to the average.
Therefore, Niwango-kun should select index 0, the smallest index among them.

",Thumbnail,"Bruteforcing, Arithmetic, Mathematics, Array",0.568,75,42
913,"
Score : 400 points


Problem Statement
One day, Niwango-kun, an employee of Dwango Co., Ltd., found an integer sequence (a_1, ..., a_N) of length N.
He is interested in properties of the sequence a.
For a nonempty contiguous subsequence a_l, ..., a_r (1 \leq l \leq r \leq N) of the sequence a, its beauty is defined as a_l + ... + a_r. Niwango-kun wants to know the maximum possible value of the bitwise AND of the beauties of K nonempty contiguous subsequences among all N(N+1)/2 nonempty contiguous subsequences. (Subsequences may share elements.)
Find the maximum possible value for him.




Constraints

2 \leq N \leq 1000
1 \leq a_i \leq 10^9
1 \leq K \leq N(N+1)/2
All numbers given in input are integers







Input
Input is given from Standard Input in the following format:
N K
a_1 a_2 ... a_N





OutputPrint the answer.






Sample Input 1
4 2
2 5 2 5





Sample Output 1
12

There are 10 nonempty contiguous subsequences of a. Let us enumerate them:

contiguous subsequences starting from the first element: \{2\}, \{2, 5\}, \{2, 5, 2\}, \{2, 5, 2, 5\}
contiguous subsequences starting from the second element: \{5\}, \{5, 2\}, \{5, 2, 5\}
contiguous subsequences starting from the third element: \{2\}, \{2, 5\}
contiguous subsequences starting from the fourth element: \{5\}

(Note that even if the elements of subsequences are equal, subsequences that have different starting indices are considered to be different.)
The maximum possible bitwise AND of the beauties of two different contiguous subsequences is 12.
This can be achieved by choosing \{5, 2, 5\} (with beauty 12) and \{2, 5, 2, 5\} (with beauty 14).





Sample Input 2
8 4
9 1 8 2 7 5 6 4





Sample Output 2
32


",Sum AND Subarrays,"Prefix sum, Enumeration, Bitmask, Greedy Algorithm, Backtracking, Counting, Sorting",0.105,44,11
914,"
Score : 300 points


Problem StatementThere are N integers a_1, a_2, ..., a_N not less than 1.
The values of a_1, a_2, ..., a_N are not known, but it is known that a_1 \times a_2 \times ... \times a_N = P.
Find the maximum possible greatest common divisor of a_1, a_2, ..., a_N.




Constraints
1 \leq N \leq 10^{12}
1 \leq P \leq 10^{12}







InputInput is given from Standard Input in the following format:
N P





OutputPrint the answer.






Sample Input 13 24





Sample Output 12

The greatest common divisor would be 2 when, for example, a_1=2, a_2=6 and a_3=2.





Sample Input 25 1





Sample Output 21

As a_i are positive integers, the only possible case is a_1 = a_2 = a_3 = a_4 = a_5 = 1.





Sample Input 31 111





Sample Output 3111






Sample Input 44 972439611840





Sample Output 4206


",Product and GCD,"Prime Factorization, Arithmetic, Exponentiation By Squaring, Data Structures",0.0,59,11
915,"
Score : 800 points


Problem StatementTakahashi Lake has a perimeter of L. On the circumference of the lake, there is a residence of the lake's owner, Takahashi.
Each point on the circumference of the lake has a coordinate between 0 and L (including 0 but not L), which is the distance from the Takahashi's residence, measured counter-clockwise.
There are N trees around the lake; the coordinate of the i-th tree is X_i. There is no tree at coordinate 0, the location of Takahashi's residence.
Starting at his residence, Takahashi will repeat the following action:

If all trees are burnt, terminate the process.
Specify a direction: clockwise or counter-clockwise.
Walk around the lake in the specified direction, until the coordinate of a tree that is not yet burnt is reached for the first time.
When the coordinate with the tree is reached, burn that tree, stay at the position and go back to the first step.

Find the longest possible total distance Takahashi walks during the process.




Partial ScoreA partial score can be obtained in this problem:

300 points will be awarded for passing the input satisfying N \leq 2000.





Constraints
2 \leq L \leq 10^9
1 \leq N \leq 2\times 10^5
1 \leq X_1 < ... < X_N \leq L-1
All values in input are integers.







InputInput is given from Standard Input in the following format:
L N
X_1
:
X_N





OutputPrint the longest possible total distance Takahashi walks during the process.






Sample Input 110 3
2
7
9





Sample Output 115

Takahashi walks the distance of 15 if the process goes as follows:

Walk a distance of 2 counter-clockwise, burn the tree at the coordinate 2 and stay there.
Walk a distance of 5 counter-clockwise, burn the tree at the coordinate 7 and stay there.
Walk a distance of 8 clockwise, burn the tree at the coordinate 9 and stay there.






Sample Input 210 6
1
2
3
6
7
9





Sample Output 227






Sample Input 3314159265 7
21662711
77271666
89022761
156626166
160332356
166902656
298992265





Sample Output 31204124749


",Tree Burning,"Prefix sum, Geometry; 3d, Sorting, Dyanmic Programming, Enumeration, Mathematics",0.2,29,7
916,"
Score : 300 points


Problem StatementYou are given a grid of squares with H horizontal rows and W vertical columns, where each square is painted white or black.
HW characters from A_{11} to A_{HW} represent the colors of the squares.
A_{ij} is # if the square at the i-th row from the top and the j-th column from the left is black, and A_{ij} is . if that square is white.
We will repeatedly perform the following operation until all the squares are black:

Every white square that shares a side with a black square, becomes black.

Find the number of operations that will be performed.
The initial grid has at least one black square.




Constraints
1 \leq H,W \leq 1000
A_{ij} is # or ..
The given grid has at least one black square.







InputInput is given from Standard Input in the following format:
H W
A_{11}A_{12}...A_{1W}
:
A_{H1}A_{H2}...A_{HW}





OutputPrint the number of operations that will be performed.






Sample Input 13 3
...
.#.
...





Sample Output 12

After one operation, all but the corners of the grid will be black. After one more operation, all the squares will be black.





Sample Input 26 6
..#..#
......
#..#..
......
.#....
....#.





Sample Output 23


",Darker and Darker,"Breadth-first Search, Grid Graph, Queue, Graph Theory, Array",0.287,222,57
917,"
Score : 400 points


Problem StatementN people are arranged in a row from left to right.
You are given a string S of length N consisting of 0 and 1, and a positive integer K.
The i-th person from the left is standing on feet if the i-th character of S is 0, and standing on hands if that character is 1.
You will give the following direction at most K times (possibly zero):
Direction: Choose integers l and r satisfying 1 \leq l \leq r \leq N, and flip the l-th, (l+1)-th, ..., and r-th persons. That is, for each i = l, l+1, ..., r, the i-th person from the left now stands on hands if he/she was standing on feet, and stands on feet if he/she was standing on hands.
Find the maximum possible number of consecutive people standing on hands after at most K directions.




Constraints
N is an integer satisfying 1 \leq N \leq 10^5.
K is an integer satisfying 1 \leq K \leq 10^5.
The length of the string S is N.
Each character of the string S is 0 or 1.







InputInput is given from Standard Input in the following format:
N K
S





OutputPrint the maximum possible number of consecutive people standing on hands after at most K directions.






Sample Input 15 1
00010





Sample Output 14

We can have four consecutive people standing on hands, which is the maximum result, by giving the following direction:

Give the direction with l = 1, r = 3, which flips the first, second and third persons from the left.






Sample Input 214 2
11101010110011





Sample Output 28






Sample Input 31 1
1





Sample Output 31

No directions are necessary.

",Handstand,"Two-pointer, Prefix sum, Greedy Algorithm, String, Array",0.393,222,73
918,"
Score: 500 points


Problem Statement
Takahashi will take part in an eating contest. Teams of N members will compete in this contest, and Takahashi's team consists of N players numbered 1 through N from youngest to oldest. The consumption coefficient of Member i is A_i.
In the contest, N foods numbered 1 through N will be presented, and the difficulty of Food i is F_i. The details of the contest are as follows:

A team should assign one member to each food, and should not assign the same member to multiple foods.
It will take x \times y seconds for a member to finish the food, where x is the consumption coefficient of the member and y is the difficulty of the dish.
The score of a team is the longest time it takes for an individual member to finish the food.

Before the contest, Takahashi's team decided to do some training. In one set of training, a member can reduce his/her consumption coefficient by 1, as long as it does not go below 0. However, for financial reasons, the N members can do at most K sets of training in total.
What is the minimum possible score of the team, achieved by choosing the amounts of members' training and allocating the dishes optimally?




Constraints

All values in input are integers.
1 \leq N \leq 2 \times 10^5
0 \leq K \leq 10^{18}
1 \leq A_i \leq 10^6\ (1 \leq i \leq N)
1 \leq F_i \leq 10^6\ (1 \leq i \leq N)







Input
Input is given from Standard Input in the following format:
N K
A_1 A_2 ... A_N
F_1 F_2 ... F_N





Output
Print the minimum possible score of the team.






Sample Input 13 5
4 2 1
2 3 1





Sample Output 12

They can achieve the score of 2, as follows:

Member 1 does 4 sets of training and eats Food 2 in (4-4) \times 3 = 0 seconds.
Member 2 does 1 set of training and eats Food 3 in (2-1) \times 1 = 1 second.
Member 3 does 0 sets of training and eats Food 1 in (1-0) \times 2 = 2 seconds.

They cannot achieve a score of less than 2, so the answer is 2.





Sample Input 23 8
4 2 1
2 3 1





Sample Output 20

They can choose not to do exactly K sets of training.





Sample Input 311 14
3 1 4 1 5 9 2 6 5 3 5
8 9 7 9 3 2 3 8 4 6 2





Sample Output 312


",Gluttony,"Sorting, Greedy Algorithm, Binary Search, Maximum Flow, Arithmetic",0.41,91,30
919,"
Score : 200 points


Problem StatementWe will say that two integer sequences of length N, x_1, x_2, ..., x_N and y_1, y_2, ..., y_N, are similar when |x_i - y_i| \leq 1 holds for all i (1 \leq i \leq N).
In particular, any integer sequence is similar to itself.
You are given an integer N and an integer sequence of length N, A_1, A_2, ..., A_N.
How many integer sequences b_1, b_2, ..., b_N are there such that b_1, b_2, ..., b_N is similar to A and the product of all elements, b_1 b_2 ... b_N, is even?




Constraints
1 \leq N \leq 10
1 \leq A_i \leq 100







InputInput is given from Standard Input in the following format:
N
A_1 A_2 ... A_N





OutputPrint the number of integer sequences that satisfy the condition.






Sample Input 12
2 3





Sample Output 17

There are seven integer sequences that satisfy the condition:

1, 2
1, 4
2, 2
2, 3
2, 4
3, 2
3, 4






Sample Input 23
3 3 3





Sample Output 226






Sample Input 31
100





Sample Output 31






Sample Input 410
90 52 56 71 44 8 13 30 57 84





Sample Output 458921


",Similar Arrays,"Combinatorics, Arithmetic, Exponentiation By Squaring, Counting, Depth-first Search",0.946,61,56
920,"
Score : 300 points


Problem StatementSnuke is making sugar water in a beaker.
Initially, the beaker is empty. Snuke can perform the following four types of operations any number of times. He may choose not to perform some types of operations.

Operation 1: Pour 100A grams of water into the beaker.
Operation 2: Pour 100B grams of water into the beaker.
Operation 3: Put C grams of sugar into the beaker.
Operation 4: Put D grams of sugar into the beaker.

In our experimental environment, E grams of sugar can dissolve into 100 grams of water.
Snuke will make sugar water with the highest possible density.
The beaker can contain at most F grams of substances (water and sugar combined), and there must not be any undissolved sugar in the beaker.
Find the mass of the sugar water Snuke will make, and the mass of sugar dissolved in it.
If there is more than one candidate, any of them will be accepted.
We remind you that the sugar water that contains a grams of water and b grams of sugar is \frac{100b}{a + b} percent.
Also, in this problem, pure water that does not contain any sugar is regarded as 0 percent density sugar water.




Constraints
1 \leq A < B \leq 30
1 \leq C < D \leq 30
1 \leq E \leq 100
100A \leq F \leq 3 000
A, B, C, D, E and F are all integers.







InputsInput is given from Standard Input in the following format:
A B C D E F





OutputsPrint two integers separated by a space.
The first integer should be the mass of the desired sugar water, and the second should be the mass of the sugar dissolved in it.






Sample Input 11 2 10 20 15 200





Sample Output 1110 10

In this environment, 15 grams of sugar can dissolve into 100 grams of water, and the beaker can contain at most 200 grams of substances.
We can make 110 grams of sugar water by performing Operation 1 once and Operation 3 once.
It is not possible to make sugar water with higher density.
For example, the following sequences of operations are infeasible:

If we perform Operation 1 once and Operation 4 once, there will be undissolved sugar in the beaker.
If we perform Operation 2 once and Operation 3 three times, the mass of substances in the beaker will exceed 200 grams.






Sample Input 21 2 1 2 100 1000





Sample Output 2200 100

There are other acceptable outputs, such as:
400 200

However, the output below is not acceptable:
300 150

This is because, in order to make 300 grams of sugar water containing 150 grams of sugar, we need to pour exactly 150 grams of water into the beaker, which is impossible.





Sample Input 317 19 22 26 55 2802





Sample Output 32634 934


",Sugar Water,"Bruteforcing, Implementation, Arithmetic, Mathematics",0.25,151,38
921,"
Score : 900 points


Problem StatementThere are N robots and M exits on a number line.
The N + M coordinates of these are all integers and all distinct.
For each i (1 \leq i \leq N), the coordinate of the i-th robot from the left is x_i.
Also, for each j (1 \leq j \leq M), the coordinate of the j-th exit from the left is y_j.
Snuke can repeatedly perform the following two kinds of operations in any order to move all the robots simultaneously:

Increment the coordinates of all the robots on the number line by 1.
Decrement the coordinates of all the robots on the number line by 1.

Each robot will disappear from the number line when its position coincides with that of an exit, going through that exit.
Snuke will continue performing operations until all the robots disappear.
When all the robots disappear, how many combinations of exits can be used by the robots?
Find the count modulo 10^9 + 7.
Here, two combinations of exits are considered different when there is a robot that used different exits in those two combinations.




Constraints
1 \leq N, M \leq 10^5
1 \leq x_1 < x_2 < ... < x_N \leq 10^9
1 \leq y_1 < y_2 < ... < y_M \leq 10^9
All given coordinates are integers.
All given coordinates are distinct.







InputInput is given from Standard Input in the following format:
N M
x_1 x_2 ... x_N
y_1 y_2 ... y_M





OutputPrint the number of the combinations of exits that can be used by the robots when all the robots disappear, modulo 10^9 + 7.






Sample Input 12 2
2 3
1 4





Sample Output 13

The i-th robot from the left will be called Robot i, and the j-th exit from the left will be called Exit j.
There are three possible combinations of exits (the exit used by Robot 1, the exit used by Robot 2) as follows:

(Exit 1, Exit 1)
(Exit 1, Exit 2)
(Exit 2, Exit 2)






Sample Input 23 4
2 5 10
1 3 7 13





Sample Output 28

The exit for each robot can be chosen independently, so there are 2^3 = 8 possible combinations of exits.





Sample Input 34 1
1 2 4 5
3





Sample Output 31

Every robot uses Exit 1.





Sample Input 44 5
2 5 7 11
1 3 6 9 13





Sample Output 46






Sample Input 510 10
4 13 15 18 19 20 21 22 25 27
1 5 11 12 14 16 23 26 29 30





Sample Output 522


",Robots and Exits,"Sorting, Two-pointer, Value / Coordinate Compression, Binary Indexed Tree, Dyanmic Programming, Arithmetic, Data Structures",0.75,4,3
922,"
Score : 600 points


Problem StatementWe have a rectangular grid of squares with H horizontal rows and W vertical columns. Let (i,j) denote the square at the i-th row from the top and the j-th column from the left.
On this grid, there is a piece, which is initially placed at square (s_r,s_c).
Takahashi and Aoki will play a game, where each player has a string of length N.
Takahashi's string is S, and Aoki's string is T. S and T both consist of four kinds of letters: L, R, U and D.
The game consists of N steps. The i-th step proceeds as follows:

First, Takahashi performs a move. He either moves the piece in the direction of S_i, or does not move the piece.
Second, Aoki performs a move. He either moves the piece in the direction of T_i, or does not move the piece.

Here, to move the piece in the direction of L, R, U and D, is to move the piece from square (r,c) to square (r,c-1), (r,c+1), (r-1,c) and (r+1,c), respectively. If the destination square does not exist, the piece is removed from the grid, and the game ends, even if less than N steps are done.
Takahashi wants to remove the piece from the grid in one of the N steps.
Aoki, on the other hand, wants to finish the N steps with the piece remaining on the grid.
Determine if the piece will remain on the grid at the end of the game when both players play optimally.




Constraints
2 \leq H,W \leq 2 \times 10^5
2 \leq N \leq 2 \times 10^5
1 \leq s_r \leq H
1 \leq s_c \leq W
|S|=|T|=N
S and T consists of the four kinds of letters L, R, U and D.







InputInput is given from Standard Input in the following format:
H W N
s_r s_c
S
T





OutputIf the piece will remain on the grid at the end of the game, print YES; otherwise, print NO.






Sample Input 12 3 3
2 2
RRL
LUD





Sample Output 1YES

Here is one possible progress of the game:

Takahashi moves the piece right. The piece is now at (2,3).
Aoki moves the piece left. The piece is now at (2,2).
Takahashi does not move the piece. The piece remains at (2,2).
Aoki moves the piece up. The piece is now at (1,2).
Takahashi moves the piece left. The piece is now at (1,1).
Aoki does not move the piece. The piece remains at (1,1).






Sample Input 24 3 5
2 2
UDRRR
LLDUD





Sample Output 2NO






Sample Input 35 6 11
2 1
RLDRRUDDLRL
URRDRLLDLRD





Sample Output 3NO


",LRUD Game,"Difference Array, Simulation, Greedy Algorithm, Divide And Conquer, Game Theory",0.56,55,23
923,"
Score : 200 points


Problem StatementSnuke lives on an infinite two-dimensional plane. He is going on an N-day trip.
At the beginning of Day 1, he is at home. His plan is described in a string S of length N.
On Day i(1 ≦ i ≦ N), he will travel a positive distance in the following direction:

North if the i-th letter of S is N
West if the i-th letter of S is W
South if the i-th letter of S is S
East if the i-th letter of S is E

He has not decided each day's travel distance. Determine whether it is possible to set each day's travel distance so that he will be back at home at the end of Day N.




Constraints
1 ≦ | S | ≦ 1000
S consists of the letters N, W, S, E.







InputThe input is given from Standard Input in the following format:
S





OutputPrint Yes if it is possible to set each day's travel distance so that he will be back at home at the end of Day N. Otherwise, print No.






Sample Input 1SENW





Sample Output 1Yes

If Snuke travels a distance of 1 on each day, he will be back at home at the end of day 4.





Sample Input 2NSNNSNSN





Sample Output 2Yes






Sample Input 3NNEW





Sample Output 3No






Sample Input 4W





Sample Output 4No


",Wanna go back home,"Counting, Boolean Operations On Geometric Objects, String",0.533,106,57
924,"
Score : 500 points


Problem StatementYou are given two integer sequences, each of length N: a_1, ..., a_N and b_1, ..., b_N.
There are N^2 ways to choose two integers i and j such that 1 \leq i, j \leq N. For each of these N^2 pairs, we will compute a_i + b_j and write it on a sheet of paper.
That is, we will write N^2 integers in total.
Compute the XOR of these N^2 integers.

Definition of XOR
The XOR of integers c_1, c_2, ..., c_m is defined as follows:

Let the XOR be X. In the binary representation of X, the digit in the 2^k's place (0 \leq k; k is an integer) is 1 if there are an odd number of integers among c_1, c_2, ...c_m whose binary representation has 1 in the 2^k's place, and 0 if that number is even.

For example, let us compute the XOR of 3 and 5. The binary representation of 3 is 011, and the binary representation of 5 is 101, thus the XOR has the binary representation 110, that is, the XOR is 6.
",Two Sequences,"Bitmask, Arithmetic, Sorting, Binary Search, Two-pointer, Parity",0.105,32,3
925,"
Score : 700 points


Problem StatementThere is a sequence X of length N, where every element is initially 0. Let X_i denote the i-th element of X.
You are given a sequence A of length N. The i-th element of A is A_i. Determine if we can make X equal to A by repeating the operation below. If we can, find the minimum number of operations required.

Choose an integer i such that 1\leq i\leq N-1. Replace the value of X_{i+1} with the value of X_i plus 1.





Constraints
1 \leq N \leq 2 \times 10^5
0 \leq A_i \leq 10^9(1\leq i\leq N)
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
A_1
:
A_N





OutputIf we can make X equal to A by repeating the operation, print the minimum number of operations required. If we cannot, print -1.






Sample Input 14
0
1
1
2





Sample Output 13

We can make X equal to A as follows:

Choose i=2. X becomes (0,0,1,0).
Choose i=1. X becomes (0,1,1,0).
Choose i=3. X becomes (0,1,1,2).






Sample Input 23
1
2
1





Sample Output 2-1






Sample Input 39
0
1
1
0
1
2
2
1
2





Sample Output 38


",Sequence Growing Easy,"Greedy Algorithm, Dynamic Programming, Shortest Path, Prefix sum",0.382,75,32
926,"
Score : 600 points


Problem StatementTakahashi has N balls with positive integers written on them. The integer written on the i-th ball is A_i.
He would like to form some number of pairs such that the sum of the integers written on each pair of balls is a power of 2.
Note that a ball cannot belong to multiple pairs.
Find the maximum possible number of pairs that can be formed.
Here, a positive integer is said to be a power of 2 when it can be written as 2^t using some non-negative integer t.




Constraints
1 \leq N \leq 2\times 10^5
1 \leq A_i \leq 10^9
A_i is an integer.







InputInput is given from Standard Input in the following format:
N
A_1 A_2 ... A_N





OutputPrint the maximum possible number of pairs such that the sum of the integers written on each pair of balls is a power of 2.






Sample Input 13
1 2 3





Sample Output 11

We can form one pair whose sum of the written numbers is 4 by pairing the first and third balls.
Note that we cannot pair the second ball with itself.





Sample Input 25
3 11 14 5 13





Sample Output 22


",Powers of two,"Set / Map, Greedy Algorithm, Sorting, Arithmetic, Data Structure, Two-pointer",0.312,77,20
927,"
Score : 900 points


Problem StatementTakahashi has an N \times M grid, with N horizontal rows and M vertical columns.
Determine if we can place A 1 \times 2 tiles (1 vertical, 2 horizontal) and B 2 \times 1 tiles (2 vertical, 1 horizontal) satisfying the following conditions, and construct one arrangement of the tiles if it is possible:

All the tiles must be placed on the grid.
Tiles must not stick out of the grid, and no two different tiles may intersect.
Neither the grid nor the tiles may be rotated.
Every tile completely covers exactly two squares.





Constraints
1 \leq N,M \leq 1000
0 \leq A,B \leq 500000
N, M, A and B are integers.







InputInput is given from Standard Input in the following format:
N M A B





OutputIf it is impossible to place all the tiles, print NO.
Otherwise, print the following:
YES
c_{11}...c_{1M}
:
c_{N1}...c_{NM}

Here, c_{ij} must be one of the following characters: ., <, >, ^ and v. Represent an arrangement by using each of these characters as follows:

When c_{ij} is ., it indicates that the square at the i-th row and j-th column is empty;
When c_{ij} is <, it indicates that the square at the i-th row and j-th column is covered by the left half of a 1 \times 2 tile;
When c_{ij} is >, it indicates that the square at the i-th row and j-th column is covered by the right half of a 1 \times 2 tile;
When c_{ij} is ^, it indicates that the square at the i-th row and j-th column is covered by the top half of a 2 \times 1 tile;
When c_{ij} is v, it indicates that the square at the i-th row and j-th column is covered by the bottom half of a 2 \times 1 tile.







Sample Input 13 4 4 2





Sample Output 1YES
<><>
^<>^
v<>v

This is one example of a way to place four 1 \times 2 tiles and three 2 \times 1 tiles on a 3 \times 4 grid.





Sample Input 24 5 5 3





Sample Output 2YES
<>..^
^.<>v
v<>.^
<><>v






Sample Input 37 9 20 20





Sample Output 3NO


",Tiling,"Greedy Algorithm, Array, Bruteforcing, Boolean Operations On Geometric Objects",0.0,17,1
928,"
Score : 400 points


Problem StatementThere is a bar of chocolate with a height of H blocks and a width of W blocks.
Snuke is dividing this bar into exactly three pieces.
He can only cut the bar along borders of blocks, and the shape of each piece must be a rectangle.
Snuke is trying to divide the bar as evenly as possible.
More specifically, he is trying to minimize S_{max} - S_{min}, where S_{max} is the area (the number of blocks contained) of the largest piece, and S_{min} is the area of the smallest piece.
Find the minimum possible value of S_{max} - S_{min}.




Constraints
2 ≤ H, W ≤ 10^5







InputInput is given from Standard Input in the following format:
H W





OutputPrint the minimum possible value of S_{max} - S_{min}.






Sample Input 13 5





Sample Output 10

In the division below, S_{max} - S_{min} = 5 - 5 = 0.








Sample Input 24 5





Sample Output 22

In the division below, S_{max} - S_{min} = 8 - 6 = 2.








Sample Input 35 5





Sample Output 34

In the division below, S_{max} - S_{min} = 10 - 6 = 4.








Sample Input 4100000 2





Sample Output 41






Sample Input 5100000 100000





Sample Output 550000


",Chocolate Bar,"Bruteforcing, Mathematics, Boolean Operations On Geometric Objects, Arithmetic",0.304,129,31
929,"
Score : 200 points


Problem StatementSnuke has N integers. Among them, the smallest is A, and the largest is B.
We are interested in the sum of those N integers. How many different possible sums there are?




Constraints
1 ≤ N,A,B ≤ 10^9
A and B are integers.







InputInput is given from Standard Input in the following format:
N A B





OutputPrint the number of the different possible sums.






Sample Input 14 4 6





Sample Output 15

There are five possible sums: 18=4+4+4+6, 19=4+4+5+6, 20=4+5+5+6, 21=4+5+6+6 and 22=4+6+6+6.





Sample Input 25 4 3





Sample Output 20






Sample Input 31 7 10





Sample Output 30






Sample Input 41 3 3





Sample Output 41


",A+...+B Problem,"Arithmetic, Mathematics, Boolean Operations On Geometric Objects",0.367,144,44
930,"
Score : 300 points


Problem StatementSnuke can change a string t of length N into a string t' of length N - 1 under the following rule:

For each i (1 ≤ i ≤ N - 1), the i-th character of t' must be either the i-th or (i + 1)-th character of t.

There is a string s consisting of lowercase English letters.
Snuke's objective is to apply the above operation to s repeatedly so that all the characters in s are the same.
Find the minimum necessary number of operations.




Constraints
1 ≤ |s| ≤ 100
s consists of lowercase English letters.







InputInput is given from Standard Input in the following format:
s





OutputPrint the minimum necessary number of operations to achieve the objective.






Sample Input 1serval





Sample Output 13

One solution is: serval → srvvl → svvv → vvv.





Sample Input 2jackal





Sample Output 22

One solution is: jackal → aacaa → aaaa.





Sample Input 3zzz





Sample Output 30

All the characters in s are the same from the beginning.





Sample Input 4whbrjpjyhsrywlqjxdbrbaomnw





Sample Output 48

In 8 operations, he can change s to rrrrrrrrrrrrrrrrrr.

",Shrinking,"Sliding Window, Enumeration, Greedy Algorithm, String",0.714,68,38
931,"
Score : 700 points


Problem StatementThere are N cats.
We number them from 1 through N.
Each of the cats wears a hat.
Cat i says: ""there are exactly a_i different colors among the N - 1 hats worn by the cats except me.""
Determine whether there exists a sequence of colors of the hats that is consistent with the remarks of the cats.




Constraints
2 ≤ N ≤ 10^5
1 ≤ a_i ≤ N-1







InputInput is given from Standard Input in the following format:
N
a_1 a_2 ... a_N





OutputPrint Yes if there exists a sequence of colors of the hats that is consistent with the remarks of the cats; print No otherwise.






Sample Input 13
1 2 2





Sample Output 1Yes

For example, if cat 1, 2 and 3 wears red, blue and blue hats, respectively, it is consistent with the remarks of the cats.





Sample Input 23
1 1 2





Sample Output 2No

From the remark of cat 1, we can see that cat 2 and 3 wear hats of the same color.
Also, from the remark of cat 2, we can see that cat 1 and 3 wear hats of the same color.
Therefore, cat 1 and 2 wear hats of the same color, which contradicts the remark of cat 3.





Sample Input 35
4 3 4 3 4





Sample Output 3No






Sample Input 43
2 2 2





Sample Output 4Yes






Sample Input 54
2 2 2 2





Sample Output 5Yes






Sample Input 65
3 3 3 3 3





Sample Output 6No


",Colorful Hats,"Sorting, Counting, Mathematics, Greedy Algorithm",0.722,24,15
932,"
Score : 600 points


Problem StatementYou are given an integer sequence of length n+1, a_1,a_2,...,a_{n+1}, which consists of the n integers 1,...,n.
It is known that each of the n integers 1,...,n appears at least once in this sequence.
For each integer k=1,...,n+1, find the number of the different subsequences (not necessarily contiguous) of the given sequence with length k, modulo 10^9+7.




Notes

If the contents of two subsequences are the same, they are not separately counted even if they originate from different positions in the original sequence.


A subsequence of a sequence a with length k is a sequence obtained by selecting k of the elements of a and arranging them without changing their relative order. For example, the sequences 1,3,5 and 1,2,3 are subsequences of 1,2,3,4,5, while 3,1,2 and 1,10,100 are not.






Constraints
1 \leq n \leq 10^5
1 \leq a_i \leq n
Each of the integers 1,...,n appears in the sequence.
n and a_i are integers.







InputInput is given from Standard Input in the following format:
n
a_1 a_2 ... a_{n+1}





OutputPrint n+1 lines.
The k-th line should contain the number of the different subsequences of the given sequence with length k, modulo 10^9+7.






Sample Input 13
1 2 1 3





Sample Output 13
5
4
1

There are three subsequences with length 1: 1 and 2 and 3.
There are five subsequences with length 2: 1,1 and 1,2 and 1,3 and 2,1 and 2,3.
There are four subsequences with length 3: 1,1,3 and 1,2,1 and 1,2,3 and 2,1,3.
There is one subsequence with length 4: 1,2,1,3.





Sample Input 21
1 1





Sample Output 21
1

There is one subsequence with length 1: 1.
There is one subsequence with length 2: 1,1.





Sample Input 332
29 19 7 10 26 32 27 4 11 20 2 8 16 23 5 14 6 12 17 22 18 30 28 24 15 1 25 3 13 21 19 31 9





Sample Output 332
525
5453
40919
237336
1107568
4272048
13884156
38567100
92561040
193536720
354817320
573166440
818809200
37158313
166803103
166803103
37158313
818809200
573166440
354817320
193536720
92561040
38567100
13884156
4272048
1107568
237336
40920
5456
528
33
1

Be sure to print the numbers modulo 10^9+7.

",11,"Two-pointer, Combinatorics, Arithmetic, Precomputation, Inclusion And Exclusion",0.143,59,13
933,"
Score : 400 points


Problem StatementThere are N squares in a row.
The leftmost square contains the integer A, and the rightmost contains the integer B. The other squares are empty.
Aohashi would like to fill the empty squares with integers so that the following condition is satisfied:

For any two adjacent squares, the (absolute) difference of the two integers in those squares is between C and D (inclusive).

As long as the condition is satisfied, it is allowed to use arbitrarily large or small integers to fill the squares.
Determine whether it is possible to fill the squares under the condition.




Constraints
3 \leq N \leq 500000
0 \leq A \leq 10^9
0 \leq B \leq 10^9
0 \leq C \leq D \leq 10^9
All input values are integers.







InputInput is given from Standard Input in the following format:
N A B C D





OutputPrint YES if it is possible to fill the squares under the condition; print NO otherwise.






Sample Input 15 1 5 2 4





Sample Output 1YES

For example, fill the squares with the following integers: 1, -1, 3, 7, 5, from left to right.





Sample Input 24 7 6 4 5





Sample Output 2NO






Sample Input 348792 105960835 681218449 90629745 90632170





Sample Output 3NO






Sample Input 4491995 412925347 825318103 59999126 59999339





Sample Output 4YES


",Moderate Differences,"Constructive, Arithmetic, Parity, Mathematics",0.684,39,15
934,"
Score : 300 points


Problem StatementSnuke and Raccoon have a heap of N cards. The i-th card from the top has the integer a_i written on it.
They will share these cards.
First, Snuke will take some number of cards from the top of the heap, then Raccoon will take all the remaining cards.
Here, both Snuke and Raccoon have to take at least one card.
Let the sum of the integers on Snuke's cards and Raccoon's cards be x and y, respectively.
They would like to minimize |x-y|.
Find the minimum possible value of |x-y|.




Constraints
2 \leq N \leq 2 \times 10^5
-10^{9} \leq a_i \leq 10^{9}
a_i is an integer.







InputInput is given from Standard Input in the following format:
N
a_1 a_2 ... a_{N}





OutputPrint the answer.






Sample Input 16
1 2 3 4 5 6





Sample Output 11

If Snuke takes four cards from the top, and Raccoon takes the remaining two cards, x=10, y=11, and thus |x-y|=1. This is the minimum possible value.





Sample Input 22
10 -10





Sample Output 220

Snuke can only take one card from the top, and Raccoon can only take the remaining one card. In this case, x=10, y=-10, and thus |x-y|=20.

",Splitting Pile,"Prefix sum, Bruteforcing, Arithmetic, Constructive",0.606,71,31
935,"
Score : 700 points


Problem StatementWe have a sandglass consisting of two bulbs, bulb A and bulb B. These bulbs contain some amount of sand.
When we put the sandglass, either bulb A or B lies on top of the other and becomes the upper bulb. The other bulb becomes the lower bulb.
The sand drops from the upper bulb to the lower bulb at a rate of 1 gram per second.
When the upper bulb no longer contains any sand, nothing happens.
Initially at time 0, bulb A is the upper bulb and contains a grams of sand; bulb B contains X-a grams of sand (for a total of X grams).
We will turn over the sandglass at time r_1,r_2,..,r_K. Assume that this is an instantaneous action and takes no time. Here, time t refer to the time t seconds after time 0.
You are given Q queries.
Each query is in the form of (t_i,a_i).
For each query, assume that a=a_i and find the amount of sand that would be contained in bulb A at time t_i.




Constraints
1≤X≤10^9
1≤K≤10^5
1≤r_1<r_2< .. <r_K≤10^9
1≤Q≤10^5
0≤t_1<t_2< .. <t_Q≤10^9
0≤a_i≤X (1≤i≤Q)
All input values are integers.







InputThe input is given from Standard Input in the following format:
X
K
r_1 r_2 .. r_K
Q
t_1 a_1
t_2 a_2
:
t_Q a_Q





OutputFor each query, print the answer in its own line.






Sample Input 1180
3
60 120 180
3
30 90
61 1
180 180





Sample Output 160
1
120

In the first query, 30 out of the initial 90 grams of sand will drop from bulb A, resulting in 60 grams.
In the second query, the initial 1 gram of sand will drop from bulb A, and nothing will happen for the next 59 seconds. Then, we will turn over the sandglass, and 1 second after this, bulb A contains 1 gram of sand at the time in question.





Sample Input 2100
1
100000
4
0 100
90 100
100 100
101 100





Sample Output 2100
10
0
0

In every query, the upper bulb initially contains 100 grams, and the question in time comes before we turn over the sandglass.





Sample Input 3100
5
48 141 231 314 425
7
0 19
50 98
143 30
231 55
342 0
365 100
600 10





Sample Output 319
52
91
10
58
42
100


",Sandglass,"Binary Search, Prefix sum, Mathematics, Greedy Algorithm, Implementation",0.429,8,3
936,"
Score : 300 points


Problem StatementSnuke is making sugar water in a beaker.
Initially, the beaker is empty. Snuke can perform the following four types of operations any number of times. He may choose not to perform some types of operations.

Operation 1: Pour 100A grams of water into the beaker.
Operation 2: Pour 100B grams of water into the beaker.
Operation 3: Put C grams of sugar into the beaker.
Operation 4: Put D grams of sugar into the beaker.

In our experimental environment, E grams of sugar can dissolve into 100 grams of water.
Snuke will make sugar water with the highest possible density.
The beaker can contain at most F grams of substances (water and sugar combined), and there must not be any undissolved sugar in the beaker.
Find the mass of the sugar water Snuke will make, and the mass of sugar dissolved in it.
If there is more than one candidate, any of them will be accepted.
We remind you that the sugar water that contains a grams of water and b grams of sugar is \frac{100b}{a + b} percent.
Also, in this problem, pure water that does not contain any sugar is regarded as 0 percent density sugar water.




Constraints
1 \leq A < B \leq 30
1 \leq C < D \leq 30
1 \leq E \leq 100
100A \leq F \leq 3 000
A, B, C, D, E and F are all integers.







InputsInput is given from Standard Input in the following format:
A B C D E F





OutputsPrint two integers separated by a space.
The first integer should be the mass of the desired sugar water, and the second should be the mass of the sugar dissolved in it.






Sample Input 11 2 10 20 15 200





Sample Output 1110 10

In this environment, 15 grams of sugar can dissolve into 100 grams of water, and the beaker can contain at most 200 grams of substances.
We can make 110 grams of sugar water by performing Operation 1 once and Operation 3 once.
It is not possible to make sugar water with higher density.
For example, the following sequences of operations are infeasible:

If we perform Operation 1 once and Operation 4 once, there will be undissolved sugar in the beaker.
If we perform Operation 2 once and Operation 3 three times, the mass of substances in the beaker will exceed 200 grams.






Sample Input 21 2 1 2 100 1000





Sample Output 2200 100

There are other acceptable outputs, such as:
400 200

However, the output below is not acceptable:
300 150

This is because, in order to make 300 grams of sugar water containing 150 grams of sugar, we need to pour exactly 150 grams of water into the beaker, which is impossible.





Sample Input 317 19 22 26 55 2802





Sample Output 32634 934


",Sugar Water,"Bruteforcing, Implementation, Arithmetic, Mathematics",0.107,92,26
937,"
Score : 400 points


Problem StatementWe have an H-by-W matrix.
Let a_{ij} be the element at the i-th row from the top and j-th column from the left.
In this matrix, each a_{ij} is a lowercase English letter.
Snuke is creating another H-by-W matrix, A', by freely rearranging the elements in A.
Here, he wants to satisfy the following condition:

Every row and column in A' can be read as a palindrome.

Determine whether he can create a matrix satisfying the condition.




NoteA palindrome is a string that reads the same forward and backward.
For example, a, aa, abba and abcba are all palindromes, while ab, abab and abcda are not.




Constraints
1 ≤ H, W ≤ 100
a_{ij} is a lowercase English letter.







InputInput is given from Standard Input in the following format:
H W
a_{11}a_{12}...a_{1W}
:
a_{H1}a_{H2}...a_{HW}





OutputIf Snuke can create a matrix satisfying the condition, print Yes; otherwise, print No.






Sample Input 13 4
aabb
aabb
aacc





Sample Output 1Yes

For example, the following matrix satisfies the condition.
abba
acca
abba






Sample Input 22 2
aa
bb





Sample Output 2No

It is not possible to create a matrix satisfying the condition, no matter how we rearrange the elements in A.





Sample Input 35 1
t
w
e
e
t





Sample Output 3Yes

For example, the following matrix satisfies the condition.
t
e
w
e
t






Sample Input 42 5
abxba
abyba





Sample Output 4No






Sample Input 51 1
z





Sample Output 5Yes


",Palindromic Matrix,"Counting, Mathematics, Greedy Algorithm, Arithmetic, String",0.486,109,30
938,"
Score : 100 points


Problem StatementSnuke built an online judge to hold a programming contest.
When a program is submitted to the judge, the judge returns a verdict, which is a two-character string that appears in the string S as a contiguous substring.
(The judge can return any two-character substring of S.)
Determine whether the judge can return the string AC as the verdict to a program.




Constraints
2 \leq |S| \leq 5
S consists of uppercase English letters.







InputInput is given from Standard Input in the following format:
S





OutputIf the judge can return the string AC as a verdict to a program, print Yes; if it cannot, print No.






Sample Input 1BACD





Sample Output 1Yes

The string AC appears in BACD as a contiguous substring (the second and third characters).





Sample Input 2ABCD





Sample Output 2No

Although the string ABCD contains both A and C (the first and third characters), the string AC does not appear in ABCD as a contiguous substring.





Sample Input 3CABD





Sample Output 3No






Sample Input 4ACACA





Sample Output 4Yes






Sample Input 5XX





Sample Output 5No


",Can you get AC?,"String, Implementation",0.812,67,49
939,"
Score : 400 points


Problem StatementWe have a string s consisting of lowercase English letters.
Snuke can perform the following operation repeatedly:

Insert a letter x to any position in s of his choice, including the beginning and end of s.

Snuke's objective is to turn s into a palindrome.
Determine whether the objective is achievable. If it is achievable, find the minimum number of operations required.




NotesA palindrome is a string that reads the same forward and backward.
For example, a, aa, abba and  abcba are palindromes, while ab, abab and abcda are not.




Constraints
1 \leq |s| \leq 10^5
s consists of lowercase English letters.







InputInput is given from Standard Input in the following format:
s





OutputIf the objective is achievable, print the number of operations required.
If it is not, print -1 instead.






Sample Input 1xabxa





Sample Output 12

One solution is as follows (newly inserted x are shown in bold):
xabxa → xaxbxa → xaxbxax





Sample Input 2ab





Sample Output 2-1

No sequence of operations can turn s into a palindrome.





Sample Input 3a





Sample Output 30

s is a palindrome already at the beginning.





Sample Input 4oxxx





Sample Output 43

One solution is as follows:
oxxx → xoxxx → xxoxxx → xxxoxxx

",Inserting 'x',"String, Two-pointer, Greedy Algorithm, Counting",0.697,68,34
940,"
Score : 700 points


Problem StatementWe have a string s consisting of lowercase English letters.
Snuke is partitioning s into some number of non-empty substrings.
Let the subtrings obtained be s_1, s_2, ..., s_N from left to right. (Here, s = s_1 + s_2 + ... + s_N holds.)
Snuke wants to satisfy the following condition:

For each i (1 \leq i \leq N), it is possible to permute the characters in s_i and obtain a palindrome.

Find the minimum possible value of N when the partition satisfies the condition.




Constraints
1 \leq |s| \leq 2 \times 10^5
s consists of lowercase English letters.







InputInput is given from Standard Input in the following format:
s





OutputPrint the minimum possible value of N when the partition satisfies the condition.






Sample Input 1aabxyyzz





Sample Output 12

The solution is to partition s as aabxyyzz = aab + xyyzz.
Here, aab can be permuted to form a palindrome aba, and xyyzz can be permuted to form a palindrome zyxyz.





Sample Input 2byebye





Sample Output 21

byebye can be permuted to form a palindrome byeeyb.





Sample Input 3abcdefghijklmnopqrstuvwxyz





Sample Output 326






Sample Input 4abcabcxabcx





Sample Output 43

The solution is to partition s as abcabcxabcx = a + b + cabcxabcx.

",Yet Another Palindrome Partitioning,"Bitmask, Prefix sum, Dyanmic Programming, Memoization",0.353,35,11
941,"
Score : 700 points


Problem StatementFind the smallest possible sum of the digits in the decimal notation of a positive multiple of K.




Constraints
2 \leq K \leq 10^5
K is an integer.







InputInput is given from Standard Input in the following format:
K





OutputPrint the smallest possible sum of the digits in the decimal notation of a positive multiple of K.






Sample Input 16





Sample Output 13

12=6×2 yields the smallest sum.





Sample Input 241





Sample Output 25

11111=41×271 yields the smallest sum.





Sample Input 379992





Sample Output 336


",Small Multiple,"Graph Theory, Breadth-first Search, Arithmetic, Shortest Path, Deque",0.167,29,5
942,"
Score : 400 points


Problem StatementThere are N dishes of cuisine placed in front of Takahashi and Aoki.
For convenience, we call these dishes Dish 1, Dish 2, ..., Dish N.
When Takahashi eats Dish i, he earns A_i points of happiness; when Aoki eats Dish i, she earns B_i points of happiness.
Starting from Takahashi, they alternately choose one dish and eat it, until there is no more dish to eat.
Here, both of them choose dishes so that the following value is maximized: ""the sum of the happiness he/she will earn in the end"" minus ""the sum of the happiness the other person will earn in the end"".
Find the value: ""the sum of the happiness Takahashi earns in the end"" minus ""the sum of the happiness Aoki earns in the end"".




Constraints
1 \leq N \leq 10^5
1 \leq A_i \leq 10^9
1 \leq B_i \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
A_1 B_1
:
A_N B_N





OutputPrint the value: ""the sum of the happiness Takahashi earns in the end"" minus ""the sum of the happiness Aoki earns in the end"".






Sample Input 13
10 10
20 20
30 30





Sample Output 120

In this sample, both of them earns 10 points of happiness by eating Dish 1, 20 points by eating Dish 2, and 30 points by eating Dish 3.
In this case, since Takahashi and Aoki have the same ""taste"", each time they will choose the dish with which they can earn the greatest happiness. Thus, first Takahashi will choose Dish 3, then Aoki will choose Dish 2, and finally Takahashi will choose Dish 1, so the answer is (30 + 10) - 20 = 20.





Sample Input 23
20 10
20 20
20 30





Sample Output 220

In this sample, Takahashi earns 20 points of happiness by eating any one of the dishes 1, 2 and 3, but Aoki earns 10 points of happiness by eating Dish 1, 20 points by eating Dish 2, and 30 points by eating Dish 3.
In this case, since only Aoki has likes and dislikes, each time they will choose the dish with which Aoki can earn the greatest happiness. Thus, first Takahashi will choose Dish 3, then Aoki will choose Dish 2, and finally Takahashi will choose Dish 1, so the answer is (20 + 20) - 20 = 20.





Sample Input 36
1 1000000000
1 1000000000
1 1000000000
1 1000000000
1 1000000000
1 1000000000





Sample Output 3-2999999997

Note that the answer may not fit into a 32-bit integer.

",Different Strokes,"Greedy Algorithm, Sorting, Simulation, Array, Arithmetic",0.357,117,33
943,"
Score : 400 points


Problem StatementYou are given an undirected connected weighted graph with N vertices and M edges that contains neither self-loops nor double edges.
The i-th (1≤i≤M) edge connects vertex a_i and vertex b_i with a distance of c_i.
Here, a self-loop is an edge where a_i = b_i (1≤i≤M), and double edges are two edges where (a_i,b_i)=(a_j,b_j) or (a_i,b_i)=(b_j,a_j) (1≤i<j≤M).
A connected graph is a graph where there is a path between every pair of different vertices.
Find the number of the edges that are not contained in any shortest path between any pair of different vertices.  




Constraints
2≤N≤100 
N-1≤M≤min(N(N-1)/2,1000) 
1≤a_i,b_i≤N 
1≤c_i≤1000
c_i is an integer.
The given graph contains neither self-loops nor double edges.
The given graph is connected.







InputThe input is given from Standard Input in the following format:
N M  
a_1 b_1 c_1  
a_2 b_2 c_2
:  
a_M b_M c_M  





OutputPrint the number of the edges in the graph that are not contained in any shortest path between any pair of different vertices.






Sample Input 13 3
1 2 1
1 3 1
2 3 3





Sample Output 11

In the given graph, the shortest paths between all pairs of different vertices are as follows:

The shortest path from vertex 1 to vertex 2 is: vertex 1 → vertex 2, with the length of 1.
The shortest path from vertex 1 to vertex 3 is: vertex 1 → vertex 3, with the length of 1.
The shortest path from vertex 2 to vertex 1 is: vertex 2 → vertex 1, with the length of 1.
The shortest path from vertex 2 to vertex 3 is: vertex 2 → vertex 1 → vertex 3, with the length of 2.
The shortest path from vertex 3 to vertex 1 is: vertex 3 → vertex 1, with the length of 1.
The shortest path from vertex 3 to vertex 2 is: vertex 3 → vertex 1 → vertex 2, with the length of 2.

Thus, the only edge that is not contained in any shortest path, is the edge of length 3 connecting vertex 2 and vertex 3, hence the output should be 1.





Sample Input 23 2
1 2 1
2 3 1





Sample Output 20

Every edge is contained in some shortest path between some pair of different vertices.

",Candidates of No Shortest Paths,"Graph Theory, Floyd-warshall, Dijkstra's, Bruteforcing, Memoization, Shortest Path",0.343,84,30
944,"
Score: 500 points


Problem Statement
N people are standing in a queue, numbered 1, 2, 3, ..., N from front to back. Each person wears a hat, which is red, blue, or green.
The person numbered i says:

""In front of me, exactly A_i people are wearing hats with the same color as mine.""

Assuming that all these statements are correct, find the number of possible combinations of colors of the N people's hats.
Since the count can be enormous, compute it modulo 1000000007.




Constraints

1 \leq N \leq 100000
0 \leq A_i \leq N-1
All values in input are integers.







Input
Input is given from Standard Input in the following format:
N
A_1 A_2 A_3 ... A_N





Output
Print the number of possible combinations of colors of the N people's hats, modulo 1000000007.






Sample Input 16
0 1 2 3 4 5





Sample Output 13

We have three possible combinations, as follows:

Red, Red, Red, Red, Red, Red
Blue, Blue, Blue, Blue, Blue, Blue
Green, Green, Green, Green, Green, Green






Sample Input 23
0 0 0





Sample Output 26






Sample Input 354
0 0 1 0 1 2 1 2 3 2 3 3 4 4 5 4 6 5 7 8 5 6 6 7 7 8 8 9 9 10 10 11 9 12 10 13 14 11 11 12 12 13 13 14 14 15 15 15 16 16 16 17 17 17





Sample Output 3115295190


",Colorful Hats 2,"Counting, Arithmetic, Greedy Algorithm, Combinatorics, Array",0.625,41,20
945,"
Score : 400 points


Problem StatementMr. Takahashi has a string s consisting of lowercase English letters.
He repeats the following operation on s exactly K times.

Choose an arbitrary letter on s and change that letter to the next alphabet. Note that the next letter of z is a.

For example, if you perform an operation for the second letter on aaz, aaz becomes abz.
If you then perform an operation for the third letter on abz, abz becomes aba.
Mr. Takahashi wants to have the lexicographically smallest string after performing exactly K operations on s.
Find the such string.




Constraints
1≤|s|≤10^5
All letters in s are lowercase English letters.
1≤K≤10^9







InputThe input is given from Standard Input in the following format:
s
K





OutputPrint the lexicographically smallest string after performing exactly K operations on s.






Sample Input 1xyz
4





Sample Output 1aya

For example, you can perform the following operations: xyz, yyz, zyz, ayz, aya.





Sample Input 2a
25





Sample Output 2z

You have to perform exactly K operations.





Sample Input 3codefestival
100





Sample Output 3aaaafeaaivap


",Next Letter,"Greedy Algorithm, Arithmetic, String, Bruteforcing",0.241,180,43
946,"
Score : 400 points


Problem StatementWe have a sequence of length N, a = (a_1, a_2, ..., a_N).
Each a_i is a positive integer.
Snuke's objective is to permute the element in a so that the following condition is satisfied:

For each 1 ≤ i ≤ N - 1, the product of a_i and a_{i + 1} is a multiple of 4.

Determine whether Snuke can achieve his objective.




Constraints
2 ≤ N ≤ 10^5
a_i is an integer.
1 ≤ a_i ≤ 10^9







InputInput is given from Standard Input in the following format:
N
a_1 a_2 ... a_N





OutputIf Snuke can achieve his objective, print Yes; otherwise, print No.






Sample Input 13
1 10 100





Sample Output 1Yes

One solution is (1, 100, 10).





Sample Input 24
1 2 3 4





Sample Output 2No

It is impossible to permute a so that the condition is satisfied.





Sample Input 33
1 4 1





Sample Output 3Yes

The condition is already satisfied initially.





Sample Input 42
1 1





Sample Output 4No






Sample Input 56
2 7 1 8 2 8





Sample Output 5Yes


",4-adjacent,"Counting, Number Theory, Greedy Algorithm, Permutation Cycle Decomposition",0.625,120,57
947,"
Score : 200 points


Problem StatementThere are K pieces of cakes.
Mr. Takahashi would like to eat one cake per day, taking K days to eat them all.
There are T types of cake, and the number of the cakes of type i (1 ≤ i ≤ T) is a_i.  
Eating the same type of cake two days in a row would be no fun,
so Mr. Takahashi would like to decide the order for eating cakes that minimizes the number of days on which he has to eat the same type of cake as the day before.  
Compute the minimum number of days on which the same type of cake as the previous day will be eaten.




Constraints
1 ≤ K ≤ 10000
1 ≤ T ≤ 100
1 ≤ a_i ≤ 100
a_1 + a_2 + ... + a_T = K







InputThe input is given from Standard Input in the following format:
K T
a_1 a_2 ... a_T





OutputPrint the minimum number of days on which the same type of cake as the previous day will be eaten.






Sample Input 17 3
3 2 2





Sample Output 10

For example, if Mr. Takahashi eats cakes in the order of 2, 1, 2, 3, 1, 3, 1, he can avoid eating the same type of cake as the previous day.





Sample Input 26 3
1 4 1





Sample Output 21

There are 6 cakes.
For example, if Mr. Takahashi eats cakes in the order of 2, 3, 2, 2, 1, 2, he has to eat the same type of cake (i.e., type 2) as the previous day only on the fourth day.
Since this is the minimum number, the answer is 1.





Sample Input 3100 1
100





Sample Output 399

Since Mr. Takahashi has only one type of cake, he has no choice but to eat the same type of cake as the previous day from the second day and after.

",K Cakes,"Greedy Algorithm, Sorting, Arithmetic",0.542,85,43
948,"
Score : 500 points


Problem StatementYou are given two integers A and B.
Print a grid where each square is painted white or black that satisfies the following conditions, in the format specified in Output section:

Let the size of the grid be h \times w (h vertical, w horizontal). Both h and w are at most 100.
The set of the squares painted white is divided into exactly A connected components.
The set of the squares painted black is divided into exactly B connected components.

It can be proved that there always exist one or more solutions under the conditions specified in Constraints section.
If there are multiple solutions, any of them may be printed.




NotesTwo squares painted white, c_1 and c_2, are called connected when the square c_2 can be reached from the square c_1 passing only white squares by repeatedly moving up, down, left or right to an adjacent square.
A set of squares painted white, S, forms a connected component when the following conditions are met:

Any two squares in S are connected.
No pair of a square painted white that is not included in S and a square included in S is connected.

A connected component of squares painted black is defined similarly.




Constraints
1 \leq A \leq 500
1 \leq B \leq 500







InputInput is given from Standard Input in the following format:
A B





OutputOutput should be in the following format:

In the first line, print integers h and w representing the size of the grid you constructed, with a space in between.
Then, print h more lines. The i-th (1 \leq i \leq h) of these lines should contain a string s_i as follows:
If the square at the i-th row and j-th column (1 \leq j \leq w) in the grid is painted white, the j-th character in s_i should be ..
If the square at the i-th row and j-th column (1 \leq j \leq w) in the grid is painted black, the j-th character in s_i should be #.









Sample Input 12 3





Sample Output 13 3
##.
..#
#.#

This output corresponds to the grid below:








Sample Input 27 8





Sample Output 23 5
#.#.#
.#.#.
#.#.#






Sample Input 31 1





Sample Output 34 2
..
#.
##
##






Sample Input 43 14





Sample Output 48 18
..................
..................
....##.......####.
....#.#.....#.....
...#...#....#.....
..#.###.#...#.....
.#.......#..#.....
#.........#..####.


",Grid Components,"Grid Graph, Graph Traversal, Graph Theory, Constructive, Boolean Operations On Geometric Objects",0.211,61,18
949,"
Score : 300 points


Problem StatementA game is played on a strip consisting of N cells consecutively numbered from 1 to N. 
Alice has her token on cell A. Borys has his token on a different cell B.
Players take turns, Alice moves first.
The moving player must shift his or her token from its current cell X to the neighboring cell on the left, cell X-1, or on the right, cell X+1.
Note that it's disallowed to move the token outside the strip or to the cell with the other player's token.
In one turn, the token of the moving player must be shifted exactly once.
The player who can't make a move loses, and the other player wins.
Both players want to win. Who wins if they play optimally?




Constraints
2 \leq N \leq 100
1 \leq A < B \leq N
All input values are integers.







InputInput is given from Standard Input in the following format:
N A B





OutputPrint Alice if Alice wins, Borys if Borys wins, and Draw if nobody wins.






Sample Input 15 2 4





Sample Output 1Alice

Alice can move her token to cell 3. 
After that, Borys will be unable to move his token to cell 3, so he will have to move his token to cell 5. 
Then, Alice moves her token to cell 4. Borys can't make a move and loses. 





Sample Input 22 1 2





Sample Output 2Borys

Alice can't make the very first move and loses.





Sample Input 358 23 42





Sample Output 3Borys


",Move and Win,"Parity, Game Theory, Mathematics",0.806,112,76
950,"
Score : 300 points


Problem StatementWe have a string X, which has an even number of characters. Half the characters are S, and the other half are T.
Takahashi, who hates the string ST, will perform the following operation 10^{10000} times:

Among the occurrences of ST in X as (contiguous) substrings, remove the leftmost one. If there is no occurrence, do nothing.

Find the eventual length of X.




Constraints
2 ≦ |X| ≦ 200,000
The length of X is even.
Half the characters in X are S, and the other half are T.





Partial Scores
In test cases worth 200 points, |X| ≦ 200.







InputThe input is given from Standard Input in the following format:
X





OutputPrint the eventual length of X.






Sample Input 1TSTTSS





Sample Output 14

In the 1-st operation, the 2-nd and 3-rd characters of TSTTSS are removed.
X becomes TTSS, and since it does not contain ST anymore, nothing is done in the remaining 10^{10000}-1 operations.
Thus, the answer is 4.





Sample Input 2SSTTST





Sample Output 20

X will eventually become an empty string: SSTTST ⇒ STST ⇒ ST ⇒ ``.





Sample Input 3TSSTTTSS





Sample Output 34

X will become: TSSTTTSS ⇒ TSTTSS ⇒ TTSS.

",STring,"Stack, Greedy Algorithm, String, Simulation",0.483,151,47
951,"
Score : 300 points


Problem StatementThere are an integer sequence A_1,...,A_N consisting of N terms, and N buttons.
When the i-th (1 ≦ i ≦ N) button is pressed, the values of the i terms from the first through the i-th are all incremented by 1.
There is also another integer sequence B_1,...,B_N. Takahashi will push the buttons some number of times so that for every i, A_i will be a multiple of B_i.
Find the minimum number of times Takahashi will press the buttons.




Constraints
All input values are integers.
1 ≦ N ≦ 10^5
0 ≦ A_i ≦ 10^9(1 ≦ i ≦ N)
1 ≦ B_i ≦ 10^9(1 ≦ i ≦ N)







InputThe input is given from Standard Input in the following format:
N
A_1 B_1
:
A_N B_N





OutputPrint an integer representing the minimum number of times Takahashi will press the buttons.






Sample Input 13
3 5
2 7
9 4





Sample Output 17

Press the first button twice, the second button twice and the third button three times.





Sample Input 27
3 1
4 1
5 9
2 6
5 3
5 8
9 7





Sample Output 222


",Multiple Array,"Arithmetic, Greedy Algorithm, Prefix sum, Implementation",0.388,129,48
952,"
Score : 300 points


Problem StatementIn a public bath, there is a shower which emits water for T seconds when the switch is pushed.
If the switch is pushed when the shower is already emitting water, from that moment it will be emitting water for T seconds.
Note that it does not mean that the shower emits water for T additional seconds.
N people will push the switch while passing by the shower.
The i-th person will push the switch t_i seconds after the first person pushes it.
How long will the shower emit water in total?




Constraints
1 ≤ N ≤ 200,000
1 ≤ T ≤ 10^9
0 = t_1 < t_2 < t_3 < , ..., < t_{N-1} < t_N ≤ 10^9
T and each t_i are integers.







InputInput is given from Standard Input in the following format:
N T
t_1 t_2 ... t_N





OutputAssume that the shower will emit water for a total of X seconds. Print X.






Sample Input 12 4
0 3





Sample Output 17

Three seconds after the first person pushes the water, the switch is pushed again and the shower emits water for four more seconds, for a total of seven seconds.





Sample Input 22 4
0 5





Sample Output 28

One second after the shower stops emission of water triggered by the first person, the switch is pushed again.





Sample Input 34 1000000000
0 1000 1000000 1000000000





Sample Output 32000000000






Sample Input 41 1
0





Sample Output 41






Sample Input 59 10
0 3 5 7 100 110 200 300 311





Sample Output 567


",Sentou,"Greedy Algorithm, Bruteforcing, Array, Arithmetic",0.871,42,31
953,"
Score : 400 points


Problem StatementThere is a bar of chocolate with a height of H blocks and a width of W blocks.
Snuke is dividing this bar into exactly three pieces.
He can only cut the bar along borders of blocks, and the shape of each piece must be a rectangle.
Snuke is trying to divide the bar as evenly as possible.
More specifically, he is trying to minimize S_{max} - S_{min}, where S_{max} is the area (the number of blocks contained) of the largest piece, and S_{min} is the area of the smallest piece.
Find the minimum possible value of S_{max} - S_{min}.




Constraints
2 ≤ H, W ≤ 10^5







InputInput is given from Standard Input in the following format:
H W





OutputPrint the minimum possible value of S_{max} - S_{min}.






Sample Input 13 5





Sample Output 10

In the division below, S_{max} - S_{min} = 5 - 5 = 0.








Sample Input 24 5





Sample Output 22

In the division below, S_{max} - S_{min} = 8 - 6 = 2.








Sample Input 35 5





Sample Output 34

In the division below, S_{max} - S_{min} = 10 - 6 = 4.








Sample Input 4100000 2





Sample Output 41






Sample Input 5100000 100000





Sample Output 550000


",Chocolate Bar,"Bruteforcing, Geometry; 3d, Implementation, Mathematics, Greedy Algorithm",0.591,44,20
954,"
Score : 400 points


Problem StatementThere are N people standing on the x-axis.
Let the coordinate of Person i be x_i.
For every i, x_i is an integer between 0 and 10^9 (inclusive).
It is possible that more than one person is standing at the same coordinate.
You will given M pieces of information regarding the positions of these people.
The i-th piece of information has the form (L_i, R_i, D_i).
This means that Person R_i is to the right of Person L_i by D_i units of distance, that is, x_{R_i} - x_{L_i} = D_i holds.
It turns out that some of these M pieces of information may be incorrect.
Determine if there exists a set of values (x_1, x_2, ..., x_N) that is consistent with the given pieces of information.




Constraints
1 \leq N \leq 100 000
0 \leq M \leq 200 000
1 \leq L_i, R_i \leq N (1 \leq i \leq M)
0 \leq D_i \leq 10 000 (1 \leq i \leq M)
L_i \neq R_i (1 \leq i \leq M)
If i \neq j, then (L_i, R_i) \neq (L_j, R_j) and (L_i, R_i) \neq (R_j, L_j).
D_i are integers.







InputInput is given from Standard Input in the following format:
N M
L_1 R_1 D_1
L_2 R_2 D_2
:
L_M R_M D_M





OutputIf there exists a set of values (x_1, x_2, ..., x_N) that is consistent with all given pieces of information, print Yes; if it does not exist, print No.






Sample Input 13 3
1 2 1
2 3 1
1 3 2





Sample Output 1Yes

Some possible sets of values (x_1, x_2, x_3) are (0, 1, 2) and (101, 102, 103).





Sample Input 23 3
1 2 1
2 3 1
1 3 5





Sample Output 2No

If the first two pieces of information are correct, x_3 - x_1 = 2 holds, which is contradictory to the last piece of information.





Sample Input 34 3
2 1 1
2 3 5
3 4 2





Sample Output 3Yes






Sample Input 410 3
8 7 100
7 9 100
9 8 100





Sample Output 4No






Sample Input 5100 0





Sample Output 5Yes


",People on a Line,"Graph Theory, Graph Traversal, Backtracking, 2-sat",0.353,69,13
955,"
Score : 400 points


Problem StatementLet {\rm comb}(n,r) be the number of ways to choose r objects from among n objects, disregarding order.
From n non-negative integers a_1, a_2, ..., a_n, select two numbers a_i > a_j so that {\rm comb}(a_i,a_j) is maximized.
If there are multiple pairs that maximize the value, any of them is accepted.




Constraints
2 \leq n \leq 10^5
0 \leq a_i \leq 10^9
a_1,a_2,...,a_n are pairwise distinct.
All values in input are integers.







InputInput is given from Standard Input in the following format:
n
a_1 a_2 ... a_n





OutputPrint a_i and a_j that you selected, with a space in between.






Sample Input 15
6 9 4 2 11





Sample Output 111 6

\rm{comb}(a_i,a_j) for each possible selection is as follows:

\rm{comb}(4,2)=6 
\rm{comb}(6,2)=15 
\rm{comb}(6,4)=15 
\rm{comb}(9,2)=36 
\rm{comb}(9,4)=126 
\rm{comb}(9,6)=84 
\rm{comb}(11,2)=55 
\rm{comb}(11,4)=330 
\rm{comb}(11,6)=462 
\rm{comb}(11,9)=55

Thus, we should print 11 and 6.





Sample Input 22
100 0





Sample Output 2100 0


",Binomial Coefficients,"Sorting, Binary Search, Combinatorics, Greedy Algorithm",0.591,40,20
956,"
Score : 400 points


Problem StatementWe have a pyramid with N steps, built with blocks.
The steps are numbered 1 through N from top to bottom.
For each 1≤i≤N, step i consists of 2i-1 blocks aligned horizontally.
The pyramid is built so that the blocks at the centers of the steps are aligned vertically.


A pyramid with N=4 steps

Snuke wrote a permutation of (1, 2, ..., 2N-1) into the blocks of step N.
Then, he wrote integers into all remaining blocks, under the following rule:

The integer written into a block b must be equal to the median of the three integers written into the three blocks directly under b, or to the lower left or lower right of b.



Writing integers into the blocks

Afterwards, he erased all integers written into the blocks.
Now, he only remembers that the integer written into the block of step 1 was x.
Construct a permutation of (1, 2, ..., 2N-1) that could have been written into the blocks of step N, or declare that Snuke's memory is incorrect and such a permutation does not exist.




Constraints
2≤N≤10^5
1≤x≤2N-1







InputThe input is given from Standard Input in the following format:
N x





OutputIf no permutation of (1, 2, ..., 2N-1) could have been written into the blocks of step N, print No.
Otherwise, print Yes in the first line, then print 2N-1 lines in addition.
The i-th of these 2N-1 lines should contain the i-th element of a possible permutation.






Sample Input 14 4





Sample Output 1Yes
1
6
3
7
4
5
2

This case corresponds to the figure in the problem statement.





Sample Input 22 1





Sample Output 2No

No matter what permutation was written into the blocks of step N, the integer written into the block of step 1 would be 2.

",Median Pyramid Easy,"Mathematics, Permutation Cycle Decomposition, Arithmetic, Constructive, Boolean Operations On Geometric Objects",0.115,92,15
957,"
Score : 400 points


Problem StatementOn a planet far, far away, M languages are spoken. They are conveniently numbered 1 through M.
For CODE FESTIVAL 20XX held on this planet, N participants gathered from all over the planet.
The i-th (1≦i≦N) participant can speak K_i languages numbered L_{i,1}, L_{i,2}, ..., L_{i,{}K_i}.
Two participants A and B can communicate with each other if and only if one of the following conditions is satisfied:

There exists a language that both A and B can speak.
There exists a participant X that both A and B can communicate with.

Determine whether all N participants can communicate with all other participants.




Constraints
2≦N≦10^5
1≦M≦10^5
1≦K_i≦M
(The sum of all K_i)≦10^5
1≦L_{i,j}≦M
L_{i,1}, L_{i,2}, ..., L_{i,{}K_i} are pairwise distinct.





Partial Score
200 points will be awarded for passing the test set satisfying the following: N≦1000, M≦1000 and (The sum of all K_i)≦1000.
Additional 200 points will be awarded for passing the test set without additional constraints.







InputThe input is given from Standard Input in the following format:
N M
K_1 L_{1,1} L_{1,2} ... L_{1,{}K_1}
K_2 L_{2,1} L_{2,2} ... L_{2,{}K_2}
:
K_N L_{N,1} L_{N,2} ... L_{N,{}K_N}





OutputIf all N participants can communicate with all other participants, print YES. Otherwise, print NO.






Sample Input 14 6
3 1 2 3
2 4 2
2 4 6
1 6





Sample Output 1YES

Any two participants can communicate with each other, as follows:

Participants 1 and 2: both can speak language 2.
Participants 2 and 3: both can speak language 4.
Participants 1 and 3: both can communicate with participant 2.
Participants 3 and 4: both can speak language 6.
Participants 2 and 4: both can communicate with participant 3.
Participants 1 and 4: both can communicate with participant 2.

Note that there can be languages spoken by no participant.





Sample Input 24 4
2 1 2
2 1 2
1 3
2 4 3





Sample Output 2NO

For example, participants 1 and 3 cannot communicate with each other.

",Interpretation,"Bipartite Graph, Graph Traversal, Disjoint Set, Graph Theory",0.25,22,6
958,"
Score : 400 points


Problem StatementSnuke has a string S consisting of three kinds of letters: a, b and c.
He has a phobia for palindromes, and wants to permute the characters in S so that S will not contain a palindrome of length 2 or more as a substring. Determine whether this is possible.




Constraints
1 \leq |S| \leq 10^5
S consists of a, b and c.







InputInput is given from Standard Input in the following format:
S





OutputIf the objective is achievable, print YES; if it is unachievable, print NO.






Sample Input 1abac





Sample Output 1YES

As it stands now, S contains a palindrome aba, but we can permute the characters to get acba, for example, that does not contain a palindrome of length 2 or more.





Sample Input 2aba





Sample Output 2NO






Sample Input 3babacccabab





Sample Output 3YES


",Palindrome-phobia,"Counting, Boolean Operations On Geometric Objects, Arithmetic, Array",0.714,12,9
959,"
Score : 300 points


Problem StatementAtCoDeer the deer and his friend TopCoDeer is playing a game.
The game consists of N turns.
In each turn, each player plays one of the two gestures, Rock and Paper, as in Rock-paper-scissors, under the following condition:
(※) After each turn, (the number of times the player has played Paper)≦(the number of times the player has played Rock).
Each player's score is calculated by (the number of turns where the player wins) - (the number of turns where the player loses), where the outcome of each turn is determined by the rules of Rock-paper-scissors.
(For those who are not familiar with Rock-paper-scissors: If one player plays Rock and the other plays Paper, the latter player will win and the former player will lose. If both players play the same gesture, the round is a tie and neither player will win nor lose.)
With his supernatural power, AtCoDeer was able to foresee the gesture that TopCoDeer will play in each of the N turns, before the game starts.
Plan AtCoDeer's gesture in each turn to maximize AtCoDeer's score.
The gesture that TopCoDeer will play in each turn is given by a string s. If the i-th (1≦i≦N) character in s is g, TopCoDeer will play Rock in the i-th turn. Similarly, if the i-th (1≦i≦N) character of s in p, TopCoDeer will play Paper in the i-th turn.




Constraints
1≦N≦10^5
N=|s|
Each character in s is g or p.
The gestures represented by s satisfy the condition (※).







InputThe input is given from Standard Input in the following format:
s





OutputPrint the AtCoDeer's maximum possible score.






Sample Input 1gpg





Sample Output 10

Playing the same gesture as the opponent in each turn results in the score of 0, which is the maximum possible score.





Sample Input 2ggppgggpgg





Sample Output 22

For example, consider playing gestures in the following order: Rock, Paper, Rock, Paper, Rock, Rock, Paper, Paper, Rock, Paper. This strategy earns three victories and suffers one defeat, resulting in the score of 2, which is the maximum possible score.

",AtCoDeer and Rock-Paper,"Greedy Algorithm, String, Mathematics, Boolean Operations On Geometric Objects, Dynamic Programming",0.864,28,23
960,"
Score : 600 points


Problem StatementGiven an undirected tree, let the distance between vertices u and v be the
number of edges on the simple path from u to v.
The diameter of a tree is the maximum among the distances between any two vertices.
We will call a tree good if and only if its diameter is at most K.
You are given an undirected tree with N vertices numbered 1 through N.
For each i (1≦i≦N-1), there is an edge connecting vertices A_i and B_i.
You want to remove zero or more vertices from the tree, so that the resulting tree is good.
When a vertex is removed, all incident edges will also be removed.
The resulting graph must be connected.
Find the minimum number of vertices that you need to remove in order to produce a good tree.




Constraints
2≦N≦2000
1≦K≦N-1
1≦A_i≦N, 1≦B_i≦N
The graph defined by A_i and B_i is a tree.







InputThe input is given from Standard Input in the following format:
N K
A_1 B_1
A_2 B_2
:
A_{N-1} B_{N-1}





OutputPrint the minimum number of vertices that you need to remove in order to produce a good tree.






Sample Input 16 2
1 2
3 2
4 2
1 6
5 6





Sample Output 12

The tree is shown below. Removing vertices 5 and 6 will result in a good tree with the diameter of 2.








Sample Input 26 5
1 2
3 2
4 2
1 6
5 6





Sample Output 20

Since the given tree is already good, you do not need to remove any vertex.

",Shorten Diameter,"Graph Theory, Graph Traversal, Diameter Of A Tree, Mathematics, Enumeration, Greedy Algorithm",0.2,37,8
961,"
Score : 1400 points


Problem StatementSnuke is having another barbeque party.
This time, he will make one serving of Skewer Meal.
He has a stock of N Skewer Meal Packs. The i-th Skewer Meal Pack contains one skewer, A_i pieces of beef and B_i pieces of green pepper.
All skewers in these packs are different and distinguishable, while all pieces of beef and all pieces of green pepper are, respectively, indistinguishable.
To make a Skewer Meal, he chooses two of his Skewer Meal Packs, and takes out all of the contents from the chosen packs, that is, two skewers and some pieces of beef or green pepper.
(Remaining Skewer Meal Packs will not be used.)
Then, all those pieces of food are threaded onto both skewers, one by one, in any order.
(See the image in the Sample section for better understanding.)
In how many different ways can he make a Skewer Meal? Two ways of making a Skewer Meal is different if and only if the sets of the used skewers are different, or the orders of the pieces of food are different.
Since this number can be extremely large, find it modulo 10^9+7.




Constraints
2≦N≦200,000
1≦A_i≦2000, 1≦B_i≦2000







InputThe input is given from Standard Input in the following format:
N
A_1 B_1
A_2 B_2
:
A_N B_N





OutputPrint the number of the different ways Snuke can make a serving of Skewer Meal, modulo 10^9+7.






Sample Input 13
1 1
1 1
2 1





Sample Output 126

The 26 ways of making a Skewer Meal are shown below.
Gray bars represent skewers, each with a number denoting the Skewer Meal Set that contained the skewer.
Brown and green rectangles represent pieces of beef and green pepper, respectively.




",BBQ Hard,"Arithmetic, Combinatorics, Prefix sum, Counting, Dyanmic Programming, Modular Multiplicative Inverse",0.333,17,3
962,"
Score : 1000 points


Problem StatementSnuke got a present from his mother on his birthday.
The present was a pair of two sequences a and b, consisting of positive integers.
They satisfied all of the following properties:

The sum of all elements of a is N.
The sum of all elements of b is N.
Any string of length N that satisfies the following two conditions (1) and (2) will also satisfy the condition (3).

(1) Any of the following forms a palindrome: the first a_1 letters, the following a_2 letters, the following a_3 letters and so on.
(2) Any of the following forms a palindrome: the first b_1 letters, the following b_2 letters, the following b_3 letters and so on.
(3) All N letters are the same.


He was happy, until one day he lost both of the sequences.
Now, he only remembers that the sequence a was a permutation of another sequence A of length M.
To bring him happiness again, his mother has decided to give him another pair of sequences a and b that satisfies his favorite properties and is consistent with his memory.




Constraints
1≦N≦10^5
1≦M≦100
1≦A_i≦10^5
The sum of all A_i equals N.







InputThe input is given from Standard Input in the following format:
N M
A_1 A_2 ... A_M





OutputIf there exists a pair of sequences a and b that satisfies the properties and is consistent with Snuke's memory, print three lines. The first line must contain the sequence a, the second line must contain the length of the sequence b, and the third line must contain the sequence b.
If such a pair does not exist (because Snuke's memory is wrong or some other reason), print a single line containing the word Impossible (case-sensitive).






Sample Input 13 2
2 1





Sample Output 11 2
1
3






Sample Input 26 1
6





Sample Output 26
3
1 2 3






Sample Input 355 10
1 2 3 4 5 6 7 8 9 10





Sample Output 3Impossible


",Arrays and Palindrome,"Parity, Permutation Cycle Decomposition, Greedy Algorithm, Constructive, Boolean Operations On Geometric Objects",0.4,12,5
963,"


Problem StatementWe have N pieces of ropes, numbered 1 through N. The length of piece i is a_i.
At first, for each i (1≤i≤N-1), piece i and piece i+1 are tied at the ends, forming one long rope with N-1 knots. Snuke will try to untie all of the knots by performing the following operation repeatedly:

Choose a (connected) rope with a total length of at least L, then untie one of its knots.

Is it possible to untie all of the N-1 knots by properly applying this operation? If the answer is positive, find one possible order to untie the knots.




Constraints
2≤N≤10^5
1≤L≤10^9
1≤a_i≤10^9
All input values are integers.







InputThe input is given from Standard Input in the following format:
N L
a_1 a_2 ... a_n





OutputIf it is not possible to untie all of the N-1 knots, print Impossible.
If it is possible to untie all of the knots, print Possible, then print another N-1 lines that describe a possible order to untie the knots. The j-th of those N-1 lines should contain the index of the knot that is untied in the j-th operation. Here, the index of the knot connecting piece i and piece i+1 is i.
If there is more than one solution, output any.






Sample Input 13 50
30 20 10





Sample Output 1Possible
2
1

If the knot 1 is untied first, the knot 2 will become impossible to untie.





Sample Input 22 21
10 10





Sample Output 2Impossible






Sample Input 35 50
10 20 30 40 50





Sample Output 3Possible
1
2
3
4

Another example of a possible solution is 3, 4, 1, 2.

",Knot Puzzle,"Greedy Algorithm, Constructive",0.182,70,22
964,"
Score : 1100 points


Problem StatementSnuke got positive integers s_1,...,s_N from his mother, as a birthday present. There may be duplicate elements.
He will circle some of these N integers. Since he dislikes cubic numbers, he wants to ensure that if both s_i and s_j (i ≠ j) are circled, the product s_is_j is not cubic. For example, when s_1=1,s_2=1,s_3=2,s_4=4, it is not possible to circle both s_1 and s_2 at the same time. It is not possible to circle both s_3 and s_4 at the same time, either.
Find the maximum number of integers that Snuke can circle.




Constraints
1 ≦ N ≦ 10^5
1 ≦ s_i ≦ 10^{10}
All input values are integers.







InputThe input is given from Standard Input in the following format:
N
s_1
:
s_N





OutputPrint the maximum number of integers that Snuke can circle.






Sample Input 18
1
2
3
4
5
6
7
8





Sample Output 16

Snuke can circle 1,2,3,5,6,7.





Sample Input 26
2
4
8
16
32
64





Sample Output 23






Sample Input 310
1
10
100
1000000007
10000000000
1000000009
999999999
999
999
999





Sample Output 39


",Anticube,"Prime Factorization, Arithmetic, Hashing, Bitmask, Greedy Algorithm, Set / Map",0.0,75,6
965,"
Score : 200 points


Problem StatementWe have a rectangular parallelepiped of size A×B×C, built with blocks of size 1×1×1. Snuke will paint each of the A×B×C blocks either red or blue, so that:

There is at least one red block and at least one blue block.
The union of all red blocks forms a rectangular parallelepiped.
The union of all blue blocks forms a rectangular parallelepiped.

Snuke wants to minimize the difference between the number of red blocks and the number of blue blocks. Find the minimum possible difference.




Constraints
2≤A,B,C≤10^9







InputThe input is given from Standard Input in the following format:
A B C





OutputPrint the minimum possible difference between the number of red blocks and the number of blue blocks.






Sample Input 13 3 3





Sample Output 19

For example, Snuke can paint the blocks as shown in the diagram below.
There are 9 red blocks and 18 blue blocks, thus the difference is 9.






Sample Input 22 2 4





Sample Output 20

For example, Snuke can paint the blocks as shown in the diagram below.
There are 8 red blocks and 8 blue blocks, thus the difference is 0.






Sample Input 35 3 5





Sample Output 315

For example, Snuke can paint the blocks as shown in the diagram below.
There are 45 red blocks and 30 blue blocks, thus the difference is 9.


",Divide a Cuboid,"Parity, Arithmetic, Mathematics, Boolean Operations On Geometric Objects, Implementation",0.321,146,51
966,"
Score : 800 points


Problem StatementThere are N towns in Snuke Kingdom, conveniently numbered 1 through N.
Town 1 is the capital.
Each town in the kingdom has a Teleporter, a facility that instantly transports a person to another place.
The destination of the Teleporter of town i is town a_i (1≤a_i≤N).
It is guaranteed that one can get to the capital from any town by using the Teleporters some number of times.
King Snuke loves the integer K.
The selfish king wants to change the destination of the Teleporters so that the following holds:

Starting from any town, one will be at the capital after using the Teleporters exactly K times in total.

Find the minimum number of the Teleporters whose destinations need to be changed in order to satisfy the king's desire.




Constraints
2≤N≤10^5
1≤a_i≤N
One can get to the capital from any town by using the Teleporters some number of times.
1≤K≤10^9







InputThe input is given from Standard Input in the following format:
N K
a_1 a_2 ... a_N





OutputPrint the minimum number of the Teleporters whose destinations need to be changed in order to satisfy King Snuke's desire.






Sample Input 13 1
2 3 1





Sample Output 12

Change the destinations of the Teleporters to a = (1,1,1).





Sample Input 24 2
1 1 2 2





Sample Output 20

There is no need to change the destinations of the Teleporters, since the king's desire is already satisfied.





Sample Input 38 2
4 1 2 3 1 2 3 4





Sample Output 33

For example, change the destinations of the Teleporters to a = (1,1,2,1,1,2,2,4).

",Teleporter,"Graph Theory, Tree, Depth-first Search, Mathematics, Recursion, Counting",0.0,43,4
967,"
Score : 700 points


Problem StatementAoki loves numerical sequences and trees.
One day, Takahashi gave him an integer sequence of length N, a_1, a_2, ..., a_N, which made him want to construct a tree.
Aoki wants to construct a tree with N vertices numbered 1 through N, such that for each i = 1,2,...,N, the distance between vertex i and the farthest vertex from it is a_i, assuming that the length of each edge is 1.
Determine whether such a tree exists.




Constraints
2 ≦ N ≦ 100
1 ≦ a_i ≦ N-1







InputThe input is given from Standard Input in the following format:
N
a_1 a_2 ... a_N





OutputIf there exists a tree that satisfies the condition, print Possible. Otherwise, print Impossible.






Sample Input 15
3 2 2 3 3





Sample Output 1Possible


The diagram above shows an example of a tree that satisfies the conditions. The red arrows show paths from each vertex to the farthest vertex from it.





Sample Input 23
1 1 2





Sample Output 2Impossible






Sample Input 310
1 2 2 2 2 2 2 2 2 2





Sample Output 3Possible






Sample Input 410
1 1 2 2 2 2 2 2 2 2





Sample Output 4Impossible






Sample Input 56
1 1 1 1 1 5





Sample Output 5Impossible






Sample Input 65
4 3 2 3 4





Sample Output 6Possible


",Tree Restoring,"Sorting, Counting, Diameter Of A Tree, Mathematics, Parity, Array",0.538,21,11
968,"
Score : 200 points


Problem Statement
We have a grid of H rows and W columns. Initially, there is a stone in the top left cell. Shik is trying to move the stone to the bottom right cell. In each step, he can move the stone one cell to its left, up, right, or down (if such cell exists). It is possible that the stone visits a cell multiple times (including the bottom right and the top left cell).
You are given a matrix of characters a_{ij} (1 \leq i \leq H, 1 \leq j \leq W). After Shik completes all moving actions, a_{ij} is # if the stone had ever located at the i-th row and the j-th column during the process of moving. Otherwise, a_{ij} is .. Please determine whether it is possible that Shik only uses right and down moves in all steps.




Constraints
2 \leq H, W \leq 8
a_{i,j} is either # or ..
There exists a valid sequence of moves for Shik to generate the map a.







InputThe input is given from Standard Input in the following format:
H W
a_{11}a_{12}...a_{1W}
:
a_{H1}a_{H2}...a_{HW}





OutputIf it is possible that Shik only uses right and down moves, print Possible. Otherwise, print Impossible.






Sample Input 14 5
##...
.##..
..##.
...##





Sample Output 1Possible

The matrix can be generated by a 7-move sequence: right, down, right, down, right, down, and right.





Sample Input 25 3
###
..#
###
#..
###





Sample Output 2Impossible






Sample Input 34 5
##...
.###.
.###.
...##





Sample Output 3Impossible


",Shik and Stone,"Depth-first Search, Greedy Algorithm, Grid Graph, Graph Theory",0.558,83,41
969,"
Score : 800 points


Problem StatementN contestants participated in a competition. The total of N-1 matches were played in a knockout tournament.
For some reasons, the tournament may not be ""fair"" for all the contestants.
That is, the number of the matches that must be played in order to win the championship may be different for each contestant. The structure of the tournament is formally described at the end of this statement.
After each match, there were always one winner and one loser. The last contestant standing was declared the champion.


Figure: an example of a tournament

For convenience, the contestants were numbered 1 through N. The contestant numbered 1 was the champion, and the contestant numbered i(2 ≦ i ≦ N) was defeated in a match against the contestant numbered a_i.
We will define the depth of the tournament as the maximum number of the matches that must be played in order to win the championship over all the contestants.
Find the minimum possible depth of the tournament.
The formal description of the structure of the tournament is as follows. In the i-th match, one of the following played against each other:

Two predetermined contestants
One predetermined contestant and the winner of the j-th match, where j(j<i) was predetermined
The winner of the j-th match and the winner of the k-th match, where j and k (j,k<i, j ≠ k) were predetermined

Such structure is valid structure of the tournament, if and only if no contestant who has already been defeated in a match will never play in a match, regardless of the outcome of the matches.




Constraints
2 ≦ N ≦ 10^5
1 ≦ a_i ≦ N(2 ≦ i ≦ N)
It is guaranteed that the input is consistent (that is, there exists at least one tournament that matches the given information).







InputThe input is given from Standard Input in the following format:
N
a_2
:
a_N





OutputPrint the minimum possible depth of the tournament.






Sample Input 15
1
1
2
4





Sample Output 13

The following tournament and the result of the matches are consistent with the given information:

In the first match, contestants 4 and 5 played against each other, and contestant 4 won.
In the second match, contestants 2 and 4 played against each other, and contestant 2 won.
In the third match, contestants 1 and 3 played against each other, and contestant 1 won.
In the fourth match, contestants 1 and 2 played against each other, and contestant 1 won.




The depth of this tournament is 3, since contestant 5 must play three matches in order to win the championship.
There is no tournament with depth 2 or less that is consistent with the given information, thus the output should be 3.





Sample Input 27
1
2
1
3
1
4





Sample Output 23






Sample Input 34
4
4
1





Sample Output 33


",Tournament,"Tree, Depth-first Search, Recursion, Sorting, Dynamic Programming On Trees, Greedy Algorithm",0.318,64,10
970,"
Score : 300 points


Problem StatementYou are given an integer N.
Find the number of the positive divisors of N!, modulo 10^9+7.




Constraints
1≤N≤10^3







InputThe input is given from Standard Input in the following format:
N





OutputPrint the number of the positive divisors of N!, modulo 10^9+7.






Sample Input 13





Sample Output 14

There are four divisors of 3! =6: 1, 2, 3 and 6. Thus, the output should be 4.





Sample Input 26





Sample Output 230






Sample Input 31000





Sample Output 3972926972


",Factors of Factorial,"Sieve Of Eratosthenes, Number Theory, Arithmetic, Bruteforcing",0.759,34,26
971,"
Score : 500 points


Problem StatementThis is an interactive task.
Let N be an odd number at least 3.
There are N seats arranged in a circle.
The seats are numbered 0 through N-1.
For each i (0 ≤ i ≤ N - 2), Seat i and Seat i + 1 are adjacent.
Also, Seat N - 1 and Seat 0 are adjacent.
Each seat is either vacant, or oppupied by a man or a woman.
However, no two adjacent seats are occupied by two people of the same sex.
It can be shown that there is at least one empty seat where N is an odd number at least 3.
You are given N, but the states of the seats are not given.
Your objective is to correctly guess the ID number of any one of the empty seats.
To do so, you can repeatedly send the following query:

Choose an integer i (0 ≤ i ≤ N - 1). If Seat i is empty, the problem is solved. Otherwise, you are notified of the sex of the person in Seat i.

Guess the ID number of an empty seat by sending at most 20 queries.




Constraints
N is an odd number.
3 ≤ N ≤ 99 999





Input and OutputFirst, N is given from Standard Input in the following format:
N

Then, you should send queries.
A query should be printed to Standart Output in the following format.
Print a newline at the end.
i

The response to the query is given from Standard Input in the following format:
s

Here, s is Vacant, Male or Female.
Each of these means that Seat i is empty, occupied by a man and occupied by a woman, respectively.




Notice
Flush Standard Output each time you print something. Failure to do so may result in TLE.
Immediately terminate the program when s is Vacant. Otherwise, the verdict is indeterminate.
The verdict is indeterminate if more than 20 queries or ill-formatted queries are sent.






Sample Input / Output 1
In this sample, N = 3, and Seat 0, 1, 2 are occupied by a man, occupied by a woman and vacant, respectively.


InputOutput


3
0
Male
1
Female
2
Vacant




",Vacant Seat,"Binary Search, Parity, Interactive, Boolean Operations On Geometric Objects",0.318,66,17
972,"
Score : 300 points


Problem StatementAtCoDeer the deer and his friend TopCoDeer is playing a game.
The game consists of N turns.
In each turn, each player plays one of the two gestures, Rock and Paper, as in Rock-paper-scissors, under the following condition:
(※) After each turn, (the number of times the player has played Paper)≦(the number of times the player has played Rock).
Each player's score is calculated by (the number of turns where the player wins) - (the number of turns where the player loses), where the outcome of each turn is determined by the rules of Rock-paper-scissors.
(For those who are not familiar with Rock-paper-scissors: If one player plays Rock and the other plays Paper, the latter player will win and the former player will lose. If both players play the same gesture, the round is a tie and neither player will win nor lose.)
With his supernatural power, AtCoDeer was able to foresee the gesture that TopCoDeer will play in each of the N turns, before the game starts.
Plan AtCoDeer's gesture in each turn to maximize AtCoDeer's score.
The gesture that TopCoDeer will play in each turn is given by a string s. If the i-th (1≦i≦N) character in s is g, TopCoDeer will play Rock in the i-th turn. Similarly, if the i-th (1≦i≦N) character of s in p, TopCoDeer will play Paper in the i-th turn.




Constraints
1≦N≦10^5
N=|s|
Each character in s is g or p.
The gestures represented by s satisfy the condition (※).







InputThe input is given from Standard Input in the following format:
s





OutputPrint the AtCoDeer's maximum possible score.






Sample Input 1gpg





Sample Output 10

Playing the same gesture as the opponent in each turn results in the score of 0, which is the maximum possible score.





Sample Input 2ggppgggpgg





Sample Output 22

For example, consider playing gestures in the following order: Rock, Paper, Rock, Paper, Rock, Rock, Paper, Paper, Rock, Paper. This strategy earns three victories and suffers one defeat, resulting in the score of 2, which is the maximum possible score.

",AtCoDeer and Rock-Paper,"Counting, Arithmetic, Greedy Algorithm, String",0.846,48,42
973,"
Score : 700 points


Problem StatementSnuke and Ciel went to a strange stationery store. Each of them got a transparent graph paper with H rows and W columns.
Snuke painted some of the cells red in his paper. Here, the cells painted red were 4-connected, that is, it was possible to traverse from any red cell to any other red cell, by moving to vertically or horizontally adjacent red cells only.
Ciel painted some of the cells blue in her paper. Here, the cells painted blue were 4-connected.
Afterwards, they precisely overlaid the two sheets in the same direction. Then, the intersection of the red cells and the blue cells appeared purple.
You are given a matrix of letters a_{ij} (1≤i≤H, 1≤j≤W) that describes the positions of the purple cells. If the cell at the i-th row and j-th column is purple, then a_{ij} is #, otherwise a_{ij} is .. Here, it is guaranteed that no outermost cell is purple. That is, if i=1, H or j = 1, W, then a_{ij} is ..
Find a pair of the set of the positions of the red cells and the blue cells that is consistent with the situation described. It can be shown that a solution always exists.




Constraints
3≤H,W≤500
a_{ij} is # or ..
If i=1,H or j=1,W, then a_{ij} is ..
At least one of a_{ij} is #.







InputThe input is given from Standard Input in the following format:
H W
a_{11}...a_{1W}
:
a_{H1}...a_{HW}





OutputPrint a pair of the set of the positions of the red cells and the blue cells that is consistent with the situation, as follows:

The first H lines should describe the positions of the red cells.
The following 1 line should be empty.
The following H lines should describe the positions of the blue cells.

The description of the positions of the red or blue cells should follow the format of the description of the positions of the purple cells.






Sample Input 15 5
.....
.#.#.
.....
.#.#.
.....





Sample Output 1.....
#####
#....
#####
.....

.###.
.#.#.
.#.#.
.#.#.
.....

One possible pair of the set of the positions of the red cells and the blue cells is as follows:






Sample Input 27 13
.............
.###.###.###.
.#.#.#...#...
.###.#...#...
.#.#.#.#.#...
.#.#.###.###.
.............





Sample Output 2.............
.###########.
.###.###.###.
.###.###.###.
.###.###.###.
.###.###.###.
.............

.............
.###.###.###.
.#.#.#...#...
.###.#...#...
.#.#.#.#.#...
.#.#########.
.............

One possible pair of the set of the positions of the red cells and the blue cells is as follows:


",AND Grid,"Graph Theory, Constructive, Matrix, Set / Map, Dynamic Programming, Game Theory",0.667,10,6
974,"
Score : 600 points


Problem StatementThere is a tree with N vertices numbered 1 to N.
The i-th edge in this tree connects Vertex a_i and Vertex b_i, and the color and length of that edge are c_i and d_i, respectively.
Here the color of each edge is represented by an integer between 1 and N-1 (inclusive). The same integer corresponds to the same color, and different integers correspond to different colors.
Answer the following Q queries:

Query j (1 \leq j \leq Q): assuming that the length of every edge whose color is x_j is changed to y_j, find the distance between Vertex u_j and Vertex v_j. (The changes of the lengths of edges do not affect the subsequent queries.)





Constraints
2 \leq N \leq 10^5
1 \leq Q \leq 10^5
1 \leq a_i, b_i \leq N
1 \leq c_i \leq N-1
1 \leq d_i \leq 10^4
1 \leq x_j \leq N-1
1 \leq y_j \leq 10^4
1 \leq u_j < v_j \leq N
The given graph is a tree.
All values in input are integers.







InputInput is given from Standard Input in the following format:
N Q
a_1 b_1 c_1 d_1
:
a_{N-1} b_{N-1} c_{N-1} d_{N-1}
x_1 y_1 u_1 v_1
:
x_Q y_Q u_Q v_Q





OutputPrint Q lines. The j-th line (1 \leq j \leq Q) should contain the answer to Query j.






Sample Input 15 3
1 2 1 10
1 3 2 20
2 4 4 30
5 2 1 40
1 100 1 4
1 100 1 5
3 1000 3 4





Sample Output 1130
200
60

The graph in this input is as follows:

Here the edges of Color 1 are shown as solid red lines, the edge of Color 2 is shown as a bold green line, and the edge of Color 4 is shown as a blue dashed line.

Query 1: Assuming that the length of every edge whose color is 1 is changed to 100, the distance between Vertex 1 and Vertex 4 is 100 + 30 = 130.
Query 2: Assuming that the length of every edge whose color is 1 is changed to 100, the distance between Vertex 1 and Vertex 5 is 100 + 100 = 200.
Query 3: Assuming that the length of every edge whose color is 3 is changed to 1000 (there is no such edge), the distance between Vertex 3 and Vertex 4 is 20 + 10 + 30 = 60. Note that the edges of Color 1 now have their original lengths.


",Colorful Tree,"Graph Theory, Depth-first Search, Tree, Counting, Offline Queries, Binary Indexed Tree",0.5,24,6
975,"
Score : 1000 points


Problem StatementHow many infinite sequences a_1, a_2, ... consisting of {{1, ... ,n}} satisfy the following conditions?

The n-th and subsequent elements are all equal. That is, if n \leq i,j, a_i = a_j.
For every integer i, the a_i elements immediately following the i-th element are all equal. That is, if i < j < k\leq i+a_i, a_j = a_k.

Find the count modulo 10^9+7.




Constraints
1 \leq n \leq 10^6







InputInput is given from Standard Input in the following format:
n





OutputPrint how many sequences satisfy the conditions, modulo 10^9+7.






Sample Input 12





Sample Output 14

The four sequences that satisfy the conditions are:

1, 1, 1, ...
1, 2, 2, ...
2, 1, 1, ...
2, 2, 2, ...






Sample Input 2654321





Sample Output 2968545283


",Infinite Sequence,"Dyanmic Programming, Mathematics, Prefix sum, Arithmetic, Array",0.667,3,2
976,"
Score : 500 points


Problem StatementYou are given a string S consisting of 0 and 1.
Find the maximum integer K not greater than |S| such that we can turn all the characters of S into 0 by repeating the following operation some number of times.

Choose a contiguous segment [l,r] in S whose length is at least K (that is, r-l+1\geq K must be satisfied). For each integer i such that l\leq i\leq r, do the following: if S_i is 0, replace it with 1; if S_i is 1, replace it with 0.





Constraints
1\leq |S|\leq 10^5
S_i(1\leq i\leq N) is either 0 or 1.







InputInput is given from Standard Input in the following format:
S





OutputPrint the maximum integer K such that we can turn all the characters of S into 0 by repeating the operation some number of times.






Sample Input 1010





Sample Output 12

We can turn all the characters of S into 0 by the following operations:

Perform the operation on the segment S[1,3] with length 3. S is now 101.
Perform the operation on the segment S[1,2] with length 2. S is now 011.
Perform the operation on the segment S[2,3] with length 2. S is now 000.






Sample Input 2100000000





Sample Output 28






Sample Input 300001111





Sample Output 34


",Wide Flip,"Binary Search, String, Greedy Algorithm, Two-pointer, Array",0.1,23,8
977,"
Score : 500 points


Problem StatementYou are given two integer sequences S and T of length N and M, respectively, both consisting of integers between 1 and 10^5 (inclusive).
In how many pairs of a subsequence of S and a subsequence of T do the two subsequences are the same in content?
Here the subsequence of A is a sequence obtained by removing zero or more elements from A and concatenating the remaining elements without changing the order.
For both S and T, we distinguish two subsequences if the sets of the indices of the removed elements are different, even if the subsequences are the same in content.
Since the answer can be tremendous, print the number modulo 10^9+7.




Constraints
1 \leq N, M \leq 2 \times 10^3
The length of S is N.
The length of T is M.     
1 \leq S_i, T_i \leq 10^5
All values in input are integers.







InputInput is given from Standard Input in the following format:
N M
S_1 S_2 ... S_{N-1} S_{N}
T_1 T_2 ... T_{M-1} T_{M}





OutputPrint the number of pairs of a subsequence of S and a subsequence of T such that the subsequences are the same in content, modulo 10^9+7.






Sample Input 12 2
1 3
3 1





Sample Output 13

S has four subsequences: (), (1), (3), (1, 3).
T has four subsequences: (), (3), (1), (3, 1).
There are 1 \times 1 pair of subsequences in which the subsequences are both (), 1 \times 1 pair of subsequences in which the subsequences are both (1), and 1 \times 1 pair of subsequences in which the subsequences are both (3), for a total of three pairs.





Sample Input 22 2
1 1
1 1





Sample Output 26

S has four subsequences: (), (1), (1), (1, 1).
T has four subsequences: (), (1), (1), (1, 1).
There are 1 \times 1 pair of subsequences in which the subsequences are both (), 2 \times 2 pairs of subsequences in which the subsequences are both (1), and 1 \times 1 pair of subsequences in which the subsequences are both (1,1), for a total of six pairs.
Note again that we distinguish two subsequences if the sets of the indices of the removed elements are different, even if the subsequences are the same in content.





Sample Input 34 4
3 4 5 6
3 4 5 6





Sample Output 316






Sample Input 410 9
9 6 5 7 5 9 8 5 6 7
8 6 8 5 5 7 9 9 7





Sample Output 4191






Sample Input 520 20
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1





Sample Output 5846527861

Be sure to print the number modulo 10^9+7.

",Common Subsequence,"Dyanmic Programming, Inclusion And Exclusion, Arithmetic, Bruteforcing",0.353,45,13
978,"
Score : 500 points


Problem StatementThere are N towns on a line running east-west.
The towns are numbered 1 through N, in order from west to east.
Each point on the line has a one-dimensional coordinate, and a point that is farther east has a greater coordinate value.
The coordinate of town i is X_i.
You are now at town 1, and you want to visit all the other towns.
You have two ways to travel:


Walk on the line.
Your fatigue level increases by A each time you travel a distance of 1, regardless of direction.


Teleport to any location of your choice.
Your fatigue level increases by B, regardless of the distance covered.


Find the minimum possible total increase of your fatigue level when you visit all the towns in these two ways.




Constraints
All input values are integers.
2≤N≤10^5
1≤X_i≤10^9
For all i(1≤i≤N-1), X_i<X_{i+1}.
1≤A≤10^9
1≤B≤10^9







InputThe input is given from Standard Input in the following format:
N A B
X_1 X_2 ... X_N





OutputPrint the minimum possible total increase of your fatigue level when you visit all the towns.






Sample Input 14 2 5
1 2 5 7





Sample Output 111

From town 1, walk a distance of 1 to town 2, then teleport to town 3, then walk a distance of 2 to town 4.
The total increase of your fatigue level in this case is 2×1+5+2×2=11, which is the minimum possible value.





Sample Input 27 1 100
40 43 45 105 108 115 124





Sample Output 284

From town 1, walk all the way to town 7.
The total increase of your fatigue level in this case is 84, which is the minimum possible value.





Sample Input 37 1 2
24 35 40 68 72 99 103





Sample Output 312

Visit all the towns in any order by teleporting six times.
The total increase of your fatigue level in this case is 12, which is the minimum possible value.

",Walk and Teleport,"Greedy Algorithm, Bruteforcing, Arithmetic, Array",0.432,76,35
979,"
Score : 500 points


Problem StatementSnuke, who loves animals, built a zoo.
There are N animals in this zoo. They are conveniently numbered 1 through N, and arranged in a circle.
The animal numbered i (2≤i≤N-1) is adjacent to the animals numbered i-1 and i+1. Also, the animal numbered 1 is adjacent to the animals numbered 2 and N, and the animal numbered N is adjacent to the animals numbered N-1 and 1.
There are two kinds of animals in this zoo: honest sheep that only speak the truth, and lying wolves that only tell lies.
Snuke cannot tell the difference between these two species, and asked each animal the following question: ""Are your neighbors of the same species?"" The animal numbered i answered s_i. Here, if s_i is o, the animal said that the two neighboring animals are of the same species, and if s_i is x, the animal said that the two neighboring animals are of different species.
More formally, a sheep answered o if the two neighboring animals are both sheep or both wolves, and answered x otherwise.
Similarly, a wolf answered x if the two neighboring animals are both sheep or both wolves, and answered o otherwise.
Snuke is wondering whether there is a valid assignment of species to the animals that is consistent with these responses. If there is such an assignment, show one such assignment. Otherwise, print -1.




Constraints
3 ≤ N ≤ 10^{5}
s is a string of length N consisting of o and x.







InputThe input is given from Standard Input in the following format:
N
s





OutputIf there does not exist an valid assignment that is consistent with s, print -1.
Otherwise, print an string t in the following format. The output is considered correct if the assignment described by t is consistent with s.

t is a string of length N consisting of S and W.
If t_i is S, it indicates that the animal numbered i is a sheep. If t_i is W, it indicates that the animal numbered i is a wolf.







Sample Input 16
ooxoox





Sample Output 1SSSWWS

For example, if the animals numbered 1, 2, 3, 4, 5 and 6 are respectively a sheep, sheep, sheep, wolf, wolf, and sheep, it is consistent with their responses. Besides, there is another valid assignment of species: a wolf, sheep, wolf, sheep, wolf and wolf.
Let us remind you: if the neiboring animals are of the same species, a sheep answers o and a wolf answers x. If the neiboring animals are of different species, a sheep answers x and a wolf answers o.








Sample Input 23
oox





Sample Output 2-1

Print -1 if there is no valid assignment of species.





Sample Input 310
oxooxoxoox





Sample Output 3SSWWSSSWWS


",Menagerie,"Backtracking, Bruteforcing, Game Theory, Arithmetic, Simulation, 2-sat",0.2,69,24
980,"
Score : 600 points


Problem StatementSnuke has an integer sequence, a, of length N. The i-th element of a (1-indexed) is a_{i}.
He can perform the following operation any number of times:

Operation: Choose integers x and y between 1 and N (inclusive), and add a_x to a_y.

He would like to perform this operation between 0 and 2N times (inclusive) so that a satisfies the condition below. Show one such sequence of operations.
It can be proved that such a sequence of operations always exists under the constraints in this problem.

Condition: a_1 \leq a_2 \leq ...  \leq a_{N}





Constraints
2 \leq N \leq 50
-10^{6} \leq a_i \leq 10^{6}
All input values are integers.







InputInput is given from Standard Input in the following format:
N
a_1 a_2 ... a_{N}





OutputLet m be the number of operations in your solution. In the first line, print m.
In the i-th of the subsequent m lines, print the numbers x and y chosen in the i-th operation, with a space in between.
The output will be considered correct if m is between 0 and 2N (inclusive) and a satisfies the condition after the m operations.






Sample Input 13
-2 5 -1





Sample Output 12
2 3
3 3


After the first operation, a = (-2,5,4).
After the second operation, a = (-2,5,8), and the condition is now satisfied.






Sample Input 22
-1 -3





Sample Output 21
2 1


After the first operation, a = (-4,-3) and the condition is now satisfied.






Sample Input 35
0 0 0 0 0





Sample Output 30


The condition is satisfied already in the beginning.


",Non-decreasing,"Array, Greedy Algorithm,  Dynamic Programming, Constructive, Bruteforcing",0.389,45,14
981,"
Score : 600 points


Problem StatementWe have one slime.
You can set the health of this slime to any integer value of your choice.
A slime reproduces every second by spawning another slime that has strictly less health. You can freely choose the health of each new slime. The first reproduction of our slime will happen in one second.
Determine if it is possible to set the healths of our first slime and the subsequent slimes spawn so that the multiset of the healths of the 2^N slimes that will exist in N seconds equals a multiset S.
Here S is a multiset containing 2^N (possibly duplicated) integers: S_1,~S_2,~...,~S_{2^N}.




Constraints
All values in input are integers.
1 \leq N \leq 18
1 \leq S_i \leq 10^9







InputInput is given from Standard Input in the following format:
N
S_1 S_2 ... S_{2^N}





OutputIf it is possible to set the healths of the first slime and the subsequent slimes spawn so that the multiset of the healths of the 2^N slimes that will exist in N seconds equals S, print Yes; otherwise, print No.






Sample Input 12
4 2 3 1





Sample Output 1Yes

We will show one way to make the multiset of the healths of the slimes that will exist in 2 seconds equal to S.
First, set the health of the first slime to 4.
By letting the first slime spawn a slime whose health is 3, the healths of the slimes that exist in 1 second can be 4,~3.
Then, by letting the first slime spawn a slime whose health is 2, and letting the second slime spawn a slime whose health is 1, the healths of the slimes that exist in 2 seconds can be 4,~3,~2,~1, which is equal to S as multisets.





Sample Input 22
1 2 3 1





Sample Output 2Yes

S may contain multiple instances of the same integer.





Sample Input 31
1 1





Sample Output 3No






Sample Input 45
4 3 5 3 1 2 7 8 7 4 6 3 7 2 3 6 2 7 3 2 6 7 3 4 6 7 3 4 2 5 2 3





Sample Output 4No


",Many Slimes,"Binary Search Tree, Greedy Algorithm, Simulation, Sorting, Set / Map, Segment Tree",0.25,59,14
982,"
Score : 700 points


Problem StatementFind the smallest possible sum of the digits in the decimal notation of a positive multiple of K.




Constraints
2 \leq K \leq 10^5
K is an integer.







InputInput is given from Standard Input in the following format:
K





OutputPrint the smallest possible sum of the digits in the decimal notation of a positive multiple of K.






Sample Input 16





Sample Output 13

12=6×2 yields the smallest sum.





Sample Input 241





Sample Output 25

11111=41×271 yields the smallest sum.





Sample Input 379992





Sample Output 336


",Small Multiple,"Graph Theory, Breadth-first Search, Dijkstra's, Arithmetic, Deque, Dyanmic Programming",0.15,58,5
983,"
Score : 700 points


Problem StatementTakahashi is playing with N cards.
The i-th card has an integer X_i on it.
Takahashi is trying to create as many pairs of cards as possible satisfying one of the following conditions:

The integers on the two cards are the same.
The sum of the integers on the two cards is a multiple of M.

Find the maximum number of pairs that can be created.
Note that a card cannot be used in more than one pair.




Constraints
2≦N≦10^5
1≦M≦10^5
1≦X_i≦10^5







InputThe input is given from Standard Input in the following format:
N M
X_1 X_2 ... X_N





OutputPrint the maximum number of pairs that can be created.






Sample Input 17 5
3 1 4 1 5 9 2





Sample Output 13

Three pairs (3,2), (1,4) and (1,9) can be created.
It is possible to create pairs (3,2) and (1,1), but the number of pairs is not maximized with this.





Sample Input 215 10
1 5 6 10 11 11 11 20 21 25 25 26 99 99 99





Sample Output 26


",Pair Cards,"Counting, Arithmetic, Number Theory, Greedy Algorithm, Bitmask, Set / Map",0.545,20,9
984,"
Score : 1000 points


Problem StatementRng is baking cookies.
Initially, he can bake one cookie per second.
He can also eat the cookies baked by himself.
When there are x cookies not yet eaten, he can choose to eat all those cookies. After he finishes eating those cookies, the number of cookies he can bake per second becomes x. Note that a cookie always needs to be baked for 1 second, that is, he cannot bake a cookie in 1/x seconds when x > 1.
When he choose to eat the cookies, he must eat all of them; he cannot choose to eat only part of them.
It takes him A seconds to eat the cookies regardless of how many, during which no cookies can be baked.
He wants to give N cookies to Grandma.
Find the shortest time needed to produce at least N cookies not yet eaten.




Constraints
1≦N≦10^{12}
0≦A≦10^{12}
A is an integer.





Partial Score
500 points will be awarded for passing the test set satisfying N≦10^6 and A≦10^6.
Additional 500 points will be awarded for passing the test set without additional constraints.







InputThe input is given from Standard Input in the following format:
N A





OutputPrint the shortest time needed to produce at least N cookies not yet eaten.






Sample Input 18 1





Sample Output 17

It is possible to produce 8 cookies in 7 seconds, as follows:

After 1 second: 1 cookie is done.
After 2 seconds: 1 more cookie is done, totaling 2. Now, Rng starts eating those 2 cookies.
After 3 seconds: He finishes eating the cookies, and he can now bake 2 cookies per second.
After 4 seconds: 2 cookies are done.
After 5 seconds: 2 more cookies are done, totaling 4.
After 6 seconds: 2 more cookies are done, totaling 6.
After 7 seconds: 2 more cookies are done, totaling 8.






Sample Input 21000000000000 1000000000000





Sample Output 21000000000000


",Cookies,"Greedy Algorithm, Binary Search, Mathematics, Simulation",0.0,16,0
985,"
Score : 500 points


Problem StatementGiven are a sequence of N positive integers A_1, A_2, \ldots, A_N, and a positive integer K.
Find the number of non-empty contiguous subsequences in A such that the remainder when dividing the sum of its elements by K is equal to the number of its elements. We consider two subsequences different if they are taken from different positions, even if they are equal sequences.




Constraints
All values in input are integers.
1 \leq N \leq 2\times 10^5
1 \leq K \leq 10^9
1 \leq A_i \leq 10^9







InputInput is given from Standard Input in the following format:
N K
A_1 A_2 \cdots A_N





OutputPrint the number of subsequences that satisfy the condition.






Sample Input 15 4
1 4 2 3 5





Sample Output 14

Four sequences satisfy the condition: (1), (4,2), (1,4,2), and (5).





Sample Input 28 4
4 2 4 2 4 2 4 2





Sample Output 27

(4,2) is counted four times, and (2,4) is counted three times.





Sample Input 310 7
14 15 92 65 35 89 79 32 38 46





Sample Output 38


",Rem of Sum is Num,"Prefix sum, Arithmetic, Set / Map, Sliding Window, Counting",0.19,39,12
986,"
Score : 500 points


Problem StatementThere are N boxes arranged in a circle. The i-th box contains A_i stones.
Determine whether it is possible to remove all the stones from the boxes by repeatedly performing the following operation:

Select one box. Let the box be the i-th box. Then, for each j from 1 through N, remove exactly j stones from the (i+j)-th box. Here, the (N+k)-th box is identified with the k-th box.

Note that the operation cannot be performed if there is a box that does not contain enough number of stones to be removed.




Constraints
1 ≦ N ≦ 10^5
1 ≦ A_i ≦ 10^9







InputThe input is given from Standard Input in the following format:
N
A_1 A_2 … A_N





OutputIf it is possible to remove all the stones from the boxes, print YES. Otherwise, print NO.






Sample Input 15
4 5 1 2 3





Sample Output 1YES

All the stones can be removed in one operation by selecting the second box.





Sample Input 25
6 9 12 10 8





Sample Output 2YES






Sample Input 34
1 2 3 1





Sample Output 3NO


",Boxes,"Arithmetic, Array, Mathematics, Implementation",0.042,119,11
987,"
Score : 600 points


Problem StatementA tetromino is a figure formed by joining four squares edge to edge.
We will refer to the following seven kinds of tetromino as I-, O-, T-, J-, L-, S- and Z-tetrominos, respectively:



Snuke has many tetrominos. The number of I-, O-, T-, J-, L-, S- and Z-tetrominos in his possession are a_I, a_O, a_T, a_J, a_L, a_S and a_Z, respectively.
Snuke will join K of his tetrominos to form a rectangle that is two squares tall and 2K squares wide.
Here, the following rules must be followed:

When placing each tetromino, rotation is allowed, but reflection is not.
Each square in the rectangle must be covered by exactly one tetromino.
No part of each tetromino may be outside the rectangle.

Snuke wants to form as large a rectangle as possible.
Find the maximum possible value of K.




Constraints
0≤a_I,a_O,a_T,a_J,a_L,a_S,a_Z≤10^9
a_I+a_O+a_T+a_J+a_L+a_S+a_Z≥1







InputThe input is given from Standard Input in the following format:
a_I a_O a_T a_J a_L a_S a_Z





OutputPrint the maximum possible value of K. If no rectangle can be formed, print 0.






Sample Input 12 1 1 0 0 0 0





Sample Output 13

One possible way to form the largest rectangle is shown in the following figure:








Sample Input 20 0 10 0 0 0 0





Sample Output 20

No rectangle can be formed.

",Tetromino Tiling,"Arithmetic, Greedy Algorithm, Boolean Operations On Geometric Objects, Mathematics",0.0,37,6
988,"
Score : 400 points


Problem Statement
You are given a permutation p of the set {1, 2, ..., N}. Please construct two sequences of positive integers a_1, a_2, ..., a_N and b_1, b_2, ..., b_N satisfying the following conditions:

1 \leq a_i, b_i \leq 10^9 for all i
a_1 < a_2 < ... < a_N
b_1 > b_2 > ... > b_N
a_{p_1}+b_{p_1} < a_{p_2}+b_{p_2} < ... < a_{p_N}+b_{p_N}





Constraints
2 \leq N \leq 20,000
p is a permutation of the set {1, 2, ..., N}







InputThe input is given from Standard Input in the following format:
N
p_1 p_2 ... p_N 





OutputThe output consists of two lines. The first line contains a_1, a_2, ..., a_N seperated by a space. The second line contains b_1, b_2, ..., b_N seperated by a space. 
It can be shown that there always exists a solution for any input satisfying the constraints.






Sample Input 12
1 2





Sample Output 11 4
5 4

a_1 + b_1 = 6 and a_2 + b_2 = 8. So this output satisfies all conditions.





Sample Input 23
3 2 1





Sample Output 21 2 3
5 3 1






Sample Input 33
2 3 1





Sample Output 35 10 100
100 10 1


",Construct Sequences,"Permutation Cycle Decomposition, Constructive, Array, Segment Tree, Mathematics",0.714,26,20
989,"
Score : 500 points


Problem StatementOn an xy plane, in an area satisfying 0 ≤ x ≤ W, 0 ≤ y ≤ H, there is one house at each and every point where both x and y are integers.
There are unpaved roads between every pair of points for which either the x coordinates are equal and the difference between the y coordinates is 1, or the y coordinates are equal and the difference between the x coordinates is 1.
The cost of paving a road between houses on coordinates (i,j) and (i+1,j) is p_i for any value of j, while the cost of paving a road between houses on coordinates (i,j) and (i,j+1) is q_j for any value of i.
Mr. Takahashi wants to pave some of these roads and be able to travel between any two houses on paved roads only. Find the solution with the minimum total cost.




Constraints
1 ≦ W,H ≦ 10^5
1 ≦ p_i ≦ 10^8(0 ≦ i ≦ W-1)
1 ≦ q_j ≦ 10^8(0 ≦ j ≦ H-1)
p_i (0 ≦ i ≦ W−1) is an integer.
q_j (0 ≦ j ≦ H−1) is an integer.







InputInputs are provided from Standard Input in the following form.
W H
p_0
:
p_{W-1}
q_0
:
q_{H-1}





OutputOutput an integer representing the minimum total cost.






Sample Input 12 2
3
5
2
7





Sample Output 129

It is enough to pave the following eight roads.

Road connecting houses at (0,0) and (0,1)
Road connecting houses at (0,1) and (1,1)
Road connecting houses at (0,2) and (1,2)
Road connecting houses at (1,0) and (1,1)
Road connecting houses at (1,0) and (2,0)
Road connecting houses at (1,1) and (1,2)
Road connecting houses at (1,2) and (2,2)
Road connecting houses at (2,0) and (2,1)






Sample Input 24 3
2
4
8
1
2
9
3





Sample Output 260


",Gr-idian MST,"Minimum Spanning Tree, Greedy Algorithm, Sorting, Two-pointer, Grid Graph",0.368,53,16
990,"
Score : 300 points


Problem StatementYou are given an integer N.
Find a triple of positive integers h, n and w such that 4/N = 1/h + 1/n + 1/w.
If there are multiple solutions, any of them will be accepted.




Constraints
It is guaranteed that, for the given integer N, there exists a solution such that h,n,w \leq 3500.







InputsInput is given from Standard Input in the following format:
N





OutputsPrint a triple of positive integers h, n and w that satisfies the condition, in the following format:
h n w







Sample Input 12





Sample Output 11 2 2

4/2 = 1/1 + 1/2 + 1/2.





Sample Input 23485





Sample Output 2872 1012974 1539173474040

It is allowed to use an integer exceeding 3500 in a solution.





Sample Input 34664





Sample Output 33498 3498 3498


",4/N,"Bruteforcing, Mathematics, Number Theory",0.08,71,13
991,"
Score : 100 points


Problem StatementSnuke prepared 6 problems for a upcoming programming contest.
For each of those problems, Rng judged whether it can be used in the contest or not.
You are given a string S of length 6.
If the i-th character of s is 1, it means that the i-th problem prepared by Snuke is accepted to be used; 0 means that the problem is not accepted.
How many problems prepared by Snuke are accepted to be used in the contest?




Constraints
The length of S is 6.
S consists of 0 and 1.







InputsInput is given from Standard Input in the following format:
S





OutputsPrint the number of problems prepared by Snuke that are accepted to be used in the contest.






Sample Input 1111100





Sample Output 14

The first, second, third and fourth problems are accepted, for a total of four.





Sample Input 2001001





Sample Output 22






Sample Input 3000000





Sample Output 30


",Accepted...?,"Bruteforcing, Implementation, Counting",0.881,83,59
992,"
Score : 200 points


Problem StatementA group of people played a game. All players had distinct scores, which are positive integers.
Takahashi knows N facts on the players' scores. The i-th fact is as follows: the A_i-th highest score among the players is B_i.
Find the maximum possible number of players in the game.




Constraints
1 \leq N \leq 10^5
1 \leq A_i \leq 10^9(1\leq i\leq N)
0 \leq B_i \leq 10^9(1\leq i\leq N)
If i ≠ j, A_i ≠ A_j.
There exists a possible outcome of the game that are consistent with the facts.
All input values are integers.







InputsInput is given from Standard Input in the following format:
N
A_1 B_1
:
A_N B_N





OutputsPrint the maximum possible number of players in the game.






Sample Input 13
4 7
2 9
6 2





Sample Output 18

The maximum possible number of players is achieved when, for example, the players have the following scores: 12,9,8,7,5,2,1,0.





Sample Input 25
1 10
3 6
5 2
4 4
2 8





Sample Output 27






Sample Input 32
1 1000000000
1000000000 1





Sample Output 31000000001


",Different Distribution,"Bruteforcing, Binary Search, Set / Map, Arithmetic",0.769,70,52
993,"
Score : 500 points


Problem StatementSeisu-ya, a store specializing in non-negative integers, sells N non-negative integers. The i-th integer is A_i and has a utility of B_i.
There may be multiple equal integers with different utilities.
Takahashi will buy some integers in this store. He can buy a combination of integers whose bitwise OR is less than or equal to K. He wants the sum of utilities of purchased integers to be as large as possible.
Find the maximum possible sum of utilities of purchased integers.




Constraints
1 \leq N \leq 10^5
0 \leq K < 2^{30}
0 \leq A_i < 2^{30}(1\leq i\leq N)
1 \leq B_i \leq 10^9(1\leq i\leq N)
All input values are integers.







InputsInput is given from Standard Input in the following format:
N K
A_1 B_1
:
A_N B_N





OutputsPrint the maximum possible sum of utilities of purchased integers.






Sample Input 13 5
3 3
4 4
2 5





Sample Output 18

Buy 2 and 3 to achieve the maximum possible total utility, 8.





Sample Input 23 6
3 3
4 4
2 5





Sample Output 29

Buy 2 and 4 to achieve the maximum possible total utility, 9.





Sample Input 37 14
10 5
7 4
11 4
9 8
3 6
6 2
8 9





Sample Output 332


",IntegerotS,"Bitmask, Greedy Algorithm, Arithmetic",0.286,15,3
994,"
Score : 600 points


Problem StatementLet us consider the following operations on a string consisting of A and B:

Select a character in a string. If it is A, replace it with BB. If it is B, replace with AA.
Select a substring that is equal to either AAA or BBB, and delete it from the string.

For example, if the first operation is performed on ABA and the first character is selected, the string becomes BBBA.
If the second operation is performed on BBBAAAA and the fourth through sixth characters are selected, the string becomes BBBA.
These operations can be performed any number of times, in any order.
You are given two string S and T, and q queries a_i, b_i, c_i, d_i.
For each query, determine whether S_{a_i} S_{{a_i}+1} ... S_{b_i}, a substring of S, can be made into T_{c_i} T_{{c_i}+1} ... T_{d_i}, a substring of T.




Constraints
1 \leq |S|, |T| \leq 10^5
S and T consist of letters A and B.
1 \leq q \leq 10^5
1 \leq a_i \leq b_i \leq |S|
1 \leq c_i \leq d_i \leq |T|







InputInput is given from Standard Input in the following format:
S
T
q
a_1 b_1 c_1 d_1
...
a_q b_q c_q d_q





OutputPrint q lines. The i-th line should contain the response to the i-th query. If S_{a_i} S_{{a_i}+1} ... S_{b_i} can be made into T_{c_i} T_{{c_i}+1} ... T_{d_i}, print YES. Otherwise, print NO.






Sample Input 1BBBAAAABA
BBBBA
4
7 9 2 5
7 9 1 4
1 7 2 5
1 7 2 4





Sample Output 1YES
NO
YES
NO

The first query asks whether the string ABA can be made into BBBA.
As explained in the problem statement, it can be done by the first operation.
The second query asks whether ABA can be made into BBBB, and the fourth query asks whether BBBAAAA can be made into BBB.
Neither is possible.
The third query asks whether the string BBBAAAA can be made into BBBA.
As explained in the problem statement, it can be done by the second operation.





Sample Input 2AAAAABBBBAAABBBBAAAA
BBBBAAABBBBBBAAAAABB
10
2 15 2 13
2 13 6 16
1 13 2 20
4 20 3 20
1 18 9 19
2 14 1 11
3 20 3 15
6 16 1 17
4 18 8 20
7 20 3 14





Sample Output 2YES
YES
YES
YES
YES
YES
NO
NO
NO
NO


",TrBBnsformBBtion,"Prefix sum, Arithmetic, Mathematics, Precomputation",0.636,19,9
995,"
Score : 300 points


Problem StatementAtCoDeer the deer is seeing a quick report of election results on TV.
Two candidates are standing for the election: Takahashi and Aoki.
The report shows the ratio of the current numbers of votes the two candidates have obtained, but not the actual numbers of votes.
AtCoDeer has checked the report N times, and when he checked it for the i-th (1≦i≦N) time, the ratio was T_i:A_i.
It is known that each candidate had at least one vote when he checked the report for the first time.
Find the minimum possible total number of votes obtained by the two candidates when he checked the report for the N-th time.
It can be assumed that the number of votes obtained by each candidate never decreases.




Constraints
1≦N≦1000
1≦T_i,A_i≦1000 (1≦i≦N)
T_i and A_i (1≦i≦N) are coprime.
It is guaranteed that the correct answer is at most 10^{18}.







InputThe input is given from Standard Input in the following format:
N
T_1 A_1
T_2 A_2
:
T_N A_N





OutputPrint the minimum possible total number of votes obtained by Takahashi and Aoki when AtCoDeer checked the report for the N-th time.






Sample Input 13
2 3
1 1
3 2





Sample Output 110

When the numbers of votes obtained by the two candidates change as 2,3 → 3,3 → 6,4, the total number of votes at the end is 10, which is the minimum possible number.





Sample Input 24
1 1
1 1
1 5
1 100





Sample Output 2101

It is possible that neither candidate obtained a vote between the moment when he checked the report, and the moment when he checked it for the next time.





Sample Input 35
3 10
48 17
31 199
231 23
3 2





Sample Output 36930


",AtCoDeer and Election Report,"Greedy Algorithm, Arithmetic, Simulation, Dynamic Programming",0.385,53,22
996,"
Score : 100 points


Problem StatementThis contest is CODEFESTIVAL, which can be shortened to the string CF by deleting some characters.  
Mr. Takahashi, full of curiosity, wondered if he could obtain CF from other strings in the same way.  
You are given a string s consisting of uppercase English letters.
Determine whether the string CF can be obtained from the string s by deleting some characters.




Constraints
2 ≤ |s| ≤ 100
All characters in s are uppercase English letters (A-Z).







InputThe input is given from Standard Input in the following format:
s





OutputPrint Yes if the string CF can be obtained from the string s by deleting some characters.
Otherwise print No.






Sample Input 1CODEFESTIVAL





Sample Output 1Yes

CF is obtained by deleting characters other than the first character C and the fifth character F.





Sample Input 2FESTIVALCODE





Sample Output 2No

FC can be obtained but CF cannot be obtained because you cannot change the order of the characters.





Sample Input 3CF





Sample Output 3Yes

It is also possible not to delete any characters.





Sample Input 4FCF





Sample Output 4Yes

CF is obtained by deleting the first character.

",CF,"String, Array, Implementation, Greedy Algorithm",0.604,118,56
997,"
Score : 800 points


Problem StatementMr. Takahashi has in his room an art object with H rows and W columns, made up of H \times W blocks.
Each block has a color represented by a lowercase English letter (a-z).
The color of the block at the i-th row and j-th column is c_{i,j}.  
Mr. Takahashi would like to dismantle the object, finding it a bit kitschy for his tastes.
The dismantling is processed by repeating the following operation:  

Choose one of the W columns and push down that column one row.
The block at the bottom of that column disappears.

Each time the operation is performed, a cost is incurred.
Since blocks of the same color have a property to draw each other together, the cost of the operation is the number of the pairs of blocks (p, q) such that:

The block p is in the selected column.
The two blocks p and q are horizontally adjacent (before pushing down the column).
The two blocks p and q have the same color.

Mr. Takahashi dismantles the object by repeating the operation H \times W times to get rid of all the blocks.
Compute the minimum total cost to dismantle the object.




Constraints
1 ≤ H ≤ 300
2 ≤ W ≤ 300
All characters c_{i,j} are lowercase English letters (a-z).





Partial Score
In test cases worth 300 points, W = 3.







InputThe input is given from Standard Input in the following format:
H W
c_{1,1}c_{1,2}..c_{1,W}
c_{2,1}c_{2,2}..c_{2,W}
:
c_{H,1}c_{H,2}..c_{H,W}





OutputPrint the minimum total cost to dismantle the object.






Sample Input 12 3
rrr
brg





Sample Output 12

For example, the total cost of 2 can be achieved by performing the operation as follows and this is the minimum value.








Sample Input 26 3
xya
xya
ayz
ayz
xaz
xaz





Sample Output 20

The total cost of 0 can be achieved by first pushing down all blocks of the middle column, then all of the left column, and all of the right column.





Sample Input 34 2
ay
xa
xy
ay





Sample Output 30

The total cost of 0 can be achieved by the following operations:

pushing down the right column one row;
pushing down the left column one row;
pushing down all of the right column;
and pushing down all of the left column.






Sample Input 45 5
aaaaa
abbba
ababa
abbba
aaaaa





Sample Output 424






Sample Input 57 10
xxxxxxxxxx
ccccxxffff
cxxcxxfxxx
cxxxxxffff
cxxcxxfxxx
ccccxxfxxx
xxxxxxxxxx





Sample Output 5130


",Friction,"Dyanmic Programming, Precomputation, Implementation, Dynamic Programming",0.417,22,7
998,"
Score : 300 points


Problem StatementSnuke has N dogs and M monkeys. He wants them to line up in a row.
As a Japanese saying goes, these dogs and monkeys are on bad terms. (""ken'en no naka"", literally ""the relationship of dogs and monkeys"", means a relationship of mutual hatred.) Snuke is trying to reconsile them, by arranging the animals so that there are neither two adjacent dogs nor two adjacent monkeys.
How many such arrangements there are? Find the count modulo 10^9+7 (since animals cannot understand numbers larger than that).
Here, dogs and monkeys are both distinguishable. Also, two arrangements that result from reversing each other are distinguished.




Constraints
1 ≤ N,M ≤ 10^5







InputInput is given from Standard Input in the following format:
N M





OutputPrint the number of possible arrangements, modulo 10^9+7.






Sample Input 12 2





Sample Output 18

We will denote the dogs by A and B, and the monkeys by C and D. There are eight possible arrangements: ACBD, ADBC, BCAD, BDAC, CADB, CBDA, DACB and DBCA.





Sample Input 23 2





Sample Output 212






Sample Input 31 8





Sample Output 30






Sample Input 4100000 100000





Sample Output 4530123477


",Reconciled?,"Arithmetic, Combinatorics, Boolean Operations On Geometric Objects, Mathematics",0.567,61,24
999,"
Score : 500 points


Problem StatementThere are N towns on a plane. The i-th town is located at the coordinates (x_i,y_i). There may be more than one town at the same coordinates.
You can build a road between two towns at coordinates (a,b) and (c,d) for a cost of min(|a-c|,|b-d|) yen (the currency of Japan). It is not possible to build other types of roads.
Your objective is to build roads so that it will be possible to travel between every pair of towns by traversing roads. At least how much money is necessary to achieve this?




Constraints
2 ≤ N ≤ 10^5
0 ≤ x_i,y_i ≤ 10^9
All input values are integers.







InputInput is given from Standard Input in the following format:
N
x_1 y_1
x_2 y_2
:
x_N y_N





OutputPrint the minimum necessary amount of money in order to build roads so that it will be possible to travel between every pair of towns by traversing roads.






Sample Input 13
1 5
3 9
7 8





Sample Output 13

Build a road between Towns 1 and 2, and another between Towns 2 and 3. The total cost is 2+1=3 yen.





Sample Input 26
8 3
4 9
12 19
18 1
13 5
7 6





Sample Output 28


",Built?,"Sorting, Graph Theory, Minimum Spanning Tree, Disjoint Set, Priority Queue",0.579,37,20
1000,"
Score : 400 points


Problem StatementWe have a large square grid with H rows and W columns.
Iroha is now standing in the top-left cell.
She will repeat going right or down to the adjacent cell, until she reaches the bottom-right cell.
However, she cannot enter the cells in the intersection of the bottom A rows and the leftmost B columns. (That is, there are A×B forbidden cells.) There is no restriction on entering the other cells.
Find the number of ways she can travel to the bottom-right cell.
Since this number can be extremely large, print the number modulo 10^9+7.




Constraints
 1 ≦ H, W ≦ 100,000
 1 ≦ A < H
 1 ≦ B < W







InputThe input is given from Standard Input in the following format:
H W A B





OutputPrint the number of ways she can travel to the bottom-right cell, modulo 10^9+7.






Sample Input 12 3 1 1





Sample Output 12

We have a 2×3 grid, but entering the bottom-left cell is forbidden. The number of ways to travel is two: ""Right, Right, Down"" and ""Right, Down, Right"".





Sample Input 210 7 3 4





Sample Output 23570

There are 12 forbidden cells.





Sample Input 3100000 100000 99999 99999





Sample Output 31






Sample Input 4100000 100000 44444 55555





Sample Output 4738162020


",Iroha and a Grid,"Combinatorics, Arithmetic, Modular Multiplicative Inverse, Precomputation, Mathematics, Bruteforcing",0.562,26,11
1001,"
Score : 800 points


Problem Statement12:17 (UTC): The sample input 1 and 2 were swapped. The error is now fixed. We are very sorry for your inconvenience.
There are N children in AtCoder Kindergarten, conveniently numbered 1 through N. Mr. Evi will distribute C indistinguishable candies to the children.
If child i is given a candies, the child's happiness will become x_i^a, where x_i is the child's excitement level. The activity level of the kindergarten is the product of the happiness of all the N children.
For each possible way to distribute C candies to the children by giving zero or more candies to each child, calculate the activity level of the kindergarten. Then, calculate the sum over all possible way to distribute C candies. This sum can be seen as a function of the children's excitement levels x_1,..,x_N, thus we call it f(x_1,..,x_N).
You are given integers A_i,B_i (1≦i≦N). Find  modulo 10^9+7.




Constraints
1≦N≦400
1≦C≦400
1≦A_i≦B_i≦400 (1≦i≦N)





Partial Score
400 points will be awarded for passing the test set satisfying A_i=B_i (1≦i≦N).







InputThe input is given from Standard Input in the following format:
N C
A_1 A_2 ... A_N
B_1 B_2 ... B_N





OutputPrint the value of  modulo 10^9+7.






Sample Input 12 3
1 1
1 1





Sample Output 14

This case is included in the test set for the partial score, since A_i=B_i.
We only have to consider the sum of the activity level of the kindergarten where the excitement level of both child 1 and child 2 are 1 (f(1,1)).

If child 1 is given 0 candy, and child 2 is given 3 candies, the activity level of the kindergarten is 1^0*1^3=1.
If child 1 is given 1 candy, and child 2 is given 2 candies, the activity level of the kindergarten is 1^1*1^2=1.
If child 1 is given 2 candies, and child 2 is given 1 candy, the activity level of the kindergarten is 1^2*1^1=1.
If child 1 is given 3 candies, and child 2 is given 0 candy, the activity level of the kindergarten is 1^3*1^0=1.

Thus, f(1,1)=1+1+1+1=4, and the sum over all f is also 4.





Sample Input 21 2
1
3





Sample Output 214

Since there is only one child, child 1's happiness itself will be the activity level of the kindergarten. Since the only possible way to distribute 2 candies is to give both candies to child 1, the activity level in this case will become the value of f.

When the excitement level of child 1 is 1, f(1)=1^2=1.
When the excitement level of child 1 is 2, f(2)=2^2=4.
When the excitement level of child 1 is 3, f(3)=3^2=9.

Thus, the answer is 1+4+9=14.





Sample Input 32 3
1 1
2 2





Sample Output 366

Since it can be seen that f(1,1)=4 , f(1,2)=15 , f(2,1)=15 , f(2,2)=32, the answer is 4+15+15+32=66.





Sample Input 44 8
3 1 4 1
3 1 4 1





Sample Output 4421749

This case is included in the test set for the partial score.





Sample Input 53 100
7 6 5
9 9 9





Sample Output 5139123417


",Children and Candies,"Exponentiation By Squaring, Prefix sum, Dyanmic Programming, Bruteforcing, Arithmetic",0.333,27,9
1002,"
Score : 100 points


Problem StatementThis contest is CODE FESTIVAL.
However, Mr. Takahashi always writes it CODEFESTIVAL, omitting the single space between CODE and FESTIVAL.
So he has decided to make a program that puts the single space he omitted.
You are given a string s with 12 letters.
Output the string putting a single space between the first 4 letters and last 8 letters in the string s.




Constraints
s contains exactly 12 letters.
All letters in s are uppercase English letters.







InputThe input is given from Standard Input in the following format:
s





OutputPrint the string putting a single space between the first 4 letters and last 8 letters in the string s.
Put a line break at the end.






Sample Input 1CODEFESTIVAL





Sample Output 1CODE FESTIVAL

Putting a single space between the first 4 letters and last 8 letters in CODEFESTIVAL makes it CODE FESTIVAL.





Sample Input 2POSTGRADUATE





Sample Output 2POST GRADUATE






Sample Input 3ABCDEFGHIJKL





Sample Output 3ABCD EFGHIJKL


",CODEFESTIVAL 2016,"String, Array",0.723,128,61
1003,"
Score : 800 points


Problem StatementThere is a grid with R rows and C columns.
We call the cell in the r-th row and c-th column (r，c).
Mr. Takahashi wrote non-negative integers into N of the cells, that is, he wrote a non-negative integer a_i into (r_i，c_i) for each i (1≤i≤N).
After that he fell asleep.
Mr. Aoki found the grid and tries to surprise Mr. Takahashi by writing integers into all remaining cells.
The grid must meet the following conditions to really surprise Mr. Takahashi.

Condition 1: Each cell contains a non-negative integer.
Condition 2: For any 2×2 square formed by cells on the grid, the sum of the top left and bottom right integers must always equal to the sum of the top right and bottom left integers.

Determine whether it is possible to meet those conditions by properly writing integers into all remaining cells.




Constraints
2≤R，C≤10^5
1≤N≤10^5
1≤r_i≤R
1≤c_i≤C
(r_i，c_i) ≠ (r_j，c_j) (i≠j)
a_i is an integer.
0≤a_i≤10^9







InputThe input is given from Standard Input in the following format:
R C
N
r_1 c_1 a_1
r_2 c_2 a_2
:
r_N c_N a_N





OutputPrint Yes if it is possible to meet the conditions by properly writing integers into all remaining cells.
Otherwise, print No.






Sample Input 12 2
3
1 1 0
1 2 10
2 1 20





Sample Output 1Yes

You can write integers as follows.






Sample Input 22 3
5
1 1 0
1 2 10
1 3 20
2 1 30
2 3 40





Sample Output 2No

There are two 2×2 squares on the grid, formed by the following cells:

Cells (1，1), (1，2), (2，1) and (2，2)
Cells (1，2), (1，3), (2，2) and (2，3)

You have to write 40 into the empty cell to meet the condition on the left square, but then it does not satisfy the condition on the right square.






Sample Input 32 2
3
1 1 20
1 2 10
2 1 0





Sample Output 3No

You have to write -10 into the empty cell to meet condition 2, but then it does not satisfy condition 1.






Sample Input 43 3
4
1 1 0
1 3 10
3 1 10
3 3 20





Sample Output 4Yes

You can write integers as follows.






Sample Input 52 2
4
1 1 0
1 2 10
2 1 30
2 2 20





Sample Output 5No

All cells already contain a integer and condition 2 is not satisfied.


",Grid and Integers,"Bipartite Graph, Mathematics, Graph Traversal, Backtracking, 2-sat, Graph Theory",0.0,44,4
1004,"
Score : 66 points


Problem Statement

  Summer vacation ended at last and the second semester has begun.
  You, a Kyoto University student, came to university and heard a rumor that somebody will barricade the entrance of your classroom.
  The barricade will be built just before the start of the A-th class and removed by Kyoto University students just before the start of the B-th class.
  All the classes conducted when the barricade is blocking the entrance will be cancelled and you will not be able to attend them.
  Today you take N classes and class i is conducted in the t_i-th period.
  You take at most one class in each period.
  Find the number of classes you can attend.





Constraints

1 \leq N \leq 1000
1 \leq A < B \leq 10^9 
1 \leq t_i \leq 10^9
All t_i values are distinct.







Input
N, A and B are given on the first line and t_i is given on the (i+1)-th line. 

N A B
t1
:
tN





Output
Print the number of classes you can attend. 






Sample Input 1

5 5 9
4
3
6
9
1





Sample Output 1

4

You can not only attend the third class. 




Sample Input 2

5 4 9
5
6
7
8
9





Sample Output 2

1

You can only attend the fifth class. 




Sample Input 3

4 3 6
9
6
8
1





Sample Output 3

4

You can attend all the classes. 




Sample Input 4

2 1 2
1
2





Sample Output 4

1

You can not attend the first class, but can attend the second. 


",A Barricade,"Bruteforcing, Implementation, Counting",0.923,14,13
1005,"
Score : 100 points


Problem Statement


		                Kyoto University Programming Contest is a programming contest voluntarily held by some Kyoto University students.
		                This contest is abbreviated as Kyoto University Programming Contest and called KUPC.
                    

		                source: Kyoto University Programming Contest Information



		            The problem-preparing committee met to hold this year's KUPC and N problems were proposed there.
		            The problems are numbered from 1 to N and the name of i-th problem is P_i.
		            However, since they proposed too many problems, they decided to divide them into some sets for several contests.
                

		            They decided to divide this year's KUPC into several KUPCs by dividing problems under the following conditions.
                    
 One KUPC provides K problems. 
 Each problem appears at most once among all the KUPCs. 
 All the first letters of the problem names in one KUPC must be different. 



		            You, one of the committee members, want to hold as many KUPCs as possible.
		            Write a program to find the maximum number of KUPCs that can be held this year.
                
Constraints

 1 \leq N \leq 10^4
 1 \leq K \leq 26
 1 \leq |P_i| \leq 10
 All characters in P_i are capital letters.


		            Note that, for each i and j (1 \leq i < j \leq N),
                    P_i \neq P_j are not necessarily satisfied.
                






Input
The input is given from Standard Input in the following format:

N K
P_1
:
P_N





Output

		                Print the maximum number of KUPCs that can be held on one line.
                    






Sample Input 1

9 3
APPLE
ANT
ATCODER
BLOCK
BULL
BOSS
CAT
DOG
EGG

For example, three KUPCs can be held by dividing the problems as follows. 

 First: APPLE, BLOCK, CAT
 Second: ANT, BULL, DOG
 Third: ATCODER, BOSS, EGG





Sample Output 1

3





Sample Input 2

3 2
KU
KYOUDAI
KYOTOUNIV





Sample Output 2

0

No KUPC can be held.


",Problem Committee,"Counting, Sorting, Greedy Algorithm, Bruteforcing",0.5,43,8
1006,"
Score : 100 points

Problem Statement
A professor invented Cookie Breeding Machine for his students who like cookies very much. 
When one cookie with the taste of x is put into the machine and a non-negative integer y less than or equal to 127 is input on the machine,
        it consumes the cookie and generates two cookies with the taste of y and (x XOR y). 
Here, XOR represents Bitwise Exclusive OR. 
At first, there is only one cookie and the taste of it is D . 
Find the maximum value of the sum of the taste of the exactly N cookies generated after the following operation is conducted N-1 times. 

Put one of the cookies into the machine. 
Input a non-negative integer less than or equal to 127 on the machine. 



Constraints

1 \leq T \leq 1000
1 \leq N_t \leq 1000 (1 \leq t \leq T)
1 \leq D_t \leq 127 (1 \leq t \leq T)





Input
The input is given from Standard Input in the following format:

T
N_1 D_1
:
N_T D_T


            The input consists of multiple test cases. An Integer T that represents the number of test cases is given on line 1. 
            Each test case is given on the next T lines. 
            In the t-th test case ( 1 \leq t \leq T ),
            N_t that represents the number of cookies generated through the operations and D_t that represents the taste of the initial cookie are given separated by space. 



Output
For each test case, print the maximum value of the sum of the taste of the N cookies generated through the operations on one line. 




Sample Input 1

3
3 1
4 108
1 10



Sample Output 1

255
400
10


        On the 1st test case, if the machine is used as follows, three cookies with the taste of 61, 95 and 99 are generated.
        Since the sum of these values is maximum among all possible ways, the answer is 255.
        
Put the cookie with the taste of 1 and input an integer 60 on the machine, lose the cookie and get two cookies with the taste of 60 and 61. 
Put the cookie with the taste of 60 and input an integer 99 on the machine, lose the cookie and get two cookies with the taste of 99 and 95. 



        On the 3rd test case, the machine may not be used.
    

",Cookie Breeding Machine,"Bit Set, Greedy Algorithm, Mathematics, Simulation",1.0,6,6
1007,"
Score : 150 points


Problem Statement

  There is a long blackboard with 2 rows and N columns in a classroom of Kyoto University. 
  This blackboard is so long that it is impossible to tell which cells are already used and which unused. 


  Recently, a blackboard retrieval device was installed at the classroom. 
  To use this device, you type a search query that forms a rectangle with 2 rows and any length of columns, where each cell is used or unused. 
  When you input a query, the decive answers whether the rectangle that corresponds to the query exists in the blackboard. 
  Here, for a rectangle that corresponds to a search query, if two integer i, j ( i < j ) exist
  and the rectangle equals to the partial blackboard between column i and j ,
  the rectangle is called a sub-blackboard of the blackboard. 


  You are currently preparing for a presentation at this classroom.
  To make the presentation go well, you decided to write a program to detect the status of the whole blackboard using the retrieval device. 
  Since it takes time to use the device, you want to use it as few times as possible. 


  The status of the whole blackboard is already determined at the beginning and does not change while you are using the device. 







Input
The first input is given in the following format:

N

 N (1 \leq N \leq 100) is an integer that represents the length of the blackboard. 

  After this input value, your program must print search queries. 
  A search query has the following format. 


s_1
s_2


  Here, s_1 represents the upper part of the blackboard and s_2 represents the lower. 
  # in s_1 and s_2 represents the cell is already used and . represents the cell is still unused. 
  The lengths of s_1 and s_2 are arbitrary, but they must be the same. 
  Make sure to insert a line break at the end of the lines. 


  Every time your program prints a search query, a string that represents the search result of the device is returned in the followin format. 


r


r is either T or F . 
  The meaning of each character is as follows. 


 T represents that the sub-blackboard that corresponds to the search query exists in the blackboard. 
 F represents that the sub-blackboard that corresponds to the search query does not exist in the blackboard. 


  If the search query equals to the whole blackboard or the number of the search queries exceeds the limit, string end is given instead of r .
  Once you receive this string, exit your program immediately. 
  If your program prints the whole blackboard as a search query before exceedin the limit, it is judged as Accepted. Note that the search query that represents the whole blackboard is also counted as the number of search queries. 





  Note that the output needs to be flushed every time the output is printed. 
  For example, In C/C++, search query s1, s2 can be printed as follows. 

printf(""%s\n%s\n"", s1, s2); fflush(stdout);

  Make sure your program receive all the input from the device. Otherwise, the result may be Time Limit Exceeded . 




Query Limit

  The maximun number of search queries is 420.
  If the number of queries exceeds the limit, the result will be Query Limit Exceeded . 






Sample Input and Output
The following is an example where N=3 and the blackboard is as follows. 

.#.
...

Note that your program does not know the state of the blackboard. 


  
    Output of your program
    Input to your program
    Explanation
  
  
    
    3
    The length of the blackboard is given
  
  
    ..##
    
    Output a search query
  
  
    
    F
    The sub-blackboard does not exist
  
  
    ..
    
    Output a search query
  
  
    
    T
    The sub-blackboard exists
  
  
    ....
    
    Output a search query
  
  
    
    F
    The sub-blackboard does not exist
  
  
    .#..
    
    Output a search query
  
  
    
    T
    The sub-blackboard exists
  
  
    .#....
    
    Output a search query
  
  
    
    end
    Exit your program because the above sub-blackboard equals to the whole blackboard. 
  




",Long Blackboard,"Geometry; 3d, Backtracking, String, Greedy Algorithm, Two-pointer, Interactive",0.833,7,6
1008,"
Score : 150 points


Problem Statement

  There are some goats on a grid with H rows and W columns. 
  Alice wants to put some fences at some cells where goats do not exist so that no goat can get outside the grid. 
  Goats can move in the four directions, that is, up, down, right and left.
  Goats can not move onto the cells where fences are placed. 
  If a goat exists at one of the outermost cells in the grid, it can move outside.
  Goats do not move until all fences are placed.  
  Find the minimum number of fences to be placed. 





Constraints

 1 \leq H \leq 100 
 1 \leq W \leq 100 
 There is at least one goat on the given grid. 







Input
The input is given from the Standart Input in the following format:

H W
S_1
:
S_H


  The j-th (1 \leq j \leq W) character in S_i (1 \leq i \leq H) represents 
  whether a goat exists at the cell located at row i and column j. 
  Character . represents there is no goat, and X represents there is one goat at the cell. 
",Fences,"Graph Theory, Maximum Flow, Graph Traversal, Maximum Flow, Implementation",0.5,8,4
1009,"
Score : 300 points


Problem StatementYou are given a string S consisting of lowercase English letters.
Another string T is initially empty.
Determine whether it is possible to obtain S = T by performing the following operation an arbitrary number of times:

Append one of the following at the end of T: dream, dreamer, erase and eraser.





Constraints
1≦|S|≦10^5
S consists of lowercase English letters.







InputThe input is given from Standard Input in the following format:
S





OutputIf it is possible to obtain S = T, print YES. Otherwise, print NO.






Sample Input 1erasedream





Sample Output 1YES

Append erase and dream at the end of T in this order, to obtain S = T.





Sample Input 2dreameraser





Sample Output 2YES

Append dream and eraser at the end of T in this order, to obtain S = T.





Sample Input 3dreamerer





Sample Output 3NO


",Daydream,"Greedy Algorithm, String, Two-pointer, Bruteforcing",0.469,79,30
1010,"
Score : 400 points


Problem StatementThere are N cities. There are also K roads and L railways, extending between the cities.
The i-th road bidirectionally connects the p_i-th and q_i-th cities, and the i-th railway bidirectionally connects the r_i-th and s_i-th cities.
No two roads connect the same pair of cities. Similarly, no two railways connect the same pair of cities.
We will say city A and B are connected by roads if city B is reachable from city A by traversing some number of roads. Here, any city is considered to be connected to itself by roads.
We will also define connectivity by railways similarly.
For each city, find the number of the cities connected to that city by both roads and railways.




Constraints
2 ≦ N ≦ 2*10^5
1 ≦ K, L≦ 10^5
1 ≦ p_i, q_i, r_i, s_i ≦ N
p_i < q_i
r_i < s_i
When i ≠ j, (p_i, q_i) ≠ (p_j, q_j)
When i ≠ j, (r_i, s_i) ≠ (r_j, s_j)







InputThe input is given from Standard Input in the following format:
N K L
p_1 q_1
:
p_K q_K
r_1 s_1
:
r_L s_L





OutputPrint N integers. The i-th of them should represent the number of the cities connected to the i-th city by both roads and railways.






Sample Input 14 3 1
1 2
2 3
3 4
2 3





Sample Output 11 2 2 1

All the four cities are connected to each other by roads.
By railways, only the second and third cities are connected. Thus, the answers for the cities are 1, 2, 2 and 1, respectively.





Sample Input 24 2 2
1 2
2 3
1 4
2 3





Sample Output 21 2 2 1






Sample Input 37 4 4
1 2
2 3
2 5
6 7
3 5
4 5
3 4
6 7





Sample Output 31 1 2 1 2 2 2


",Connectivity,"Graph Theory, Graph Traversal, Disjoint Set, Set / Map",0.235,61,17
1011,"
Score : 300 points


Problem StatementSnuke loves ""paper cutting"": he cuts out characters from a newspaper headline and rearranges them to form another string.
He will receive a headline which contains one of the strings S_1,...,S_n tomorrow.
He is excited and already thinking of what string he will create.
Since he does not know the string on the headline yet, he is interested in strings that can be created regardless of which string the headline contains.
Find the longest string that can be created regardless of which string among S_1,...,S_n the headline contains.
If there are multiple such strings, find the lexicographically smallest one among them.




Constraints
1 \leq n \leq 50
1 \leq |S_i| \leq 50 for every i = 1, ..., n.
S_i consists of lowercase English letters (a - z) for every i = 1, ..., n.







InputInput is given from Standard Input in the following format:
n
S_1
...
S_n





OutputPrint the lexicographically smallest string among the longest strings that satisfy the condition.
If the answer is an empty string, print an empty line.






Sample Input 13
cbaa
daacc
acacac





Sample Output 1aac

The strings that can be created from each of cbaa, daacc and acacac, are aa, aac, aca, caa and so forth.
Among them, aac, aca and caa are the longest, and the lexicographically smallest of these three is aac.





Sample Input 23
a
aa
b





Sample Output 2

The answer is an empty string.

",Dubious Document,"Counting, Array, Mathematics, String, Sorting",0.682,34,21
1012,"
Score : 500 points


Problem StatementOn a two-dimensional plane, there are m lines drawn parallel to the x axis, and n lines drawn parallel to the y axis.
Among the lines parallel to the x axis, the i-th from the bottom is represented by y = y_i.
Similarly, among the lines parallel to the y axis, the i-th from the left is represented by x = x_i.
For every rectangle that is formed by these lines, find its area, and print the total area modulo 10^9+7.
That is, for every quadruple (i,j,k,l) satisfying 1\leq i < j\leq n and 1\leq k < l\leq m, find the area of the rectangle formed by the lines x=x_i, x=x_j, y=y_k and y=y_l, and print the sum of these areas modulo 10^9+7.




Constraints
2 \leq n,m \leq 10^5
-10^9 \leq x_1 < ... < x_n \leq 10^9
-10^9 \leq y_1 < ... < y_m \leq 10^9
x_i and y_i are integers.







InputInput is given from Standard Input in the following format:
n m
x_1 x_2 ... x_n
y_1 y_2 ... y_m





OutputPrint the total area of the rectangles, modulo 10^9+7.






Sample Input 13 3
1 3 4
1 3 6





Sample Output 160

The following figure illustrates this input:

The total area of the nine rectangles A, B, ..., I shown in the following figure, is 60.






Sample Input 26 5
-790013317 -192321079 95834122 418379342 586260100 802780784
-253230108 193944314 363756450 712662868 735867677





Sample Output 2835067060


",###,"Prefix sum, Arithmetic, Counting, Difference Array, Array",0.5,30,19
1013,"
Score : 300 points


Problem StatementYou are given an integer sequence of length N. The i-th term in the sequence is a_i.
In one operation, you can select a term and either increment or decrement it by one.
At least how many operations are necessary to satisfy the following conditions?

For every i (1≤i≤n), the sum of the terms from the 1-st through i-th term is not zero.
For every i (1≤i≤n-1), the sign of the sum of the terms from the 1-st through i-th term, is different from the sign of the sum of the terms from the 1-st through (i+1)-th term.





Constraints
2 ≤ n ≤ 10^5
|a_i| ≤ 10^9
Each a_i is an integer.







InputInput is given from Standard Input in the following format:
n
a_1 a_2 ... a_n





OutputPrint the minimum necessary count of operations.






Sample Input 14
1 -3 1 0





Sample Output 14

For example, the given sequence can be transformed into 1, -2, 2, -2 by four operations. The sums of the first one, two, three and four terms are 1, -1, 1 and -1, respectively, which satisfy the conditions.





Sample Input 25
3 -6 4 -5 7





Sample Output 20

The given sequence already satisfies the conditions.





Sample Input 36
-1 4 3 2 -5 4





Sample Output 38


",Sequence,"Greedy Algorithm, Prefix sum, Bitmask, Bruteforcing",0.412,54,14
1014,"
Score : 500 points


Problem StatementAlice and Brown loves games. Today, they will play the following game.
In this game, there are two piles initially consisting of X and Y stones, respectively.
Alice and Bob alternately perform the following operation, starting from Alice:

Take 2i stones from one of the piles. Then, throw away i of them, and put the remaining i in the other pile. Here, the integer i (1≤i) can be freely chosen as long as there is a sufficient number of stones in the pile.

The player who becomes unable to perform the operation, loses the game.
Given X and Y, determine the winner of the game, assuming that both players play optimally.




Constraints
0 ≤ X, Y ≤ 10^{18}







InputInput is given from Standard Input in the following format:
X Y





OutputPrint the winner: either Alice or Brown.






Sample Input 12 1





Sample Output 1Brown

Alice can do nothing but taking two stones from the pile containing two stones. As a result, the piles consist of zero and two stones, respectively. Then, Brown will take the two stones, and the piles will consist of one and zero stones, respectively. Alice will be unable to perform the operation anymore, which means Brown's victory.





Sample Input 25 0





Sample Output 2Alice






Sample Input 30 0





Sample Output 3Brown






Sample Input 44 8





Sample Output 4Alice


",Alice&Brown,"Game Theory, Dyanmic Programming, Arithmetic, Implementation",0.6,32,12
1015,"
Score : 400 points


Problem StatementYou have N items and a bag of strength W.
The i-th item has a weight of w_i and a value of v_i.
You will select some of the items and put them in the bag.
Here, the total weight of the selected items needs to be at most W.
Your objective is to maximize the total value of the selected items.




Constraints
1 ≤ N ≤ 100
1 ≤ W ≤ 10^9
1 ≤ w_i ≤ 10^9
For each i = 2,3,...,N, w_1 ≤ w_i ≤ w_1 + 3.
1 ≤ v_i ≤ 10^7
W, each w_i and v_i are integers.







InputInput is given from Standard Input in the following format:
N W
w_1 v_1
w_2 v_2
:
w_N v_N





OutputPrint the maximum possible total value of the selected items.






Sample Input 14 6
2 1
3 4
4 10
3 4





Sample Output 111

The first and third items should be selected.





Sample Input 24 6
2 1
3 7
4 10
3 6





Sample Output 213

The second and fourth items should be selected.





Sample Input 34 10
1 100
1 100
1 100
1 100





Sample Output 3400

You can take everything.





Sample Input 44 1
10 100
10 100
10 100
10 100





Sample Output 40

You can take nothing.

",Simple Knapsack,"Dyanmic Programming, Sorting, Prefix sum, Enumeration, Sorting, Mathematics",0.412,56,16
1016,"
Score : 700 points


Problem StatementThere are N bags, each containing two white balls. The i-th box contains two balls with integers x_i and y_i written on them, respectively.
For each of these bags, you will paint one of the balls red, and paint the other blue.
Afterwards, the 2N balls will be classified according to color.
Then, we will define the following:

R_{max}: the maximum integer written on a ball painted in red
R_{min}: the minimum integer written on a ball painted in red
B_{max}: the maximum integer written on a ball painted in blue
B_{min}: the minimum integer written on a ball painted in blue

Find the minimum possible value of (R_{max} - R_{min}) \times (B_{max} - B_{min}).




Constraints
1 ≤ N ≤ 200,000
1 ≤ x_i, y_i ≤ 10^9







InputInput is given from Standard Input in the following format:
N
x_1 y_1
x_2 y_2
:
x_N y_N





OutputPrint the minimum possible value.






Sample Input 13
1 2
3 4
5 6





Sample Output 115

The optimal solution is to paint the balls with x_1, x_2, y_3 red, and paint the balls with y_1, y_2, x_3 blue.





Sample Input 23
1010 10
1000 1
20 1020





Sample Output 2380






Sample Input 32
1 1
1000000000 1000000000





Sample Output 3999999998000000001


",Ball Coloring,"Sorting, Two-pointer, Data Structure, Greedy Algorithm, Heuristics, Set / Map, Tree",0.0,20,5
1017,"
Score : 900 points


Problem StatementThere are N squares in a row. The squares are numbered 1, 2, ..., N from left to right.
You have two pieces, initially placed on square A and B, respectively.
You will be asked to process Q queries of the following kind, in the order received:

Given an integer x_i, move one of the two pieces of your choice to square x_i.

Here, it takes you one second to move a piece one square.
That is, the time it takes to move a piece from square X to Y is |X-Y| seconds.
Your objective is to process all the queries in the shortest possible time.
You may only move the pieces in response to queries, and you may not move both pieces at the same time.
Also, it is not allowed to rearrange the order in which queries are given.
It is, however, allowed to have both pieces in the same square at the same time.




Constraints
1 ≤ N, Q ≤ 200,000
1 ≤ A, B ≤ N
1 ≤ x_i ≤ N







InputInput is given from Standard Input in the following format:
N Q A B
x_1 x_2 ... x_Q





OutputLet the shortest possible time to process all the queries be X seconds. Print X.






Sample Input 18 3 1 8
3 5 1





Sample Output 17

All the queries can be processed in seven seconds, by:

moving the piece at square 1 to 3
moving the piece at square 8 to 5
moving the piece at square 3 to 1






Sample Input 29 2 1 9
5 1





Sample Output 24

The piece at square 9 should be moved first.





Sample Input 39 2 1 9
5 9





Sample Output 34

The piece at square 1 should be moved first.





Sample Input 411 16 8 1
1 1 5 1 11 4 5 2 5 3 3 3 5 5 6 7





Sample Output 421


",Many Moves,"Dyanmic Programming, Segment Tree, Arithmetic, Bitmask",0.75,7,5
1018,"
Score : 800 points


Problem StatementThere are N squares arranged in a row.
The squares are numbered 1, 2, ..., N, from left to right.
Snuke is painting each square in red, green or blue.
According to his aesthetic sense, the following M conditions must all be satisfied.
The i-th condition is:

There are exactly x_i different colors among squares l_i, l_i + 1, ..., r_i.

In how many ways can the squares be painted to satisfy all the conditions?
Find the count modulo 10^9+7.




Constraints
1 ≤ N ≤ 300
1 ≤ M ≤ 300
1 ≤ l_i ≤ r_i ≤ N
1 ≤ x_i ≤ 3







InputInput is given from Standard Input in the following format:
N M
l_1 r_1 x_1
l_2 r_2 x_2
:
l_M r_M x_M





OutputPrint the number of ways to paint the squares to satisfy all the conditions, modulo 10^9+7.






Sample Input 13 1
1 3 3





Sample Output 16

The six ways are:

RGB
RBG
GRB
GBR
BRG
BGR

where R, G and B correspond to red, green and blue squares, respectively.





Sample Input 24 2
1 3 1
2 4 2





Sample Output 26

The six ways are:

RRRG
RRRB
GGGR
GGGB
BBBR
BBBG






Sample Input 31 3
1 1 1
1 1 2
1 1 3





Sample Output 30

There are zero ways.





Sample Input 48 10
2 6 2
5 5 1
3 5 2
4 7 3
4 4 1
2 3 1
7 7 1
1 5 2
1 7 3
3 4 2





Sample Output 4108


",RGB Sequence,"Dyanmic Programming, Segment Tree, Bitmask, Arithmetic, Backtracking",0.0,26,2
1019,"
Score : 700 points


Problem StatementNuske has a grid with N rows and M columns of squares. The rows are numbered 1 through N from top to bottom, and the columns are numbered 1 through M from left to right.
Each square in the grid is painted in either blue or white. If S_{i,j} is 1, the square at the i-th row and j-th column is blue; if S_{i,j} is 0, the square is white.
For every pair of two blue square a and b, there is at most one path that starts from a, repeatedly proceeds to an adjacent (side by side) blue square and finally reaches b, without traversing the same square more than once.
Phantom Thnook, Nuske's eternal rival, gives Q queries to Nuske. The i-th query consists of four integers x_{i,1}, y_{i,1}, x_{i,2} and y_{i,2} and asks him the following: when the rectangular region of the grid bounded by (and including) the x_{i,1}-th row, x_{i,2}-th row, y_{i,1}-th column and y_{i,2}-th column is cut out, how many connected components consisting of blue squares there are in the region?
Process all the queries.




Constraints
1 ≤ N,M ≤ 2000
1 ≤ Q ≤ 200000
S_{i,j} is either 0 or 1.
S_{i,j} satisfies the condition explained in the statement.
1 ≤ x_{i,1} ≤ x_{i,2} ≤ N(1 ≤ i ≤ Q)
1 ≤ y_{i,1} ≤ y_{i,2} ≤ M(1 ≤ i ≤ Q)







InputThe input is given from Standard Input in the following format:
N M Q
S_{1,1}..S_{1,M}
:
S_{N,1}..S_{N,M}
x_{1,1} y_{i,1} x_{i,2} y_{i,2}
:
x_{Q,1} y_{Q,1} x_{Q,2} y_{Q,2}





OutputFor each query, print the number of the connected components consisting of blue squares in the region.






Sample Input 13 4 4
1101
0110
1101
1 1 3 4
1 1 3 1
2 2 3 4
1 2 2 4





Sample Output 13
2
2
2


In the first query, the whole grid is specified. There are three components consisting of blue squares, and thus 3 should be printed.
In the second query, the region within the red frame is specified. There are two components consisting of blue squares, and thus 2 should be printed.
Note that squares that belong to the same component in the original grid may belong to different components.





Sample Input 25 5 6
11010
01110
10101
11101
01010
1 1 5 5
1 2 4 5
2 3 3 4
3 3 3 3
3 1 3 5
1 1 3 4





Sample Output 23
2
1
1
3
2


",Nuske vs Phantom Thnook,"Prefix sum, Tree, Graph Theory, Grid Graph, Offline Queries",0.25,22,9
1020,"
Score : 600 points


Problem StatementYou are given an integer sequence of length N, a = {a_1, a_2, …, a_N}, and an integer K.
a has N(N+1)/2 non-empty contiguous subsequences, {a_l, a_{l+1}, …, a_r} (1 ≤ l ≤ r ≤ N). Among them, how many have an arithmetic mean that is greater than or equal to K?




Constraints
All input values are integers.
1 ≤ N ≤ 2 \times 10^5
1 ≤ K ≤ 10^9
1 ≤ a_i ≤ 10^9







InputInput is given from Standard Input in the following format:
N K
a_1
a_2
:
a_N





OutputPrint the number of the non-empty contiguous subsequences with an arithmetic mean that is greater than or equal to K.






Sample Input 13 6
7
5
7





Sample Output 15

All the non-empty contiguous subsequences of a are listed below:

{a_1} = {7}
{a_1, a_2} = {7, 5}
{a_1, a_2, a_3} = {7, 5, 7}
{a_2} = {5}
{a_2, a_3} = {5, 7}
{a_3} = {7}

Their means are 7, 6, 19/3, 5, 6 and 7, respectively, and five among them are 6 or greater. Note that {a_1} and {a_3} are indistinguishable by the values of their elements, but we count them individually.





Sample Input 21 2
1





Sample Output 20






Sample Input 37 26
10
20
30
40
30
20
10





Sample Output 313


",Meaningful Mean,"Prefix sum, Mathematics, Value / Coordinate Compression, Binary Indexed Tree, Counting",0.364,19,7
1021,"


Problem StatementThere are N piles of candies on the table. The piles are numbered 1 through N. At first, pile i contains a_i candies.
Snuke and Ciel are playing a game. They take alternating turns. Snuke goes first. In each turn, the current player must perform one of the following two operations:

Choose a pile with the largest number of candies remaining, then eat all candies of that pile.
From each pile with one or more candies remaining, eat one candy.

The player who eats the last candy on the table, loses the game. Determine which player will win if both players play the game optimally.




Constraints
1≤N≤10^5
1≤a_i≤10^9







InputThe input is given from Standard Input in the following format:
N
a_1 a_2 … a_N





OutputIf Snuke will win, print First. If Ciel will win, print Second.






Sample Input 12
1 3





Sample Output 1First

At the beginning of the game, pile 2 contains the most candies. If Snuke eats all candies of this pile, Ciel has no choice but to eat the last candy.





Sample Input 23
1 2 1





Sample Output 2First

If Snuke eats one candy from each pile, Ciel is again left with the last candy.





Sample Input 33
1 2 3





Sample Output 3Second


",Candy Piles,"Sorting, Two-pointer, Counting, Parity, Game Theory",0.0,21,1
1022,"
Score : 1700 points


Problem StatementSnuke got a grid from his mother, as a birthday present. The grid has H rows and W columns. Each cell is painted black or white. All black cells are 4-connected, that is, it is possible to traverse from any black cell to any other black cell by just visiting black cells, where it is only allowed to move horizontally or vertically.
The color of the cell at the i-th row and j-th column (1 ≦ i ≦ H, 1 ≦ j ≦ W) is represented by a character s_{ij}. If s_{ij} is #, the cell is painted black. If s_{ij} is ., the cell is painted white. At least one cell is painted black.
We will define fractals as follows.
The fractal of level 0 is a 1 × 1 grid with a black cell.
The fractal of level k+1 is obtained by arranging smaller grids in H rows and W columns, following the pattern of the Snuke's grid.
At a position that corresponds to a black cell in the Snuke's grid, a copy of the fractal of level k is placed.
At a position that corresponds to a white cell in the Snuke's grid, a grid whose cells are all white, with the same dimensions as the fractal of level k, is placed.
You are given the description of the Snuke's grid, and an integer K. Find the number of connected components of black cells in the fractal of level K, modulo 10^9+7.




Constraints
1 ≦ H,W ≦ 1000
0 ≦ K ≦ 10^{18}
Each s_{ij} is either # or ..
All black cells in the given grid are 4-connected.
There is at least one black cell in the given grid.







InputThe input is given from Standard Input in the following format:
H W K
s_{11} .. s_{1W}
:
s_{H1} .. s_{HW}





OutputPrint the number of connected components of black cells in the fractal of level K, modulo 10^9+7.






Sample Input 13 3 3
.#.
###
#.#





Sample Output 120

The fractal of level K=3 in this case is shown below. There are 20 connected components of black cells.

.............#.............
............###............
............#.#............
..........#..#..#..........
.........#########.........
.........#.##.##.#.........
..........#.....#..........
.........###...###.........
.........#.#...#.#.........
....#........#........#....
...###......###......###...
...#.#......#.#......#.#...
.#..#..#..#..#..#..#..#..#.
###########################
#.##.##.##.##.##.##.##.##.#
.#.....#..#.....#..#.....#.
###...######...######...###
#.#...#.##.#...#.##.#...#.#
....#.................#....
...###...............###...
...#.#...............#.#...
.#..#..#...........#..#..#.
#########.........#########
#.##.##.#.........#.##.##.#
.#.....#...........#.....#.
###...###.........###...###
#.#...#.#.........#.#...#.#






Sample Input 23 3 3
###
#.#
###





Sample Output 21






Sample Input 311 15 1000000000000000000
.....#.........
....###........
....####.......
...######......
...#######.....
..##.###.##....
..##########...
.###.....####..
.####...######.
###############
#.##..##..##..#





Sample Output 3301811921


",Fraction of Fractal,"Graph Theory, Boolean Operations On Geometric Objects, Mathematics, Matrix, Arithmetic",1.0,1,1
1023,"
Score : 700 points


Problem StatementN cells are arranged in a row.
Some of them may contain tokens.
You are given a string s that consists of 0s and 1s.
If the i-th character of s is 1, the i-th cell (from left) contains a token.
Otherwise, it doesn't contain a token.
Snuke wants to perform the following operation as many times as possible.
In each operation, he chooses three consecutive cells.
Let's call the cells X, Y, Z from left to right.
In order for the operation to be valid, both X and Z must contain tokens and Y must not contain a token.
Then, he removes these two tokens and puts a new token on Y.
How many operations can he perform if he performs operations in the optimal way?




Constraints
1 \leq N \leq 500,000
|s| = N
Each character in s is either 0 or 1.







InputInput is given from Standard Input in the following format:
N
s





OutputPrint the answer.






Sample Input 17
1010101





Sample Output 12

For example, he can perform two operations in the following way:

Perform an operation on the last three cells. Now the string that represents tokens becomes 1010010.
Perform an operation on the first three cells. Now the string that represents tokens becomes 0100010.

Note that the choice of operations matters.
For example, if he chooses three cells in the middle first, he can perform no more operations.





Sample Input 250
10101000010011011110001001111110000101010111100110





Sample Output 210


",101 to 010,"Dyanmic Programming, String, Sliding Window, Greedy Algorithm",0.0,33,2
1024,"
Score : 500 points


Problem StatementFor integers b (b \geq 2) and n (n \geq 1), let the function f(b,n) be defined as follows:

f(b,n) = n, when n < b
f(b,n) = f(b,\,{\rm floor}(n / b)) + (n \ {\rm mod} \ b), when n \geq b

Here, {\rm floor}(n / b) denotes the largest integer not exceeding n / b,
and n \ {\rm mod} \ b denotes the remainder of n divided by b.
Less formally, f(b,n) is equal to the sum of the digits of n written in base b.
For example, the following hold:

f(10,\,87654)=8+7+6+5+4=30
f(100,\,87654)=8+76+54=138

You are given integers n and s.
Determine if there exists an integer b (b \geq 2) such that f(b,n)=s.
If the answer is positive, also find the smallest such b.




Constraints
1 \leq n \leq 10^{11}
1 \leq s \leq 10^{11}
n,\,s are integers.







InputThe input is given from Standard Input in the following format:
n
s





OutputIf there exists an integer b (b \geq 2) such that f(b,n)=s, print the smallest such b.
If such b does not exist, print -1 instead.






Sample Input 187654
30





Sample Output 110






Sample Input 287654
138





Sample Output 2100






Sample Input 387654
45678





Sample Output 3-1






Sample Input 431415926535
1





Sample Output 431415926535






Sample Input 51
31415926535





Sample Output 5-1


",Digit Sum,"Arithmetic, Mathematics, Number Theory, Implementation",0.25,18,4
1025,"
Score : 200 points


Problem StatementThere is a kangaroo at coordinate 0 on an infinite number line that runs from left to right, at time 0.
During the period between time i-1 and time i, the kangaroo can either stay at his position, or perform a jump of length exactly i to the left or to the right.
That is, if his coordinate at time i-1 is x, he can be at coordinate x-i, x or x+i at time i.
The kangaroo's nest is at coordinate X, and he wants to travel to coordinate X as fast as possible.
Find the earliest possible time to reach coordinate X.




Constraints
X is an integer.
1≤X≤10^9







InputThe input is given from Standard Input in the following format:
X





OutputPrint the earliest possible time for the kangaroo to reach coordinate X.






Sample Input 16





Sample Output 13

The kangaroo can reach his nest at time 3 by jumping to the right three times, which is the earliest possible time.





Sample Input 22





Sample Output 22

He can reach his nest at time 2 by staying at his position during the first second, and jumping to the right at the next second.





Sample Input 311





Sample Output 35


",Go Home,"Arithmetic, Greedy Algorithm, Parity, Binary Search, Bruteforcing",0.677,47,28
1026,"
Score : 700 points


Problem StatementThere is a circle with a circumference of L.
Each point on the circumference has a coordinate value, which represents the arc length from a certain reference point clockwise to the point.
On this circumference, there are N ants.
These ants are numbered 1 through N in order of increasing coordinate, and ant i is at coordinate X_i.
The N ants have just started walking.
For each ant i, you are given the initial direction W_i. Ant i is initially walking clockwise if W_i is 1; counterclockwise if W_i is 2.
Every ant walks at a constant speed of 1 per second.
Sometimes, two ants bump into each other.
Each of these two ants will then turn around and start walking in the opposite direction.
For each ant, find its position after T seconds.




Constraints
All input values are integers.
1 \leq N \leq 10^5
1 \leq L \leq 10^9
1 \leq T \leq 10^9
0 \leq X_1 < X_2 < ... < X_N \leq L - 1
1 \leq W_i \leq 2







InputThe input is given from Standard Input in the following format:
N L T
X_1 W_1
X_2 W_2
:
X_N W_N





OutputPrint N lines.
The i-th line should contain the coordinate of ant i after T seconds. Here, each coordinate must be between 0 and L-1, inclusive.






Sample Input 13 8 3
0 1
3 2
6 1





Sample Output 11
3
0

1.5 seconds after the ants start walking, ant 1 and 2 bump into each other at coordinate 1.5.
1 second after that, ant 1 and 3 bump into each other at coordinate 0.5.
0.5 seconds after that, that is, 3 seconds after the ants start walking, ants 1, 2 and 3 are at coordinates 1, 3 and 0, respectively.





Sample Input 24 20 9
7 2
9 1
12 1
18 1





Sample Output 27
18
18
1


",Ants on a Circle,"Arithmetic, Simulation, Sorting, Array",0.071,55,6
1027,"
Score : 900 points


Problem StatementAtCoDeer the deer has N square tiles. The tiles are numbered 1 through N, and the number given to each tile is written on one side of the tile. Also, each corner of each tile is painted in one of the 1000 colors, which are represented by the integers 0 between 999. The top-left, top-right, bottom-right and bottom-left corner of the tile with the number i are painted in color C_{i,0}, C_{i,1}, C_{i,2} and C_{i,3}, respectively, when seen in the direction of the number written on the tile (See Figure 1).


Figure 1: The correspondence between the colors of a tile and the input

AtCoDeer is constructing a cube using six of these tiles, under the following conditions:

For each tile, the side with the number must face outward.
For each vertex of the cube, the three corners of the tiles that forms it must all be painted in the same color.

Help him by finding the number of the different cubes that can be constructed under the conditions.
Since each tile has a number written on it, two cubes are considered different if the set of the used tiles are different, or the tiles are used in different directions, even if the formation of the colors are the same. (Each tile can be used in one of the four directions, obtained by 90° rotations.) Two cubes are considered the same only if rotating one in the three dimensional space can obtain an exact copy of the other, including the directions of the tiles.


Figure 2: The four directions of a tile





Constraints
6≦N≦400
0≦C_{i,j}≦999 (1≦i≦N , 0≦j≦3)







InputThe input is given from Standard Input in the following format:
N
C_{1,0} C_{1,1} C_{1,2} C_{1,3}
C_{2,0} C_{2,1} C_{2,2} C_{2,3}
:
C_{N,0} C_{N,1} C_{N,2} C_{N,3}





OutputPrint the number of the different cubes that can be constructed under the conditions.






Sample Input 16
0 1 2 3
0 4 6 1
1 6 7 2
2 7 5 3
6 4 5 7
4 0 3 5





Sample Output 11

The cube below can be constructed.






Sample Input 28
0 0 0 0
0 0 1 1
0 1 0 1
0 1 1 0
1 0 0 1
1 0 1 0
1 1 0 0
1 1 1 1





Sample Output 2144






Sample Input 36
0 0 0 0
0 0 0 0
0 0 0 0
0 0 0 0
0 0 0 0
0 0 0 0





Sample Output 3122880


",Building Cubes with AtCoDeer,"Enumeration, Bitmask, Hashing, Geometry; 3d, Backtracking, Counting, Bruteforcing, Arithmetic",0.333,19,5
1028,"
Score : 200 points


Problem StatementSnuke is interested in strings that satisfy the following conditions:

The length of the string is at least N.
The first N characters equal to the string s.
The last N characters equal to the string t.

Find the length of the shortest string that satisfies the conditions.




Constraints
1≤N≤100
The lengths of s and t are both N.
s and t consist of lowercase English letters.







InputThe input is given from Standard Input in the following format:
N
s
t





OutputPrint the length of the shortest string that satisfies the conditions.






Sample Input 13
abc
cde





Sample Output 15

The shortest string is abcde.





Sample Input 21
a
z





Sample Output 22

The shortest string is az.





Sample Input 34
expr
expr





Sample Output 34

The shortest string is expr.

",Prefix and Suffix,"String, Greedy Algorithm, Bruteforcing",0.673,93,43
1029,"
Score : 300 points


Problem StatementTwo foxes Jiro and Saburo are playing a game called 1D Reversi. This game is played on a board, using black and white stones. On the board, stones are placed in a row, and each player places a new stone to either end of the row. Similarly to the original game of Reversi, when a white stone is placed, all black stones between the new white stone and another white stone, turn into white stones, and vice versa.
In the middle of a game, something came up and Saburo has to leave the game. The state of the board at this point is described by a string S. There are |S| (the length of S) stones on the board, and each character in S represents the color of the i-th (1 ≦ i ≦ |S|) stone from the left. If the i-th character in S is B, it means that the color of the corresponding stone on the board is black. Similarly, if the i-th character in S is W, it means that the color of the corresponding stone is white.
Jiro wants all stones on the board to be of the same color. For this purpose, he will place new stones on the board according to the rules. Find the minimum number of new stones that he needs to place.




Constraints
1 ≦ |S| ≦ 10^5
Each character in S is B or W.







InputThe input is given from Standard Input in the following format:
S





OutputPrint the minimum number of new stones that Jiro needs to place for his purpose.






Sample Input 1BBBWW





Sample Output 11

By placing a new black stone to the right end of the row of stones, all white stones will become black. Also, by placing a new white stone to the left end of the row of stones, all black stones will become white.
In either way, Jiro's purpose can be achieved by placing one stone.





Sample Input 2WWWWWW





Sample Output 20

If all stones are already of the same color, no new stone is necessary.





Sample Input 3WBWBWBWBWB





Sample Output 39


",1D Reversi,"Greedy Algorithm, String, Counting",0.824,27,17
1030,"
Score : 400 points


Problem StatementThere are N towns located in a line, conveniently numbered 1 through N. Takahashi the merchant is going on a travel from town 1 to town N, buying and selling apples.
Takahashi will begin the travel at town 1, with no apple in his possession. The actions that can be performed during the travel are as follows:

Move: When at town i (i < N), move to town i + 1.
Merchandise: Buy or sell an arbitrary number of apples at the current town. Here, it is assumed that one apple can always be bought and sold for A_i yen (the currency of Japan) at town i (1 ≦ i ≦ N), where A_i are distinct integers. Also, you can assume that he has an infinite supply of money.

For some reason, there is a constraint on merchandising apple during the travel: the sum of the number of apples bought and the number of apples sold during the whole travel, must be at most T. (Note that a single apple can be counted in both.)
During the travel, Takahashi will perform actions so that the profit of the travel is maximized. Here, the profit of the travel is the amount of money that is gained by selling apples, minus the amount of money that is spent on buying apples. Note that we are not interested in apples in his possession at the end of the travel.
Aoki, a business rival of Takahashi, wants to trouble Takahashi by manipulating the market price of apples. Prior to the beginning of Takahashi's travel, Aoki can change A_i into another arbitrary non-negative integer A_i' for any town i, any number of times. The cost of performing this operation is |A_i - A_i'|. After performing this operation, different towns may have equal values of A_i.
Aoki's objective is to decrease Takahashi's expected profit by at least 1 yen. Find the minimum total cost to achieve it. You may assume that Takahashi's expected profit is initially at least 1 yen.




Constraints
1 ≦ N ≦ 10^5
1 ≦ A_i ≦ 10^9 (1 ≦ i ≦ N)
A_i are distinct.
2 ≦ T ≦ 10^9
In the initial state, Takahashi's expected profit is at least 1 yen.







InputThe input is given from Standard Input in the following format:
N T
A_1 A_2 ... A_N





OutputPrint the minimum total cost to decrease Takahashi's expected profit by at least 1 yen.






Sample Input 13 2
100 50 200





Sample Output 11

In the initial state, Takahashi can achieve the maximum profit of 150 yen as follows:

Move from town 1 to town 2.
Buy one apple for 50 yen at town 2.
Move from town 2 to town 3.
Sell one apple for 200 yen at town 3.

If, for example, Aoki changes the price of an apple at town 2 from 50 yen to 51 yen, Takahashi will not be able to achieve the profit of 150 yen. The cost of performing this operation is 1, thus the answer is 1.
There are other ways to decrease Takahashi's expected profit, such as changing the price of an apple at town 3 from 200 yen to 199 yen.





Sample Input 25 8
50 30 40 10 20





Sample Output 22






Sample Input 310 100
7 10 4 5 9 3 6 8 2 1





Sample Output 32


",An Invisible Hand,"Array, Data Structure, Prefix sum, Counting, Greedy Algorithm",0.643,26,14
1031,"
Score : 800 points


Problem StatementWe have a tree with N vertices. The vertices are numbered 1, 2, ..., N. The i-th (1 ≦ i ≦ N - 1) edge connects the two vertices A_i and B_i.
Takahashi wrote integers into K of the vertices. Specifically, for each 1 ≦ j ≦ K, he wrote the integer P_j into vertex V_j. The remaining vertices are left empty. After that, he got tired and fell asleep.
Then, Aoki appeared. He is trying to surprise Takahashi by writing integers into all empty vertices so that the following condition is satisfied:

Condition: For any two vertices directly connected by an edge, the integers written into these vertices differ by exactly 1.

Determine if it is possible to write integers into all empty vertices so that the condition is satisfied. If the answer is positive, find one specific way to satisfy the condition.




Constraints
1 ≦ N ≦ 10^5
1 ≦ K ≦ N
1 ≦ A_i, B_i ≦ N (1 ≦ i ≦ N - 1)
1 ≦ V_j ≦ N (1 ≦ j ≦ K) (21:18, a mistake in this constraint was corrected)
0 ≦ P_j ≦ 10^5 (1 ≦ j ≦ K)
The given graph is a tree.
All v_j are distinct.







InputThe input is given from Standard Input in the following format:
N
A_1 B_1
A_2 B_2
:
A_{N-1} B_{N-1}
K
V_1 P_1
V_2 P_2
:
V_K P_K





OutputIf it is possible to write integers into all empty vertices so that the condition is satisfied, print Yes. Otherwise, print No.
If it is possible to satisfy the condition, print N lines in addition. The v-th (1 ≦ v ≦ N) of these N lines should contain the integer that should be written into vertex v. If there are multiple ways to satisfy the condition, any of those is accepted.






Sample Input 15
1 2
3 1
4 3
3 5
2
2 6
5 7





Sample Output 1Yes
5
6
6
5
7

The figure below shows the tree when Takahashi fell asleep. For each vertex, the integer written beside it represents the index of the vertex, and the integer written into the vertex is the integer written by Takahashi.



Aoki can, for example, satisfy the condition by writing integers into the remaining vertices as follows:



This corresponds to Sample Output 1. Note that other outputs that satisfy the condition will also be accepted, such as:
Yes
7
6
8
7
7






Sample Input 25
1 2
3 1
4 3
3 5
3
2 6
4 3
5 7





Sample Output 2No






Sample Input 34
1 2
2 3
3 4
1
1 0





Sample Output 3Yes
0
-1
-2
-3

The integers written by Aoki may be negative or exceed 10^6.

",Integers on a Tree,"Graph Theory, Depth-first Search, Backtracking, Sorting, Tree",0.286,23,6
1032,"
Score : 1200 points


Problem Statement
Imagine a game played on a line. Initially, the player is located at position 0 with N candies in his possession, and the exit is at position E. There are also N bears in the game. The i-th bear is located at x_i. The maximum moving speed of the player is 1 while the bears do not move at all.
When the player gives a candy to a bear, it will provide a coin after T units of time. More specifically, if the i-th bear is given a candy at time t, it will put a coin at its position at time t+T. The purpose of this game is to give candies to all the bears, pick up all the coins, and go to the exit. Note that the player can only give a candy to a bear if the player is at the exact same position of the bear. Also, each bear will only produce a coin once. If the player visits the position of a coin after or at the exact same time that the coin is put down, the player can pick up the coin. Coins do not disappear until collected by the player.
Shik is an expert of this game. He can give candies to bears and pick up coins instantly. You are given the configuration of the game. Please calculate the minimum time Shik needs to collect all the coins and go to the exit.




Constraints
1 \leq N \leq 100,000
1 \leq T, E \leq 10^9
0 < x_i < E
x_i < x_{i+1} for 1 \leq i < N
All input values are integers.





Partial Scores
In test cases worth 600 points, N \leq 2,000.







InputThe input is given from Standard Input in the following format:
N E T
x_1 x_2 ... x_N





OutputPrint an integer denoting the answer.






Sample Input 13 9 1
1 3 8





Sample Output 112

The optimal strategy is to wait for the coin after treating each bear. The total time spent on waiting is 3 and moving is 9. So the answer is 3 + 9 = 12.





Sample Input 23 9 3
1 3 8





Sample Output 216






Sample Input 32 1000000000 1000000000
1 999999999





Sample Output 32999999996


",Shik and Game,"Dyanmic Programming, Two-pointer, Binary Search, Monotonic Stack, Mathematics, Greedy Algorithm",0.571,34,6
1033,"
Score : 300 points


Problem StatementSnuke has decided to play with a six-sided die. Each of its six sides shows an integer 1 through 6, and two numbers on opposite sides always add up to 7.
Snuke will first put the die on the table with an arbitrary side facing upward, then repeatedly perform the following operation:

Operation: Rotate the die 90° toward one of the following directions: left, right, front (the die will come closer) and back (the die will go farther). Then, obtain y points where y is the number written in the side facing upward.

For example, let us consider the situation where the side showing 1 faces upward, the near side shows 5 and the right side shows 4, as illustrated in the figure.
If the die is rotated toward the right as shown in the figure, the side showing 3 will face upward.
Besides, the side showing 4 will face upward if the die is rotated toward the left, the side showing 2 will face upward if the die is rotated toward the front, and the side showing 5 will face upward if the die is rotated toward the back.



Find the minimum number of operation Snuke needs to perform in order to score at least x points in total.




Constraints
1 ≦ x ≦ 10^{15}
x is an integer.







InputThe input is given from Standard Input in the following format:
x





OutputPrint the answer.






Sample Input 17





Sample Output 12






Sample Input 2149696127901





Sample Output 227217477801


",X: Yet Another Die Game,"Arithmetic, Greedy Algorithm, Mathematics, Boolean Operations On Geometric Objects",0.455,68,27
1034,"
Score : 700 points


Problem StatementSnuke has decided to play a game, where the player runs a railway company.
There are M+1 stations on Snuke Line, numbered 0 through M.
A train on Snuke Line stops at station 0 and every d-th station thereafter, where d is a predetermined constant for each train.
For example, if d = 3, the train stops at station 0, 3, 6, 9, and so forth.
There are N kinds of souvenirs sold in areas around Snuke Line. The i-th kind of souvenirs can be purchased when the train stops at one of the following stations: stations l_i, l_i+1, l_i+2, ..., r_i.
There are M values of d, the interval between two stops, for trains on Snuke Line: 1, 2, 3, ..., M.
For each of these M values, find the number of the kinds of souvenirs that can be purchased if one takes a train with that value of d at station 0.
Here, assume that it is not allowed to change trains.




Constraints
1 ≦ N ≦ 3 × 10^{5}
1 ≦ M ≦ 10^{5}
1 ≦ l_i ≦ r_i ≦ M







InputThe input is given from Standard Input in the following format:
N M
l_1 r_1
:
l_{N} r_{N}





OutputPrint the answer in M lines. The i-th line should contain the maximum number of the kinds of souvenirs that can be purchased if one takes a train stopping every i-th station.






Sample Input 13 3
1 2
2 3
3 3





Sample Output 13
2
2


If one takes a train stopping every station, three kinds of souvenirs can be purchased: kind 1, 2 and 3.
If one takes a train stopping every second station, two kinds of souvenirs can be purchased: kind 1 and 2.
If one takes a train stopping every third station, two kinds of souvenirs can be purchased: kind 2 and 3.






Sample Input 27 9
1 7
5 9
5 7
5 9
1 1
6 8
3 4





Sample Output 27
6
6
5
4
5
5
3
2


",Snuke Line,"Binary Indexed Tree, Sorting, Recursion, Segment Tree With Lazy Propagation, Arithmetic",0.357,58,29
1035,"
Score : 1300 points


Problem StatementThere is a square-shaped grid with N vertical rows and N horizontal columns.
We will denote the square at the i-th row from the top and the j-th column from the left as (i,\ j).
Initially, each square is either white or black.
The initial color of the grid is given to you as characters a_{ij}, arranged in a square shape.
If the square (i,\ j) is white, a_{ij} is .. If it is black, a_{ij} is #.
You are developing a robot that repaints the grid.
It can repeatedly perform the following operation:

Select two integers i, j (1 ≤ i,\ j ≤ N). Memorize the colors of the squares (i,\ 1), (i,\ 2), ..., (i,\ N) as c_1, c_2, ..., c_N, respectively. Then, repaint the squares (1,\ j), (2,\ j), ..., (N,\ j) with the colors c_1, c_2, ..., c_N, respectively.

Your objective is to turn all the squares black.
Determine whether it is possible, and find the minimum necessary number of operations to achieve it if the answer is positive.




Constraints
2 ≤ N ≤ 500
a_{ij} is either . or #.





Partial Score
In a test set worth 300 points, N ≤ 3.







InputThe input is given from Standard Input in the following format:
N
a_{11}...a_{1N}
:
a_{N1}...a_{NN}





OutputIf it is possible to turn all the squares black, print the minimum necessary number of operations to achieve the objective.
If it is impossible, print -1 instead.






Sample Input 12
#.
.#





Sample Output 13

For example, perform the operation as follows:

Select i = 1, j = 2.
Select i = 1, j = 1.
Select i = 1, j = 2.

The transition of the colors of the squares is shown in the figure below:








Sample Input 22
..
..





Sample Output 2-1






Sample Input 32
##
##





Sample Output 30






Sample Input 43
.#.
###
.#.





Sample Output 42






Sample Input 53
...
.#.
...





Sample Output 55


",Row to Column,"Matrix, Counting, Greedy Algorithm, Boolean Operations On Geometric Objects, Mathematics",0.222,18,5
1036,"
Score : 600 points


Problem StatementYou are given a forest with N vertices and M edges. The vertices are numbered 0 through N-1.
The edges are given in the format (x_i,y_i), which means that Vertex x_i and y_i are connected by an edge.
Each vertex i has a value a_i.
You want to add edges in the given forest so that the forest becomes connected.
To add an edge, you choose two different vertices i and j, then span an edge between i and j.
This operation costs a_i + a_j dollars, and afterward neither Vertex i nor j can be selected again.
Find the minimum total cost required to make the forest connected, or print Impossible if it is impossible.




Constraints
1 ≤ N ≤ 100,000
0 ≤ M ≤ N-1
1 ≤ a_i ≤ 10^9
0 ≤ x_i,y_i ≤ N-1
The given graph is a forest.
All input values are integers.







InputInput is given from Standard Input in the following format:
N M
a_0 a_1 .. a_{N-1}
x_1 y_1
x_2 y_2
:
x_M y_M





OutputPrint the minimum total cost required to make the forest connected, or print Impossible if it is impossible.






Sample Input 17 5
1 2 3 4 5 6 7
3 0
4 0
1 2
1 3
5 6





Sample Output 17

If we connect vertices 0 and 5, the graph becomes connected, for the cost of 1 + 6 = 7 dollars.





Sample Input 25 0
3 1 4 1 5





Sample Output 2Impossible

We can't make the graph connected.





Sample Input 31 0
5





Sample Output 30

The graph is already connected, so we do not need to add any edges.

",Forest,"Graph Traversal, Graph Theory, Greedy Algorithm, Priority Queue, Minimum Spanning Tree, Mathematics",0.235,78,13
1037,"
Score : 400 points


Problem StatementThere are N towns located in a line, conveniently numbered 1 through N. Takahashi the merchant is going on a travel from town 1 to town N, buying and selling apples.
Takahashi will begin the travel at town 1, with no apple in his possession. The actions that can be performed during the travel are as follows:

Move: When at town i (i < N), move to town i + 1.
Merchandise: Buy or sell an arbitrary number of apples at the current town. Here, it is assumed that one apple can always be bought and sold for A_i yen (the currency of Japan) at town i (1 ≦ i ≦ N), where A_i are distinct integers. Also, you can assume that he has an infinite supply of money.

For some reason, there is a constraint on merchandising apple during the travel: the sum of the number of apples bought and the number of apples sold during the whole travel, must be at most T. (Note that a single apple can be counted in both.)
During the travel, Takahashi will perform actions so that the profit of the travel is maximized. Here, the profit of the travel is the amount of money that is gained by selling apples, minus the amount of money that is spent on buying apples. Note that we are not interested in apples in his possession at the end of the travel.
Aoki, a business rival of Takahashi, wants to trouble Takahashi by manipulating the market price of apples. Prior to the beginning of Takahashi's travel, Aoki can change A_i into another arbitrary non-negative integer A_i' for any town i, any number of times. The cost of performing this operation is |A_i - A_i'|. After performing this operation, different towns may have equal values of A_i.
Aoki's objective is to decrease Takahashi's expected profit by at least 1 yen. Find the minimum total cost to achieve it. You may assume that Takahashi's expected profit is initially at least 1 yen.




Constraints
1 ≦ N ≦ 10^5
1 ≦ A_i ≦ 10^9 (1 ≦ i ≦ N)
A_i are distinct.
2 ≦ T ≦ 10^9
In the initial state, Takahashi's expected profit is at least 1 yen.







InputThe input is given from Standard Input in the following format:
N T
A_1 A_2 ... A_N





OutputPrint the minimum total cost to decrease Takahashi's expected profit by at least 1 yen.






Sample Input 13 2
100 50 200





Sample Output 11

In the initial state, Takahashi can achieve the maximum profit of 150 yen as follows:

Move from town 1 to town 2.
Buy one apple for 50 yen at town 2.
Move from town 2 to town 3.
Sell one apple for 200 yen at town 3.

If, for example, Aoki changes the price of an apple at town 2 from 50 yen to 51 yen, Takahashi will not be able to achieve the profit of 150 yen. The cost of performing this operation is 1, thus the answer is 1.
There are other ways to decrease Takahashi's expected profit, such as changing the price of an apple at town 3 from 200 yen to 199 yen.





Sample Input 25 8
50 30 40 10 20





Sample Output 22






Sample Input 310 100
7 10 4 5 9 3 6 8 2 1





Sample Output 32


",An Invisible Hand,"Greedy Algorithm, Counting, Mathematics, Graph Theory",0.667,55,27
1038,"
Score : 700 points


Problem StatementN people are waiting in a single line in front of the Takahashi Store. The cash on hand of the i-th person from the front of the line is a positive integer A_i.
Mr. Takahashi, the shop owner, has decided on the following scheme: He picks a product, sets a positive integer P indicating its price, and shows this product to customers in order, starting from the front of the line. This step is repeated as described below.
At each step, when a product is shown to a customer, if price P is equal to or less than the cash held by that customer at the time, the customer buys the product and Mr. Takahashi ends the current step. That is, the cash held by the first customer in line with cash equal to or greater than P decreases by P, and the next step begins.
Mr. Takahashi can set the value of positive integer P independently at each step.
He would like to sell as many products as possible. However, if a customer were to end up with 0 cash on hand after a purchase, that person would not have the fare to go home. Customers not being able to go home would be a problem for Mr. Takahashi, so he does not want anyone to end up with 0 cash.
Help out Mr. Takahashi by writing a program that determines the maximum number of products he can sell, when the initial cash in possession of each customer is given.




Constraints
1 ≦ | N | ≦ 100000
1 ≦ A_i ≦ 10^9(1 ≦ i ≦ N)
All inputs are integers.







InputInputs are provided from Standard Inputs in the following form.
N
A_1
:
A_N





OutputOutput an integer representing the maximum number of products Mr. Takahashi can sell.






Sample Input 13
3
2
5





Sample Output 13

As values of P, select in order 1, 4, 1.





Sample Input 215
3
1
4
1
5
9
2
6
5
3
5
8
9
7
9





Sample Output 218


",Greedy customers,"Greedy Algorithm, Arithmetic, Bruteforcing, Boolean Operations On Geometric Objects",0.176,65,15
1039,"
Score : 1300 points


Problem StatementWe have a pyramid with N steps, built with blocks.
The steps are numbered 1 through N from top to bottom.
For each 1≤i≤N, step i consists of 2i-1 blocks aligned horizontally.
The pyramid is built so that the blocks at the centers of the steps are aligned vertically.


A pyramid with N=4 steps

Snuke wrote a permutation of (1, 2, ..., 2N-1) into the blocks of step N.
Then, he wrote integers into all remaining blocks, under the following rule:

The integer written into a block b must be equal to the median of the three integers written into the three blocks directly under b, or to the lower left or lower right of b.



Writing integers into the blocks

Afterwards, he erased all integers written into the blocks.
Now, he only remembers that the permutation written into the blocks of step N was (a_1, a_2, ..., a_{2N-1}).
Find the integer written into the block of step 1.




Constraints
2≤N≤10^5
(a_1, a_2, ..., a_{2N-1}) is a permutation of (1, 2, ..., 2N-1).







InputThe input is given from Standard Input in the following format:
N
a_1 a_2 ... a_{2N-1}





OutputPrint the integer written into the block of step 1.






Sample Input 14
1 6 3 7 4 5 2





Sample Output 14

This case corresponds to the figure in the problem statement.





Sample Input 22
1 2 3





Sample Output 22


",Median Pyramid Hard,"Binary Search, Bitmask, Two-pointer, Dynamic Programming, Permutation Cycle Decomposition",0.0,21,4
1040,"
Score : 800 points


Problem StatementThere are N rabbits on a number line.
The rabbits are conveniently numbered 1 through N.
The coordinate of the initial position of rabbit i is x_i.
The rabbits will now take exercise on the number line, by performing sets described below.
A set consists of M jumps. The j-th jump of a set is performed by rabbit a_j (2≤a_j≤N-1).
For this jump, either rabbit a_j-1 or rabbit a_j+1 is chosen with equal probability (let the chosen rabbit be rabbit x), then rabbit a_j will jump to the symmetric point of its current position with respect to rabbit x.
The rabbits will perform K sets in succession.
For each rabbit, find the expected value of the coordinate of its eventual position after K sets are performed.




Constraints
3≤N≤10^5
x_i is an integer.
|x_i|≤10^9
1≤M≤10^5
2≤a_j≤N-1
1≤K≤10^{18}







InputThe input is given from Standard Input in the following format:
N
x_1 x_2 ... x_N
M K
a_1 a_2 ... a_M





OutputPrint N lines.
The i-th line should contain the expected value of the coordinate of the eventual position of rabbit i after K sets are performed.
The output is considered correct if the absolute or relative error is at most 10^{-9}.






Sample Input 13
-1 0 2
1 1
2





Sample Output 1-1.0
1.0
2.0

Rabbit 2 will perform the jump.
If rabbit 1 is chosen, the coordinate of the destination will be -2.
If rabbit 3 is chosen, the coordinate of the destination will be 4.
Thus, the expected value of the coordinate of the eventual position of rabbit 2 is 0.5×(-2)+0.5×4=1.0.





Sample Input 23
1 -1 1
2 2
2 2





Sample Output 21.0
-1.0
1.0

x_i may not be distinct.





Sample Input 35
0 1 3 6 10
3 10
2 3 4





Sample Output 30.0
3.0
7.0
8.0
10.0


",Rabbit Exercise,"Permutation Cycle Decomposition, Mathematics, Array, Mathematics, Exponentiation By Squaring, Probability Theory",0.0,27,4
1041,"
Score : 500 points


Problem StatementThere is a string s of length 3 or greater.
No two neighboring characters in s are equal.
Takahashi and Aoki will play a game against each other.
The two players alternately performs the following operation, Takahashi going first:

Remove one of the characters in s, excluding both ends. However, a character cannot be removed if removal of the character would result in two neighboring equal characters in s.

The player who becomes unable to perform the operation, loses the game. Determine which player will win when the two play optimally.




Constraints
3 ≤ |s| ≤ 10^5
s consists of lowercase English letters.
No two neighboring characters in s are equal.







InputThe input is given from Standard Input in the following format:
s





OutputIf Takahashi will win, print First. If Aoki will win, print Second.






Sample Input 1aba





Sample Output 1Second

Takahashi, who goes first, cannot perform the operation, since removal of the b, which is the only character not at either ends of s, would result in s becoming aa, with two as neighboring.





Sample Input 2abc





Sample Output 2First

When Takahashi removes b from s, it becomes ac.
Then, Aoki cannot perform the operation, since there is no character in s, excluding both ends.





Sample Input 3abcab





Sample Output 3First


",An Ordinary Game,"Game Theory, Arithmetic, Boolean Operations On Geometric Objects, Graph Theory",0.412,40,10
1042,"
Score : 300 points


Problem StatementThere are N people, conveniently numbered 1 through N.
They were standing in a row yesterday, but now they are unsure of the order in which they were standing.
However, each person remembered the following fact: the absolute difference of the number of the people who were standing to the left of that person, and the number of the people who were standing to the right of that person.
According to their reports, the difference above for person i is A_i.
Based on these reports, find the number of the possible orders in which they were standing.
Since it can be extremely large, print the answer modulo 10^9+7.
Note that the reports may be incorrect and thus there may be no consistent order.
In such a case, print 0.




Constraints
1≦N≦10^5
0≦A_i≦N-1







InputThe input is given from Standard Input in the following format:
N
A_1 A_2 ... A_N





OutputPrint the number of the possible orders in which they were standing, modulo 10^9+7.






Sample Input 15
2 4 4 0 2





Sample Output 14

There are four possible orders, as follows:

2,1,4,5,3
2,5,4,1,3
3,1,4,5,2
3,5,4,1,2






Sample Input 27
6 4 0 2 4 0 2





Sample Output 20

Any order would be inconsistent with the reports, thus the answer is 0.





Sample Input 38
7 5 1 1 7 3 5 3





Sample Output 316


",Lining Up,"Counting, Mathematics, String, Exponentiation By Squaring, Combinatorics",0.579,34,18
1043,"
Score : 600 points


Problem StatementNagase is a top student in high school. One day, she's analyzing some properties of special sets of positive integers.  
She thinks that a set S = \{a_{1}, a_{2}, ..., a_{N}\} of distinct positive integers is called special if for all 1 \leq i \leq N, the gcd (greatest common divisor) of a_{i} and the sum of the remaining elements of S is not 1.
Nagase wants to find a special set of size N. However, this task is too easy, so she decided to ramp up the difficulty. Nagase challenges you to find a special set of size N such that the gcd of all elements are 1 and the elements of the set does not exceed 30000.




Constraints
3 \leq N \leq 20000







InputInput is given from Standard Input in the following format:
N





OutputOutput N space-separated integers, denoting the elements of the set S. S must satisfy the following conditions :

The elements must be distinct positive integers not exceeding 30000.
The gcd of all elements of S is 1, i.e. there does not exist an integer d > 1 that divides all elements of S.
S is a special set.

If there are multiple solutions, you may output any of them. The elements of S may be printed in any order. It is guaranteed that at least one solution exist under the given contraints.






Sample Input 13





Sample Output 12 5 63

\{2, 5, 63\} is special because gcd(2, 5 + 63) = 2, gcd(5, 2 + 63) = 5, gcd(63, 2 + 5) = 7. Also, gcd(2, 5, 63) = 1. Thus, this set satisfies all the criteria.
Note that \{2, 4, 6\} is not a valid solution because gcd(2, 4, 6) = 2 > 1.





Sample Input 24





Sample Output 22 5 20 63

\{2, 5, 20, 63\} is special because gcd(2, 5 + 20 + 63) = 2, gcd(5, 2 + 20 + 63) = 5, gcd(20, 2 + 5 + 63) = 10, gcd(63, 2 + 5 + 20) = 9. Also, gcd(2, 5, 20, 63) = 1. Thus, this set satisfies all the criteria.

",GCD Sequence,"Euclidean Algorithm, Arithmetic, Constructive, Number Theory, Recursion, Greedy Algorithm",0.273,51,15
1044,"
Score : 500 points


Problem StatementOn a two-dimensional plane, there are m lines drawn parallel to the x axis, and n lines drawn parallel to the y axis.
Among the lines parallel to the x axis, the i-th from the bottom is represented by y = y_i.
Similarly, among the lines parallel to the y axis, the i-th from the left is represented by x = x_i.
For every rectangle that is formed by these lines, find its area, and print the total area modulo 10^9+7.
That is, for every quadruple (i,j,k,l) satisfying 1\leq i < j\leq n and 1\leq k < l\leq m, find the area of the rectangle formed by the lines x=x_i, x=x_j, y=y_k and y=y_l, and print the sum of these areas modulo 10^9+7.




Constraints
2 \leq n,m \leq 10^5
-10^9 \leq x_1 < ... < x_n \leq 10^9
-10^9 \leq y_1 < ... < y_m \leq 10^9
x_i and y_i are integers.







InputInput is given from Standard Input in the following format:
n m
x_1 x_2 ... x_n
y_1 y_2 ... y_m





OutputPrint the total area of the rectangles, modulo 10^9+7.






Sample Input 13 3
1 3 4
1 3 6





Sample Output 160

The following figure illustrates this input:

The total area of the nine rectangles A, B, ..., I shown in the following figure, is 60.






Sample Input 26 5
-790013317 -192321079 95834122 418379342 586260100 802780784
-253230108 193944314 363756450 712662868 735867677





Sample Output 2835067060


",###,"Mathematics, Arithmetic, Sorting, Prefix sum",0.292,50,18
1045,"
Score : 600 points


Problem StatementSnuke has an integer sequence, a, of length N. The i-th element of a (1-indexed) is a_{i}.
He can perform the following operation any number of times:

Operation: Choose integers x and y between 1 and N (inclusive), and add a_x to a_y.

He would like to perform this operation between 0 and 2N times (inclusive) so that a satisfies the condition below. Show one such sequence of operations.
It can be proved that such a sequence of operations always exists under the constraints in this problem.

Condition: a_1 \leq a_2 \leq ...  \leq a_{N}





Constraints
2 \leq N \leq 50
-10^{6} \leq a_i \leq 10^{6}
All input values are integers.







InputInput is given from Standard Input in the following format:
N
a_1 a_2 ... a_{N}





OutputLet m be the number of operations in your solution. In the first line, print m.
In the i-th of the subsequent m lines, print the numbers x and y chosen in the i-th operation, with a space in between.
The output will be considered correct if m is between 0 and 2N (inclusive) and a satisfies the condition after the m operations.






Sample Input 13
-2 5 -1





Sample Output 12
2 3
3 3


After the first operation, a = (-2,5,4).
After the second operation, a = (-2,5,8), and the condition is now satisfied.






Sample Input 22
-1 -3





Sample Output 21
2 1


After the first operation, a = (-4,-3) and the condition is now satisfied.






Sample Input 35
0 0 0 0 0





Sample Output 30


The condition is satisfied already in the beginning.


",Non-decreasing,"Greedy Algorithm, Array, Dynamic Programming, Boolean Operations On Geometric Objects",0.389,48,16
1046,"
Score : 1200 points


Problem StatementThere are N arrays.
The length of each array is M and initially each array contains integers (1，2，...，M) in this order.
Mr. Takahashi has decided to perform Q operations on those N arrays.
For the i-th (1≤i≤Q) time, he performs the following operation.

Choose an arbitrary array from the N arrays and move the integer a_i (1≤a_i≤M) to the front of that array. For example, after performing the operation on a_i=2 and the array (5，4，3，2，1), this array becomes (2，5，4，3，1).

Mr. Takahashi wants to make N arrays exactly the same after performing the Q operations.
Determine if it is possible or not.




Constraints
2≤N≤10^5
2≤M≤10^5
1≤Q≤10^5
1≤a_i≤M







InputThe input is given from Standard Input in the following format:
N M
Q
a_1 a_2 ... a_Q





OutputPrint Yes if it is possible to make N arrays exactly the same after performing the Q operations.
Otherwise, print No.






Sample Input 12 2
3
2 1 2





Sample Output 1Yes

You can perform the operations as follows.






Sample Input 23 2
3
2 1 2





Sample Output 2No






Sample Input 32 3
3
3 2 1





Sample Output 3Yes

You can perform the operations as follows.






Sample Input 43 3
6
1 2 2 3 3 3





Sample Output 4No


",LRU Puzzle,"Greedy Algorithm, Dynamic Programming, Set / Map, Hashing, Binary Search Tree, Array, Counting",0.0,11,2
1047,"
Score : 700 points


Problem Statement10^{10^{10}} participants, including Takahashi, competed in two programming contests.
In each contest, all participants had distinct ranks from first through 10^{10^{10}}-th.
The score of a participant is the product of his/her ranks in the two contests.
Process the following Q queries:

In the i-th query, you are given two positive integers A_i and B_i. Assuming that Takahashi was ranked A_i-th in the first contest and B_i-th in the second contest, find the maximum possible number of participants whose scores are smaller than Takahashi's.





Constraints
1 \leq Q \leq 100
1\leq A_i,B_i\leq 10^9(1\leq i\leq Q)
All values in input are integers.







InputInput is given from Standard Input in the following format:
Q
A_1 B_1
:
A_Q B_Q





OutputFor each query, print the maximum possible number of participants whose scores are smaller than Takahashi's.






Sample Input 18
1 4
10 5
3 3
4 11
8 9
22 40
8 36
314159265 358979323





Sample Output 11
12
4
11
14
57
31
671644785

Let us denote a participant who was ranked x-th in the first contest and y-th in the second contest as (x,y).
In the first query, (2,1) is a possible candidate of a participant whose score is smaller than Takahashi's. There are never two or more participants whose scores are smaller than Takahashi's, so we should print 1.

",Worst Case,Arithmetic,0.417,24,9
1048,"
Score : 100 points


Problem StatementThere is a grid with H rows and W columns.
The square at the i-th row and j-th column contains a string S_{i,j} of length 5.
The rows are labeled with the numbers from 1 through H, and the columns are labeled with the uppercase English letters from A through the W-th letter of the alphabet.

Exactly one of the squares in the grid contains the string snuke. Find this square and report its location.
For example, the square at the 6-th row and 8-th column should be reported as H6.




Constraints
1≦H, W≦26
The length of S_{i,j} is 5.
S_{i,j} consists of lowercase English letters (a-z).
Exactly one of the given strings is equal to snuke.







InputThe input is given from Standard Input in the following format:
H W
S_{1,1} S_{1,2} ... S_{1,W}
S_{2,1} S_{2,2} ... S_{2,W}
:
S_{H,1} S_{H,2} ... S_{H,W}





OutputPrint the labels of the row and the column of the square containing the string snuke, with no space inbetween.






Sample Input 115 10
snake snake snake snake snake snake snake snake snake snake
snake snake snake snake snake snake snake snake snake snake
snake snake snake snake snake snake snake snake snake snake
snake snake snake snake snake snake snake snake snake snake
snake snake snake snake snake snake snake snake snake snake
snake snake snake snake snake snake snake snuke snake snake
snake snake snake snake snake snake snake snake snake snake
snake snake snake snake snake snake snake snake snake snake
snake snake snake snake snake snake snake snake snake snake
snake snake snake snake snake snake snake snake snake snake
snake snake snake snake snake snake snake snake snake snake
snake snake snake snake snake snake snake snake snake snake
snake snake snake snake snake snake snake snake snake snake
snake snake snake snake snake snake snake snake snake snake
snake snake snake snake snake snake snake snake snake snake





Sample Output 1H6






Sample Input 21 1
snuke





Sample Output 2A1


",Where's Snuke?,"Bruteforcing, String, Arithmetic",0.8,14,11
1049,"
Score : 300 points


Problem StatementThe problem set at CODE FESTIVAL 20XX Finals consists of N problems.
The score allocated to the i-th (1≦i≦N) problem is i points.
Takahashi, a contestant, is trying to score exactly N points. For that, he is deciding which problems to solve.
As problems with higher scores are harder, he wants to minimize the highest score of a problem among the ones solved by him.
Determine the set of problems that should be solved.




Constraints
1≦N≦10^7





Partial Score
200 points will be awarded for passing the test set satisfying 1≦N≦1000.
Additional 100 points will be awarded for passing the test set without additional constraints.







InputThe input is given from Standard Input in the following format:
N





OutputAmong the sets of problems with the total score of N, find a set in which the highest score of a problem is minimum, then print the indices of the problems in the set in any order, one per line.
If there exists more than one such set, any of them will be accepted.






Sample Input 14





Sample Output 11
3

Solving only the 4-th problem will also result in the total score of 4 points, but solving the 1-st and 3-rd problems will lower the highest score of a solved problem.





Sample Input 27





Sample Output 21
2
4

The set \{3,4\} will also be accepted.





Sample Input 31





Sample Output 31


",Exactly N points,"Arithmetic, Binary Search, Greedy Algorithm, Set / Map",0.4,14,6
1050,"
Score : 400 points


Problem StatementThere are N people standing on the x-axis.
Let the coordinate of Person i be x_i.
For every i, x_i is an integer between 0 and 10^9 (inclusive).
It is possible that more than one person is standing at the same coordinate.
You will given M pieces of information regarding the positions of these people.
The i-th piece of information has the form (L_i, R_i, D_i).
This means that Person R_i is to the right of Person L_i by D_i units of distance, that is, x_{R_i} - x_{L_i} = D_i holds.
It turns out that some of these M pieces of information may be incorrect.
Determine if there exists a set of values (x_1, x_2, ..., x_N) that is consistent with the given pieces of information.




Constraints
1 \leq N \leq 100 000
0 \leq M \leq 200 000
1 \leq L_i, R_i \leq N (1 \leq i \leq M)
0 \leq D_i \leq 10 000 (1 \leq i \leq M)
L_i \neq R_i (1 \leq i \leq M)
If i \neq j, then (L_i, R_i) \neq (L_j, R_j) and (L_i, R_i) \neq (R_j, L_j).
D_i are integers.







InputInput is given from Standard Input in the following format:
N M
L_1 R_1 D_1
L_2 R_2 D_2
:
L_M R_M D_M





OutputIf there exists a set of values (x_1, x_2, ..., x_N) that is consistent with all given pieces of information, print Yes; if it does not exist, print No.






Sample Input 13 3
1 2 1
2 3 1
1 3 2





Sample Output 1Yes

Some possible sets of values (x_1, x_2, x_3) are (0, 1, 2) and (101, 102, 103).





Sample Input 23 3
1 2 1
2 3 1
1 3 5





Sample Output 2No

If the first two pieces of information are correct, x_3 - x_1 = 2 holds, which is contradictory to the last piece of information.





Sample Input 34 3
2 1 1
2 3 5
3 4 2





Sample Output 3Yes






Sample Input 410 3
8 7 100
7 9 100
9 8 100





Sample Output 4No






Sample Input 5100 0





Sample Output 5Yes


",People on a Line,"Graph Theory, Graph Traversal, Backtracking, 2-sat, Disjoint Set",0.19,60,10
1051,"
(Please read problem A first. The maximum score you can get by solving this problem B is 1, which will have almost no effect on your ranking.)


Beginner's GuideLet's first write a program to calculate the score from a pair of input and output. You can know the total score by submitting your solution, or an official program to calculate a score is often provided for local evaluation as in this contest. Nevertheless, writing a score calculator by yourself is still useful to check your understanding of the problem specification. Moreover, the source code of the score calculator can often be reused for solving the problem or debugging your solution. So it is worthwhile to write a score calculator unless it is very complicated.




Problem StatementYou will be given a contest schedule for D days.
For each d=1,2,\ldots,D, calculate the satisfaction at the end of day d.






InputInput is given from Standard Input in the form of the input of Problem A followed by the output of Problem A.
D
c_1 c_2 \cdots c_{26}
s_{1,1} s_{1,2} \cdots s_{1,26}
\vdots
s_{D,1} s_{D,2} \cdots s_{D,26}
t_1
t_2
\vdots
t_D


The constraints and generation methods for the input part are the same as those for Problem A.
For each d, t_d is an integer satisfying 1\leq t_d \leq 26, and your program is expected to work correctly for any value that meets the constraints.





OutputLet v_d be the satisfaction at the end of day d.
Print D integers v_d to Standard Output in the following format:
v_1
v_2
\vdots
v_D







Sample Input 15
86 90 69 51 2 96 71 47 88 34 45 46 89 34 31 38 97 84 41 80 14 4 50 83 7 82
19771 12979 18912 10432 10544 12928 13403 3047 10527 9740 8100 92 2856 14730 1396 15905 6534 4650 11469 3628 8433 2994 10899 16396 18355 11424
6674 17707 13855 16407 12232 2886 11908 1705 5000 1537 10440 10711 4917 10770 17272 15364 19277 18094 3929 3705 7169 6159 18683 15410 9092 4570
6878 4239 19925 1799 375 9563 3445 5658 19857 11401 6997 6498 19933 3848 2426 2146 19745 16880 17773 18359 3921 14172 16730 11157 5439 256
8633 15862 15303 10749 18499 7792 10317 5901 9395 11433 3514 3959 5202 19850 19469 9790 5653 784 18500 10552 17975 16615 7852 197 8471 7452
19855 17918 7990 10572 4333 438 9140 9104 12622 4985 12319 4028 19922 12132 16259 17476 2976 547 19195 19830 16285 4806 4471 9457 2864 2192
1
17
13
14
13





Sample Output 118398
35037
51140
65837
79325

Note that this example is a small one for checking the problem specification. It does not satisfy the constraint D=365 and is never actually given as a test case.




Next StepWe can build a solution (schedule) for this problem in the order of day 1, day 2, and so on. And for every partial solution we have built, we can calculate the goodness (satisfaction) by using the above score calculator. So we can construct the following algorithm: for each d=1,2,\ldots,D, we select the contest type that maximizes the satisfaction at the end of day d. You may have already encountered this kind of ""greedy algorithms"" in algorithm contests such as ABC. Greedy algorithms can guarantee the optimality for several problems, but unfortunately, it doesn't ensure optimality for this problem. However, even if it does not ensure optimality, we can still obtain a reasonable solution in many cases. Let's go back to Problem A and implement the greedy algorithm by utilizing the score calculator you just implemented!
Greedy methods can be applied to a variety of problems, are easy to implement, and often run relatively fast compared to other methods. Greedy is often the most powerful method when we need to process huge inputs.
We can further improve the score by changing the greedy selection criteria (evaluation function), keeping multiple candidates instead of focusing on one best partial solution (beam search), or using the output of greedy algorithms as an initial solution of other methods.
For more information, please refer to the editorial that will be published after the contest.

",Scoring,"Array, Prefix sum, Simulation, Greedy Algorithm, Bruteforcing, Dynamic Programming, Arithmetic",0.914,46,35
1052,"
Score : 400 points


Problem StatementWe have N points in a two-dimensional plane.
The coordinates of the i-th point (1 \leq i \leq N) are (x_i,y_i).
Let us consider a rectangle whose sides are parallel to the coordinate axes that contains K or more of the N points in its interior.
Here, points on the sides of the rectangle are considered to be in the interior.
Find the minimum possible area of such a rectangle.  




Constraints
2 \leq K \leq N \leq 50 
-10^9 \leq x_i,y_i \leq 10^9 (1 \leq i \leq N) 
x_i≠x_j (1 \leq i<j \leq N) 
y_i≠y_j (1 \leq i<j \leq N) 
All input values are integers. (Added at 21:50 JST)  







InputInput is given from Standard Input in the following format:  
N K  
x_1 y_1
:  
x_{N} y_{N}





OutputPrint the minimum possible area of a rectangle that satisfies the condition.  






Sample Input 14 4
1 4
3 3
6 2
8 1





Sample Output 121

One rectangle that satisfies the condition with the minimum possible area has the following vertices: (1,1), (8,1), (1,4) and (8,4).
Its area is (8-1) × (4-1) = 21.  





Sample Input 24 2
0 0
1 1
2 2
3 3





Sample Output 21






Sample Input 34 3
-1000000000 -1000000000
1000000000 1000000000
-999999999 999999999
999999999 -999999999





Sample Output 33999999996000000001

Watch out for integer overflows.  

",Axis-Parallel Rectangle,"Sorting, Bruteforcing, Value / Coordinate Compression, Implementation, Data Structure, Arithmetic",0.444,63,25
1053,"
Score : 800 points


Problem StatementThere are N positive integers A_1, A_2, ..., A_N.
Takahashi can perform the following operation on these integers any number of times:

Choose 1 \leq i \leq N and multiply the value of A_i by -2.

Notice that he multiplies it by minus two.
He would like to make A_1 \leq A_2 \leq ... \leq A_N holds.
Find the minimum number of operations required. If it is impossible, print -1.




Constraints
1 \leq N \leq 200000
1 \leq A_i \leq 10^9







InputInput is given from Standard Input in the following format:
N
A_1 A_2 ... A_N





OutputPrint the answer.






Sample Input 14
3 1 4 1





Sample Output 13

One possible solution is:

Choose i=4 and multiply the value of A_4 by -2. A_1, A_2, A_3, A_4 are now 3, 1, 4, -2.
Choose i=1 and multiply the value of A_1 by -2. A_1, A_2, A_3, A_4 are now -6, 1, 4, -2.
Choose i=4 and multiply the value of A_4 by -2. A_1, A_2, A_3, A_4 are now -6, 1, 4, 4.






Sample Input 25
1 2 3 4 5





Sample Output 20

A_1 \leq A_2 \leq ... \leq A_N holds before any operation is performed.





Sample Input 38
657312726 129662684 181537270 324043958 468214806 916875077 825989291 319670097





Sample Output 37


",Negative Doubling,"Dyanmic Programming, Monotonic Stack, Two-pointer, Constructive, Dynamic Programming Using Bitfield, Segment Tree",0.167,13,2
1054,"
Score : 500 points


Problem StatementYou are given two integers A and B.
Print a grid where each square is painted white or black that satisfies the following conditions, in the format specified in Output section:

Let the size of the grid be h \times w (h vertical, w horizontal). Both h and w are at most 100.
The set of the squares painted white is divided into exactly A connected components.
The set of the squares painted black is divided into exactly B connected components.

It can be proved that there always exist one or more solutions under the conditions specified in Constraints section.
If there are multiple solutions, any of them may be printed.




NotesTwo squares painted white, c_1 and c_2, are called connected when the square c_2 can be reached from the square c_1 passing only white squares by repeatedly moving up, down, left or right to an adjacent square.
A set of squares painted white, S, forms a connected component when the following conditions are met:

Any two squares in S are connected.
No pair of a square painted white that is not included in S and a square included in S is connected.

A connected component of squares painted black is defined similarly.




Constraints
1 \leq A \leq 500
1 \leq B \leq 500







InputInput is given from Standard Input in the following format:
A B





OutputOutput should be in the following format:

In the first line, print integers h and w representing the size of the grid you constructed, with a space in between.
Then, print h more lines. The i-th (1 \leq i \leq h) of these lines should contain a string s_i as follows:
If the square at the i-th row and j-th column (1 \leq j \leq w) in the grid is painted white, the j-th character in s_i should be ..
If the square at the i-th row and j-th column (1 \leq j \leq w) in the grid is painted black, the j-th character in s_i should be #.









Sample Input 12 3





Sample Output 13 3
##.
..#
#.#

This output corresponds to the grid below:








Sample Input 27 8





Sample Output 23 5
#.#.#
.#.#.
#.#.#






Sample Input 31 1





Sample Output 34 2
..
#.
##
##






Sample Input 43 14





Sample Output 48 18
..................
..................
....##.......####.
....#.#.....#.....
...#...#....#.....
..#.###.#...#.....
.#.......#..#.....
#.........#..####.


",Grid Components,"Graph Theory, Grid Graph, Array, Constructive, Bruteforcing",0.286,53,21
1055,"
Score : 500 points


Problem StatementThere is a string s of length 3 or greater.
No two neighboring characters in s are equal.
Takahashi and Aoki will play a game against each other.
The two players alternately performs the following operation, Takahashi going first:

Remove one of the characters in s, excluding both ends. However, a character cannot be removed if removal of the character would result in two neighboring equal characters in s.

The player who becomes unable to perform the operation, loses the game. Determine which player will win when the two play optimally.




Constraints
3 ≤ |s| ≤ 10^5
s consists of lowercase English letters.
No two neighboring characters in s are equal.







InputThe input is given from Standard Input in the following format:
s





OutputIf Takahashi will win, print First. If Aoki will win, print Second.






Sample Input 1aba





Sample Output 1Second

Takahashi, who goes first, cannot perform the operation, since removal of the b, which is the only character not at either ends of s, would result in s becoming aa, with two as neighboring.





Sample Input 2abc





Sample Output 2First

When Takahashi removes b from s, it becomes ac.
Then, Aoki cannot perform the operation, since there is no character in s, excluding both ends.





Sample Input 3abcab





Sample Output 3First


",An Ordinary Game,"Parity, String, Game Theory, Boolean Operations On Geometric Objects",0.5,34,16
1056,"
Score : 500 points


Problem StatementA robot is put at the origin in a two-dimensional plane.
Initially, the robot is facing in the positive x-axis direction.
This robot will be given an instruction sequence s.
s consists of the following two kinds of letters, and will be executed in order from front to back.

F : Move in the current direction by distance 1.
T : Turn 90 degrees, either clockwise or counterclockwise.

The objective of the robot is to be at coordinates (x, y) after all the instructions are executed.
Determine whether this objective is achievable.




Constraints
s consists of F and T.
1 \leq |s| \leq 8 000
x and y are integers.
|x|, |y| \leq |s|







InputInput is given from Standard Input in the following format:
s
x y





OutputIf the objective is achievable, print Yes; if it is not, print No.






Sample Input 1FTFFTFFF
4 2





Sample Output 1Yes

The objective can be achieved by, for example, turning counterclockwise in the first T and turning clockwise in the second T.





Sample Input 2FTFFTFFF
-2 -2





Sample Output 2Yes

The objective can be achieved by, for example, turning clockwise in the first T and turning clockwise in the second T.





Sample Input 3FF
1 0





Sample Output 3No






Sample Input 4TF
1 0





Sample Output 4No






Sample Input 5FFTTFF
0 0





Sample Output 5Yes

The objective can be achieved by, for example, turning counterclockwise in the first T and turning counterclockwise in the second T.





Sample Input 6TTTT
1 0





Sample Output 6No


",FT Robot,"Dyanmic Programming, Graph Traversal, Bitmask, Parsing, Dynamic Programming",0.19,68,10
1057,"
Score : 400 points


Problem StatementWe have a permutation of the integers from 1 through N, p_1, p_2, .., p_N.
We also have M pairs of two integers between 1 and N (inclusive), represented as (x_1,y_1), (x_2,y_2), .., (x_M,y_M).
AtCoDeer the deer is going to perform the following operation on p as many times as desired so that the number of i (1 ≤ i ≤ N) such that p_i = i is maximized:

Choose j such that 1 ≤ j ≤ M, and swap p_{x_j} and p_{y_j}.

Find the maximum possible number of i such that p_i = i after operations.




Constraints
2 ≤ N ≤ 10^5
1 ≤ M ≤ 10^5
p is a permutation of integers from 1 through N.
1 ≤ x_j,y_j ≤ N
x_j ≠ y_j
If i ≠ j, \{x_i,y_i\} ≠ \{x_j,y_j\}.
All values in input are integers.







InputInput is given from Standard Input in the following format:
N M
p_1 p_2 .. p_N
x_1 y_1
x_2 y_2
:
x_M y_M





OutputPrint the maximum possible number of i such that p_i = i after operations.






Sample Input 15 2
5 3 1 4 2
1 3
5 4





Sample Output 12

If we perform the operation by choosing j=1, p becomes 1 3 5 4 2, which is optimal, so the answer is 2.





Sample Input 23 2
3 2 1
1 2
2 3





Sample Output 23

If we perform the operation by, for example, choosing j=1, j=2, j=1 in this order, p becomes 1 2 3, which is obviously optimal.
Note that we may choose the same j any number of times.





Sample Input 310 8
5 3 6 8 7 10 9 1 2 4
3 1
4 1
5 9
2 5
6 5
3 5
8 9
7 9





Sample Output 38






Sample Input 45 1
1 2 3 4 5
1 5





Sample Output 45

We do not have to perform the operation. 

",Equals,"Disjoint Set, Graph Theory, Graph Traversal, Combinatorics",0.788,72,40
1058,"
﻿Score : 400 points


Problem StatementIn the year 2168, AtCoder Inc., which is much larger than now, is starting a limited express train service called AtCoder Express.
In the plan developed by the president Takahashi, the trains will run as follows:

A train will run for (t_1 + t_2 + t_3 + ... + t_N) seconds.
In the first t_1 seconds, a train must run at a speed of at most v_1 m/s (meters per second). Similarly, in the subsequent t_2 seconds, a train must run at a speed of at most v_2 m/s, and so on.

According to the specifications of the trains, the acceleration of a train must be always within ±1m/s^2. Additionally, a train must stop at the beginning and the end of the run.
Find the maximum possible distance that a train can cover in the run.




Constraints
1 \leq N \leq 100
1 \leq t_i \leq 200
1 \leq v_i \leq 100
All input values are integers.







InputInput is given from Standard Input in the following format:
N
t_1 t_2 t_3 … t_N
v_1 v_2 v_3 … v_N





OutputPrint the maximum possible that a train can cover in the run.
Output is considered correct if its absolute difference from the judge's output is at most 10^{-3}.






Sample Input 11
100
30





Sample Output 12100.000000000000000


The maximum distance is achieved when a train runs as follows:

In the first 30 seconds, it accelerates at a rate of 1m/s^2, covering 450 meters.
In the subsequent 40 seconds, it maintains the velocity of 30m/s, covering 1200 meters.
In the last 30 seconds, it decelerates at the acceleration of -1m/s^2, covering 450 meters.

The total distance covered is 450 + 1200 + 450 = 2100 meters.





Sample Input 22
60 50
34 38





Sample Output 22632.000000000000000


The maximum distance is achieved when a train runs as follows:

In the first 34 seconds, it accelerates at a rate of 1m/s^2, covering 578 meters.
In the subsequent 26 seconds, it maintains the velocity of 34m/s, covering 884 meters.
In the subsequent 4 seconds, it accelerates at a rate of 1m/s^2, covering 144 meters.
In the subsequent 8 seconds, it maintains the velocity of 38m/s, covering 304 meters.
In the last 38 seconds, it decelerates at the acceleration of -1m/s^2, covering 722 meters.

The total distance covered is 578 + 884 + 144 + 304 + 722 = 2632 meters.





Sample Input 33
12 14 2
6 2 7





Sample Output 376.000000000000000


The maximum distance is achieved when a train runs as follows:

In the first 6 seconds, it accelerates at a rate of 1m/s^2, covering 18 meters.
In the subsequent 2 seconds, it maintains the velocity of 6m/s, covering 12 meters.
In the subsequent 4 seconds, it decelerates at the acceleration of -1m/s^2, covering 16 meters.
In the subsequent 14 seconds, it maintains the velocity of 2m/s, covering 28 meters.
In the last 2 seconds, it decelerates at the acceleration of -1m/s^2, covering 2 meters.

The total distance covered is 18 + 12 + 16 + 28 + 2 = 76 meters.





Sample Input 41
9
10





Sample Output 420.250000000000000000


The maximum distance is achieved when a train runs as follows:

In the first 4.5 seconds, it accelerates at a rate of 1m/s^2, covering 10.125 meters.
In the last 4.5 seconds, it decelerates at the acceleration of -1m/s^2, covering 10.125 meters.

The total distance covered is 10.125 + 10.125 = 20.25 meters.





Sample Input 510
64 55 27 35 76 119 7 18 49 100
29 19 31 39 27 48 41 87 55 70





Sample Output 520291.000000000000


",AtCoder Express,"Precomputation, Dyanmic Programming, Numerical Analysis, Array, Greedy Algorithm",0.45,48,22
1059,"
Score : 700 points


Problem StatementYou are given sequences A and B consisting of non-negative integers.
The lengths of both A and B are N, and the sums of the elements in A and B are equal.
The i-th element in A is A_i, and the i-th element in B is B_i.
Tozan and Gezan repeats the following sequence of operations:

If A and B are equal sequences, terminate the process.
Otherwise, first Tozan chooses a positive element in A and decrease it by 1.
Then, Gezan chooses a positive element in B and decrease it by 1.
Then, give one candy to Takahashi, their pet.

Tozan wants the number of candies given to Takahashi until the process is terminated to be as large as possible, while Gezan wants it to be as small as possible.
Find the number of candies given to Takahashi when both of them perform the operations optimally.




Constraints
1 \leq N \leq 2 × 10^5
0 \leq A_i,B_i \leq 10^9(1\leq i\leq N)
The sums of the elements in A and B are equal.
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
A_1 B_1
:
A_N B_N





OutputPrint the number of candies given to Takahashi when both Tozan and Gezan perform the operations optimally.






Sample Input 12
1 2
3 2





Sample Output 12

When both Tozan and Gezan perform the operations optimally, the process will proceed as follows:

Tozan decreases A_1 by 1.
Gezan decreases B_1 by 1.
One candy is given to Takahashi.
Tozan decreases A_2 by 1.
Gezan decreases B_1 by 1.
One candy is given to Takahashi.
As A and B are equal, the process is terminated.






Sample Input 23
8 3
0 1
4 8





Sample Output 29






Sample Input 31
1 1





Sample Output 30


",Tozan and Gezan,"Greedy Algorithm, Bruteforcing, Boolean Operations On Geometric Objects, Data Structure, Prefix sum",0.389,40,12
1060,"
Score : 700 points


Problem StatementThere is an H \times W grid (H vertical, W horizontal), where each square contains a lowercase English letter.
Specifically, the letter in the square at the i-th row and j-th column is equal to the j-th character in the string S_i.
Snuke can apply the following operation to this grid any number of times:

Choose two different rows and swap them. Or, choose two different columns and swap them.

Snuke wants this grid to be symmetric.
That is, for any 1 \leq i \leq H and 1 \leq j \leq W, the letter in the square at the i-th row and j-th column and the letter in the square at the (H + 1 - i)-th row and (W + 1 - j)-th column should be equal.
Determine if Snuke can achieve this objective.




Constraints
1 \leq H \leq 12
1 \leq W \leq 12
|S_i| = W
S_i consists of lowercase English letters.







InputInput is given from Standard Input in the following format:
H W
S_1
S_2
:
S_H





OutputIf Snuke can make the grid symmetric, print YES; if he cannot, print NO.






Sample Input 12 3
arc
rac





Sample Output 1YES

If the second and third columns from the left are swapped, the grid becomes symmetric, as shown in the image below:






Sample Input 23 7
atcoder
regular
contest





Sample Output 2NO






Sample Input 312 12
bimonigaloaf
faurwlkbleht
dexwimqxzxbb
lxdgyoifcxid
ydxiliocfdgx
nfoabgilamoi
ibxbdqmzxxwe
pqirylfrcrnf
wtehfkllbura
yfrnpflcrirq
wvcclwgiubrk
lkbrwgwuiccv





Sample Output 3YES


",Symmetric Grid,"Bipartite Graph, Graph Theory, Combinatorics, String",0.0,26,0
1061,"
Score : 700 points


Problem StatementTakahashi and Aoki will play a game with a number line and some segments.
Takahashi is standing on the number line and he is initially at coordinate 0.
Aoki has N segments. The i-th segment is [L_i,R_i], that is, a segment consisting of points with coordinates between L_i and R_i (inclusive).
The game has N steps. The i-th step proceeds as follows:

First, Aoki chooses a segment that is still not chosen yet from the N segments and tells it to Takahashi.
Then, Takahashi walks along the number line to some point within the segment chosen by Aoki this time.

After N steps are performed, Takahashi will return to coordinate 0 and the game ends.
Let K be the total distance traveled by Takahashi throughout the game. Aoki will choose segments so that K will be as large as possible, and Takahashi walks along the line so that K will be as small as possible. What will be the value of K in the end?




Constraints
1 ≤ N ≤ 10^5
-10^5 ≤ L_i < R_i ≤ 10^5
L_i and R_i are integers.







InputInput is given from Standard Input in the following format:
N
L_1 R_1
:
L_N R_N





OutputPrint the total distance traveled by Takahashi throughout the game when Takahashi and Aoki acts as above.
It is guaranteed that K is always an integer when L_i,R_i are integers.






Sample Input 13
-5 1
3 7
-4 -2





Sample Output 110

One possible sequence of actions of Takahashi and Aoki is as follows:

Aoki chooses the first segment. Takahashi moves from coordinate 0 to -4, covering a distance of 4.
Aoki chooses the third segment. Takahashi stays at coordinate -4.
Aoki chooses the second segment. Takahashi moves from coordinate -4 to 3, covering a distance of 7.
Takahashi moves from coordinate 3 to 0, covering a distance of 3.

The distance covered by Takahashi here is 14 (because Takahashi didn't move optimally).
It turns out that if both players move optimally, the distance covered by Takahashi will be 10.





Sample Input 23
1 2
3 4
5 6





Sample Output 212






Sample Input 35
-2 0
-2 0
7 8
9 10
-2 -1





Sample Output 334


",Interval Game,"Greedy Algorithm, Priority Queue, Sorting, Simulation, Two-pointer, Difference Array, Game Theory",0.409,32,15
1062,"
Score : 500 points


Problem StatementAtCoDeer is thinking of painting an infinite two-dimensional grid in a checked pattern of side K.
Here, a checked pattern of side K is a pattern where each square is painted black or white so that each connected component of each color is a K × K square.
Below is an example of a checked pattern of side 3:



AtCoDeer has N desires.
The i-th desire is represented by x_i, y_i and c_i.
If c_i is B, it means that he wants to paint the square (x_i,y_i) black; if c_i is W, he wants to paint the square (x_i,y_i) white.
At most how many desires can he satisfy at the same time?




Constraints
1 ≤ N ≤ 10^5
1 ≤ K ≤ 1000
0 ≤ x_i ≤ 10^9
0 ≤ y_i ≤ 10^9
If i ≠ j, then (x_i,y_i) ≠ (x_j,y_j).
c_i is B or W.
N, K, x_i and y_i are integers.







InputInput is given from Standard Input in the following format:
N K
x_1 y_1 c_1
x_2 y_2 c_2
:
x_N y_N c_N





OutputPrint the maximum number of desires that can be satisfied at the same time.






Sample Input 14 3
0 1 W
1 2 W
5 3 B
5 4 B





Sample Output 14

He can satisfy all his desires by painting as shown in the example above.





Sample Input 22 1000
0 0 B
0 1 W





Sample Output 22






Sample Input 36 2
1 2 B
2 1 W
2 2 B
1 0 B
0 6 W
4 5 W





Sample Output 34


",Checker,"Arithmetic, Prefix sum, Value / Coordinate Compression, Enumeration, Counting, Parity",0.056,58,3
1063,"
Score : 800 points


Problem StatementIn Finite Encyclopedia of Integer Sequences (FEIS), all integer sequences of lengths between 1 and N (inclusive) consisting of integers between 1 and K (inclusive) are listed.
Let the total number of sequences listed in FEIS be X. Among those sequences, find the (X/2)-th (rounded up to the nearest integer) lexicographically smallest one.




Constraints
1 \leq N,K \leq 3 × 10^5
N and K are integers.







InputInput is given from Standard Input in the following format:
K N





OutputPrint the (X/2)-th (rounded up to the nearest integer) lexicographically smallest sequence listed in FEIS, with spaces in between, where X is the total number of sequences listed in FEIS.






Sample Input 13 2





Sample Output 12 1 

There are 12 sequences listed in FEIS: (1),(1,1),(1,2),(1,3),(2),(2,1),(2,2),(2,3),(3),(3,1),(3,2),(3,3).
The (12/2 = 6)-th lexicographically smallest one among them is (2,1).





Sample Input 22 4





Sample Output 21 2 2 2






Sample Input 35 14





Sample Output 33 3 3 3 3 3 3 3 3 3 3 3 2 2 


",Finite Encyclopedia of Integer Sequences,"Mathematics, Sorting, Dynamic Programming, Greedy Algorithm, Array",0.333,23,8
1064,"
Score : 300 points


Problem StatementYou are given a sequence of positive integers of length N, a = (a_1, a_2, ..., a_N).
Your objective is to remove some of the elements in a so that a will be a good sequence.
Here, an sequence b is a good sequence when the following condition holds true:

For each element x in b, the value x occurs exactly x times in b.

For example, (3, 3, 3), (4, 2, 4, 1, 4, 2, 4) and () (an empty sequence) are good sequences, while (3, 3, 3, 3) and (2, 4, 1, 4, 2) are not.
Find the minimum number of elements that needs to be removed so that a will be a good sequence.




Constraints
1 \leq N \leq 10^5
a_i is an integer.
1 \leq a_i \leq 10^9







InputInput is given from Standard Input in the following format:
N
a_1 a_2 ... a_N





OutputPrint the minimum number of elements that needs to be removed so that a will be a good sequence.






Sample Input 14
3 3 3 3





Sample Output 11

We can, for example, remove one occurrence of 3. Then, (3, 3, 3) is a good sequence.





Sample Input 25
2 4 1 4 2





Sample Output 22

We can, for example, remove two occurrences of 4. Then, (2, 1, 2) is a good sequence.





Sample Input 36
1 2 2 3 3 3





Sample Output 30






Sample Input 41
1000000000





Sample Output 41

Remove one occurrence of 10^9. Then, () is a good sequence.





Sample Input 58
2 7 1 8 2 8 1 8





Sample Output 55


",Good Sequence,"Set / Map, Boolean Operations On Geometric Objects, Arithmetic",0.667,35,16
1065,"
Score : 500 points


Problem StatementWe have a deck consisting of N cards. Each card has an integer written on it. The integer on the i-th card from the top is a_i.
Two people X and Y will play a game using this deck. Initially, X has a card with Z written on it in his hand, and Y has a card with W written on it in his hand. Then, starting from X, they will alternately perform the following action:

Draw some number of cards from the top of the deck. Then, discard the card in his hand and keep the last drawn card instead. Here, at least one card must be drawn.

The game ends when there is no more card in the deck. The score of the game is the absolute difference of the integers written on the cards in the two players' hand.
X will play the game so that the score will be maximized, and Y will play the game so that the score will be minimized. What will be the score of the game?




Constraints
All input values are integers.
1 \leq N \leq 2000
1 \leq Z, W, a_i \leq 10^9







InputInput is given from Standard Input in the following format:
N Z W
a_1 a_2 ... a_N





OutputPrint the score.






Sample Input 13 100 100
10 1000 100





Sample Output 1900

If X draws two cards first, Y will draw the last card, and the score will be |1000 - 100| = 900.





Sample Input 23 100 1000
10 100 100





Sample Output 2900

If X draws all the cards first, the score will be |1000 - 100| = 900.





Sample Input 35 1 1
1 1 1 1 1





Sample Output 30






Sample Input 41 1 1
1000000000





Sample Output 4999999999


",ABS,"Dyanmic Programming, Game Theory, Greedy Algorithm, Arithmetic, Constructive, Mathematics",0.429,18,6
1066,"
Score : 300 points


Problem StatementTakahashi is now competing in a programming contest, but he received TLE in a problem where the answer is YES or NO.
When he checked the detailed status of the submission, there were N test cases in the problem, and the code received TLE in M of those cases.
Then, he rewrote the code to correctly solve each of those M cases with 1/2 probability in 1900 milliseconds, and correctly solve each of the other N-M cases without fail in 100 milliseconds.
Now, he goes through the following process:

Submit the code.
Wait until the code finishes execution on all the cases.
If the code fails to correctly solve some of the M cases, submit it again.
Repeat until the code correctly solve all the cases in one submission.

Let the expected value of the total execution time of the code be X milliseconds. Print X (as an integer).




Constraints
All input values are integers.
1 \leq N \leq 100
1 \leq M \leq {\rm min}(N, 5)







InputInput is given from Standard Input in the following format:
N M





OutputPrint X, the expected value of the total execution time of the code, as an integer. It can be proved that, under the constraints in this problem, X is an integer not exceeding 10^9.






Sample Input 11 1





Sample Output 13800

In this input, there is only one case. Takahashi will repeatedly submit the code that correctly solves this case with 1/2 probability in 1900 milliseconds.
The code will succeed in one attempt with 1/2 probability, in two attempts with 1/4 probability, and in three attempts with 1/8 probability, and so on.
Thus, the answer is 1900 \times 1/2 + (2 \times 1900) \times 1/4 + (3 \times 1900) \times 1/8 + ... = 3800.





Sample Input 210 2





Sample Output 218400

The code will take 1900 milliseconds in each of the 2 cases, and 100 milliseconds in each of the 10-2=8 cases. The probability of the code correctly solving all the cases is 1/2 \times 1/2 = 1/4.





Sample Input 3100 5





Sample Output 3608000


",HSI,"Probability Theory, Exponentiation By Squaring, Arithmetic",0.714,39,15
1067,"
Score : 400 points


Problem StatementFennec and Snuke are playing a board game.
On the board, there are N cells numbered 1 through N, and N-1 roads, each connecting two cells. Cell a_i is adjacent to Cell b_i through the i-th road. Every cell can be reached from every other cell by repeatedly traveling to an adjacent cell. In terms of graph theory, the graph formed by the cells and the roads is a tree.
Initially, Cell 1 is painted black, and Cell N is painted white. The other cells are not yet colored.
Fennec (who goes first) and Snuke (who goes second) alternately paint an uncolored cell.
More specifically, each player performs the following action in her/his turn:

Fennec: selects an uncolored cell that is adjacent to a black cell, and paints it black.
Snuke: selects an uncolored cell that is adjacent to a white cell, and paints it white.

A player loses when she/he cannot paint a cell. Determine the winner of the game when Fennec and Snuke play optimally.




Constraints
2 \leq N \leq 10^5
1 \leq a_i, b_i \leq N
The given graph is a tree.







InputInput is given from Standard Input in the following format:
N
a_1 b_1
:
a_{N-1} b_{N-1}





OutputIf Fennec wins, print Fennec; if Snuke wins, print Snuke.






Sample Input 17
3 6
1 2
3 1
7 4
5 7
1 4





Sample Output 1Fennec

For example, if Fennec first paints Cell 2 black, she will win regardless of Snuke's moves.





Sample Input 24
1 4
4 2
2 3





Sample Output 2Snuke


",Fennec VS. Snuke,"Graph Theory, Breadth-first Search, Depth-first Search, Tree, Graph Traversal, Geometry; 3d",0.5,70,25
1068,"
Score : 900 points


Problem StatementMole decided to live in an abandoned mine. The structure of the mine is represented by a simple connected undirected graph which consists of N vertices numbered 1 through N and M edges.
The i-th edge connects Vertices a_i and b_i, and it costs c_i yen (the currency of Japan) to remove it.
Mole would like to remove some of the edges so that there is exactly one path from Vertex 1 to Vertex N that does not visit the same vertex more than once. Find the minimum budget needed to achieve this.




Constraints
2 \leq N \leq 15
N-1 \leq M \leq N(N-1)/2
1 \leq a_i, b_i \leq N
1 \leq c_i \leq 10^{6}
There are neither multiple edges nor self-loops in the given graph.
The given graph is connected.







InputInput is given from Standard Input in the following format:
N M
a_1 b_1 c_1
:
a_M b_M c_M





OutputPrint the answer.






Sample Input 14 6
1 2 100
3 1 100
2 4 100
4 3 100
1 4 100
3 2 100





Sample Output 1200

By removing the two edges represented by the red dotted lines in the figure below, the objective can be achieved for a cost of 200 yen.








Sample Input 22 1
1 2 1





Sample Output 20

It is possible that there is already only one path from Vertex 1 to Vertex N in the beginning.





Sample Input 315 22
8 13 33418
14 15 55849
7 10 15207
4 6 64328
6 9 86902
15 7 46978
8 14 53526
1 2 8720
14 12 37748
8 3 61543
6 5 32425
4 11 20932
3 12 55123
8 2 45333
9 12 77796
3 9 71922
12 15 70793
2 4 25485
11 6 1436
2 7 81563
7 11 97843
3 1 40491





Sample Output 3133677


",Mole and Abandoned Mine,"Graph Theory, Dynamic Programming Using Bitfield, Bitmask, Precomputation, Dynamic Programming, Tree, Constructive",0.5,3,2
1069,"
Score : 600 points


Problem StatementWe have a sequence of length N consisting of non-negative integers. Consider performing the following operation on this sequence until the largest element in this sequence becomes N-1 or smaller.

Determine the largest element in the sequence (if there is more than one, choose one). Decrease the value of this element by N, and increase each of the other elements by 1.

It can be proved that the largest element in the sequence becomes N-1 or smaller after a finite number of operations.
You are given an integer K. Find an integer sequence a_i such that the number of times we will perform the above operation is exactly K. It can be shown that there is always such a sequence under the constraints on input and output in this problem.




Constraints
0 ≤ K ≤ 50 \times 10^{16}







InputInput is given from Standard Input in the following format:
K





OutputPrint a solution in the following format:
N
a_1 a_2 ... a_N

Here, 2 ≤ N ≤ 50 and 0 ≤ a_i ≤ 10^{16} + 1000 must hold.






Sample Input 10





Sample Output 14
3 3 3 3






Sample Input 21





Sample Output 23
1 0 3






Sample Input 32





Sample Output 32
2 2

The operation will be performed twice: [2, 2] -> [0, 3] -> [1, 1].





Sample Input 43





Sample Output 47
27 0 0 0 0 0 0






Sample Input 51234567894848





Sample Output 510
1000 193 256 777 0 1 1192 1234567891011 48 425


",Decrease (Contestant ver.),"Arithmetic, Mathematics, Array, Bruteforcing",0.345,87,22
1070,"
Score : 600 points


Problem StatementA subsequence of a string S is a string that can be obtained by deleting zero or more characters from S without changing the order of the remaining characters.
For example, arc, artistic and (an empty string) are all subsequences of artistic; abc and ci are not.
You are given a string A consisting of lowercase English letters.
Find the shortest string among the strings consisting of lowercase English letters that are not subsequences of A.
If there are more than one such string, find the lexicographically smallest one among them.




Constraints
1 \leq |A| \leq 2 \times 10^5
A consists of lowercase English letters.







InputInput is given from Standard Input in the following format:
A





OutputPrint the lexicographically smallest string among the shortest strings consisting of lowercase English letters that are not subsequences of A.






Sample Input 1atcoderregularcontest





Sample Output 1b

The string atcoderregularcontest contains a as a subsequence, but not b.





Sample Input 2abcdefghijklmnopqrstuvwxyz





Sample Output 2aa






Sample Input 3frqnvhydscshfcgdemurlfrutcpzhopfotpifgepnqjxupnskapziurswqazdwnwbgdhyktfyhqqxpoidfhjdakoxraiedxskywuepzfniuyskxiyjpjlxuqnfgmnjcvtlpnclfkpervxmdbvrbrdn





Sample Output 3aca


",Don't Be a Subsequence,"Dyanmic Programming, Precomputation, Constructive, String",0.4,31,15
1071,"
Score : 700 points


Problem StatementWe have a board with an H \times W grid.
Each square in the grid is painted in black or white. The square at the i-th row from the top and j-th column from the left is black if the j-th character in S_i is #, and white if that character is ..
Snuke can perform the following operation on the grid any number of times:

Select a row or column in the grid, and invert the color of all the squares in that row or column (that is, black squares become white and vice versa).

Then, Snuke draws a rectangle along grid lines. Here, all the squares contained in the rectangle must be painted in black.
Find the maximum possible area of Snuke's rectangle when the operation is performed optimally.




Constraints
2 \leq H \leq 2000
2 \leq W \leq 2000
|S_i| = W
S_i consists of # and ..







InputInput is given from Standard Input in the following format:
H W
S_1
S_2
:
S_H





OutputPrint the maximum possible area of Snuke's rectangle.






Sample Input 13 3
..#
##.
.#.





Sample Output 16

If the first row from the top and the third column from the left are inverted, a 2 \times 3 rectangle can be drawn, as shown below:






Sample Input 24 4
....
....
....
....





Sample Output 216






Sample Input 310 8
##...#.#
##...#.#
..###.#.
#.##.#.#
.#..#.#.
..##.#.#
##.#.#..
...#.#..
###.#.##
###..###





Sample Output 327


",Flip and Rectangles,"Bitmask, Grid Graph, Stack, Monotonic Stack, Matrix, Dyanmic Programming",0.2,17,5
1072,"
Score : 900 points


Problem StatementIn the city of Nevermore, there are 10^8 streets and 10^8 avenues, both numbered from 0 to 10^8-1.
All streets run straight from west to east, and all avenues run straight from south to north.
The distance between neighboring streets and between neighboring avenues is exactly 100 meters.
Every street intersects every avenue. Every intersection can be described by pair (x, y), where x is avenue ID and y is street ID.
There are N fountains in the city, situated at intersections (X_i, Y_i).
Unlike normal intersections, there's a circle with radius 10 meters centered at the intersection, and there are no road parts inside this circle.
The picture below shows an example of how a part of the city with roads and fountains may look like.



City governors don't like encountering more than one fountain while moving along the same road.
Therefore, every street contains at most one fountain on it, as well as every avenue.
Citizens can move along streets, avenues and fountain perimeters.
What is the shortest distance one needs to cover in order to get from intersection (x_1, y_1) to intersection (x_2, y_2)?




Constraints
0 \leq x_1, y_1, x_2, y_2 < 10^8
1 \leq N \leq 200,000
0 \leq X_i, Y_i < 10^8
X_i \neq X_j for i \neq j
Y_i \neq Y_j for i \neq j
Intersections (x_1, y_1) and (x_2, y_2) are different and don't contain fountains.
All input values are integers.







InputInput is given from Standard Input in the following format:
x_1 y_1 x_2 y_2
N
X_1 Y_1
X_2 Y_2
:
X_N Y_N





OutputPrint the shortest possible distance one needs to cover in order to get from intersection (x_1, y_1) to intersection (x_2, y_2), in meters.
Your answer will be considered correct if its absolute or relative error doesn't exceed 10^{-11}.






Sample Input 11 1 6 5
3
3 2
5 3
2 4





Sample Output 1891.415926535897938

One possible shortest path is shown on the picture below. The path starts at the blue point, finishes at the purple point and follows along the red line.








Sample Input 23 5 6 4
3
3 2
5 3
2 4





Sample Output 2400.000000000000000









Sample Input 34 2 2 2
3
3 2
5 3
2 4





Sample Output 3211.415926535897938





",Fountain Walk,"Geometry; 3d, Array, Sorting, Dynamic Programming, Mathematics",0.0,43,5
1073,"
Score : 500 points


Problem StatementA robot is put at the origin in a two-dimensional plane.
Initially, the robot is facing in the positive x-axis direction.
This robot will be given an instruction sequence s.
s consists of the following two kinds of letters, and will be executed in order from front to back.

F : Move in the current direction by distance 1.
T : Turn 90 degrees, either clockwise or counterclockwise.

The objective of the robot is to be at coordinates (x, y) after all the instructions are executed.
Determine whether this objective is achievable.




Constraints
s consists of F and T.
1 \leq |s| \leq 8 000
x and y are integers.
|x|, |y| \leq |s|







InputInput is given from Standard Input in the following format:
s
x y





OutputIf the objective is achievable, print Yes; if it is not, print No.






Sample Input 1FTFFTFFF
4 2





Sample Output 1Yes

The objective can be achieved by, for example, turning counterclockwise in the first T and turning clockwise in the second T.





Sample Input 2FTFFTFFF
-2 -2





Sample Output 2Yes

The objective can be achieved by, for example, turning clockwise in the first T and turning clockwise in the second T.





Sample Input 3FF
1 0





Sample Output 3No






Sample Input 4TF
1 0





Sample Output 4No






Sample Input 5FFTTFF
0 0





Sample Output 5Yes

The objective can be achieved by, for example, turning counterclockwise in the first T and turning counterclockwise in the second T.





Sample Input 6TTTT
1 0





Sample Output 6No


",FT Robot,"Dyanmic Programming, Set / Map, Parsing, Dynamic Programming, Arithmetic",0.273,23,7
1074,"
Score : 700 points


Problem StatementFor strings s and t, we will say that s and t are prefix-free when neither is a prefix of the other.
Let L be a positive integer. A set of strings S is a good string set when the following conditions hold true:

Each string in S has a length between 1 and L (inclusive) and consists of the characters 0 and 1.
Any two distinct strings in S are prefix-free.

We have a good string set S = \{ s_1, s_2, ..., s_N \}. Alice and Bob will play a game against each other. They will alternately perform the following operation, starting from Alice:

Add a new string to S. After addition, S must still be a good string set.

The first player who becomes unable to perform the operation loses the game. Determine the winner of the game when both players play optimally.




Constraints
1 \leq N \leq 10^5
1 \leq L \leq 10^{18}
s_1, s_2, ..., s_N are all distinct.
{ s_1, s_2, ..., s_N } is a good string set.
|s_1| + |s_2| + ... + |s_N| \leq 10^5







InputInput is given from Standard Input in the following format:
N L
s_1
s_2
:
s_N





OutputIf Alice will win, print Alice; if Bob will win, print Bob.






Sample Input 12 2
00
01





Sample Output 1Alice

If Alice adds 1, Bob will be unable to add a new string.





Sample Input 22 2
00
11





Sample Output 2Bob

There are two strings that Alice can add on the first turn: 01 and 10.
In case she adds 01, if Bob add 10, she will be unable to add a new string.
Also, in case she adds 10, if Bob add 01, she will be unable to add a new string.





Sample Input 33 3
0
10
110





Sample Output 3Alice

If Alice adds 111, Bob will be unable to add a new string.





Sample Input 42 1
0
1





Sample Output 4Bob

Alice is unable to add a new string on the first turn.





Sample Input 51 2
11





Sample Output 5Alice






Sample Input 62 3
101
11





Sample Output 6Bob


",Prefix-free Game,"Trie, Depth-first Search, Game Theory, Boolean Operations On Geometric Objects, Tree",0.5,6,2
1075,"
Score : 800 points


Problem StatementThere is a tree with N vertices. The vertices are numbered 1 through N. The i-th edge (1 \leq i \leq N - 1) connects Vertex x_i and y_i. For vertices v and w (1 \leq v, w \leq N), we will define the distance between v and w d(v, w) as ""the number of edges contained in the path v-w"".
A squirrel lives in each vertex of the tree. They are planning to move, as follows. First, they will freely choose a permutation of (1, 2, ..., N), p = (p_1, p_2, ..., p_N). Then, for each 1 \leq i \leq N, the squirrel that lived in Vertex i will move to Vertex p_i.
Since they like long travels, they have decided to maximize the total distance they traveled during the process. That is, they will choose p so that d(1, p_1) + d(2, p_2) + ... + d(N, p_N) will be maximized. How many such ways are there to choose p, modulo 10^9 + 7?




Constraints
2 \leq N \leq 5,000
1 \leq x_i, y_i \leq N
The input graph is a tree.







InputInput is given from Standard Input in the following format:
N
x_1 y_1
x_2 y_2
:
x_{N - 1} y_{N - 1}





OutputPrint the number of the ways to choose p so that the condition is satisfied, modulo 10^9 + 7.






Sample Input 13
1 2
2 3





Sample Output 13

The maximum possible distance traveled by squirrels is 4.
There are three choices of p that achieve it, as follows:

(2, 3, 1)
(3, 1, 2)
(3, 2, 1)






Sample Input 24
1 2
1 3
1 4





Sample Output 211

The maximum possible distance traveled by squirrels is 6.
For example, p = (2, 1, 4, 3) achieves it.





Sample Input 36
1 2
1 3
1 4
2 5
2 6





Sample Output 336






Sample Input 47
1 2
6 3
4 5
1 7
1 5
2 3





Sample Output 4396


",Squirrel Migration,"Depth-first Search, Tree, Dyanmic Programming, Combinatorics, Inclusion And Exclusion, Arithmetic",0.0,2,1
1076,"
Score : 700 points


Problem StatementWe have a tree with N vertices. Vertex 1 is the root of the tree, and the parent of Vertex i (2 \leq i \leq N) is Vertex P_i.
To each vertex in the tree, Snuke will allocate a color, either black or white, and a non-negative integer weight.
Snuke has a favorite integer sequence, X_1, X_2, ..., X_N, so he wants to allocate colors and weights so that the following condition is satisfied for all v.

The total weight of the vertices with the same color as v among the vertices contained in the subtree whose root is v, is X_v.

Here, the subtree whose root is v is the tree consisting of Vertex v and all of its descendants.
Determine whether it is possible to allocate colors and weights in this way.




Constraints
1 \leq N \leq 1 000
1 \leq P_i \leq i - 1
0 \leq X_i \leq 5 000







InputsInput is given from Standard Input in the following format:
N
P_2 P_3 ... P_N
X_1 X_2 ... X_N





OutputsIf it is possible to allocate colors and weights to the vertices so that the condition is satisfied, print POSSIBLE; otherwise, print IMPOSSIBLE.






Sample Input 13
1 1
4 3 2





Sample Output 1POSSIBLE

For example, the following allocation satisfies the condition:

Set the color of Vertex 1 to white and its weight to 2.
Set the color of Vertex 2 to black and its weight to 3.
Set the color of Vertex 3 to white and its weight to 2.

There are also other possible allocations.





Sample Input 23
1 2
1 2 3





Sample Output 2IMPOSSIBLE

If the same color is allocated to Vertex 2 and Vertex 3, Vertex 2 cannot be allocated a non-negative weight.
If different colors are allocated to Vertex 2 and 3, no matter which color is allocated to Vertex 1, it cannot be allocated a non-negative weight.
Thus, there exists no allocation of colors and weights that satisfies the condition.





Sample Input 38
1 1 1 3 4 5 5
4 1 6 2 2 1 3 3





Sample Output 3POSSIBLE






Sample Input 41

0





Sample Output 4POSSIBLE


",Bichrome Tree,"Tree, Depth-first Search, Dynamic Programming On Trees, Knapsack, Bitmask",0.875,21,8
1077,"
Score : 700 points


Problem StatementWe have a grid with H rows and W columns of squares.
We will represent the square at the i-th row from the top and j-th column from the left as (i,\ j).
Also, we will define the distance between the squares (i_1,\ j_1) and (i_2,\ j_2) as |i_1 - i_2| + |j_1 - j_2|.
Snuke is painting each square in red, yellow, green or blue.
Here, for a given positive integer d, he wants to satisfy the following condition:

No two squares with distance exactly d have the same color.

Find a way to paint the squares satisfying the condition.
It can be shown that a solution always exists.




Constraints
2 ≤ H, W ≤ 500
1 ≤ d ≤ H + W - 2







InputInput is given from Standard Input in the following format:
H W d





OutputPrint a way to paint the squares satisfying the condition, in the following format. If the square (i,\ j) is painted in red, yellow, green or blue, c_{ij} should be R, Y, G or B, respectively.
c_{11}c_{12}...c_{1W}
:
c_{H1}c_{H2}...c_{HW}







Sample Input 12 2 1





Sample Output 1RY
GR

There are four pairs of squares with distance exactly 1.
As shown below, no two such squares have the same color.

(1,\ 1), (1,\ 2) : R, Y
(1,\ 2), (2,\ 2) : Y, R
(2,\ 2), (2,\ 1) : R, G
(2,\ 1), (1,\ 1) : G, R






Sample Input 22 3 2





Sample Output 2RYB
RGB

There are six pairs of squares with distance exactly 2.
As shown below, no two such squares have the same color.

(1,\ 1) , (1,\ 3) : R , B
(1,\ 3) , (2,\ 2) : B , G
(2,\ 2) , (1,\ 1) : G , R
(2,\ 1) , (2,\ 3) : R , B
(2,\ 3) , (1,\ 2) : B , Y
(1,\ 2) , (2,\ 1) : Y , R


",Four Coloring,"Arithmetic, Graph Theory, Geometry; 3d, Constructive, Bruteforcing",0.0,36,3
1078,"
Score : 700 points


Problem StatementYou are given N points (x_i,y_i) located on a two-dimensional plane.
Consider a subset S of the N points that forms a convex polygon.
Here, we say a set of points S forms a convex polygon when there exists a convex polygon with a positive area that has the same set of vertices as S. All the interior angles of the polygon must be strictly less than 180°.



For example, in the figure above, {A,C,E} and {B,D,E} form convex polygons; {A,C,D,E}, {A,B,C,E}, {A,B,C}, {D,E} and {} do not.
For a given set S, let n be the number of the points among the N points that are inside the convex hull of S (including the boundary and vertices). Then, we will define the score of S as 2^{n-|S|}.
Compute the scores of all possible sets S that form convex polygons, and find the sum of all those scores.
However, since the sum can be extremely large, print the sum modulo 998244353.




Constraints
1≤N≤200
0≤x_i,y_i<10^4 (1≤i≤N)
If i≠j, x_i≠x_j or y_i≠y_j.
x_i and y_i are integers.







InputThe input is given from Standard Input in the following format:
N
x_1 y_1
x_2 y_2
:
x_N y_N





OutputPrint the sum of all the scores modulo 998244353.






Sample Input 14
0 0
0 1
1 0
1 1





Sample Output 15

We have five possible sets as S, four sets that form triangles and one set that forms a square. Each of them has a score of 2^0=1, so the answer is 5.





Sample Input 25
0 0
0 1
0 2
0 3
1 1





Sample Output 211

We have three ""triangles"" with a score of 1 each, two ""triangles"" with a score of 2 each, and one ""triangle"" with a score of 4. Thus, the answer is 11.





Sample Input 31
3141 2718





Sample Output 30

There are no possible set as S, so the answer is 0.

",ConvexScore,"Combinatorics, Inclusion And Exclusion, Geometry; 3d, Arithmetic, Bruteforcing, Set / Map",0.6,9,5
1079,"
Score : 800 points


Problem StatementThere are X+Y+Z people, conveniently numbered 1 through X+Y+Z.
Person i has A_i gold coins, B_i silver coins and C_i bronze coins.
Snuke is thinking of getting gold coins from X of those people, silver coins from Y of the people and bronze coins from Z of the people.
It is not possible to get two or more different colors of coins from a single person.
On the other hand, a person will give all of his/her coins of the color specified by Snuke.
Snuke would like to maximize the total number of coins of all colors he gets.
Find the maximum possible number of coins.




Constraints
1 \leq X
1 \leq Y
1 \leq Z
X+Y+Z \leq 10^5
1 \leq A_i \leq 10^9
1 \leq B_i \leq 10^9
1 \leq C_i \leq 10^9







InputInput is given from Standard Input in the following format:
X Y Z
A_1 B_1 C_1
A_2 B_2 C_2
:
A_{X+Y+Z} B_{X+Y+Z} C_{X+Y+Z}





OutputPrint the maximum possible total number of coins of all colors he gets.






Sample Input 11 2 1
2 4 4
3 2 1
7 6 7
5 2 3





Sample Output 118

Get silver coins from Person 1, silver coins from Person 2, bronze coins from Person 3 and gold coins from Person 4.
In this case, the total number of coins will be 4+2+7+5=18.
It is not possible to get 19 or more coins, and the answer is therefore 18.





Sample Input 23 3 2
16 17 1
2 7 5
2 16 12
17 7 7
13 2 10
12 18 3
16 15 19
5 6 2





Sample Output 2110






Sample Input 36 2 4
33189 87907 277349742
71616 46764 575306520
8801 53151 327161251
58589 4337 796697686
66854 17565 289910583
50598 35195 478112689
13919 88414 103962455
7953 69657 699253752
44255 98144 468443709
2332 42580 752437097
39752 19060 845062869
60126 74101 382963164





Sample Output 33093929975


",Coins,"Sorting, Priority Queue, Prefix sum, Two-pointer, Greedy Algorithm, Dynamic Programming",0.333,18,7
1080,"
Score : 1000 points


Problem Statement
There are N balls and N+1 holes in a line. Balls are numbered 1 through N from left to right. Holes are numbered 1 through N+1 from left to right. The i-th ball is located between the i-th hole and (i+1)-th hole. We denote the distance between neighboring items (one ball and one hole) from left to right as d_i (1 \leq i \leq 2 \times N). You are given two parameters d_1 and x. d_i - d_{i-1} is equal to x for all i (2 \leq i \leq 2 \times N).
We want to push all N balls into holes one by one. When a ball rolls over a hole, the ball will drop into the hole if there is no ball in the hole yet. Otherwise, the ball will pass this hole and continue to roll. (In any scenario considered in this problem, balls will never collide.)
In each step, we will choose one of the remaining balls uniformly at random and then choose a direction (either left or right) uniformly at random and push the ball in this direction. Please calculate the expected total distance rolled by all balls during this process.
For example, when N = 3, d_1 = 1, and x = 1, the following is one possible scenario:




first step: push the ball numbered 2 to its left, it will drop into the hole numbered 2. The distance rolled is 3.
second step: push the ball numbered 1 to its right, it will pass the hole numbered 2 and drop into the hole numbered 3. The distance rolled is 9.
third step: push the ball numbered 3 to its right, it will drop into the hole numbered 4. The distance rolled is 6.

So the total distance in this scenario is 18.
Note that in all scenarios every ball will drop into some hole and there will be a hole containing no ball in the end.




Constraints
1 \leq N \leq 200,000
1 \leq d_1 \leq 100
0 \leq x \leq 100
All input values are integers.







InputThe input is given from Standard Input in the following format:
N d_1 x





OutputPrint a floating number denoting the answer. The relative or absolute error of your answer should not be higher than 10^{-9}.






Sample Input 11 3 3





Sample Output 14.500000000000000

The distance between the only ball and the left hole is 3 and distance between the only ball and the right hole is 6. There are only two scenarios (i.e. push left and push right). The only ball will roll 3 and 6 unit distance, respectively. So the answer for this example is (3+6)/2 = 4.5.





Sample Input 22 1 0





Sample Output 22.500000000000000






Sample Input 31000 100 100





Sample Output 3649620280.957660079002380


",Pushing Balls,"Arithmetic, Recursion, Mathematics, Probability Theory, Bruteforcing",1.0,1,1
1081,"
Score : 700 points


Problem StatementWe have N gemstones labeled 1 through N.
You can perform the following operation any number of times (possibly zero).

Select a positive integer x, and smash all the gems labeled with multiples of x.

Then, for each i, if the gem labeled i remains without getting smashed, you will receive a_i yen (the currency of Japan).
However, a_i may be negative, in which case you will be charged money.
By optimally performing the operation, how much yen can you earn?




Constraints
All input values are integers.
1 \leq N \leq 100
|a_i| \leq 10^9







InputInput is given from Standard Input in the following format:
N
a_1 a_2 ... a_N





OutputPrint the maximum amount of money that can be earned.






Sample Input 16
1 2 -6 4 5 3





Sample Output 112

It is optimal to smash Gem 3 and 6.





Sample Input 26
100 -100 -100 -100 100 -100





Sample Output 2200






Sample Input 35
-1 -2 -3 -4 -5





Sample Output 30

It is optimal to smash all the gems.





Sample Input 42
-1000 100000





Sample Output 499000


",MUL,"Graph Theory, Maximum Flow, Graph Theory, Arithmetic",0.375,23,6
1082,"
Score : 300 points


Problem StatementYou are given a string S.
Takahashi can insert the character A at any position in this string any number of times.
Can he change S into AKIHABARA?




Constraints
1 \leq |S| \leq 50
S consists of uppercase English letters.







InputInput is given from Standard Input in the following format:
S





OutputIf it is possible to change S into AKIHABARA, print YES; otherwise, print NO.






Sample Input 1KIHBR





Sample Output 1YES

Insert one A at each of the four positions: the beginning, immediately after H, immediately after B and the end.





Sample Input 2AKIBAHARA





Sample Output 2NO

The correct spell is AKIHABARA.





Sample Input 3AAKIAHBAARA





Sample Output 3NO


",AKIBA,"Bitmask, String, Bruteforcing, Boolean Operations On Geometric Objects",0.214,39,12
1083,"
Score : 700 points


Problem StatementIn the final of CODE FESTIVAL in some year, there are N participants.
The height and power of Participant i is H_i and P_i, respectively.
Ringo is hosting a game of stacking zabuton (cushions).
The participants will line up in a row in some order, and they will in turn try to add zabuton to the stack of zabuton.
Initially, the stack is empty.
When it is Participant i's turn, if there are H_i or less zabuton already stacked, he/she will add exactly P_i zabuton to the stack. Otherwise, he/she will give up and do nothing.
Ringo wants to maximize the number of participants who can add zabuton to the stack.
How many participants can add zabuton to the stack in the optimal order of participants?




Constraints
1 \leq N \leq 5000
0 \leq H_i \leq 10^9
1 \leq P_i \leq 10^9







InputInput is given from Standard Input in the following format:
N
H_1 P_1
H_2 P_2
:
H_N P_N





OutputPrint the maximum number of participants who can add zabuton to the stack.






Sample Input 13
0 2
1 3
3 4





Sample Output 12

When the participants line up in the same order as the input, Participants 1 and 3 will be able to add zabuton.
On the other hand, there is no order such that all three participants can add zabuton. Thus, the answer is 2.





Sample Input 23
2 4
3 1
4 1





Sample Output 23

When the participants line up in the order 2, 3, 1, all of them will be able to add zabuton.





Sample Input 310
1 3
8 4
8 3
9 1
6 4
2 3
4 2
9 2
8 3
0 1





Sample Output 35


",Zabuton,"Sorting, Dyanmic Programming, Dynamic Programming, Heuristics, Array",0.571,13,7
1084,"
Score : 100 points


Problem StatementButCoder Inc. runs a programming competition site called ButCoder. In this site, a user is given an integer value called rating that represents his/her skill, which changes each time he/she participates in a contest. The initial value of a new user's rating is 0, and a user whose rating reaches K or higher is called Kaiden (""total transmission""). Note that a user's rating may become negative.
Hikuhashi is a new user in ButCoder. It is estimated that, his rating increases by A in each of his odd-numbered contests (first, third, fifth, ...), and decreases by B in each of his even-numbered contests (second, fourth, sixth, ...).
According to this estimate, after how many contests will he become Kaiden for the first time, or will he never become Kaiden?




Constraints
1 ≤ K, A, B ≤ 10^{18}
All input values are integers.







InputInput is given from Standard Input in the following format:
K A B





OutputIf it is estimated that Hikuhashi will never become Kaiden, print -1. Otherwise, print the estimated number of contests before he become Kaiden for the first time.






Sample Input 14000 2000 500





Sample Output 15

Each time Hikuhashi participates in a contest, his rating is estimated to change as 0 → 2000 → 1500 → 3500 → 3000 → 5000 → … After his fifth contest, his rating will reach 4000 or higher for the first time.





Sample Input 24000 500 2000





Sample Output 2-1

Each time Hikuhashi participates in a contest, his rating is estimated to change as 0 → 500 → -1500 → -1000 → -3000 → -2500 → … He will never become Kaiden.





Sample Input 31000000000000000000 2 1





Sample Output 31999999999999999997

The input and output values may not fit into 32-bit integers.

",Kaiden,"Arithmetic, Implementation",0.571,12,7
1085,"
Score : 100 points


Problem StatementIn your garden, there is a long and narrow flowerbed that stretches infinitely to the east. You have decided to plant N kinds of flowers in this empty flowerbed. For convenience, we will call these N kinds of flowers Flower 1, 2, …, N. Also, we will call the position that is p centimeters from the west end of the flowerbed Position p.
You will plant Flower i (1 ≤ i ≤ N) as follows: first, plant one at Position w_i, then plant one every d_i centimeters endlessly toward the east. That is, Flower i will be planted at the positions w_i, w_i + d_i, w_i + 2 d_i, … Note that more than one flower may be planted at the same position.
Find the position at which the K-th flower from the west is planted. If more than one flower is planted at the same position, they are counted individually.




Constraints
1 ≤ N ≤ 10^5
1 ≤ K ≤ 10^9
1 ≤ w_i ≤ 10^{18}
1 ≤ d_i ≤ 10^9
All input values are integers.







InputInput is given from Standard Input in the following format:
N K
w_1 d_1
:
w_N d_N





OutputWhen the K-th flower from the west is planted at Position X, print the value of X. (The westmost flower is counted as the 1-st flower.)






Sample Input 12 6
20 10
25 15





Sample Output 150

Two kinds of flowers are planted at the following positions:

Flower 1: Position 20, 30, 40, 50, 60, …
Flower 2: Position 25, 40, 55, 70, 85, …

The sixth flower from the west is the Flower 1 planted at Position 50. Note that the two flowers planted at Position 40 are counted individually.





Sample Input 23 9
10 10
10 10
10 10





Sample Output 230

Three flowers are planted at each of the positions 10, 20, 30, … Thus, the ninth flower from the west is planted at Position 30.





Sample Input 31 1000000000
1000000000000000000 1000000000





Sample Output 31999999999000000000


",Garden,"Binary Search, Arithmetic, Counting",0.5,9,4
1086,"
Score : 100 points


Problem StatementYou are given an undirected graph G. G has N vertices and M edges. The vertices are numbered from 1 through N, and the i-th edge (1 ≤ i ≤ M) connects Vertex a_i and b_i. G does not have self-loops and multiple edges.
You can repeatedly perform the operation of adding an edge between two vertices. However, G must not have self-loops or multiple edges as the result. Also, if Vertex 1 and 2 are connected directly or indirectly by edges, your body will be exposed to a voltage of 1000000007 volts. This must also be avoided.
Under these conditions, at most how many edges can you add? Note that Vertex 1 and 2 are never connected directly or indirectly in the beginning.




Constraints
2 ≤ N ≤ 10^5
0 ≤ M ≤ 10^5
1 ≤ a_i < b_i ≤ N
All pairs (a_i, b_i) are distinct.
Vertex 1 and 2 in G are not connected directly or indirectly by edges.







InputInput is given from Standard Input in the following format:
N M
a_1 b_1
:
a_M b_M





OutputPrint the maximum number of edges that can be added.






Sample Input 14 1
1 3





Sample Output 12


As shown above, two edges can be added. It is not possible to add three or more edges.





Sample Input 22 0





Sample Output 20


No edge can be added.





Sample Input 39 6
1 4
1 8
2 5
3 6
4 8
5 7





Sample Output 312


",Shock,"Disjoint Set, Graph Theory, Combinatorics, Arithmetic",1.0,5,5
1087,"
Score : 100 points


Problem StatementYou are given two strings s and t consisting of lowercase English letters and an integer L.
We will consider generating a string of length L by concatenating one or more copies of s and t. Here, it is allowed to use the same string more than once.
For example, when s = at, t = code and L = 6, the strings atatat, atcode and codeat can be generated.
Among the strings that can be generated in this way, find the lexicographically smallest one. In the cases given as input, it is always possible to generate a string of length L.




Constraints
1 ≤ L ≤ 2 × 10^5
1 ≤ |s|, |t| ≤ L
s and t consist of lowercase English letters.
It is possible to generate a string of length L in the way described in Problem Statement.







InputInput is given from Standard Input in the following format:
N
x_1 s_1
x_2 s_2
:
x_N s_N





OutputPrint the lexicographically smallest string among the ones that can be generated in the way described in Problem Statement.






Sample Input 16
at
code





Sample Output 1atatat

This input corresponds to the example shown in Problem Statement.





Sample Input 28
coding
festival





Sample Output 2festival

It is possible that either s or t cannot be used at all in generating a string of length L.





Sample Input 38
same
same





Sample Output 3samesame

It is also possible that s = t.





Sample Input 410
coin
age





Sample Output 4ageagecoin


",Coinage,"Number Theory, Bruteforcing, String, Greedy Algorithm",0.4,10,4
1088,"
Score : 500 points


Problem StatementIn CODE FESTIVAL XXXX, there are N+1 participants from all over the world, including Takahashi.
Takahashi checked and found that the time gap (defined below) between the local times in his city and the i-th person's city was D_i hours.
The time gap between two cities is defined as follows. For two cities A and B, if the local time in city B is d o'clock at the moment when the local time in city A is 0 o'clock, then the time gap between these two cities is defined to be min(d,24-d) hours.
Here, we are using 24-hour notation.
That is, the local time in the i-th person's city is either d o'clock or 24-d o'clock at the moment when the local time in Takahashi's city is 0 o'clock, for example.
Then, for each pair of two people chosen from the N+1 people, he wrote out the time gap between their cities. Let the smallest time gap among them be s hours.
Find the maximum possible value of s.




Constraints
1 \leq N \leq 50
0 \leq D_i \leq 12
All input values are integers.







InputInput is given from Standard Input in the following format:
N
D_1 D_2 ... D_N





OutputPrint the maximum possible value of s.






Sample Input 13
7 12 8





Sample Output 14

For example, consider the situation where it is 7, 12 and 16 o'clock in each person's city at the moment when it is 0 o'clock in Takahashi's city. In this case, the time gap between the second and third persons' cities is 4 hours.





Sample Input 22
11 11





Sample Output 22






Sample Input 31
0





Sample Output 30

Note that Takahashi himself is also a participant.

",Time Gap,"Backtracking, Bitmask, Combinatorics, Arithmetic, Data Structure",0.4,20,4
1089,"
Score : 600 points


Problem StatementThere is a function f(x), which is initially a constant function f(x) = 0.
We will ask you to process Q queries in order. There are two kinds of queries, update queries and evaluation queries, as follows:

An update query 1 a b: Given two integers a and b, let g(x) = f(x) + |x - a| + b and replace f(x) with g(x).
An evaluation query 2: Print x that minimizes f(x), and the minimum value of f(x). If there are multiple such values of x, choose the minimum such value.

We can show that the values to be output in an evaluation query are always integers, so we ask you to print those values as integers without decimal points.




Constraints
All values in input are integers.
1 \leq Q \leq 2 \times 10^5
-10^9 \leq a, b \leq 10^9
The first query is an update query.







InputInput is given from Standard Input in the following format:
Q
Query_1
:
Query_Q

See Sample Input 1 for an example.




OutputFor each evaluation query, print a line containing the response, in the order in which the queries are given.
The response to each evaluation query should be the minimum value of x that minimizes f(x), and the minimum value of f(x), in this order, with space in between.






Sample Input 14
1 4 2
2
1 1 -8
2





Sample Output 14 2
1 -3

In the first evaluation query, f(x) = |x - 4| + 2, which attains the minimum value of 2 at x = 4.
In the second evaluation query, f(x) = |x - 1| + |x - 4| - 6, which attains the minimum value of -3 when 1 \leq x \leq 4. Among the multiple values of x that minimize f(x), we ask you to print the minimum, that is, 1.





Sample Input 24
1 -1000000000 1000000000
1 -1000000000 1000000000
1 -1000000000 1000000000
2





Sample Output 2-1000000000 3000000000


",Absolute Minima,"Data Structure, Priority Queue, Convex Hull Trick, Prefix sum, Mathematics, Greedy Algorithm",0.091,54,8
1090,"
Score : 400 points


Problem StatementYour friend gave you a dequeue D as a birthday present.
D is a horizontal cylinder that contains a row of N jewels.
The values of the jewels are V_1, V_2, ..., V_N from left to right. There may be jewels with negative values.
In the beginning, you have no jewel in your hands.
You can perform at most K operations on D, chosen from the following, at most K times (possibly zero):


Operation A: Take out the leftmost jewel contained in D and have it in your hand. You cannot do this operation when D is empty.


Operation B: Take out the rightmost jewel contained in D and have it in your hand. You cannot do this operation when D is empty.


Operation C: Choose a jewel in your hands and insert it to the left end of D. You cannot do this operation when you have no jewel in your hand.


Operation D: Choose a jewel in your hands and insert it to the right end of D. You cannot do this operation when you have no jewel in your hand.


Find the maximum possible sum of the values of jewels in your hands after the operations.




Constraints
All values in input are integers.
1 \leq N \leq 50
1 \leq K \leq 100
-10^7 \leq V_i \leq 10^7







InputInput is given from Standard Input in the following format:
N K
V_1 V_2 ... V_N





OutputPrint the maximum possible sum of the values of jewels in your hands after the operations.






Sample Input 16 4
-10 8 2 1 2 6





Sample Output 114

After the following sequence of operations, you have two jewels of values 8 and 6 in your hands for a total of 14, which is the maximum result.

Do operation A. You take out the jewel of value -10 from the left end of D.
Do operation B. You take out the jewel of value 6 from the right end of D.
Do operation A. You take out the jewel of value 8 from the left end of D.
Do operation D. You insert the jewel of value -10 to the right end of D.






Sample Input 26 4
-6 -100 50 -2 -5 -3





Sample Output 244






Sample Input 36 3
-6 -100 50 -2 -5 -3





Sample Output 30

It is optimal to do no operation.

",equeue,"Bruteforcing, Sorting, Greedy Algorithm, Two-pointer, Combinatorics",0.5,158,59
1091,"
Score : 300 points


Problem StatementYou are given a string S.
Takahashi can insert the character A at any position in this string any number of times.
Can he change S into AKIHABARA?




Constraints
1 \leq |S| \leq 50
S consists of uppercase English letters.







InputInput is given from Standard Input in the following format:
S





OutputIf it is possible to change S into AKIHABARA, print YES; otherwise, print NO.






Sample Input 1KIHBR





Sample Output 1YES

Insert one A at each of the four positions: the beginning, immediately after H, immediately after B and the end.





Sample Input 2AKIBAHARA





Sample Output 2NO

The correct spell is AKIHABARA.





Sample Input 3AAKIAHBAARA





Sample Output 3NO


",AKIBA,String,0.222,55,7
1092,"
Score : 700 points


Problem StatementWe will define the median of a sequence b of length M, as follows:

Let b' be the sequence obtained by sorting b in non-decreasing order. Then, the value of the (M / 2 + 1)-th element of b' is the median of b. Here, / is integer division, rounding down.

For example, the median of (10, 30, 20) is 20; the median of (10, 30, 20, 40) is 30; the median of (10, 10, 10, 20, 30) is 10.
Snuke comes up with the following problem.
You are given a sequence a of length N.
For each pair (l, r) (1 \leq l \leq r \leq N), let m_{l, r} be the median of the contiguous subsequence (a_l, a_{l + 1}, ..., a_r) of a.
We will list m_{l, r} for all pairs (l, r) to create a new sequence m.
Find the median of m.




Constraints
1 \leq N \leq 10^5
a_i is an integer.
1 \leq a_i \leq 10^9







InputInput is given from Standard Input in the following format:
N
a_1 a_2 ... a_N





OutputPrint the median of m.






Sample Input 13
10 30 20





Sample Output 130

The median of each contiguous subsequence of a is as follows:

The median of (10) is 10.
The median of (30) is 30.
The median of (20) is 20.
The median of (10, 30) is 30.
The median of (30, 20) is 30.
The median of (10, 30, 20) is 20.

Thus, m = (10, 30, 20, 30, 30, 20) and the median of m is 30.





Sample Input 21
10





Sample Output 210






Sample Input 310
5 9 5 9 8 9 3 5 4 3





Sample Output 38


",Median of Medians,"Binary Search, Prefix sum, Binary Indexed Tree, Counting, Array, Arithmetic",0.5,29,9
1093,"
Score : 700 points


Problem StatementTakahashi is hosting an sports meet.
There are N people who will participate. These people are conveniently numbered 1 through N.
Also, there are M options of sports for this event. These sports are numbered 1 through M.
Among these options, Takahashi will select one or more sports (possibly all) to be played in the event.
Takahashi knows that Person i's j-th favorite sport is Sport A_{ij}.
Each person will only participate in his/her most favorite sport among the ones that are actually played in the event, and will not participate in the other sports.
Takahashi is worried that one of the sports will attract too many people.
Therefore, he would like to carefully select sports to be played so that the number of the participants in the sport with the largest number of participants is minimized.
Find the minimum possible number of the participants in the sport with the largest number of participants.




Constraints
1 \leq N \leq 300
1 \leq M \leq 300
A_{i1} , A_{i2} , ... , A_{iM} is a permutation of the integers from 1 to M.







InputInput is given from Standard Input in the following format:
N M
A_{11} A_{12} ... A_{1M}
A_{21} A_{22} ... A_{2M}
:
A_{N1} A_{N2} ... A_{NM}





OutputPrint the minimum possible number of the participants in the sport with the largest number of participants.






Sample Input 14 5
5 1 3 4 2
2 5 3 1 4
2 3 1 4 5
2 5 4 3 1





Sample Output 12

Assume that Sports 1, 3 and 4 are selected to be played. In this case, Person 1 will participate in Sport 1, Person 2 in Sport 3, Person 3 in Sport 3 and Person 4 in Sport 4.
Here, the sport with the largest number of participants is Sport 3, with two participants.
There is no way to reduce the number of participants in the sport with the largest number of participants to 1. Therefore, the answer is 2.





Sample Input 23 3
2 1 3
2 1 3
2 1 3





Sample Output 23

Since all the people have the same taste in sports, there will be a sport with three participants, no matter what sports are selected.
Therefore, the answer is 3.

",Sports Festival,"Greedy Algorithm, Two-pointer, Counting, 2-sat, Array, Bit Set",0.211,55,19
1094,"
Score : 800 points


Problem StatementLet N be a positive even number.
We have a permutation of (1, 2, ..., N), p = (p_1, p_2, ..., p_N).
Snuke is constructing another permutation of (1, 2, ..., N), q, following the procedure below.
First, let q be an empty sequence.
Then, perform the following operation until p becomes empty:

Select two adjacent elements in p, and call them x and y in order. Remove x and y from p (reducing the length of p by 2), and insert x and y, preserving the original order, at the beginning of q.

When p becomes empty, q will be a permutation of (1, 2, ..., N).
Find the lexicographically smallest permutation that can be obtained as q.




Constraints
N is an even number.
2 ≤ N ≤ 2 × 10^5
p is a permutation of (1, 2, ..., N).







InputInput is given from Standard Input in the following format:
N
p_1 p_2 ... p_N





OutputPrint the lexicographically smallest permutation, with spaces in between.






Sample Input 14
3 2 4 1





Sample Output 13 1 2 4

The solution above is obtained as follows:



p
q




(3, 2, 4, 1)
()


↓
↓


(3, 1)
(2, 4)


↓
↓


()
(3, 1, 2, 4)








Sample Input 22
1 2





Sample Output 21 2






Sample Input 38
4 6 3 2 8 5 7 1





Sample Output 33 1 2 7 4 6 8 5

The solution above is obtained as follows:



p
q




(4, 6, 3, 2, 8, 5, 7, 1)
()


↓
↓


(4, 6, 3, 2, 7, 1)
(8, 5)


↓
↓


(3, 2, 7, 1)
(4, 6, 8, 5)


↓
↓


(3, 1)
(2, 7, 4, 6, 8, 5)


↓
↓


()
(3, 1, 2, 7, 4, 6, 8, 5)




",Young Maids,"Divide And Conquer, Segment Tree, Priority Queue, Sorting, Permutation Cycle Decomposition",0.067,65,9
1095,"
Score : 500 points


Problem StatementSeisu-ya, a store specializing in non-negative integers, sells N non-negative integers. The i-th integer is A_i and has a utility of B_i.
There may be multiple equal integers with different utilities.
Takahashi will buy some integers in this store. He can buy a combination of integers whose bitwise OR is less than or equal to K. He wants the sum of utilities of purchased integers to be as large as possible.
Find the maximum possible sum of utilities of purchased integers.




Constraints
1 \leq N \leq 10^5
0 \leq K < 2^{30}
0 \leq A_i < 2^{30}(1\leq i\leq N)
1 \leq B_i \leq 10^9(1\leq i\leq N)
All input values are integers.







InputsInput is given from Standard Input in the following format:
N K
A_1 B_1
:
A_N B_N





OutputsPrint the maximum possible sum of utilities of purchased integers.






Sample Input 13 5
3 3
4 4
2 5





Sample Output 18

Buy 2 and 3 to achieve the maximum possible total utility, 8.





Sample Input 23 6
3 3
4 4
2 5





Sample Output 29

Buy 2 and 4 to achieve the maximum possible total utility, 9.





Sample Input 37 14
10 5
7 4
11 4
9 8
3 6
6 2
8 9





Sample Output 332


",IntegerotS,"Bitmask, Greedy Algorithm, Bruteforcing, Implementation",0.4,17,6
1096,"
Score : 100 points


Problem StatementYou have N cups and 1 ball.
The cups are arranged in a row, from left to right.
You turned down all the cups, then inserted the ball into the leftmost cup.
Then, you will perform the following Q operations:

The i-th operation: swap the positions of the A_i-th and B_i-th cups from the left. If one of these cups contains the ball, the ball will also move.

Since you are a magician, you can cast a magic described below:

Magic: When the ball is contained in the i-th cup from the left, teleport the ball into the adjacent cup (that is, the (i-1)-th or (i+1)-th cup, if they exist).

The magic can be cast before the first operation, between two operations, or after the last operation, but you are allowed to cast it at most once during the whole process.
Find the number of cups with a possibility of containing the ball after all the operations and possibly casting the magic.




Constraints
2 \leq N \leq 10^5
1 \leq Q \leq 10^5
1 \leq A_i < B_i \leq N







InputThe input is given from Standard Input in the following format:
N Q
A_1 B_1
A_2 B_2
:          
A_Q B_Q





OutputPrint the number of cups with a possibility of eventually containing the ball.






Sample Input 110 3
1 3
2 4
4 5





Sample Output 14






Sample Input 220 3
1 7
8 20
1 19





Sample Output 25


",Magician,"Simulation, Array, Bitmask, Graph Theory, Dynamic Programming",1.0,5,5
1097,"
Score : 700 points


Problem StatementSnuke loves constructing integer sequences.
There are N piles of stones, numbered 1 through N.
The pile numbered i consists of a_i stones.
Snuke will construct an integer sequence s of length Σa_i, as follows:

Among the piles with the largest number of stones remaining, let x be the index of the pile with the smallest index. Append x to the end of s.
Select a pile with one or more stones remaining, and remove a stone from that pile.
If there is a pile with one or more stones remaining, go back to step 1. Otherwise, terminate the process.

We are interested in the lexicographically smallest sequence that can be constructed. For each of the integers 1,2,3,...,N, how many times does it occur in the lexicographically smallest sequence?




Constraints
1 ≤ N ≤ 10^{5}
1 ≤ a_i ≤ 10^{9}







InputThe input is given from Standard Input in the following format:
N
a_1 a_2 ... a_{N}





OutputPrint N lines. The i-th line should contain the number of the occurrences of the integer i in the lexicographically smallest sequence that can be constructed.






Sample Input 12
1 2





Sample Output 12
1

The lexicographically smallest sequence is constructed as follows:

Since the pile with the largest number of stones remaining is pile 2, append 2 to the end of s. Then, remove a stone from pile 2.
Since the piles with the largest number of stones remaining are pile 1 and 2, append 1 to the end of s (we take the smallest index). Then, remove a stone from pile 2.
Since the pile with the largest number of stones remaining is pile 1, append 1 to the end of s. Then, remove a stone from pile 1.

The resulting sequence is (2,1,1). In this sequence, 1 occurs twice, and 2 occurs once.





Sample Input 210
1 2 1 3 2 4 2 5 8 1





Sample Output 210
7
0
4
0
3
0
2
3
0


",Frequency,"Sorting, Disjoint Set, Greedy Algorithm, Prefix sum, Breadth-first Search, Stack, Arithmetic, Data Structure",0.333,44,13
1098,"
Score : 500 points


Problem StatementThere are N towns on a plane. The i-th town is located at the coordinates (x_i,y_i). There may be more than one town at the same coordinates.
You can build a road between two towns at coordinates (a,b) and (c,d) for a cost of min(|a-c|,|b-d|) yen (the currency of Japan). It is not possible to build other types of roads.
Your objective is to build roads so that it will be possible to travel between every pair of towns by traversing roads. At least how much money is necessary to achieve this?




Constraints
2 ≤ N ≤ 10^5
0 ≤ x_i,y_i ≤ 10^9
All input values are integers.







InputInput is given from Standard Input in the following format:
N
x_1 y_1
x_2 y_2
:
x_N y_N





OutputPrint the minimum necessary amount of money in order to build roads so that it will be possible to travel between every pair of towns by traversing roads.






Sample Input 13
1 5
3 9
7 8





Sample Output 13

Build a road between Towns 1 and 2, and another between Towns 2 and 3. The total cost is 2+1=3 yen.





Sample Input 26
8 3
4 9
12 19
18 1
13 5
7 6





Sample Output 28


",Built?,"Sorting, Graph Theory, Minimum Spanning Tree, Disjoint Set, Greedy Algorithm",0.5,24,11
1099,"
Score : 700 points


Problem StatementSnuke has decided to use a robot to clean his room.
There are N pieces of trash on a number line.
The i-th piece from the left is at position x_i.
We would like to put all of them in a trash bin at position 0.
For the positions of the pieces of trash, 0 < x_1 < x_2 < ... < x_{N} \leq 10^{9} holds.
The robot is initially at position 0.
It can freely move left and right along the number line, pick up a piece of trash when it comes to the position of that piece, carry any number of pieces of trash and put them in the trash bin when it comes to position 0. It is not allowed to put pieces of trash anywhere except in the trash bin.
The robot consumes X points of energy when the robot picks up a piece of trash, or put pieces of trash in the trash bin. (Putting any number of pieces of trash in the trash bin consumes X points of energy.)
Also, the robot consumes (k+1)^{2} points of energy to travel by a distance of 1 when the robot is carrying k pieces of trash.
Find the minimum amount of energy required to put all the N pieces of trash in the trash bin.




Constraints
1 \leq N \leq 2 \times 10^{5}
0 < x_1 < ... < x_N \leq 10^9
1 \leq X \leq 10^9
All values in input are integers.





Partial Scores
400 points will be awarded for passing the test set satisfying N \leq 2000.







InputInput is given from Standard Input in the following format:
N X
x_1 x_2 ... x_{N}





OutputPrint the answer.






Sample Input 12 100
1 10





Sample Output 1355


Travel to position 10 by consuming 10 points of energy.
Pick up the piece of trash by consuming 100 points of energy.
Travel to position 1 by consuming 36 points of energy.
Pick up the piece of trash by consuming 100 points of energy.
Travel to position 0 by consuming 9 points of energy.
Put the two pieces of trash in the trash bin by consuming 100 points of energy.

This strategy consumes a total of 10+100+36+100+9+100=355 points of energy.





Sample Input 25 1
1 999999997 999999998 999999999 1000000000





Sample Output 219999999983






Sample Input 310 8851025
38 87 668 3175 22601 65499 90236 790604 4290609 4894746





Sample Output 3150710136






Sample Input 416 10
1 7 12 27 52 75 731 13856 395504 534840 1276551 2356789 9384806 19108104 82684732 535447408





Sample Output 43256017715


",Garbage Collector,"Prefix sum, Bruteforcing, Mathematics, Enumeration, Arithmetic, Greedy Algorithm",0.045,63,16
1100,"
Score : 500 points


Problem StatementThere are N towns numbered 1 to N and M roads. The i-th road connects Town A_i and Town B_i bidirectionally and has a length of C_i.
Takahashi will travel between these towns by car, passing through these roads. The fuel tank of his car can contain at most L liters of fuel, and one liter of fuel is consumed for each unit distance traveled. When visiting a town while traveling, he can full the tank (or choose not to do so). Travel that results in the tank becoming empty halfway on the road cannot be done.
Process the following Q queries:

The tank is now full. Find the minimum number of times he needs to full his tank while traveling from Town s_i to Town t_i. If Town t_i is unreachable, print -1.





Constraints
All values in input are integers.
2 \leq N \leq 300
0 \leq M \leq \frac{N(N-1)}{2}
1 \leq L \leq 10^9
1 \leq A_i, B_i \leq N
A_i \neq B_i
\left(A_i, B_i\right) \neq \left(A_j, B_j\right) (if i \neq j)
\left(A_i, B_i\right) \neq \left(B_j, A_j\right) (if i \neq j)
1 \leq C_i \leq 10^9
1 \leq Q \leq N\left(N-1\right)
1 \leq s_i, t_i \leq N
s_i \neq t_i
\left(s_i, t_i\right) \neq \left(s_j, t_j\right) (if i \neq j)







InputInput is given from Standard Input in the following format:
N M L
A_1 B_1 C_1
:
A_M B_M C_M
Q
s_1 t_1
:
s_Q t_Q





OutputPrint Q lines.
The i-th line should contain the minimum number of times the tank needs to be fulled while traveling from Town s_i to Town t_i. If Town t_i is unreachable, the line should contain -1 instead.






Sample Input 13 2 5
1 2 3
2 3 3
2
3 2
1 3





Sample Output 10
1

To travel from Town 3 to Town 2, we can use the second road to reach Town 2 without fueling the tank on the way.
To travel from Town 1 to Town 3, we can first use the first road to get to Town 2, full the tank, and use the second road to reach Town 3.





Sample Input 24 0 1
1
2 1





Sample Output 2-1

There may be no road at all.





Sample Input 35 4 4
1 2 2
2 3 2
3 4 3
4 5 2
20
2 1
3 1
4 1
5 1
1 2
3 2
4 2
5 2
1 3
2 3
4 3
5 3
1 4
2 4
3 4
5 4
1 5
2 5
3 5
4 5





Sample Output 30
0
1
2
0
0
1
2
0
0
0
1
1
1
0
0
2
2
1
0


",Travel by Car,"Graph Theory, Floyd-warshall, Shortest Path, Matrix",0.355,76,26
1101,"
Score : 500 points


Problem StatementYou are given a tree with N vertices 1,2,\ldots,N, and positive integers c_1,c_2,\ldots,c_N.
The i-th edge in the tree (1 \leq i \leq N-1) connects Vertex a_i and Vertex b_i.
We will write a positive integer on each vertex in T and calculate our score as follows:

On each edge, write the smaller of the integers written on the two endpoints.
Let our score be the sum of the integers written on all the edges.

Find the maximum possible score when we write each of c_1,c_2,\ldots,c_N on one vertex in T, and show one way to achieve it. If an integer occurs multiple times in c_1,c_2,\ldots,c_N, we must use it that number of times.




Constraints
1 \leq N \leq 10000
1 \leq a_i,b_i \leq N
1 \leq c_i \leq 10^5
The given graph is a tree.







InputInput is given from Standard Input in the following format:
N
a_1 b_1
:
a_{N-1} b_{N-1}
c_1 \ldots c_N





OutputUse the following format:
M
d_1 \ldots d_N

where M is the maximum possible score, and d_i is the integer to write on Vertex i.
d_1,d_2,\ldots,d_N must be a permutation of c_1,c_2,\ldots,c_N.
If there are multiple ways to achieve the maximum score, any of them will be accepted.






Sample Input 15
1 2
2 3
3 4
4 5
1 2 3 4 5





Sample Output 110
1 2 3 4 5

If we write 1,2,3,4,5 on Vertex 1,2,3,4,5, respectively, the integers written on the four edges will be 1,2,3,4, for the score of 10. This is the maximum possible score.





Sample Input 25
1 2
1 3
1 4
1 5
3141 59 26 53 59





Sample Output 2197
59 26 3141 59 53

c_1,c_2,\ldots,c_N may not be pairwise distinct.

",Maximum Sum of Minimum,"Graph Theory, Sorting, Breadth-first Search, Greedy Algorithm, Tree, Mathematics",0.45,32,11
1102,"
Score : 600 points


Problem StatementWe have a tree with N vertices and N-1 edges, respectively numbered 1, 2,\cdots, N and 1, 2, \cdots, N-1. Edge i connects Vertex u_i and v_i.
For integers L, R (1 \leq L \leq R \leq N), let us define a function f(L, R) as follows:

Let S be the set of the vertices numbered L through R. f(L, R) represents the number of connected components in the subgraph formed only from the vertex set S and the edges whose endpoints both belong to S.

Compute \sum_{L=1}^{N} \sum_{R=L}^{N} f(L, R).




Constraints
1 \leq N \leq 2 \times 10^5
1 \leq u_i, v_i \leq N
The given graph is a tree.
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
u_1 v_1
u_2 v_2
:
u_{N-1} v_{N-1}





OutputPrint \sum_{L=1}^{N} \sum_{R=L}^{N} f(L, R).






Sample Input 13
1 3
2 3





Sample Output 17

We have six possible pairs (L, R) as follows:

For L = 1, R = 1, S = \{1\} and we have 1 connected component.
For L = 1, R = 2, S = \{1, 2\} and we have 2 connected components.
For L = 1, R = 3, S = \{1, 2, 3\} and we have 1 connected component, since S contains both endpoints of each of the edges 1, 2.
For L = 2, R = 2, S = \{2\} and we have 1 connected component.
For L = 2, R = 3, S = \{2, 3\} and we have 1 connected component, since S contains both endpoints of Edge 2.
For L = 3, R = 3, S = \{3\} and we have 1 connected component.

The sum of these is 7.





Sample Input 22
1 2





Sample Output 23






Sample Input 310
5 3
5 7
8 9
1 9
9 10
8 4
7 4
6 10
7 2





Sample Output 3113


",Intervals on Tree,"Combinatorics, Tree, Mathematics, Counting, Arithmetic, Graph Theory, Sorting",0.606,61,36
1103,"
Score : 300 points


Problem StatementThere are N balls in a two-dimensional plane. The i-th ball is at coordinates (x_i, y_i).
We will collect all of these balls, by choosing two integers p and q such that p \neq 0 or q \neq 0 and then repeating the following operation:

Choose a ball remaining in the plane and collect it. Let (a, b) be the coordinates of this ball. If we collected a ball at coordinates (a - p, b - q) in the previous operation, the cost of this operation is 0. Otherwise, including when this is the first time to do this operation, the cost of this operation is 1.

Find the minimum total cost required to collect all the balls when we optimally choose p and q.




Constraints
1 \leq N \leq 50
|x_i|, |y_i| \leq 10^9
If i \neq j, x_i \neq x_j or y_i \neq y_j.
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
x_1 y_1
:
x_N y_N





OutputPrint the minimum total cost required to collect all the balls.






Sample Input 12
1 1
2 2





Sample Output 11

If we choose p = 1, q = 1, we can collect all the balls at a cost of 1 by collecting them in the order (1, 1), (2, 2).





Sample Input 23
1 4
4 6
7 8





Sample Output 21

If we choose p = -3, q = -2, we can collect all the balls at a cost of 1 by collecting them in the order (7, 8), (4, 6), (1, 4).





Sample Input 34
1 1
1 2
2 1
2 2





Sample Output 32


",Picking Up,"Enumeration, Set / Map, Arithmetic, Greedy Algorithm",0.229,107,24
1104,"
Score : 400 points


Problem StatementYou are going out for a walk, when you suddenly encounter N monsters. Each monster has a parameter called health, and the health of the i-th monster is h_i at the moment of encounter. A monster will vanish immediately when its health drops to 0 or below.
Fortunately, you are a skilled magician, capable of causing explosions that damage monsters. In one explosion, you can damage monsters as follows:

Select an alive monster, and cause an explosion centered at that monster. The health of the monster at the center of the explosion will decrease by A, and the health of each of the other monsters will decrease by B. Here, A and B are predetermined parameters, and A > B holds.

At least how many explosions do you need to cause in order to vanish all the monsters?




Constraints
All input values are integers.
1 ≤ N ≤ 10^5
1 ≤ B < A ≤ 10^9
1 ≤ h_i ≤ 10^9







InputInput is given from Standard Input in the following format:
N A B
h_1
h_2
:
h_N





OutputPrint the minimum number of explosions that needs to be caused in order to vanish all the monsters.






Sample Input 14 5 3
8
7
4
2





Sample Output 12

You can vanish all the monsters in two explosion, as follows:

First, cause an explosion centered at the monster with 8 health. The healths of the four monsters become 3, 4, 1 and -1, respectively, and the last monster vanishes.
Second, cause an explosion centered at the monster with 4 health remaining. The healths of the three remaining monsters become 0, -1 and -2, respectively, and all the monsters are now vanished.






Sample Input 22 10 4
20
20





Sample Output 24

You need to cause two explosions centered at each monster, for a total of four.





Sample Input 35 2 1
900000000
900000000
1000000000
1000000000
1000000000





Sample Output 3800000000


",Widespread,"Binary Search, Greedy Algorithm, Arithmetic, Array, Boolean Operations On Geometric Objects",0.5,42,18
1105,"
Score : 300 points


Problem StatementYou are given an integer sequence of length n, a_1, ..., a_n.
Let us consider performing the following n operations on an empty sequence b.
The i-th operation is as follows:

Append a_i to the end of b.
Reverse the order of the elements in b.

Find the sequence b obtained after these n operations.




Constraints
1 \leq n \leq 2\times 10^5
0 \leq a_i \leq 10^9
n and a_i are integers.







InputInput is given from Standard Input in the following format:
n
a_1 a_2 ... a_n





OutputPrint n integers in a line with spaces in between.
The i-th integer should be b_i.






Sample Input 14
1 2 3 4





Sample Output 14 2 1 3


After step 1 of the first operation, b becomes: 1.
After step 2 of the first operation, b becomes: 1.
After step 1 of the second operation, b becomes: 1, 2.
After step 2 of the second operation, b becomes: 2, 1.
After step 1 of the third operation, b becomes: 2, 1, 3.
After step 2 of the third operation, b becomes: 3, 1, 2.
After step 1 of the fourth operation, b becomes: 3, 1, 2, 4.
After step 2 of the fourth operation, b becomes: 4, 2, 1, 3.

Thus, the answer is 4 2 1 3.





Sample Input 23
1 2 3





Sample Output 23 1 2

As shown above in Sample Output 1, b becomes 3, 1, 2 after step 2 of the third operation. Thus, the answer is 3 1 2.





Sample Input 31
1000000000





Sample Output 31000000000






Sample Input 46
0 6 7 6 7 0





Sample Output 40 6 6 0 7 7


",pushpush,"Machine Learning, Array, Two-pointer, Arithmetic, Constructive",0.577,58,24
1106,"
Score : 800 points


Problem StatementThis is an interactive task.
Snuke has a favorite positive integer, N. You can ask him the following type of question at most 64 times: ""Is n your favorite integer?"" Identify N.
Snuke is twisted, and when asked ""Is n your favorite integer?"", he answers ""Yes"" if one of the two conditions below is satisfied, and answers ""No"" otherwise:

Both n \leq N and str(n) \leq str(N) hold.
Both n > N and str(n) > str(N) hold.

Here, str(x) is the decimal representation of x (without leading zeros) as a string. For example, str(123) = 123 and str(2000) = 2000.
Strings are compared lexicographically. For example, 11111 < 123 and 123456789 < 9.




Constraints
1 \leq N \leq 10^{9}





Input and OutputWrite your question to Standard Output in the following format:
? n

Here, n must be an integer between 1 and 10^{18} (inclusive).
Then, the response to the question shall be given from Standard Input in the following format:
ans

Here, ans is either Y or N. Y represents ""Yes""; N represents ""No"".
Finally, write your answer in the following format:
! n

Here, n=N must hold.






Judging
After each output, you must flush Standard Output. Otherwise you may get TLE.
After you print the answer, the program must be terminated immediately. Otherwise, the behavior of the judge is undefined.
When your output is invalid or incorrect, the behavior of the judge is undefined (it does not necessarily give WA).





SampleBelow is a sample communication for the case N=123:



Input
Output





? 1


Y




? 32


N




? 1010


N




? 999


Y




! 123




Since 1 \leq 123 and str(1) \leq str(123), the first response is ""Yes"".
Since 32 \leq 123 but str(32) > str(123), the second response is ""No"".
Since 1010 > 123 but str(1010) \leq str(123), the third response is ""No"".
Since 999 \geq 123 and str(999) > str(123), the fourth response is ""Yes"".
The program successfully identifies N=123 in four questions, and thus passes the case.



",Awkward Response,"Interactive, Binary Search, String, Hashing, Boolean Operations On Geometric Objects",0.222,19,6
1107,"
Score : 700 points


Problem StatementSquid loves painting vertices in graphs.
There is a simple undirected graph consisting of N vertices numbered 1 through N, and M edges.
Initially, all the vertices are painted in color 0. The i-th edge bidirectionally connects two vertices a_i and b_i. The length of every edge is 1.
Squid performed Q operations on this graph. In the i-th operation, he repaints all the vertices within a distance of d_i from vertex v_i, in color c_i.
Find the color of each vertex after the Q operations.




Constraints
1 ≤ N,M,Q ≤ 10^5
1 ≤ a_i,b_i,v_i ≤ N
a_i ≠ b_i
0 ≤ d_i ≤ 10
1 ≤ c_i ≤10^5
d_i and c_i are all integers.
There are no self-loops or multiple edges in the given graph.





Partial Score
200 points will be awarded for passing the testset satisfying 1 ≤ N,M,Q ≤ 2{,}000.







InputInput is given from Standard Input in the following format:
N M
a_1 b_1
:
a_{M} b_{M}
Q
v_1 d_1 c_1
:
v_{Q} d_{Q} c_{Q}





OutputPrint the answer in N lines.
In the i-th line, print the color of vertex i after the Q operations.






Sample Input 17 7
1 2
1 3
1 4
4 5
5 6
5 7
2 3
2
6 1 1
1 2 2





Sample Output 12
2
2
2
2
1
0

Initially, each vertex is painted in color 0.
In the first operation, vertices 5 and 6 are repainted in color 1.
In the second operation, vertices 1, 2, 3, 4 and 5 are repainted in color 2.








Sample Input 214 10
1 4
5 7
7 11
4 10
14 7
14 3
6 14
8 11
5 13
8 3
8
8 6 2
9 7 85
6 9 3
6 7 5
10 3 1
12 9 4
9 6 6
8 2 3





Sample Output 21
0
3
1
5
5
3
3
6
1
3
4
5
3

The given graph may not be connected.

",Splatter Painting,"Graph Theory, Graph Traversal, Array, Segment Tree With Lazy Propagation",0.28,63,10
1108,"
Score : 700 points


Problem StatementYou are given four integers: H, W, h and w (1 ≤ h ≤ H, 1 ≤ w ≤ W).
Determine whether there exists a matrix such that all of the following conditions are held, and construct one such matrix if the answer is positive:

The matrix has H rows and W columns.
Each element of the matrix is an integer between -10^9 and 10^9 (inclusive).
The sum of all the elements of the matrix is positive.
The sum of all the elements within every subrectangle with h rows and w columns in the matrix is negative.





Constraints
1 ≤ h ≤ H ≤ 500
1 ≤ w ≤ W ≤ 500







InputInput is given from Standard Input in the following format:
H W h w





OutputIf there does not exist a matrix that satisfies all of the conditions, print No.
Otherwise, print Yes in the first line, and print a matrix in the subsequent lines in the following format:
a_{11} ... a_{1W}
:
a_{H1} ... a_{HW}

Here, a_{ij} represents the (i,\ j) element of the matrix.






Sample Input 13 3 2 2





Sample Output 1Yes
1 1 1
1 -4 1
1 1 1

The sum of all the elements of this matrix is 4, which is positive.
Also, in this matrix, there are four subrectangles with 2 rows and 2 columns as shown below. For each of them, the sum of all the elements inside is -1, which is negative.








Sample Input 22 4 1 2





Sample Output 2No






Sample Input 33 4 2 3





Sample Output 3Yes
2 -5 8 7
3 -5 -4 -5
2 1 -1 7


",+/- Rectangle,"Arithmetic, Matrix, Mathematics, Greedy Algorithm",0.1,49,8
1109,"
Score : 1100 points


Problem StatementLet f(A, B), where A and B are positive integers, be the string satisfying the following conditions:

f(A, B) has length A + B;
f(A, B) contains exactly A letters A and exactly B letters B;
The length of the longest substring of f(A, B) consisting of equal letters (ex., AAAAA or BBBB) is as small as possible under the conditions above;
f(A, B) is the lexicographically smallest string satisfying the conditions above.

For example, f(2, 3) = BABAB, and f(6, 4) = AABAABAABB.
Answer Q queries: find the substring of f(A_i, B_i) from position C_i to position D_i (1-based).




Constraints
1 \leq Q \leq 10^3
1 \leq A_i, B_i \leq 5 \times 10^8
1 \leq C_i \leq D_i \leq A_i + B_i
D_i - C_i + 1 \leq 100
All input values are integers.





Partial Score
500 points will be awarded for passing the testset satisfying 1 \leq A_i, B_i \leq 10^3.







InputInput is given from Standard Input in the following format:
Q
A_1 B_1 C_1 D_1
A_2 B_2 C_2 D_2
:
A_Q B_Q C_Q D_Q





OutputFor each query i in order of input, print a line containing the substring of f(A_i, B_i) from position C_i to position D_i (1-based).






Sample Input 15
2 3 1 5
6 4 1 10
2 3 4 4
6 4 3 7
8 10 5 8





Sample Output 1BABAB
AABAABAABB
A
BAABA
ABAB


",Min Max Repetition,"Mathematics, Binary Search, Arithmetic, Greedy Algorithm, Machine Learning",0.167,11,2
1110,"
Score : 1000 points


Problem StatementThere are N barbecue restaurants along a street.
The restaurants are numbered 1 through N from west to east, and the distance between restaurant i and restaurant i+1 is A_i.
Joisino has M tickets, numbered 1 through M.
Every barbecue restaurant offers barbecue meals in exchange for these tickets.
Restaurant i offers a meal of deliciousness B_{i,j} in exchange for ticket j.
Each ticket can only be used once, but any number of tickets can be used at a restaurant.
Joisino wants to have M barbecue meals by starting from a restaurant of her choice, then repeatedly traveling to another barbecue restaurant and using unused tickets at the restaurant at her current location.
Her eventual happiness is calculated by the following formula: ""(The total deliciousness of the meals eaten) - (The total distance traveled)"".
Find her maximum possible eventual happiness.




Constraints
All input values are integers.
2≤N≤5×10^3
1≤M≤200
1≤A_i≤10^9
1≤B_{i,j}≤10^9







InputThe input is given from Standard Input in the following format:
N M
A_1 A_2 ... A_{N-1}
B_{1,1} B_{1,2} ... B_{1,M}
B_{2,1} B_{2,2} ... B_{2,M}
:
B_{N,1} B_{N,2} ... B_{N,M}





OutputPrint Joisino's maximum possible eventual happiness.






Sample Input 13 4
1 4
2 2 5 1
1 3 3 2
2 2 5 1





Sample Output 111

The eventual happiness can be maximized by the following strategy: start from restaurant 1 and use tickets 1 and 3, then move to restaurant 2 and use tickets 2 and 4.





Sample Input 25 3
1 2 3 4
10 1 1
1 1 1
1 10 1
1 1 1
1 1 10





Sample Output 220


",Yakiniku Restaurants,"Prefix sum, Dyanmic Programming, Segment Tree, Monotonic Stack, Difference Array, Segment Tree With Lazy Propagation, Greedy Algorithm",0.0,15,3
1111,"
Score : 800 points


Problem StatementThere is a directed graph with N vertices and N edges. The vertices are numbered 1, 2, ..., N.
The graph has the following N edges: (p_1, 1), (p_2, 2), ..., (p_N, N), and the graph is weakly connected. Here, an edge from Vertex u to Vertex v is denoted by (u, v), and a weakly connected graph is a graph which would be connected if each edge was bidirectional.
We would like to assign a value to each of the vertices in this graph so that the following conditions are satisfied. Here, a_i is the value assigned to Vertex i.

Each a_i is a non-negative integer.
For each edge (i, j), a_i \neq a_j holds.
For each i and each integer x(0 ≤ x < a_i), there exists a vertex j such that the edge (i, j) exists and x = a_j holds.

Determine whether there exists such an assignment.




Constraints
2 ≤ N ≤ 200 000
1 ≤ p_i ≤ N
p_i \neq i
The graph is weakly connected.







InputInput is given from Standard Input in the following format:
N
p_1 p_2 ... p_N





OutputIf the assignment is possible, print POSSIBLE; otherwise, print IMPOSSIBLE.






Sample Input 14
2 3 4 1





Sample Output 1POSSIBLE

The assignment is possible: {a_i} = {0, 1, 0, 1} or {a_i} = {1, 0, 1, 0}.





Sample Input 23
2 3 1





Sample Output 2IMPOSSIBLE






Sample Input 34
2 3 1 1





Sample Output 3POSSIBLE

The assignment is possible: {a_i} = {2, 0, 1, 0}.





Sample Input 46
4 5 6 5 6 4





Sample Output 4IMPOSSIBLE


",Namori Grundy,"Strongly Connected Component, Depth-first Search, Graph Theory, Game Theory, Dyanmic Programming, Bit Set, Topological Sorting",0.6,7,5
1112,"
Score : 600 points


Problem StatementSnuke is introducing a robot arm with the following properties to his factory:

The robot arm consists of m sections and m+1 joints. The sections are numbered 1, 2, ..., m, and the joints are numbered 0, 1, ..., m. Section i connects Joint i-1 and Joint i. The length of Section i is d_i.
For each section, its mode can be specified individually. There are four modes: L, R, D and U. The mode of a section decides the direction of that section. If we consider the factory as a coordinate plane, the position of Joint i will be determined as follows (we denote its coordinates as (x_i, y_i)):
(x_0, y_0) = (0, 0).
If the mode of Section i is L, (x_{i}, y_{i}) = (x_{i-1} - d_{i}, y_{i-1}).
If the mode of Section i is R, (x_{i}, y_{i}) = (x_{i-1} + d_{i}, y_{i-1}).
If the mode of Section i is D, (x_{i}, y_{i}) = (x_{i-1}, y_{i-1} - d_{i}).
If the mode of Section i is U, (x_{i}, y_{i}) = (x_{i-1}, y_{i-1} + d_{i}).



Snuke would like to introduce a robot arm so that the position of Joint m can be matched with all of the N points (X_1, Y_1), (X_2, Y_2), ..., (X_N, Y_N) by properly specifying the modes of the sections.
Is this possible?
If so, find such a robot arm and how to bring Joint m to each point (X_j, Y_j).




Constraints
All values in input are integers.
1 \leq N \leq 1000
-10^9 \leq X_i \leq 10^9
-10^9 \leq Y_i \leq 10^9





Partial Score
In the test cases worth 300 points, -10 \leq X_i \leq 10 and -10 \leq Y_i \leq 10 hold.







InputInput is given from Standard Input in the following format:
N
X_1 Y_1
X_2 Y_2
:
X_N Y_N





OutputIf the condition can be satisfied, follow the following format. If the condition cannot be satisfied, print -1.
m
d_1 d_2 ... d_m
w_1
w_2
:
w_N

m and d_i are the configurations of the robot arm. Refer to the problem statement for what each of them means.
Here, 1 \leq m \leq 40 and 1 \leq d_i \leq 10^{12} must hold. Also, m and d_i must all be integers.
w_j is a string of length m that represents the way to bring Joint m of the robot arm to point (X_j, Y_j).
The i-th character of w_j should be one of the letters L, R, D and U, representing the mode of Section i.






Sample Input 13
-1 0
0 3
2 -1





Sample Output 12
1 2
RL
UU
DR

In the given way to bring Joint m of the robot arm to each (X_j, Y_j), the positions of the joints will be as follows:

To (X_1, Y_1) = (-1, 0): First, the position of Joint 0 is (x_0, y_0) = (0, 0). As the mode of Section 1 is R, the position of Joint 1 is (x_1, y_1) = (1, 0). Then, as the mode of Section 2 is L, the position of Joint 2 is (x_2, y_2) = (-1, 0).
To (X_2, Y_2) = (0, 3): (x_0, y_0) = (0, 0), (x_1, y_1) = (0, 1), (x_2, y_2) = (0, 3).
To (X_3, Y_3) = (2, -1): (x_0, y_0) = (0, 0), (x_1, y_1) = (0, -1), (x_2, y_2) = (2, -1).






Sample Input 25
0 0
1 0
2 0
3 0
4 0





Sample Output 2-1






Sample Input 32
1 1
1 1





Sample Output 32
1 1
RU
UR

There may be duplicated points among (X_j, Y_j).





Sample Input 43
-7 -3
7 3
-3 -7





Sample Output 45
3 1 4 1 5
LRDUL
RDULR
DULRD


",Robot Arms,"Parity, Greedy Algorithm, Bitmask, Mathematics, Constructive",0.231,37,10
1113,"
Score : 700 points


Problem StatementYou are given a string s of length n.
Does a tree with n vertices that satisfies the following conditions exist?

The vertices are numbered 1,2,..., n.
The edges are numbered 1,2,..., n-1, and Edge i connects Vertex u_i and v_i.
If the i-th character in s is 1, we can have a connected component of size i by removing one edge from the tree.
If the i-th character in s is 0, we cannot have a connected component of size i by removing any one edge from the tree.

If such a tree exists, construct one such tree.




Constraints
2 \leq n \leq 10^5
s is a string of length n consisting of 0 and 1.







InputInput is given from Standard Input in the following format:
s





OutputIf a tree with n vertices that satisfies the conditions does not exist, print -1.
If a tree with n vertices that satisfies the conditions exist, print n-1 lines.
The i-th line should contain u_i and v_i with a space in between.
If there are multiple trees that satisfy the conditions, any such tree will be accepted.






Sample Input 11111





Sample Output 1-1

It is impossible to have a connected component of size n after removing one edge from a tree with n vertices.





Sample Input 21110





Sample Output 21 2
2 3
3 4

If Edge 1 or Edge 3 is removed, we will have a connected component of size 1 and another of size 3. If Edge 2 is removed, we will have two connected components, each of size 2.





Sample Input 31010





Sample Output 31 2
1 3
1 4

Removing any edge will result in a connected component of size 1 and another of size 3.

",Tr/ee,"Graph Theory, Geometry; 3d, Greedy Algorithm, Stack",0.571,22,14
1114,"
Score : 900 points


Problem StatementYou are given a sequence D_1, D_2, ..., D_N of length N.
The values of D_i are all distinct.
Does a tree with N vertices that satisfies the following conditions exist?

The vertices are numbered 1,2,..., N.
The edges are numbered 1,2,..., N-1, and Edge i connects Vertex u_i and v_i.
For each vertex i, the sum of the distances from i to the other vertices is D_i, assuming that the length of each edge is 1.

If such a tree exists, construct one such tree.




Constraints
2 \leq N \leq 100000
1 \leq D_i \leq 10^{12}
D_i are all distinct.







InputInput is given from Standard Input in the following format:
N
D_1
D_2
:
D_N





OutputIf a tree with n vertices that satisfies the conditions does not exist, print -1.
If a tree with n vertices that satisfies the conditions exist, print n-1 lines.
The i-th line should contain u_i and v_i with a space in between.
If there are multiple trees that satisfy the conditions, any such tree will be accepted.






Sample Input 17
10
15
13
18
11
14
19





Sample Output 11 2
1 3
1 5
3 4
5 6
6 7

The tree shown below satisfies the conditions.






Sample Input 22
1
2





Sample Output 2-1






Sample Input 315
57
62
47
45
42
74
90
75
54
50
66
63
77
87
51





Sample Output 31 10
1 11
2 8
2 15
3 5
3 9
4 5
4 10
5 15
6 12
6 14
7 13
9 12
11 13


",Distance Sums,"Sorting, Set / Map, Hashing, Tree, Mathematics, Depth-first Search, Binary Search",0.0,16,6
1115,"
Score : 600 points


Problem StatementThere are N blocks arranged in a row, numbered 1 to N from left to right.
Each block has a weight, and the weight of Block i is A_i.
Snuke will perform the following operation on these blocks N times:

Choose one block that is still not removed, and remove it.
The cost of this operation is the sum of the weights of the blocks that are connected to the block being removed (including itself).
Here, two blocks x and y ( x \leq y ) are connected when, for all z ( x \leq z \leq y ), Block z is still not removed.

There are N! possible orders in which Snuke removes the blocks.
For all of those N! orders, find the total cost of the N operations, and calculate the sum of those N! total costs.
As the answer can be extremely large, compute the sum modulo 10^9+7.




Constraints
1 \leq N \leq 10^5
1 \leq A_i \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
A_1 A_2 ... A_N





OutputFor all of the N! orders, find the total cost of the N operations, and print the sum of those N! total costs, modulo 10^9+7.






Sample Input 12
1 2





Sample Output 19

First, we will consider the order ""Block 1 -> Block 2"".
In the first operation, the cost of the operation is 1+2=3, as Block 1 and 2 are connected.
In the second operation, the cost of the operation is 2, as only Block 2 remains.
Thus, the total cost of the two operations for this order is 3+2=5.
Then, we will consider the order ""Block 2 -> Block 1"".
In the first operation, the cost of the operation is 1+2=3, as Block 1 and 2 are connected.
In the second operation, the cost of the operation is 1, as only Block 1 remains.
Thus, the total cost of the two operations for this order is 3+1=4.
Therefore, the answer is 5+4=9.





Sample Input 24
1 1 1 1





Sample Output 2212






Sample Input 310
1 2 4 8 16 32 64 128 256 512





Sample Output 3880971923


",Removing Blocks,"Combinatorics, Prefix sum, Arithmetic, Modular Multiplicative Inverse, Precomputation, Constructive",0.75,14,11
1116,"
Score : 700 points


Problem StatementWe have a directed weighted graph with N vertices.
Each vertex has two integers written on it, and the integers written on Vertex i are A_i and B_i.
In this graph, there is an edge from Vertex x to Vertex y for all pairs 1 \leq x,y \leq N, and its weight is {\rm min}(A_x,B_y).
We will consider a directed cycle in this graph that visits every vertex exactly once.
Find the minimum total weight of the edges in such a cycle.




Constraints
2 \leq N \leq 10^5
1 \leq A_i \leq 10^9
1 \leq B_i \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
A_1 B_1
A_2 B_2
:
A_N B_N





OutputPrint the minimum total weight of the edges in such a cycle.






Sample Input 13
1 5
4 2
6 3





Sample Output 17

Consider the cycle 1→3→2→1. The weights of those edges are {\rm min}(A_1,B_3)=1, {\rm min}(A_3,B_2)=2 and {\rm min}(A_2,B_1)=4, for a total of 7.
As there is no cycle with a total weight of less than 7, the answer is 7.





Sample Input 24
1 5
2 6
3 7
4 8





Sample Output 210






Sample Input 36
19 92
64 64
78 48
57 33
73 6
95 73





Sample Output 3227


",Min Cost Cycle,"Sorting, Greedy Algorithm, Array, Bitmask, Permutation Cycle Decomposition, Two-pointer",0.182,34,6
1117,"
Score : 1100 points


Problem StatementThere is a tree with N vertices numbered 1, 2, ..., N.
The edges of the tree are denoted by (x_i, y_i).
On this tree, Alice and Bob play a game against each other.
Starting from Alice, they alternately perform the following operation:

Select an existing edge and remove it from the tree, disconnecting it into two separate connected components. Then, remove the component that does not contain Vertex 1.

A player loses the game when he/she is unable to perform the operation.
Determine the winner of the game assuming that both players play optimally.




Constraints
2 \leq N \leq 100000
1 \leq x_i, y_i \leq N
The given graph is a tree.







InputInput is given from Standard Input in the following format:
N
x_1 y_1
x_2 y_2
:
x_{N-1} y_{N-1}





OutputPrint Alice if Alice wins; print Bob if Bob wins.






Sample Input 15
1 2
2 3
2 4
4 5





Sample Output 1Alice

If Alice first removes the edge connecting Vertices 1 and 2, the tree becomes a single vertex tree containing only Vertex 1.
Since there is no edge anymore, Bob cannot perform the operation and Alice wins.





Sample Input 25
1 2
2 3
1 4
4 5





Sample Output 2Bob






Sample Input 36
1 2
2 4
5 1
6 3
3 2





Sample Output 3Alice






Sample Input 47
1 2
3 7
4 6
2 3
2 4
1 5





Sample Output 4Bob


",Game on Tree,"Graph Theory, Depth-first Search, Game Theory, Bitmask, Tree",0.571,9,4
1118,"
Score : 1000 points


Problem StatementThere are N balls in a row.
Initially, the i-th ball from the left has the integer A_i written on it.
When Snuke cast a spell, the following happens:

Let the current number of balls be k. All the balls with k written on them disappear at the same time.

Snuke's objective is to vanish all the balls by casting the spell some number of times.
This may not be possible as it is. If that is the case, he would like to modify the integers on the minimum number of balls to make his objective achievable.
By the way, the integers on these balls sometimes change by themselves.
There will be M such changes. In the j-th change, the integer on the X_j-th ball from the left will change into Y_j.
After each change, find the minimum number of modifications of integers on the balls Snuke needs to make if he wishes to achieve his objective before the next change occurs. We will assume that he is quick enough in modifying integers. Here, note that he does not actually perform those necessary modifications and leaves them as they are.




Constraints
1 \leq N \leq 200000
1 \leq M \leq 200000
1 \leq A_i \leq N
1 \leq X_j \leq N
1 \leq Y_j \leq N





Subscore
In the test set worth 500 points, N \leq 200 and M \leq 200.







InputInput is given from Standard Input in the following format:
N M
A_1 A_2 ... A_N
X_1 Y_1
X_2 Y_2
:
X_M Y_M





OutputPrint M lines.
The j-th line should contain the minimum necessary number of modifications of integers on the balls to make Snuke's objective achievable.






Sample Input 15 3
1 1 3 4 5
1 2
2 5
5 4





Sample Output 10
1
1


After the first change, the integers on the balls become 2, 1, 3, 4, 5, from left to right. Here, all the balls can be vanished by casting the spell five times. Thus, no modification is necessary.
After the second change, the integers on the balls become 2, 5, 3, 4, 5, from left to right. In this case, at least one modification must be made. One optimal solution is to modify the integer on the fifth ball from the left to 2, and cast the spell four times.
After the third change, the integers on the balls become 2, 5, 3, 4, 4, from left to right. Also in this case, at least one modification must be made. One optimal solution is to modify the integer on the third ball from the left to 2, and cast the spell three times.






Sample Input 24 4
4 4 4 4
4 1
3 1
1 1
2 1





Sample Output 20
1
2
3






Sample Input 310 10
8 7 2 9 10 6 6 5 5 4
8 1
6 3
6 2
7 10
9 7
9 9
2 4
8 1
1 8
7 7





Sample Output 31
0
1
2
2
3
3
3
3
2


",Snuke and Spells,"Counting, Difference Array, Segment Tree With Lazy Propagation, Prefix sum, Offline Queries, Array, Greedy Algorithm",0.0,6,2
1119,"
Score : 700 points


Problem StatementThere is a tree with N vertices, numbered 1 through N.
The i-th of the N-1 edges connects vertices a_i and b_i.
Currently, there are A_i stones placed on vertex i.
Determine whether it is possible to remove all the stones from the vertices by repeatedly performing the following operation:

Select a pair of different leaves. Then, remove exactly one stone from every vertex on the path between those two vertices.
  Here, a leaf is a vertex of the tree whose degree is 1, and the selected leaves themselves are also considered as vertices on the path connecting them.

Note that the operation cannot be performed if there is a vertex with no stone on the path.




Constraints
2 ≦ N ≦ 10^5
1 ≦ a_i,b_i ≦ N
0 ≦ A_i ≦ 10^9
The given graph is a tree.







InputThe input is given from Standard Input in the following format:
N
A_1 A_2 … A_N
a_1 b_1
:
a_{N-1} b_{N-1}





OutputIf it is possible to remove all the stones from the vertices, print YES. Otherwise, print NO.






Sample Input 15
1 2 1 1 2
2 4
5 2
3 2
1 3





Sample Output 1YES

All the stones can be removed, as follows:

Select vertices 4 and 5. Then, there is one stone remaining on each vertex except 4.
Select vertices 1 and 5. Then, there is no stone on any vertex.






Sample Input 23
1 2 1
1 2
2 3





Sample Output 2NO






Sample Input 36
3 2 2 2 2 2
1 2
2 3
1 4
1 5
4 6





Sample Output 3YES


",Cleaning,"Graph Theory, Depth-first Search, Tree, Dynamic Programming On Trees, Segment Tree, Constructive, Sorting",0.5,21,2
1120,"
Score : 900 points


Problem StatementNukes has an integer that can be represented as the bitwise OR of one or more integers between A and B (inclusive).
How many possible candidates of the value of Nukes's integer there are?




Constraints
1 ≤ A ≤ B < 2^{60}
A and B are integers.







InputThe input is given from Standard Input in the following format:
A
B





OutputPrint the number of possible candidates of the value of Nukes's integer.






Sample Input 17
9





Sample Output 14

In this case, A=7 and B=9. There are four integers that can be represented as the bitwise OR of a non-empty subset of {7, 8, 9}: 7, 8, 9 and 15.





Sample Input 265
98





Sample Output 263






Sample Input 3271828182845904523
314159265358979323





Sample Output 368833183630578410


",A or...or B Problem,"Bitmask, Divide And Conquer, Recursion, Bit Set",0.0,9,2
1121,"
Score : 1000 points


Problem StatementYou have two strings A = A_1 A_2 ... A_n and B = B_1 B_2 ... B_n of the same length consisting of 0 and 1.
You can transform A using the following operations in any order and as many times as you want:

Shift A by one character to the left (i.e., if A = A_1 A_2 ... A_n, replace A with A_2 A_3 ... A_n A_1).
Shift A by one character to the right (i.e., if A = A_1 A_2 ... A_n, replace A with A_n A_1 A_2 ... A_{n-1}).
Choose any i such that B_i = 1. Flip A_i (i.e., set A_i = 1 - A_i).

You goal is to make strings A and B equal.
Print the smallest number of operations required to achieve this, or -1 if the goal is unreachable.




Constraints
1 \leq |A| = |B| \leq 2,000
A and B consist of 0 and 1.







InputInput is given from Standard Input in the following format:
A
B





OutputPrint the smallest number of operations required to make strings A and B equal, or -1 if the goal is unreachable.






Sample Input 11010
1100





Sample Output 13

Here is one fastest way to achieve the goal:

Flip A_1: A = 0010
Shift A to the left: A = 0100
Flip A_1 again: A = 1100






Sample Input 21
0





Sample Output 2-1

There is no way to flip the only bit in A.





Sample Input 311010
10001





Sample Output 34

Here is one fastest way to achieve the goal:

Shift A to the right: A = 01101
Flip A_5: A = 01100
Shift A to the left: A = 11000
Shift A to the left again: A = 10001






Sample Input 40100100
1111111





Sample Output 45

Flip A_1, A_3, A_4, A_6 and A_7 in any order.

",Shift and Flip,"Array, Bitmask, Greedy Algorithm, Binary Search, Dyanmic Programming, Sorting, Arithmetic",0.25,12,3
1122,"
Score : 1700 points


Problem StatementYou have two strings A = A_1 A_2 ... A_n and B = B_1 B_2 ... B_n of the same length consisting of 0 and 1.
The number of 1's in A and B is equal.
You've decided to transform A using the following algorithm:

Let a_1, a_2, ..., a_k be the indices of 1's in A.
Let b_1, b_2, ..., b_k be the indices of 1's in B.
Replace a and b with their random permutations, chosen independently and uniformly.
For each i from 1 to k, in order, swap A_{a_i} and A_{b_i}.

Let P be the probability that strings A and B become equal after the procedure above.
Let Z = P \times (k!)^2. Clearly, Z is an integer.
Find Z modulo 998244353.




Constraints
1 \leq |A| = |B| \leq 10,000
A and B consist of 0 and 1.
A and B contain the same number of 1's.
A and B contain at least one 1.





Partial Score
1200 points will be awarded for passing the testset satisfying 1 \leq |A| = |B| \leq 500.







InputInput is given from Standard Input in the following format:
A
B





OutputPrint the value of Z modulo 998244353.






Sample Input 11010
1100





Sample Output 13

After the first two steps, a = [1, 3] and b = [1, 2]. There are 4 possible scenarios after shuffling a and b:

a = [1, 3], b = [1, 2]. Initially, A = 1010. After swap(A_1, A_1), A = 1010. After swap(A_3, A_2), A = 1100.
a = [1, 3], b = [2, 1]. Initially, A = 1010. After swap(A_1, A_2), A = 0110. After swap(A_3, A_1), A = 1100.
a = [3, 1], b = [1, 2]. Initially, A = 1010. After swap(A_3, A_1), A = 1010. After swap(A_1, A_2), A = 0110.
a = [3, 1], b = [2, 1]. Initially, A = 1010. After swap(A_3, A_2), A = 1100. After swap(A_1, A_1), A = 1100.

Out of 4 scenarios, 3 of them result in A = B. Therefore, P = 3 / 4, and Z = 3.





Sample Input 201001
01001





Sample Output 24

No swap ever changes A, so we'll always have A = B.





Sample Input 3101010
010101





Sample Output 336

Every possible sequence of three swaps puts the 1's in A into the right places.





Sample Input 41101011011110
0111101011101





Sample Output 4932171449


",Shuffle and Swap,"Combinatorics, Bipartite Graph, Arithmetic, Divide And Conquer",0.0,1,0
1123,"
Score : 900 points


Problem StatementWe have a tree with N vertices.
The vertices are numbered 0 through N - 1, and the i-th edge (0 ≤ i < N - 1) comnnects Vertex a_i and b_i.
For each pair of vertices u and v (0 ≤ u, v < N), we define the distance d(u, v) as the number of edges in the path u-v.
It is expected that one of the vertices will be invaded by aliens from outer space.
Snuke wants to immediately identify that vertex when the invasion happens.
To do so, he has decided to install an antenna on some vertices.
First, he decides the number of antennas, K (1 ≤ K ≤ N).
Then, he chooses K different vertices, x_0, x_1, ..., x_{K - 1}, on which he installs Antenna 0, 1, ..., K - 1, respectively.
If Vertex v is invaded by aliens, Antenna k (0 ≤ k < K) will output the distance d(x_k, v).
Based on these K outputs, Snuke will identify the vertex that is invaded.
Thus, in order to identify the invaded vertex no matter which one is invaded, the following condition must hold:

For each vertex u (0 ≤ u < N), consider the vector (d(x_0, u), ..., d(x_{K - 1}, u)). These N vectors are distinct.

Find the minumum value of K, the number of antennas, when the condition is satisfied.




Constraints
2 ≤ N ≤ 10^5
0 ≤ a_i, b_i < N
The given graph is a tree.







InputInput is given from Standard Input in the following format:
N
a_0 b_0
a_1 b_1
:
a_{N - 2} b_{N - 2}





OutputPrint the minumum value of K, the number of antennas, when the condition is satisfied.






Sample Input 15
0 1
0 2
0 3
3 4





Sample Output 12

For example, install an antenna on Vertex 1 and 3.
Then, the following five vectors are distinct:

(d(1, 0), d(3, 0)) = (1, 1)
(d(1, 1), d(3, 1)) = (0, 2)
(d(1, 2), d(3, 2)) = (2, 2)
(d(1, 3), d(3, 3)) = (2, 0)
(d(1, 4), d(3, 4)) = (3, 1)






Sample Input 22
0 1





Sample Output 21

For example, install an antenna on Vertex 0.





Sample Input 310
2 8
6 0
4 1
7 6
2 3
8 6
6 9
2 4
5 8





Sample Output 33

For example, install an antenna on Vertex 0, 4, 9.

",Antennas on Tree,"Graph Theory, Tree, Depth-first Search, Counting",0.571,14,6
1124,"
Score : 1000 points


Problem StatementYou are given a permutation p = (p_1, \ldots, p_N) of \{ 1, \ldots, N \}.
You can perform the following two kinds of operations repeatedly in any order:

Pay a cost A. Choose integers l and r (1 \leq l < r \leq N), and shift (p_l, \ldots, p_r) to the left by one. That is, replace p_l, p_{l + 1}, \ldots, p_{r - 1}, p_r with p_{l + 1}, p_{l + 2}, \ldots, p_r, p_l, respectively.
Pay a cost B. Choose integers l and r (1 \leq l < r \leq N), and shift (p_l, \ldots, p_r) to the right by one.  That is, replace p_l, p_{l + 1}, \ldots, p_{r - 1}, p_r with p_r, p_l, \ldots, p_{r - 2}, p_{r - 1}, respectively.

Find the minimum total cost required to sort p in ascending order.




Constraints
All values in input are integers.
1 \leq N \leq 5000
1 \leq A, B \leq 10^9
(p_1 \ldots, p_N) is a permutation of \{ 1, \ldots, N \}.







InputInput is given from Standard Input in the following format:
N A B
p_1 \cdots p_N





OutputPrint the minimum total cost required to sort p in ascending order.






Sample Input 13 20 30
3 1 2





Sample Output 120

Shifting (p_1, p_2, p_3) to the left by one results in p = (1, 2, 3).





Sample Input 24 20 30
4 2 3 1





Sample Output 250

One possible sequence of operations is as follows:

Shift (p_1, p_2, p_3, p_4) to the left by one. Now we have p = (2, 3, 1, 4).
Shift (p_1, p_2, p_3) to the right by one. Now we have p = (1, 2, 3, 4).

Here, the total cost is 20 + 30 = 50.





Sample Input 31 10 10
1





Sample Output 30






Sample Input 44 1000000000 1000000000
4 3 2 1





Sample Output 43000000000






Sample Input 59 40 50
5 3 4 7 6 1 2 9 8





Sample Output 5220


",Rotation Sort,"Dyanmic Programming, Permutation Cycle Decomposition, Dynamic Programming, Precomputation",0.444,13,7
1125,"
Score : 500 points


Problem StatementGiven is a connected undirected graph with N vertices and M edges. The vertices are numbered 1 to N, and the edges are described by a grid of characters S.
If S_{i,j} is 1, there is an edge connecting Vertex i and j; otherwise, there is no such edge.
Determine whether it is possible to divide the vertices into non-empty sets V_1, \dots, V_k such that the following condition is satisfied. If the answer is yes, find the maximum possible number of sets, k, in such a division.

Every edge connects two vertices belonging to two ""adjacent"" sets. More formally, for every edge (i,j), there exists 1\leq t\leq k-1 such that i\in V_t,j\in V_{t+1} or i\in V_{t+1},j\in V_t holds.





Constraints
2 \leq N \leq 200
S_{i,j} is 0 or 1.
S_{i,i} is 0.
S_{i,j}=S_{j,i}
The given graph is connected.
N is an integer.







InputInput is given from Standard Input in the following format:
N
S_{1,1}...S_{1,N}
:
S_{N,1}...S_{N,N}





OutputIf it is impossible to divide the vertices into sets so that the condition is satisfied, print -1.
Otherwise, print the maximum possible number of sets, k, in a division that satisfies the condition.






Sample Input 12
01
10





Sample Output 12

We can put Vertex 1 in V_1 and Vertex 2 in V_2.





Sample Input 23
011
101
110





Sample Output 2-1






Sample Input 36
010110
101001
010100
101000
100000
010000





Sample Output 34


",Graph Partition,"Graph Theory, Breadth-first Search, Shortest Path, Graph Traversal, Bruteforcing",0.714,34,19
1126,"
Score : 800 points


Problem StatementGiven are integers N and X. For each integer k between 0 and X (inclusive), find the answer to the following question, then compute the sum of all those answers, modulo 998244353.

Let us repeat the following operation on the integer k. Operation: if the integer is currently odd, subtract 1 from it and divide it by 2; otherwise, divide it by 2 and add 2^{N-1} to it. How many operations need to be performed until k returns to its original value? (The answer is considered to be 0 if k never returns to its original value.)





Constraints
1 \leq N \leq 2\times 10^5
0 \leq X < 2^N
X is given in binary and has exactly N digits. (In case X has less than N digits, it is given with leading zeroes.)
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
X





OutputPrint the sum of the answers to the questions for the integers between 0 and X (inclusive), modulo 998244353.






Sample Input 13
111





Sample Output 140

For example, for k=3, the operation changes k as follows: 1,0,4,6,7,3. Therefore the answer for k=3 is 6.





Sample Input 26
110101





Sample Output 2616






Sample Input 330
001110011011011101010111011100





Sample Output 3549320998


",Division by Two with Something,"Permutation Cycle Decomposition, Number Theory, Inclusion And Exclusion, String, Arithmetic",0.625,13,7
1127,"
Score : 900 points


Problem StatementTakahashi and Aoki are playing a stone-taking game. Initially, there are N piles of stones, and the i-th pile contains A_i stones and has an associated integer K_i.
Starting from Takahashi, Takahashi and Aoki take alternate turns to perform the following operation:

Choose a pile. If the i-th pile is selected and there are X stones left in the pile, remove some number of stones between 1 and floor(X/K_i) (inclusive) from the pile.

The player who first becomes unable to perform the operation loses the game. Assuming that both players play optimally, determine the winner of the game.
Here, floor(x) represents the largest integer not greater than x.




Constraints
1 \leq N \leq 200
1 \leq A_i,K_i \leq 10^9
All input values are integers.







InputInput is given from Standard Input in the following format:
N
A_1 K_1
:
A_N K_N





OutputIf Takahashi will win, print Takahashi; if Aoki will win, print Aoki.






Sample Input 12
5 2
3 3





Sample Output 1Aoki

Initially, from the first pile at most floor(5/2)=2 stones can be removed at a time, and from the second pile at most floor(3/3)=1 stone can be removed at a time.

If Takahashi first takes two stones from the first pile, from the first pile at most floor(3/2)=1 stone can now be removed at a time, and from the second pile at most floor(3/3)=1 stone can be removed at a time.
Then, if Aoki takes one stone from the second pile, from the first pile at most floor(3/2)=1 stone can be removed at a time, and from the second pile no more stones can be removed (since floor(2/3)=0).
Then, if Takahashi takes one stone from the first pile, from the first pile at most floor(2/2)=1 stone can now be removed at a time, and from the second pile no more stones can be removed.
Then, if Aoki takes one stone from the first pile, from the first pile at most floor(1/2)=0 stones can now be removed at a time, and from the second pile no more stones can be removed.

No more operation can be performed, thus Aoki wins. If Takahashi plays differently, Aoki can also win by play accordingly.





Sample Input 23
3 2
4 3
5 1





Sample Output 2Takahashi






Sample Input 33
28 3
16 4
19 2





Sample Output 3Aoki






Sample Input 44
3141 59
26535 897
93 23
8462 64





Sample Output 4Takahashi


",Strange Nim,"Game Theory, Mathematics, Bitmask, Recursion, Binary Search",0.25,9,3
1128,"
Score : 600 points


Problem StatementThere are N points in a two-dimensional plane. The initial coordinates of the i-th point are (x_i, y_i). Now, each point starts moving at a speed of 1 per second, in a direction parallel to the x- or y- axis. You are given a character d_i that represents the specific direction in which the i-th point moves, as follows:

If d_i = R, the i-th point moves in the positive x direction;
If d_i = L, the i-th point moves in the negative x direction;
If d_i = U, the i-th point moves in the positive y direction;
If d_i = D, the i-th point moves in the negative y direction.

You can stop all the points at some moment of your choice after they start moving (including the moment they start moving).
Then, let x_{max} and x_{min} be the maximum and minimum among the x-coordinates of the N points, respectively. Similarly, let y_{max} and y_{min} be the maximum and minimum among the y-coordinates of the N points, respectively.
Find the minimum possible value of (x_{max} - x_{min}) \times (y_{max} - y_{min}) and print it.




Constraints
1 \leq N \leq 10^5
-10^8 \leq x_i,\ y_i \leq 10^8
x_i and y_i are integers.
d_i is R, L, U, or D.







InputInput is given from Standard Input in the following format:
N
x_1 y_1 d_1
x_2 y_2 d_2
.
.
.
x_N y_N d_N





OutputPrint the minimum possible value of (x_{max} - x_{min}) \times (y_{max} - y_{min}).
The output will be considered correct when its absolute or relative error from the judge's output is at most 10^{-9}.






Sample Input 12
0 3 D
3 0 L





Sample Output 10

After three seconds, the two points will meet at the origin. The value in question will be 0 at that moment.





Sample Input 25
-7 -10 U
7 -6 U
-8 7 D
-3 3 D
0 -6 R





Sample Output 297.5

The answer may not be an integer.





Sample Input 320
6 -10 R
-4 -9 U
9 6 D
-3 -2 R
0 7 D
4 5 D
10 -10 U
-1 -8 U
10 -6 D
8 -5 U
6 4 D
0 3 D
7 9 R
9 -4 R
3 10 D
1 9 U
1 -6 U
9 -8 R
6 7 D
7 -3 D





Sample Output 3273


",Minimum Bounding Box,"Mathematics, Simulation, Convex Hull Trick, Data Structure, Backtracking, Numerical Analysis",0.0,11,2
1129,"
Score : 600 points


Problem StatementThere are N dots in a two-dimensional plane. The coordinates of the i-th dot are (x_i, y_i).
We will repeat the following operation as long as possible:

Choose four integers a, b, c, d (a \neq c, b \neq d) such that there are dots at exactly three of the positions (a, b), (a, d), (c, b) and (c, d), and add a dot at the remaining position.

We can prove that we can only do this operation a finite number of times. Find the maximum number of times we can do the operation.




Constraints
1 \leq N \leq 10^5
1 \leq x_i, y_i \leq 10^5
If i \neq j, x_i \neq x_j or y_i \neq y_j.
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
x_1 y_1
:
x_N y_N





OutputPrint the maximum number of times we can do the operation.






Sample Input 13
1 1
5 1
5 5





Sample Output 11

By choosing a = 1, b = 1, c = 5, d = 5, we can add a dot at (1, 5). We cannot do the operation any more, so the maximum number of operations is 1.





Sample Input 22
10 10
20 20





Sample Output 20

There are only two dots, so we cannot do the operation at all.





Sample Input 39
1 1
2 1
3 1
4 1
5 1
1 2
1 3
1 4
1 5





Sample Output 316

We can do the operation for all choices of the form a = 1, b = 1, c = i, d = j (2 \leq i,j \leq 5), and no more. Thus, the maximum number of operations is 16.

",Must Be Rectangular!,"Graph Theory, Graph Traversal, Set / Map, Counting",0.25,33,13
1130,"
Score : 600 points


Problem StatementFind the number of sequences of length K consisting of positive integers such that the product of any two adjacent elements is at most N, modulo 10^9+7.




Constraints
1\leq N\leq 10^9
1 2\leq K\leq 100 (fixed at 21:33 JST)
N and K are integers.







InputInput is given from Standard Input in the following format:
N K





OutputPrint the number of sequences, modulo 10^9+7.






Sample Input 13 2





Sample Output 15

(1,1), (1,2), (1,3), (2,1), and (3,1) satisfy the condition.





Sample Input 210 3





Sample Output 2147






Sample Input 3314159265 35





Sample Output 3457397712


",Small Products,"Mathematics, Number Theory, Dyanmic Programming, Prefix sum, Binary Search, Arithmetic",1.0,3,3
1131,"
Score : 500 points


Problem StatementYou are given a tree with N vertices and N-1 edges. The vertices are numbered 1 to N, and the i-th edge connects Vertex a_i and b_i.
You have coloring materials of K colors.
For each vertex in the tree, you will choose one of the K colors to paint it, so that the following condition is satisfied:

If the distance between two different vertices x and y is less than or equal to two, x and y have different colors.

How many ways are there to paint the tree? Find the count modulo 1\ 000\ 000\ 007.

What is tree?
A tree is a kind of graph. For detail, please see: Wikipedia ""Tree (graph theory)""
",Virus Tree 2,"Graph Theory, Tree, Depth-first Search, Combinatorics, Arithmetic",0.696,46,22
1132,"
Score : 600 points


Problem StatementLet us define the oddness of a permutation p = {p_1,\ p_2,\ ...,\ p_n} of {1,\ 2,\ ...,\ n} as \sum_{i = 1}^n |i - p_i|.
Find the number of permutations of {1,\ 2,\ ...,\ n} of oddness k, modulo 10^9+7.




Constraints
All values in input are integers.
1 \leq n \leq 50
0 \leq k \leq n^2







InputInput is given from Standard Input in the following format:
n k





OutputPrint the number of permutations of {1,\ 2,\ ...,\ n} of oddness k, modulo 10^9+7.






Sample Input 13 2





Sample Output 12

There are six permutations of {1,\ 2,\ 3}. Among them, two have oddness of 2:  {2,\ 1,\ 3} and {1,\ 3,\ 2}.





Sample Input 239 14





Sample Output 274764168


",Permutation Oddness,"Dyanmic Programming, Combinatorics, Graph Theory, Arithmetic, Dynamic Programming",0.75,4,3
1133,"
(Please read problem A first. The maximum score you can get by solving this problem C is 1, which will have almost no effect on your ranking.)


Beginner's Guide""Local search"" is a powerful method for finding a high-quality solution.
In this method, instead of constructing a solution from scratch, we try to find a better solution by slightly modifying the already found solution.
If the solution gets better, update it, and if it gets worse, restore it.
By repeating this process, the quality of the solution is gradually improved over time.
The pseudo-code is as follows.
solution = compute an initial solution (by random generation, or by applying other methods such as greedy)
while the remaining time > 0:
    slightly modify the solution (randomly)
    if the solution gets worse:
        restore the solution

For example, in this problem, we can use the following modification: pick the date d and contest type q at random and change the type of contest to be held on day d to q.
The pseudo-code is as follows.
t[1..D] = compute an initial solution (by random generation, or by applying other methods such as greedy)
while the remaining time > 0:
    pick d and q at random
    old = t[d] # Remember the original value so that we can restore it later
    t[d] = q
    if the solution gets worse:
        t[d] = old

The most important thing when using the local search method is the design of how to modify solutions.

If the amount of modification is too small, we will soon fall into a dead-end (local optimum) and, conversely, if the amount of modification is too large, the probability of finding an improving move becomes extremely small.
In order to increase the number of iterations, it is desirable to be able to quickly calculate the score after applying a modification.

In this problem C, we focus on the second point.
The score after the modification can, of course, be obtained by calculating the score from scratch.
However, by focusing on only the parts that have been modified, it may be possible to quickly compute the difference between the scores before and after the modification.
From another viewpoint, the impossibility of such a fast incremental calculation implies that a small modification to the solution affects a majority of the score calculation.
In such a case, we may need to redesign how to modify solutions, or there is a high possibility that the problem is not suitable for local search.
Let's implement fast incremental score computation.
It's time to demonstrate the skills of algorithms and data structures you have developed in ABC and ARC!
In this kind of contest, where the objective is to find a better solution instead of the optimal one, a bug in a program does not result in a wrong answer, which may delay the discovery of the bug.
For early detection of bugs, it is a good idea to unit test functions you implemented complicated routines.
For example, if you implement fast incremental score calculation, it is a good idea to test that the scores computed by the fast implementation match the scores computed from scratch, as we will do in this problem C.




Problem StatementYou will be given a contest schedule for D days and M queries of schedule modification.
In the i-th query, given integers d_i and q_i, change the type of contest to be held on day d_i to q_i, and then output the final satisfaction at the end of day D on the updated schedule.
Note that we do not revert each query. That is, the i-th query is applied to the new schedule obtained by the (i-1)-th query.






InputInput is given from Standard Input in the form of the input of Problem A followed by the output of Problem A and the queries.
D
c_1 c_2 \cdots c_{26}
s_{1,1} s_{1,2} \cdots s_{1,26}
\vdots
s_{D,1} s_{D,2} \cdots s_{D,26}
t_1
t_2
\vdots
t_D
M
d_1 q_1
d_2 q_2
\vdots
d_M q_M


The constraints and generation methods for the input part are the same as those for Problem A.
For each d=1,\ldots,D, t_d is an integer generated independently and uniformly at random from {1,2,\ldots,26}.
The number of queries M is an integer satisfying 1\leq M\leq 10^5.
For each i=1,\ldots,M, d_i is an integer generated independently and uniformly at random from {1,2,\ldots,D}.
For each i=1,\ldots,26, q_i is an integer satisfying 1\leq q_i\leq 26 generated uniformly at random from the 25 values that differ from the type of contest on day d_i.





OutputLet v_i be the final satisfaction at the end of day D on the schedule after applying the i-th query.
Print M integers v_i to Standard Output in the following format:
v_1
v_2
\vdots
v_M







Sample Input 15
86 90 69 51 2 96 71 47 88 34 45 46 89 34 31 38 97 84 41 80 14 4 50 83 7 82
19771 12979 18912 10432 10544 12928 13403 3047 10527 9740 8100 92 2856 14730 1396 15905 6534 4650 11469 3628 8433 2994 10899 16396 18355 11424
6674 17707 13855 16407 12232 2886 11908 1705 5000 1537 10440 10711 4917 10770 17272 15364 19277 18094 3929 3705 7169 6159 18683 15410 9092 4570
6878 4239 19925 1799 375 9563 3445 5658 19857 11401 6997 6498 19933 3848 2426 2146 19745 16880 17773 18359 3921 14172 16730 11157 5439 256
8633 15862 15303 10749 18499 7792 10317 5901 9395 11433 3514 3959 5202 19850 19469 9790 5653 784 18500 10552 17975 16615 7852 197 8471 7452
19855 17918 7990 10572 4333 438 9140 9104 12622 4985 12319 4028 19922 12132 16259 17476 2976 547 19195 19830 16285 4806 4471 9457 2864 2192
1
17
13
14
13
5
1 7
4 11
3 4
5 24
4 19





Sample Output 172882
56634
38425
27930
42884

Note that this example is a small one for checking the problem specification. It does not satisfy the constraint D=365 and is never actually given as a test case.




Next StepLet's go back to Problem A and implement the local search algorithm by utilizing the incremental score calculator you just implemented!
For this problem, the current modification ""pick the date d and contest type q at random and change the type of contest to be held on day d to q"" is actually not so good. By considering why it is not good, let's improve the modification operation.
One of the most powerful and widely used variant of the local search method is ""Simulated Annealing (SA)"", which makes it easier to reach a better solution by stochastically accepting worsening moves.
For more information about SA and other local search techniques, please refer to the editorial that will be published after the contest.

",Incremental Scoring,"Prefix sum, Segment Tree, Binary Search, Data Structures, Simulation",0.733,29,13
1134,"
Score : 500 points


Problem StatementThere is a directed graph with N vertices numbered 1 to N and M edges.
The i-th edge is directed from Vertex A_i to Vertex B_i, and there are C_i coins placed along that edge.
Additionally, there is a button on Vertex N.
We will play a game on this graph.
You start the game on Vertex 1 with zero coins, and head for Vertex N by traversing the edges while collecting coins.
It takes one minute to traverse an edge, and you can collect the coins placed along the edge each time you traverse it.
As usual in games, even if you traverse an edge once and collect the coins, the same number of coins will reappear next time you traverse that edge, which you can collect again.
When you reach Vertex N, you can end the game by pressing the button. (You can also choose to leave Vertex N without pressing the button and continue traveling.)
However, when you end the game, you will be asked to pay T \times P coins, where T is the number of minutes elapsed since the start of the game. If you have less than T \times P coins, you will have to pay all of your coins instead.
Your score will be the number of coins you have after this payment.
Determine if there exists a maximum value of the score that can be obtained. If the answer is yes, find that maximum value.




Constraints
2 \leq N \leq 2500
1 \leq M \leq 5000
1 \leq A_i, B_i \leq N
1 \leq C_i \leq 10^5
0 \leq P \leq 10^5
All values in input are integers.
Vertex N can be reached from Vertex 1.







InputInput is given from Standard Input in the following format:
N M P
A_1 B_1 C_1
:
A_M B_M C_M





OutputIf there exists a maximum value of the score that can be obtained, print that maximum value; otherwise, print -1.






Sample Input 13 3 10
1 2 20
2 3 30
1 3 45





Sample Output 135


There are two ways to travel from Vertex 1 to Vertex 3:

Vertex 1 \rightarrow 2 \rightarrow 3: You collect 20 + 30 = 50 coins on the way. After two minutes from the start of the game, you press the button, pay 2 \times 10 = 20 coins, and you have 50 - 20 = 30 coins left.
Vertex 1 \rightarrow 2: You collect 45 coins on the way. After one minute from the start of the game, you press the button, pay 1 \times 10 = 10 coins, and you have 45 - 10 = 35 coins left.

Thus, the maximum score that can be obtained is 35.





Sample Input 22 2 10
1 2 100
2 2 100





Sample Output 2-1


The edge extending from Vertex 1 takes you to Vertex 2. If you then traverse the edge extending from Vertex 2 to itself t times and press the button, your score will be 90 + 90t. Thus, you can infinitely increase your score, which means there is no maximum value of the score that can be obtained.





Sample Input 34 5 10
1 2 1
1 4 1
3 4 1
2 2 100
3 3 100





Sample Output 30


There is no way to travel from Vertex 1 to Vertex 4 other than traversing the edge leading from Vertex 1 to Vertex 4 directly. You will pick up one coin along this edge, but after being asked to paying 10 coins, your score will be 0.
Note that you can collect an infinite number of coins if you traverse the edge leading from Vertex 1 to Vertex 2, but this is pointless since you can no longer reach Vertex 4 and end the game.

",Coins Respawn,"Graph Theory, Depth-first Search, Shortest Path, Graph Theory",0.227,124,22
1135,"
Score : 700 points


Problem StatementTakahashi is locked within a building.
This building consists of H×W rooms, arranged in H rows and W columns.
We will denote the room at the i-th row and j-th column as (i,j). The state of this room is represented by a character A_{i,j}. If A_{i,j}= #, the room is locked and cannot be entered; if A_{i,j}= ., the room is not locked and can be freely entered.
Takahashi is currently at the room where A_{i,j}= S, which can also be freely entered.
Each room in the 1-st row, 1-st column, H-th row or W-th column, has an exit.
Each of the other rooms (i,j) is connected to four rooms: (i-1,j), (i+1,j), (i,j-1) and (i,j+1).
Takahashi will use his magic to get out of the building. In one cast, he can do the following:

Move to an adjacent room at most K times, possibly zero. Here, locked rooms cannot be entered.
Then, select and unlock at most K locked rooms, possibly zero. Those rooms will remain unlocked from then on.

His objective is to reach a room with an exit. Find the minimum necessary number of casts to do so.
It is guaranteed that Takahashi is initially at a room without an exit.




Constraints
3 ≤ H ≤ 800
3 ≤ W ≤ 800
1 ≤ K ≤ H×W
Each A_{i,j} is # , .  or S.
There uniquely exists (i,j) such that A_{i,j}= S, and it satisfies 2 ≤ i ≤ H-1 and 2 ≤ j ≤ W-1.







InputInput is given from Standard Input in the following format:
H W K
A_{1,1}A_{1,2}...A_{1,W}
:
A_{H,1}A_{H,2}...A_{H,W}





OutputPrint the minimum necessary number of casts.






Sample Input 13 3 3
#.#
#S.
###





Sample Output 11

Takahashi can move to room (1,2) in one cast.





Sample Input 23 3 3
###
#S#
###





Sample Output 22

Takahashi cannot move in the first cast, but can unlock room (1,2).
Then, he can move to room (1,2) in the next cast, achieving the objective in two casts.





Sample Input 37 7 2
#######
#######
##...##
###S###
##.#.##
###.###
#######





Sample Output 32


",Closed Rooms,"Breadth-first Search, Grid Graph, Mathematics, Arithmetic",0.375,45,13
1136,"
Score : 500 points


Problem StatementYou are given an integer N. Determine if there exists a tuple of subsets of \{1,2,...N\}, (S_1,S_2,...,S_k), that satisfies the following conditions:

Each of the integers 1,2,...,N is contained in exactly two of the sets S_1,S_2,...,S_k.
Any two of the sets S_1,S_2,...,S_k have exactly one element in common.

If such a tuple exists, construct one such tuple.




Constraints
1 \leq N \leq 10^5
N is an integer.







InputInput is given from Standard Input in the following format:
N





OutputIf a tuple of subsets of \{1,2,...N\} that satisfies the conditions does not exist, print No.
If such a tuple exists, print Yes first, then print such subsets in the following format:
k
|S_1| S_{1,1} S_{1,2} ... S_{1,|S_1|}
:
|S_k| S_{k,1} S_{k,2} ... S_{k,|S_k|}

where S_i={S_{i,1},S_{i,2},...,S_{i,|S_i|}}.
If there are multiple such tuples, any of them will be accepted.






Sample Input 13





Sample Output 1Yes
3
2 1 2
2 3 1
2 2 3

It can be seen that (S_1,S_2,S_3)=(\{1,2\},\{3,1\},\{2,3\}) satisfies the conditions.





Sample Input 24





Sample Output 2No


",Crossing,"Combinatorics, Binary Search, Graph Theory, Implementation",0.5,41,19
1137,"
Score : 800 points


Problem StatementLet’s take a prime P = 200\,003.
You are given N integers A_1, A_2, \ldots, A_N.
Find the sum of ((A_i \cdot A_j) \bmod P) over all N \cdot (N-1) / 2 unordered pairs of elements (i < j).
Please note that the sum isn't computed modulo P.




Constraints
2 \leq N \leq 200\,000
0 \leq A_i < P = 200\,003
All values in input are integers.







InputInput is given from Standard Input in the following format.
N
A_1 A_2 \cdots A_N





OutputPrint one integer — the sum over ((A_i \cdot A_j) \bmod P).






Sample Input 14
2019 0 2020 200002





Sample Output 1474287

The non-zero products are:

2019 \cdot 2020 \bmod P = 78320
2019 \cdot 200002 \bmod P = 197984
2020 \cdot 200002 \bmod P = 197983

So the answer is 0 + 78320 + 197984 + 0 + 0 + 197983 = 474287. 





Sample Input 25
1 1 2 2 100000





Sample Output 2600013


",Product Modulo,"Arithmetic, Number Theory, Counting, Fast Fourier Transform, Exponentiation By Squaring, Combinatorics",0.167,45,6
1138,"


					Max Score: $300$ Points 

Problem Statement
						We are playing a puzzle. An upright board with $H$ rows by $W$ columns of cells, is used in this puzzle. 
						A stone in $i$-th row and $j$-th column engraved with a digit, one of 1 through 9, is placed in each of the cells. 
						You can erase 1 cell in the board. 

						The game process is following: 

When $K$ or more stones in horizontally adjacent cells are engraved with the same digit, the stones will disappear. Disappearances of all such groups of stones take place simultaneously.
When stones are in the cells above the emptied cells, these stones drop down so that the emptied cells are filled.
After the completion of all stone drops, if one or more groups of stones satisfy the disappearance condition, repeat by returning to the step 1.
Score is $\sum_i 2^i \times \left(\text{Sum of numbers in the stones which disappeared in the $i$-th chain (0-indexed)}\right)$.

						Please answer the points if he erased the optimal place.






Input
							The input is given from standard input in the following format. ",Falling Stone Game,"Simulation, Two-pointer, Implementation, Bitmask, Bruteforcing, Array, Greedy Algorithm",0.667,4,2
1139,"
Score : 600 points


Problem StatementGiven are N points (x_i, y_i) in a two-dimensional plane.
Find the minimum radius of a circle such that all the points are inside or on it.




Constraints
2 \leq N \leq 50
0 \leq x_i \leq 1000
0 \leq y_i \leq 1000
The given N points are all different.
The values in input are all integers.







InputInput is given from Standard Input in the following format:
N
x_1 y_1
:
x_N y_N





OutputPrint the minimum radius of a circle such that all the N points are inside or on it.
Your output will be considered correct if the absolute or relative error from our answer is at most 10^{-6}.






Sample Input 12
0 0
1 0





Sample Output 10.500000000000000000

Both points are contained in the circle centered at (0.5,0) with a radius of 0.5.





Sample Input 23
0 0
0 1
1 0





Sample Output 20.707106781186497524






Sample Input 310
10 9
5 9
2 0
0 0
2 7
3 3
2 5
10 0
3 7
1 9





Sample Output 36.726812023536805158

If the absolute or relative error from our answer is at most 10^{-6}, the output will be considered correct.

",Enclose All,"Mathematics, Geometry; 3d,Dynamic Programming, Numerical Analysis",0.238,56,12
1140,"
Score : 600 points


Problem StatementThere are N piles of stones. The i-th pile has A_i stones.
Aoki and Takahashi are about to use them to play the following game:

Starting with Aoki, the two players alternately do the following operation:
Operation: Choose one pile of stones, and remove one or more stones from it.


When a player is unable to do the operation, he loses, and the other player wins.

When the two players play optimally, there are two possibilities in this game: the player who moves first always wins, or the player who moves second always wins, only depending on the initial number of stones in each pile.
In such a situation, Takahashi, the second player to act, is trying to guarantee his win by moving at least zero and at most (A_1 - 1) stones from the 1-st pile to the 2-nd pile before the game begins.
If this is possible, print the minimum number of stones to move to guarantee his victory; otherwise, print -1 instead.




Constraints
2 \leq N \leq 300
1 \leq A_i \leq 10^{12}







InputInput is given from Standard Input in the following format:
N
A_1 \ldots A_N





OutputPrint the minimum number of stones to move to guarantee Takahashi's win; otherwise, print -1 instead.






Sample Input 12
5 3





Sample Output 11

Without moving stones, if Aoki first removes 2 stones from the 1-st pile, Takahashi cannot win in any way.
If Takahashi moves 1 stone from the 1-st pile to the 2-nd before the game begins so that both piles have 4 stones, Takahashi can always win by properly choosing his actions.





Sample Input 22
3 5





Sample Output 2-1

It is not allowed to move stones from the 2-nd pile to the 1-st.





Sample Input 33
1 1 2





Sample Output 3-1

It is not allowed to move all stones from the 1-st pile.





Sample Input 48
10 9 8 7 6 5 4 3





Sample Output 43






Sample Input 53
4294967297 8589934593 12884901890





Sample Output 51

Watch out for overflows.

",Unfair Nim,"Boolean Operations On Geometric Objects, Xor Basis (gf(2)), Bitmask, Implementation",0.304,76,20
1141,"
Score : 800 points


Problem StatementThere is a connected undirected graph with N vertices and M edges.
The vertices are numbered 1 to N, and the edges are numbered 1 to M.
Also, each of these vertices and edges has a specified weight.
Vertex i has a weight of X_i; Edge i has a weight of Y_i and connects Vertex A_i and B_i.
We would like to remove zero or more edges so that the following condition is satisfied:

For each edge that is not removed, the sum of the weights of the vertices in the connected component containing that edge, is greater than or equal to the weight of that edge.

Find the minimum number of edges that need to be removed.




Constraints
1 \leq N \leq 10^5
N-1 \leq M \leq 10^5
1 \leq X_i \leq 10^9
1 \leq A_i < B_i \leq N
1 \leq Y_i \leq 10^9
(A_i,B_i) \neq (A_j,B_j) (i \neq j)
The given graph is connected.
All values in input are integers.







InputInput is given from Standard Input in the following format:
N M
X_1 X_2 ... X_N
A_1 B_1 Y_1
A_2 B_2 Y_2
:
A_M B_M Y_M





OutputFind the minimum number of edges that need to be removed.






Sample Input 14 4
2 3 5 7
1 2 7
1 3 9
2 3 12
3 4 18





Sample Output 12

Assume that we removed Edge 3 and 4.
In this case, the connected component containing Edge 1 contains Vertex 1, 2 and 3, and the sum of the weights of these vertices is 2+3+5=10.
The weight of Edge 1 is 7, so the condition is satisfied for Edge 1.
Similarly, it can be seen that the condition is also satisfied for Edge 2.
Thus, a graph satisfying the condition can be obtained by removing two edges.
The condition cannot be satisfied by removing one or less edges, so the answer is 2.





Sample Input 26 10
4 4 1 1 1 7
3 5 19
2 5 20
4 5 8
1 6 16
2 3 9
3 6 16
3 4 1
2 6 20
2 4 19
1 2 9





Sample Output 24






Sample Input 310 9
81 16 73 7 2 61 86 38 90 28
6 8 725
3 10 12
1 4 558
4 9 615
5 6 942
8 9 918
2 7 720
4 7 292
7 10 414





Sample Output 38


",Weights on Vertices and Edges,"Sorting, Greedy Algorithm, Disjoint Set, Graph Theory",0.429,22,8
1142,"
Score : 700 points


Problem StatementGiven are positive integers N and K.
Determine if the 3N integers K, K+1, ..., K+3N-1 can be partitioned into N triples (a_1,b_1,c_1), ..., (a_N,b_N,c_N) so that the condition below is satisfied. Any of the integers K, K+1, ..., K+3N-1 must appear in exactly one of those triples.

For every integer i from 1 to N, a_i + b_i \leq c_i holds.

If the answer is yes, construct one such partition.




Constraints
1 \leq N \leq 10^5
1 \leq K \leq 10^9







InputInput is given from Standard Input in the following format:
N K





OutputIf it is impossible to partition the integers satisfying the condition, print -1. If it is possible, print N triples in the following format:
a_1 b_1 c_1
:
a_N b_N c_N







Sample Input 11 1





Sample Output 11 2 3






Sample Input 23 3





Sample Output 2-1


",Non-triangular Triplets,"Greedy Algorithm, Arithmetic, Bruteforcing, Mathematics, Constructive",0.0,3,0
1143,"
Score: 800 points


Problem Statement
This is an interactive task.
We have 2N balls arranged in a row, numbered 1, 2, 3, ..., 2N from left to right, where N is an odd number. Among them, there are N red balls and N blue balls.
While blindfolded, you are challenged to guess the color of every ball correctly, by asking at most 210 questions of the following form:

You choose any N of the 2N balls and ask whether there are more red balls than blue balls or not among those N balls.

Now, let us begin.




Constraints

1 \leq N \leq 99
N is an odd number.






Input and Output
First, receive the number of balls of each color, N, from Standard Input:
N

Then, ask questions until you find out the color of every ball.
A question should be printed to Standard Output in the following format:
? A_1 A_2 A_3 ... A_N

This means that you are asking about the N balls A_1, A_2, A_3, ..., A_N, where 1 \leq A_i \leq 2N and A_i \neq A_j (i \neq j) must hold.
The response T to this question will be given from Standard Input in the following format:
T

Here T is one of the following strings:

Red: Among the N balls chosen, there are more red balls than blue balls.
Blue: Among the N balls chosen, there are more blue balls than red balls.
-1: You printed an invalid question (including the case you asked more than 210 questions), or something else that was invalid.

If the judge returns -1, your submission is already judged as incorrect. The program should immediately quit in this case.
When you find out the color of every ball, print your guess to Standard Output in the following format:
! c_1c_2c_3...c_{2N}

Here c_i should be the character representing the color of Ball i; use R for red and B for blue.




Notice

Flush Standard Output each time you print something. Failure to do so may result in TLE.
Immediately terminate your program after printing your guess (or receiving the -1 response). Otherwise, the verdict will be indeterminate.
If your program prints something invalid, the verdict will be indeterminate.






Sample Input and Output


Input
Output


3




? 1 2 3


Red




? 2 4 6


Blue




! RRBBRB


In this sample, N = 3, and the colors of Ball 1, 2, 3, 4, 5, 6 are red, red, blue, blue, red, blue, respectively.

In the first question, there are two red balls and one blue ball among the balls 1, 2, 3, so the judge returns Red.
In the second question, there are one red ball and two blue balls among the balls 2, 4, 6, so the judge returns Blue.


",Majority of Balls,"Binary Search, Arithmetic, Interactive, Array, Constructive",0.167,36,5
1144,"
Score : 400 points


Problem StatementDolphin is planning to generate a small amount of a certain chemical substance C.
In order to generate the substance C, he must prepare a solution which is a mixture of two substances A and B in the ratio of M_a:M_b.
He does not have any stock of chemicals, however, so he will purchase some chemicals at a local pharmacy.
The pharmacy sells N kinds of chemicals. For each kind of chemical, there is exactly one package of that chemical in stock.
The package of chemical i contains a_i grams of the substance A and b_i grams of the substance B, and is sold for c_i yen (the currency of Japan).
Dolphin will purchase some of these packages. For some reason, he must use all contents of the purchased packages to generate the substance C.
Find the minimum amount of money required to generate the substance C.
If it is not possible to generate the substance C by purchasing any combination of packages at the pharmacy, report that fact.  




Constraints
1≦N≦40 
1≦a_i,b_i≦10 
1≦c_i≦100 
1≦M_a,M_b≦10 
gcd(M_a,M_b)=1
a_i, b_i, c_i, M_a and M_b are integers.







InputThe input is given from Standard Input in the following format:
N M_a M_b  
a_1 b_1 c_1  
a_2 b_2 c_2
:  
a_N b_N c_N  





OutputPrint the minimum amount of money required to generate the substance C. If it is not possible to generate the substance C, print -1 instead.






Sample Input 13 1 1
1 2 1
2 1 2
3 3 10





Sample Output 13

The amount of money spent will be minimized by purchasing the packages of chemicals 1 and 2.
In this case, the mixture of the purchased chemicals will contain 3 grams of the substance A and 3 grams of the substance B, which are in the desired ratio: 3:3=1:1.
The total price of these packages is 3 yen.  





Sample Input 21 1 10
10 10 10





Sample Output 2-1

The ratio 1:10 of the two substances A and B cannot be satisfied by purchasing any combination of the packages. Thus, the output should be -1.

",Mixing Experiment,"Dyanmic Programming, Dynamic Programming, Arithmetic",0.333,121,26
1145,"
Score : 600 points


Problem StatementAtCoDeer the deer has N cards with positive integers written on them. The number on the i-th card (1≤i≤N) is a_i.
Because he loves big numbers, he calls a subset of the cards good when the sum of the numbers written on the cards in the subset, is K or greater.
Then, for each card i, he judges whether it is unnecessary or not, as follows:

If, for any good subset of the cards containing card i, the set that can be obtained by eliminating card i from the subset is also good, card i is unnecessary.
Otherwise, card i is NOT unnecessary.

Find the number of the unnecessary cards. Here, he judges each card independently, and he does not throw away cards that turn out to be unnecessary.




Constraints
All input values are integers.
1≤N≤5000
1≤K≤5000
1≤a_i≤10^9 (1≤i≤N)





Partial Score
300 points will be awarded for passing the test set satisfying N,K≤400.







InputThe input is given from Standard Input in the following format:
N K
a_1 a_2 ... a_N





OutputPrint the number of the unnecessary cards.






Sample Input 13 6
1 4 3





Sample Output 11

There are two good sets: {2,3} and {1,2,3}.
Card 1 is only contained in {1,2,3}, and this set without card 1, {2,3}, is also good. Thus, card 1 is unnecessary.
For card 2, a good set {2,3} without card 2, {3}, is not good. Thus, card 2 is NOT unnecessary.
Neither is card 3 for a similar reason, hence the answer is 1.





Sample Input 25 400
3 1 4 1 5





Sample Output 25

In this case, there is no good set. Therefore, all the cards are unnecessary.





Sample Input 36 20
10 4 3 10 25 2





Sample Output 33


",No Need,"Sorting, Binary Search, Dyanmic Programming, Bit Set, Prefix sum, Dynamic Programming, Two-pointer",0.143,55,10
1146,"
Score : 1000 points


Problem StatementAtCoDeer the deer found N rectangle lying on the table, each with height 1.
If we consider the surface of the desk as a two-dimensional plane, the i-th rectangle i(1≤i≤N) covers the vertical range of [i-1,i] and the horizontal range of [l_i,r_i], as shown in the following figure:

AtCoDeer will move these rectangles horizontally so that all the rectangles are connected.
For each rectangle, the cost to move it horizontally by a distance of x, is x.
Find the minimum cost to achieve connectivity.
It can be proved that this value is always an integer under the constraints of the problem.




Constraints
All input values are integers.
1≤N≤10^5
1≤l_i<r_i≤10^9





Partial Score
300 points will be awarded for passing the test set satisfying 1≤N≤400 and 1≤l_i<r_i≤400.







InputThe input is given from Standard Input in the following format:
N
l_1 r_1
l_2 r_2
:
l_N r_N





OutputPrint the minimum cost to achieve connectivity.






Sample Input 13
1 3
5 7
1 3





Sample Output 12

The second rectangle should be moved to the left by a distance of 2.





Sample Input 23
2 5
4 6
1 4





Sample Output 20

The rectangles are already connected, and thus no move is needed.





Sample Input 35
999999999 1000000000
1 2
314 315
500000 500001
999999999 1000000000





Sample Output 31999999680






Sample Input 45
123456 789012
123 456
12 345678901
123456 789012
1 23





Sample Output 4246433






Sample Input 51
1 400





Sample Output 50


",NarrowRectangles,"Sorting, Arithmetic, Dyanmic Programming, Greedy Algorithm, Convex Hull Trick, Prefix sum",0.0,4,0
1147,"
Score : 600 points


Problem StatementGiven are two strings s and t consisting of lowercase English letters. Determine if the number of non-negative integers i satisfying the following condition is finite, and find the maximum value of such i if the number is finite.

There exists a non-negative integer j such that the concatenation of i copies of t is a substring of the concatenation of j copies of s.





Notes

A string a is a substring of another string b if and only if there exists an integer x (0 \leq x \leq |b| - |a|) such that, for any y (1 \leq y \leq |a|), a_y = b_{x+y} holds.


We assume that the concatenation of zero copies of any string is the empty string. From the definition above, the empty string is a substring of any string. Thus, for any two strings s and t, i = 0 satisfies the condition in the problem statement.






Constraints
1 \leq |s| \leq 5 \times 10^5
1 \leq |t| \leq 5 \times 10^5
s and t consist of lowercase English letters.







InputInput is given from Standard Input in the following format:
s
t





OutputIf the number of non-negative integers i satisfying the following condition is finite, print the maximum value of such i; if the number is infinite, print -1.






Sample Input 1abcabab
ab





Sample Output 13

The concatenation of three copies of t, ababab, is a substring of the concatenation of two copies of s, abcabababcabab, so i = 3 satisfies the condition.
On the other hand, the concatenation of four copies of t, abababab, is not a substring of the concatenation of any number of copies of s, so i = 4 does not satisfy the condition.
Similarly, any integer greater than 4 does not satisfy the condition, either. Thus, the number of non-negative integers i satisfying the condition is finite, and the maximum value of such i is 3.





Sample Input 2aa
aaaaaaa





Sample Output 2-1

For any non-negative integer i, the concatenation of i copies of t is a substring of the concatenation of 4i copies of s. Thus, there are infinitely many non-negative integers i that satisfy the condition.





Sample Input 3aba
baaab





Sample Output 30

As stated in Notes, i = 0 always satisfies the condition.

",Strings of Eternity,"String, Sliding Window",0.0,41,4
1148,"
Score : 900 points


Problem StatementTakahashi has an ability to generate a tree using a permutation (p_1,p_2,...,p_n) of (1,2,...,n), in the following process:
First, prepare Vertex 1, Vertex 2, ..., Vertex N.
For each i=1,2,...,n, perform the following operation:

If p_i = 1, do nothing.
If p_i \neq 1, let j' be the largest j such that p_j < p_i. Span an edge between Vertex i and Vertex j'.

Takahashi is trying to make his favorite tree with this ability.
His favorite tree has n vertices from Vertex 1 through Vertex n, and its i-th edge connects Vertex v_i and w_i.
Determine if he can make a tree isomorphic to his favorite tree by using a proper permutation.
If he can do so, find the lexicographically smallest such permutation.




NotesFor the definition of isomorphism of trees, see wikipedia. Intuitively, two trees are isomorphic when they are the ""same"" if we disregard the indices of their vertices.




Constraints
2 \leq n \leq 10^5
1 \leq v_i, w_i \leq n
The given graph is a tree.







InputInput is given from Standard Input in the following format:
n
v_1 w_1
v_2 w_2
:
v_{n-1} w_{n-1}





OutputIf there is no permutation that can generate a tree isomorphic to Takahashi's favorite tree, print -1.
If it exists, print the lexicographically smallest such permutation, with spaces in between.






Sample Input 16
1 2
1 3
1 4
1 5
5 6





Sample Output 11 2 4 5 3 6

If the permutation (1, 2, 4, 5, 3, 6) is used to generate a tree, it looks as follows:

This is isomorphic to the given graph.





Sample Input 26
1 2
2 3
3 4
1 5
5 6





Sample Output 21 2 3 4 5 6






Sample Input 315
1 2
1 3
2 4
2 5
3 6
3 7
4 8
4 9
5 10
5 11
6 12
6 13
7 14
7 15





Sample Output 3-1


",Permutation Tree,"Graph Theory, Depth-first Search, Tree, Permutation Cycle Decomposition, Sorting, Recursion",0.0,7,1
1149,"
Score: 600 points


Problem Statement
How many strings can be obtained by applying the following operation on a string S exactly K times: ""choose one lowercase English letter and insert it somewhere""?
The answer can be enormous, so print it modulo (10^9+7).




Constraints

K is an integer between 1 and 10^6 (inclusive).
S is a string of length between 1 and 10^6 (inclusive) consisting of lowercase English letters.







Input
Input is given from Standard Input in the following format:
K
S





Output
Print the number of strings satisfying the condition, modulo (10^9+7).






Sample Input 15
oof





Sample Output 1575111451

For example, we can obtain proofend, moonwolf, and onionpuf, while we cannot obtain oofsix, oofelevennn, voxafolt, or fooooooo.





Sample Input 237564
whydidyoudesertme





Sample Output 2318008117


",Strivore,"Combinatorics, Arithmetic, Exponentiation By Squaring, Precomputation, Prefix sum, Mathematics",0.529,61,35
1150,"
Score : 500 points


Problem StatementWe have a sequence of N integers: A_1, A_2, \cdots, A_N.
You can perform the following operation between 0 and K times (inclusive):

Choose two integers i and j such that i \neq j, each between 1 and N (inclusive). Add 1 to A_i and -1 to A_j, possibly producing a negative element.

Compute the maximum possible positive integer that divides every element of A after the operations. Here a positive integer x divides an integer y if and only if there exists an integer z such that y = xz.




Constraints
2 \leq N \leq 500
1 \leq A_i \leq 10^6
0 \leq K \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N K
A_1 A_2 \cdots A_{N-1} A_{N}





OutputPrint the maximum possible positive integer that divides every element of A after the operations.






Sample Input 12 3
8 20





Sample Output 17

7 will divide every element of A if, for example, we perform the following operation:

Choose i = 2, j = 1. A becomes (7, 21).

We cannot reach the situation where 8 or greater integer divides every element of A.





Sample Input 22 10
3 5





Sample Output 28

Consider performing the following five operations:

Choose i = 2, j = 1. A becomes (2, 6).
Choose i = 2, j = 1. A becomes (1, 7).
Choose i = 2, j = 1. A becomes (0, 8).
Choose i = 2, j = 1. A becomes (-1, 9).
Choose i = 1, j = 2. A becomes (0, 8).

Then, 0 = 8 \times 0 and 8 = 8 \times 1, so 8 divides every element of A. We cannot reach the situation where 9 or greater integer divides every element of A.





Sample Input 34 5
10 1 2 22





Sample Output 37






Sample Input 48 7
1 7 5 6 8 2 6 5





Sample Output 45


",Max GCD,"Number Theory, Arithmetic, Sorting, Prefix sum, Greedy Algorithm, Two-pointer",0.333,70,21
1151,"
Score : 600 points


Problem StatementWe have an integer sequence A of length N, where A_1 = X, A_{i+1} = A_i + D (1 \leq  i < N ) holds.
Takahashi will take some (possibly all or none) of the elements in this sequence, and Aoki will take all of the others.
Let S and T be the sum of the numbers taken by Takahashi and Aoki, respectively. How many possible values of S - T are there?




Constraints
-10^8 \leq X, D \leq 10^8
1 \leq N \leq 2 \times 10^5
All values in input are integers.







InputInput is given from Standard Input in the following format:
N X D





OutputPrint the number of possible values of S - T.






Sample Input 13 4 2





Sample Output 18

A is (4, 6, 8).
There are eight ways for (Takahashi, Aoki) to take the elements: ((), (4, 6, 8)), ((4), (6, 8)), ((6), (4, 8)), ((8), (4, 6))), ((4, 6), (8))), ((4, 8), (6))), ((6, 8), (4))), and ((4, 6, 8), ()).
The values of S - T in these ways are -18, -10, -6, -2, 2, 6, 10, and 18, respectively, so there are eight possible values of S - T.





Sample Input 22 3 -3





Sample Output 22

A is (3, 0). There are two possible values of S - T: -3 and 3.





Sample Input 3100 14 20





Sample Output 349805


",Sum Difference,"Arithmetic, Dynamic Programming, Array, Number Theory, Counting",0.0,22,4
1152,"
Score : 300 points


Problem StatementThere are N stones arranged in a row. Every stone is painted white or black.
A string S represents the color of the stones. The i-th stone from the left is white if the i-th character of S is ., and the stone is black if the character is #.
Takahashi wants to change the colors of some stones to black or white so that there will be no white stone immediately to the right of a black stone.
Find the minimum number of stones that needs to be recolored.




Constraints
1 \leq N \leq 2\times 10^5
S is a string of length N consisting of . and #.







InputInput is given from Standard Input in the following format:
N
S





OutputPrint the minimum number of stones that needs to be recolored.






Sample Input 13
#.#





Sample Output 11

It is enough to change the color of the first stone to white.





Sample Input 25
#.##.





Sample Output 22






Sample Input 39
.........





Sample Output 30


",Stones,"Prefix sum, Enumeration, Greedy Algorithm, Counting",0.292,80,15
1153,"
Score : 600 points


Problem Statement
In Dwango Co., Ltd., there is a content distribution system named 'Dwango Media Cluster', and it is called 'DMC' for short.
The name 'DMC' sounds cool for Niwango-kun, so he starts to define DMC-ness of a string.
Given a string S of length N and an integer k (k \geq 3),
he defines the k-DMC number of S as the number of triples (a, b, c) of integers that satisfy the following conditions:

0 \leq a < b < c \leq N - 1
S[a] = D
S[b] = M
S[c] = C
c-a < k

Here S[a] is the a-th character of the string S. Indexing is zero-based, that is, 0 \leq a \leq N - 1 holds.
For a string S and Q integers k_0, k_1, ..., k_{Q-1}, calculate the k_i-DMC number of S for each i (0 \leq i \leq Q-1).




Constraints

3 \leq N \leq 10^6
S consists of uppercase English letters
1 \leq Q \leq 75
3 \leq k_i \leq N
All numbers given in input are integers







Input
Input is given from Standard Input in the following format:
N
S
Q
k_{0} k_{1} ... k_{Q-1}





Output
Print Q lines.
The i-th line should contain the k_i-DMC number of the string S.






Sample Input 1
18
DWANGOMEDIACLUSTER
1
18





Sample Output 1
1

(a,b,c) = (0, 6, 11) satisfies the conditions.
Strangely, Dwango Media Cluster does not have so much DMC-ness by his definition.





Sample Input 2
18
DDDDDDMMMMMCCCCCCC
1
18





Sample Output 2
210

The number of triples can be calculated as 6\times 5\times 7.





Sample Input 3
54
DIALUPWIDEAREANETWORKGAMINGOPERATIONCORPORATIONLIMITED
3
20 30 40





Sample Output 3
0
1
2

(a, b, c) = (0, 23, 36), (8, 23, 36) satisfy the conditions except the last one, namely, c-a < k_i.
By the way, DWANGO is an acronym for ""Dial-up Wide Area Network Gaming Operation"".





Sample Output 4
30
DMCDMCDMCDMCDMCDMCDMCDMCDMCDMC
4
5 10 15 20





Sample Output 4
10
52
110
140


",k-DMC,"Prefix sum, Sliding Window, Two-pointer, Combinatorics",0.222,18,4
1154,"
Score : 500 points


Problem StatementThere are N cards. The i-th card has an integer A_i written on it.
For any two cards, the integers on those cards are different.
Using these cards, Takahashi and Aoki will play the following game:

Aoki chooses an integer x.
Starting from Takahashi, the two players alternately take a card. The card should be chosen in the following manner:
Takahashi should take the card with the largest integer among the remaining card.
Aoki should take the card with the integer closest to x among the remaining card. If there are multiple such cards, he should take the card with the smallest integer among those cards.


The game ends when there is no card remaining.

You are given Q candidates for the value of x: X_1, X_2, ..., X_Q.
For each i (1 \leq i \leq Q), find the sum of the integers written on the cards that Takahashi will take if Aoki chooses x = X_i.




Constraints
2 \leq N \leq 100 000
1 \leq Q \leq 100 000
1 \leq A_1 < A_2 < ... < A_N \leq 10^9
1 \leq X_i \leq 10^9 (1 \leq i \leq Q)
All values in input are integers.







InputInput is given from Standard Input in the following format:
N Q
A_1 A_2 ... A_N
X_1
X_2
:
X_Q





OutputPrint Q lines. The i-th line (1 \leq i \leq Q) should contain the answer for x = X_i.






Sample Input 15 5
3 5 7 11 13
1
4
9
10
13





Sample Output 131
31
27
23
23

For example, when x = X_3(= 9), the game proceeds as follows:

Takahashi takes the card with 13.
Aoki takes the card with 7.
Takahashi takes the card with 11.
Aoki takes the card with 5.
Takahashi takes the card with 3.

Thus, 13 + 11 + 3 = 27 should be printed on the third line.





Sample Input 24 3
10 20 30 40
2
34
34





Sample Output 270
60
60


",Nearest Card Game,"Binary Search, Prefix sum, Two-pointer, Sorting, Greedy Algorithm, Implementation",0.091,43,5
1155,"
Score : 600 points


Problem StatementAtCoDeer the deer has N cards with positive integers written on them. The number on the i-th card (1≤i≤N) is a_i.
Because he loves big numbers, he calls a subset of the cards good when the sum of the numbers written on the cards in the subset, is K or greater.
Then, for each card i, he judges whether it is unnecessary or not, as follows:

If, for any good subset of the cards containing card i, the set that can be obtained by eliminating card i from the subset is also good, card i is unnecessary.
Otherwise, card i is NOT unnecessary.

Find the number of the unnecessary cards. Here, he judges each card independently, and he does not throw away cards that turn out to be unnecessary.




Constraints
All input values are integers.
1≤N≤5000
1≤K≤5000
1≤a_i≤10^9 (1≤i≤N)





Partial Score
300 points will be awarded for passing the test set satisfying N,K≤400.







InputThe input is given from Standard Input in the following format:
N K
a_1 a_2 ... a_N





OutputPrint the number of the unnecessary cards.






Sample Input 13 6
1 4 3





Sample Output 11

There are two good sets: {2,3} and {1,2,3}.
Card 1 is only contained in {1,2,3}, and this set without card 1, {2,3}, is also good. Thus, card 1 is unnecessary.
For card 2, a good set {2,3} without card 2, {3}, is not good. Thus, card 2 is NOT unnecessary.
Neither is card 3 for a similar reason, hence the answer is 1.





Sample Input 25 400
3 1 4 1 5





Sample Output 25

In this case, there is no good set. Therefore, all the cards are unnecessary.





Sample Input 36 20
10 4 3 10 25 2





Sample Output 33


",No Need,"Dyanmic Programming, Prefix sum, Sorting, Combinatorics, Dynamic Programming",0.125,68,12
1156,"
Score : 2400 points


Problem StatementTakahashi and Aoki love calculating things, so they will play with numbers now.
First, they came up with one positive integer each. Takahashi came up with X, and Aoki came up with Y.
Then, they will enjoy themselves by repeating the following operation K times:

Compute the bitwise AND of the number currently kept by Takahashi and the number currently kept by Aoki. Let Z be the result.
Then, add Z to both of the numbers kept by Takahashi and Aoki.

However, it turns out that even for the two math maniacs this is just too much work.
Could you find the number that would be kept by Takahashi and the one that would be kept by Aoki eventually?
Note that input and output are done in binary.
Especially, X and Y are given as strings S and T of length N and M consisting of 0 and 1, respectively, whose initial characters are guaranteed to be 1.




Constraints
1 ≤ K ≤ 10^6
1 ≤ N,M ≤ 10^6
The initial characters of S and T are 1.







InputInput is given from Standard Input in the following format:
N M K
S
T





OutputIn the first line, print the number that would be kept by Takahashi eventually; in the second line, print the number that would be kept by Aoki eventually.
Those numbers should be represented in binary and printed as strings consisting of 0 and 1 that begin with 1.






Sample Input 12 3 3
11
101





Sample Output 110000
10010

The values of X and Y after each operation are as follows:

After the first operation: (X,Y)=(4,6).
After the second operation: (X,Y)=(8,10).
After the third operation: (X,Y)=(16,18).






Sample Input 25 8 3
10101
10101001





Sample Output 2100000
10110100






Sample Input 310 10 10
1100110011
1011001101





Sample Output 310000100000010001000
10000100000000100010


",Addition and Andition,"Boolean Operations On Geometric Objects, Mathematics, Number Theory",0.0,10,0
1157,"
Score : 700 points


Problem StatementThere are some coins in the xy-plane.
The positions of the coins are represented by a grid of characters with H rows and W columns.
If the character at the i-th row and j-th column, s_{ij}, is #, there is one coin at point (i,j); if that character is ., there is no coin at point (i,j). There are no other coins in the xy-plane.
There is no coin at point (x,y) where 1\leq i\leq H,1\leq j\leq W does not hold.
There is also no coin at point (x,y) where x or y (or both) is not an integer.
Additionally, two or more coins never exist at the same point.
Find the number of triples of different coins that satisfy the following condition:

Choosing any two of the three coins would result in the same Manhattan distance between the points where they exist.

Here, the Manhattan distance between points (x,y) and (x',y') is |x-x'|+|y-y'|.
Two triples are considered the same if the only difference between them is the order of the coins.




Constraints
1 \leq H,W \leq 300
s_{ij} is # or ..







InputInput is given from Standard Input in the following format:
H W
s_{11}...s_{1W}
:
s_{H1}...s_{HW}





OutputPrint the number of triples that satisfy the condition.






Sample Input 15 4
#.##
.##.
#...
..##
...#





Sample Output 13

((1,1),(1,3),(2,2)),((1,1),(2,2),(3,1)) and ((1,3),(3,1),(4,4)) satisfy the condition.





Sample Input 213 27
......#.........#.......#..
#############...#.....###..
..............#####...##...
...#######......#...#######
...#.....#.....###...#...#.
...#######....#.#.#.#.###.#
..............#.#.#...#.#..
#############.#.#.#...###..
#...........#...#...#######
#..#######..#...#...#.....#
#..#.....#..#...#...#.###.#
#..#######..#...#...#.#.#.#
#..........##...#...#.#####





Sample Output 2870


",Equilateral,"Geometry; 3d, Prefix sum, Bruteforcing, Counting, Constructive, Matrix",0.4,7,2
1158,"
Score : 700 points


Problem StatementThere are N strings arranged in a row.
It is known that, for any two adjacent strings, the string to the left is lexicographically smaller than the string to the right.
That is, S_1<S_2<...<S_N holds lexicographically, where S_i is the i-th string from the left.
At least how many different characters are contained in S_1,S_2,...,S_N, if the length of S_i is known to be A_i?




Constraints
1 \leq N \leq 2\times 10^5
1 \leq A_i \leq 10^9
A_i is an integer.





NoteThe strings do not necessarily consist of English alphabet; there can be arbitrarily many different characters (and the lexicographic order is defined for those characters).






InputInput is given from Standard Input in the following format:
N
A_1 A_2 ... A_N





OutputPrint the minimum possible number of different characters contained in the strings.






Sample Input 13
3 2 1





Sample Output 12

The number of different characters contained in S_1,S_2,...,S_N would be 3 when, for example, S_1=abc, S_2=bb and S_3=c.
However, if we choose the strings properly, the number of different characters can be 2.





Sample Input 25
2 3 2 1 2





Sample Output 22


",Lexicographic constraints,"Binary Search, Greedy Algorithm, Stack, Mathematics, 2-sat, Array, Set / Map, Tree, Two-pointer",0.286,60,9
1159,"
Score : 500 points


Problem StatementCount the pairs of length-N sequences consisting of integers between 1 and M (inclusive), A_1, A_2, \cdots, A_{N} and B_1, B_2, \cdots, B_{N}, that satisfy all of the following conditions:

A_i \neq B_i, for every i such that 1\leq i\leq N.
A_i \neq A_j and B_i \neq B_j, for every (i, j) such that 1\leq i < j\leq N.

Since the count can be enormous, print it modulo (10^9+7).




Constraints
1\leq N \leq M \leq 5\times10^5
All values in input are integers.







InputInput is given from Standard Input in the following format:
N M





OutputPrint the count modulo (10^9+7).






Sample Input 12 2





Sample Output 12

A_1=1,A_2=2,B_1=2,B_2=1 and A_1=2,A_2=1,B_1=1,B_2=2 satisfy the conditions.





Sample Input 22 3





Sample Output 218






Sample Input 3141421 356237





Sample Output 3881613484


",NEQ,"Combinatorics, Inclusion And Exclusion, Arithmetic, Precomputation, Number Theory, Exponentiation By Squaring",0.739,29,20
1160,"
Score : 700 points


Problem StatementAoki is playing with a sequence of numbers a_{1}, a_{2}, ..., a_{N}. Every second, he performs the following operation :

Choose a positive integer k. For each element of the sequence v, Aoki may choose to replace v with its remainder when divided by k, or do nothing with v. The cost of this operation is 2^{k} (regardless of how many elements he changes).

Aoki wants to turn the sequence into b_{1}, b_{2}, ..., b_{N} (the order of the elements is important). Determine if it is possible for Aoki to perform this task and if yes, find the minimum cost required.




Constraints
1 \leq N \leq 50
0 \leq a_{i}, b_{i} \leq 50
All values in the input are integers.







InputInput is given from Standard Input in the following format:
N
a_{1} a_{2} ... a_{N}
b_{1} b_{2} ... b_{N}





OutputPrint the minimum cost required to turn the original sequence into b_{1}, b_{2}, ..., b_{N}. If the task is impossible, output -1 instead.






Sample Input 13
19 10 14
0 3 4





Sample Output 1160

Here's a possible sequence of operations :


Choose k = 7. Replace 19 with 5, 10 with 3 and do nothing to 14. The sequence is now 5, 3, 14.


Choose k = 5. Replace 5 with 0, do nothing to 3 and replace 14 with 4. The sequence is now 0, 3, 4.


The total cost is 2^{7} + 2^{5} = 160.





Sample Input 23
19 15 14
0 0 0





Sample Output 22

Aoki can just choose k = 1 and turn everything into 0. The cost is 2^{1} = 2.





Sample Input 32
8 13
5 13





Sample Output 3-1

The task is impossible because we can never turn 8 into 5 using the given operation.





Sample Input 44
2 0 1 8
2 0 1 8





Sample Output 40

Aoki doesn't need to do anything here. The cost is 0.





Sample Input 51
50
13





Sample Output 5137438953472

Beware of overflow issues.

",Remainder Game,"Dyanmic Programming, Bitmask, Greedy Algorithm, Dynamic Programming, Arithmetic, Set / Map",0.333,17,4
1161,"
Score : 500 points


Problem StatementYou are given a connected undirected simple graph, which has N vertices and M edges.
The vertices are numbered 1 through N, and the edges are numbered 1 through M.
Edge i connects vertices A_i and B_i.
Your task is to find a path that satisfies the following conditions:

The path traverses two or more vertices.
The path does not traverse the same vertex more than once.
A vertex directly connected to at least one of the endpoints of the path, is always contained in the path.

It can be proved that such a path always exists.
Also, if there are more than one solution, any of them will be accepted.




Constraints
2 \leq N \leq 10^5
1 \leq M \leq 10^5
1 \leq A_i < B_i \leq N
The given graph is connected and simple (that is, for every pair of vertices, there is at most one edge that directly connects them).







InputInput is given from Standard Input in the following format:
N M
A_1 B_1
A_2 B_2
:
A_M B_M





OutputFind one path that satisfies the conditions, and print it in the following format.
In the first line, print the count of the vertices contained in the path.
In the second line, print a space-separated list of the indices of the vertices, in order of appearance in the path.






Sample Input 15 6
1 3
1 4
2 3
1 5
3 5
2 4





Sample Output 14
2 3 1 4

There are two vertices directly connected to vertex 2: vertices 3 and 4.
There are also two vertices directly connected to vertex 4: vertices 1 and 2.
Hence, the path 2 → 3 → 1 → 4 satisfies the conditions.





Sample Input 27 8
1 2
2 3
3 4
4 5
5 6
6 7
3 5
2 6





Sample Output 27
1 2 3 4 5 6 7


",Hamiltonish Path,"Graph Theory, Greedy Algorithm, Graph Traversal, Deque, Bit Set",0.15,71,15
1162,"
Score : 800 points


Problem StatementTakahashi and Aoki will play a game on a tree.
The tree has N vertices numbered 1 to N, and the i-th of the N-1 edges connects Vertex a_i and Vertex b_i.
At the beginning of the game, each vertex contains a coin.
Starting from Takahashi, he and Aoki will alternately perform the following operation:

Choose a vertex v that contains one or more coins, and remove all the coins from v.
Then, move each coin remaining on the tree to the vertex that is nearest to v among the adjacent vertices of the coin's current vertex.

The player who becomes unable to play, loses the game.
That is, the player who takes his turn when there is no coin remaining on the tree, loses the game.
Determine the winner of the game when both players play optimally.




Constraints
1 \leq N \leq 2 \times 10^5
1 \leq a_i, b_i \leq N
a_i \neq b_i
The graph given as input is a tree.







InputInput is given from Standard Input in the following format:
N
a_1 b_1
a_2 b_2
:
a_{N-1} b_{N-1}





OutputPrint First if Takahashi will win, and print Second if Aoki will win.






Sample Input 13
1 2
2 3





Sample Output 1First

Here is one possible progress of the game:

Takahashi removes the coin from Vertex 1. Now, Vertex 1 and Vertex 2 contain one coin each.
Aoki removes the coin from Vertex 2. Now, Vertex 2 contains one coin.
Takahashi removes the coin from Vertex 2. Now, there is no coin remaining on the tree.
Aoki takes his turn when there is no coin on the tree and loses.






Sample Input 26
1 2
2 3
2 4
4 6
5 6





Sample Output 2Second






Sample Input 37
1 7
7 4
3 4
7 5
6 3
2 1





Sample Output 3First


",Removing Coins,"Graph Theory, Breadth-first Search, Diameter Of A Tree, Arithmetic, Boolean Operations On Geometric Objects",0.562,30,11
1163,"
Score : 700 points


Problem StatementYou are given N integers A_1, A_2, ..., A_N.
Consider the sums of all non-empty subsequences of A. There are 2^N - 1 such sums, an odd number.
Let the list of these sums in non-decreasing order be S_1, S_2, ..., S_{2^N - 1}.
Find the median of this list, S_{2^{N-1}}.




Constraints
1 \leq N \leq 2000
1 \leq A_i \leq 2000
All input values are integers.







InputInput is given from Standard Input in the following format:
N
A_1 A_2 ... A_N





OutputPrint the median of the sorted list of the sums of all non-empty subsequences of A.






Sample Input 13
1 2 1





Sample Output 12

In this case, S = (1, 1, 2, 2, 3, 3, 4). Its median is S_4 = 2.





Sample Input 21
58





Sample Output 258

In this case, S = (58).

",Median Sum,"Dyanmic Programming, Bit Set, Sorting",0.0,50,8
1164,"
Score : 1000 points


Problem StatementYou are given a tree with N vertices. The vertices are numbered 0 through N-1, and the edges are numbered 1 through N-1.
Edge i connects Vertex x_i and y_i, and has a value a_i.
You can perform the following operation any number of times:

Choose a simple path and a non-negative integer x, then for each edge e that belongs to the path, change a_e by executing a_e ← a_e ⊕ x (⊕ denotes XOR).

Your objective is to have a_e = 0 for all edges e.
Find the minimum number of operations required to achieve it.




Constraints
2 ≤ N ≤ 10^5
0 ≤ x_i,y_i ≤ N-1
0 ≤ a_i ≤ 15
The given graph is a tree.
All input values are integers.







InputInput is given from Standard Input in the following format:
N
x_1 y_1 a_1
x_2 y_2 a_2
:
x_{N-1} y_{N-1} a_{N-1}





OutputFind the minimum number of operations required to achieve the objective.






Sample Input 15
0 1 1
0 2 3
0 3 6
3 4 4





Sample Output 13

The objective can be achieved in three operations, as follows:

First, choose the path connecting Vertex 1, 2, and x = 1.
Then, choose the path connecting Vertex 2, 3, and x = 2.
Lastly, choose the path connecting Vertex 0, 4, and x = 4.






Sample Input 22
1 0 0





Sample Output 20


",XOR Tree,"Depth-first Search, Graph Theory, Xor Basis (gf(2)), Dynamic Programming Using Bitfield, Tree, Counting, Bitmask",0.0,3,1
1165,"
Score : 900 points


Problem StatementTakahashi has decided to give a string to his mother.
The value of a string T is the length of the longest common subsequence of T and T', where T' is the string obtained by reversing T.
That is, the value is the longest length of the following two strings that are equal: a subsequence of T (possibly non-contiguous), and a subsequence of T' (possibly non-contiguous).
Takahashi has a string S. He wants to give her mother a string of the highest possible value, so he would like to change at most K characters in S to any other characters in order to obtain a string of the highest possible value.
Find the highest possible value achievable.




Constraints
1 \leq |S| \leq 300
0 \leq K \leq |S|
S consists of lowercase English letters.
K is an integer.







InputInput is given from Standard Input in the following format:
S
K





OutputPrint the highest possible value achievable.






Sample Input 1abcabcabc
1





Sample Output 17

Changing the first character to c results in cbcabcabc.
Let this tring be T, then one longest common subsequence of T and T' is cbabcbc, whose length is 7.





Sample Input 2atcodergrandcontest
3





Sample Output 215


",Reversed LCS,"Dyanmic Programming, Dynamic Programming, Enumeration, Bitmask",0.667,9,6
1166,"
Score : 1200 points


Problem StatementIn Republic of AtCoder, Snuke Chameleons (Family: Chamaeleonidae, Genus: Bartaberia) are very popular pets.
Ringo keeps N Snuke Chameleons in a cage.
A Snuke Chameleon that has not eaten anything is blue. It changes its color according to the following rules:

A Snuke Chameleon that is blue will change its color to red when the number of red balls it has eaten becomes strictly larger than the number of blue balls it has eaten.
A Snuke Chameleon that is red will change its color to blue when the number of blue balls it has eaten becomes strictly larger than the number of red balls it has eaten.

Initially, every Snuke Chameleon had not eaten anything. Ringo fed them by repeating the following process K times:

Grab either a red ball or a blue ball.
Throw that ball into the cage. Then, one of the chameleons eats it.

After Ringo threw in K balls, all the chameleons were red. We are interested in the possible ways Ringo could have thrown in K balls. How many such ways are there? Find the count modulo 998244353. Here, two ways to throw in balls are considered different when there exists i such that the color of the ball that are thrown in the i-th throw is different.




Constraints
1 \leq N,K \leq 5 \times 10^5
N and K are integers.







InputInput is given from Standard Input in the following format:
N K





OutputPrint the possible ways Ringo could have thrown in K balls, modulo 998244353.






Sample Input 12 4





Sample Output 17

We will use R to represent a red ball, and B to represent a blue ball. There are seven ways to throw in balls that satisfy the condition: BRRR, RBRB, RBRR, RRBB, RRBR, RRRB and RRRR.





Sample Input 23 7





Sample Output 257






Sample Input 38 3





Sample Output 30






Sample Input 48 10





Sample Output 446






Sample Input 5123456 234567





Sample Output 5857617983


",Ball Eat Chameleons,"Combinatorics, Arithmetic, Precomputation, Inclusion And Exclusion, Mathematics",0.333,9,2
1167,"
Score : 1900 points


Problem Statement
One day, Takahashi was given the following problem from Aoki:

You are given a tree with N vertices and an integer K. The vertices are numbered 1 through N. The edges are represented by pairs of integers (a_i, b_i).
For a set S of vertices in the tree, let f(S) be the minimum number of the vertices in a subtree of the given tree that contains all vertices in S.
There are  ways to choose K vertices from the trees. For each of them, let S be the set of the chosen vertices, and find the sum of f(S) over all  ways.
Since the answer may be extremely large, print it modulo 924844033(prime).

Since it was too easy for him, he decided to solve this problem for all K = 1,2,...,N.




Constraints
2 ≦ N ≦ 200,000
1 ≦ a_i, b_i ≦ N
The given graph is a tree.







InputThe input is given from Standard Input in the following format:
N
a_1 b_1
a_2 b_2
:
a_{N-1} b_{N-1}





OutputPrint N lines. The i-th line should contain the answer to the problem where K=i, modulo 924844033.






Sample Input 13
1 2
2 3





Sample Output 13
7
3


The diagram above illustrates the case where K=2. The chosen vertices are colored pink, and the subtrees with the minimum number of vertices are enclosed by red lines.





Sample Input 24
1 2
1 3
1 4





Sample Output 24
15
13
4






Sample Input 37
1 2
2 3
2 4
4 5
4 6
6 7





Sample Output 37
67
150
179
122
45
7


",Many Easy Problems,"Depth-first Search, Tree, Combinatorics, Mathematics, Fast Fourier Transform, Arithmetic, Inclusion And Exclusion",0.5,19,16
1168,"
Score : 900 points


Problem StatementIn ""Takahashi-ya"", a ramen restaurant, basically they have one menu: ""ramen"", but N kinds of toppings are also offered. When a customer orders a bowl of ramen, for each kind of topping, he/she can choose whether to put it on top of his/her ramen or not. There is no limit on the number of toppings, and it is allowed to have all kinds of toppings or no topping at all. That is, considering the combination of the toppings, 2^N types of ramen can be ordered.
Akaki entered Takahashi-ya. She is thinking of ordering some bowls of ramen that satisfy both of the following two conditions:

Do not order multiple bowls of ramen with the exactly same set of toppings.
Each of the N kinds of toppings is on two or more bowls of ramen ordered.

You are given N and a prime number M. Find the number of the sets of bowls of ramen that satisfy these conditions, disregarding order, modulo M. Since she is in extreme hunger, ordering any number of bowls of ramen is fine.




Constraints
2 \leq N \leq 3000
10^8 \leq M \leq 10^9 + 9
N is an integer.
M is a prime number.





Subscores
600 points will be awarded for passing the test set satisfying N ≤ 50.







InputInput is given from Standard Input in the following format:
N M





OutputPrint the number of the sets of bowls of ramen that satisfy the conditions, disregarding order, modulo M.






Sample Input 12 1000000007





Sample Output 12

Let the two kinds of toppings be A and B. Four types of ramen can be ordered: ""no toppings"", ""with A"", ""with B"" and ""with A, B"". There are two sets of ramen that satisfy the conditions:

The following three ramen: ""with A"", ""with B"", ""with A, B"".
Four ramen, one for each type.






Sample Input 23 1000000009





Sample Output 2118

Let the three kinds of toppings be A, B and C. In addition to the four types of ramen above, four more types of ramen can be ordered, where C is added to the above four. There are 118 sets of ramen that satisfy the conditions, and here are some of them:

The following three ramen: ""with A, B"", ""with A, C"", ""with B, C"".
The following five ramen: ""no toppings"", ""with A"", ""with A, B"", ""with B, C"", ""with A, B, C"".
Eight ramen, one for each type.

Note that the set of the following three does not satisfy the condition: ""'with A', 'with B', 'with A, B'"", because C is not on any of them.





Sample Input 350 111111113





Sample Output 31456748

Remember to print the number of the sets modulo M. Note that these three sample inputs above are included in the test set for the partial score.





Sample Input 43000 123456791





Sample Output 416369789

This sample input is not included in the test set for the partial score.

",Everything on It,"Inclusion And Exclusion, Combinatorics, Dyanmic Programming, Exponentiation By Squaring, Arithmetic, Precomputation",0.5,5,3
1169,"
Score : 1200 points


Problem StatementThere are N apartments along a number line, numbered 1 through N.
Apartment i is located at coordinate X_i.
Also, the office of AtCoder Inc. is located at coordinate S.
Every employee of AtCoder lives in one of the N apartments.
There are P_i employees who are living in Apartment i.
All employees of AtCoder are now leaving the office all together.
Since they are tired from work, they would like to get home by the company's bus.
AtCoder owns only one bus, but it can accommodate all the employees.
This bus will leave coordinate S with all the employees and move according to the following rule:


Everyone on the bus casts a vote on which direction the bus should proceed, positive or negative. (The bus is autonomous and has no driver.) Each person has one vote, and abstaining from voting is not allowed. Then, the bus moves a distance of 1 in the direction with the greater number of votes. If a tie occurs, the bus moves in the negative direction. If there is an apartment at the coordinate of the bus after the move, all the employees who live there get off.


Repeat the operation above as long as there is one or more employees on the bus.


For a specific example, see Sample Input 1.
The bus takes one seconds to travel a distance of 1.
The time required to vote and get off the bus is ignorable.
Every employee will vote so that he himself/she herself can get off the bus at the earliest possible time.
Strictly speaking, when a vote is taking place, each employee see which direction results in the earlier arrival at his/her apartment, assuming that all the employees follow the same strategy in the future.
Based on this information, each employee makes the optimal choice, but if either direction results in the arrival at the same time, he/she casts a vote to the negative direction.
Find the time the bus will take from departure to arrival at the last employees' apartment.
It can be proved that, given the positions of the apartments, the numbers of employees living in each apartment and the initial position of the bus, the future movement of the bus is uniquely determined, and the process will end in a finite time.




Constraints
1 \leq N \leq 10^5
1 \leq S \leq 10^9
1 \leq X_1 < X_2 < ... < X_N \leq 10^9
X_i \neq S ( 1 \leq i \leq N )
1 \leq P_i \leq 10^9 ( 1 \leq i \leq N )
All values in input are integers.







InputInput is given from Standard Input in the following format:
N S
X_1 P_1
X_2 P_2
:
X_N P_N





OutputPrint the number of seconds the bus will take from departure to arrival at the last employees' apartment.






Sample Input 13 2
1 3
3 4
4 2





Sample Output 14

Assume that the bus moves in the negative direction first.
Then, the coordinate of the bus changes from 2 to 1, and the employees living in Apartment 1 get off.
The movement of the bus after that is obvious: it just continues moving in the positive direction.
Thus, if the bus moves in the negative direction first, the coordinate of the bus changes as 2 → 1 → 2 → 3 → 4 from departure.
The time it takes to get home for the employees living in Apartment 1, 2, 3 are 1, 3, 4 seconds, respectively.
Next, assume that the bus moves in the positive direction first.
Then, the coordinate of the bus changes from 2 to 3, and the employees living in Apartment 2 get off.
Afterwards, the bus starts heading to Apartment 1, because there are more employees living in Apartment 1 than in Apartment 3.
Then, after arriving at Apartment 1, the bus heads to Apartment 3.
Thus, if the bus moves in the positive direction first, the coordinate of the bus changes as 2 → 3 → 2 → 1 → 2 → 3 → 4 from departure.
The time it takes to get home for the employees living in Apartment 1, 2, 3 are 3, 1, 6 seconds, respectively.
Therefore, in the beginning, the employees living in Apartment 1 or 3 will try to move the bus in the negative direction.
On the other hand, the employees living in Apartment 2 will try to move the bus in the positive direction in the beginning.
There are a total of 3 + 2 = 5 employees living in Apartment 1 and 3 combined, which is more than those living in Apartment 2, which is 4.
Thus, the bus will move in the negative direction first, and the coordinate of the bus will change as 2 → 1 → 2 → 3 → 4 from departure.





Sample Input 26 4
1 10
2 1000
3 100000
5 1000000
6 10000
7 100





Sample Output 221

Since the numbers of employees living in different apartments are literally off by a digit, the bus consistently head to the apartment where the most number of employees on the bus lives.





Sample Input 315 409904902
94198000 15017
117995501 7656764
275583856 313263626
284496300 356635175
324233841 607
360631781 148
472103717 5224
497641071 34695
522945827 816241
554305668 32
623788284 22832
667409501 124410641
876731548 12078
904557302 291749534
918215789 5





Sample Output 32397671583


",Go Home,"Two-pointer, Greedy Algorithm, Sorting, Simulation, Prefix sum, Mathematics",0.333,5,3
1170,"
Score : 1700 points


Problem StatementSnuke has a rooted tree with N vertices, numbered 1 through N.
Vertex 1 is the root of the tree, and the parent of Vertex i ( 2\leq i \leq N ) is Vertex P_i ( P_i < i ).
There is a number, 0 or 1, written on each vertex. The number written on Vertex i is V_i.
Snuke would like to arrange the vertices of this tree in a horizontal row.
Here, for every vertex, there should be no ancestor of that vertex to the right of that vertex.
After arranging the vertices, let X be the sequence obtained by reading the numbers written on the vertices from left to right in the arrangement.
Snuke would like to minimize the inversion number of X.
Find the minimum possible inversion number of X.




NotesThe inversion number of a sequence Z whose length N is the number of pairs of integers i and j ( 1 \leq i < j \leq N ) such that Z_i > Z_j.




Constraints
1 \leq N \leq 2 \times 10^5
1 \leq P_i < i ( 2 \leq i \leq N )
0 \leq V_i \leq 1 ( 1 \leq i \leq N )
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
P_2 P_3 ... P_N
V_1 V_2 ... V_N





OutputPrint the minimum possible inversion number of X.






Sample Input 16
1 1 2 3 3
0 1 1 0 0 0





Sample Output 14

When the vertices are arranged in the order 1, 3, 5, 6, 2, 4, X will be (0, 1, 0, 0, 1, 0), whose inversion number is 4.
It is impossible to have fewer inversions, so the answer is 4.





Sample Input 21

0





Sample Output 20

X = (0), whose inversion number is 0.





Sample Input 315
1 2 3 2 5 6 2 2 9 10 1 12 13 12
1 1 1 0 1 1 0 0 1 0 0 1 1 0 0





Sample Output 331


",01 on Tree,"Tree, Topological Sorting",0.5,4,1
1171,"
Score : 900 points


Problem StatementJoisino has a formula consisting of N terms: A_1 op_1 A_2 ... op_{N-1} A_N.
Here, A_i is an integer, and op_i is an binary operator either + or -.
Because Joisino loves large numbers, she wants to maximize the evaluated value of the formula by inserting an arbitrary number of pairs of parentheses (possibly zero) into the formula.
Opening parentheses can only be inserted immediately before an integer, and closing parentheses can only be inserted immediately after an integer.
It is allowed to insert any number of parentheses at a position.
Your task is to write a program to find the maximum possible evaluated value of the formula after inserting an arbitrary number of pairs of parentheses.




Constraints
1≦N≦10^5
1≦A_i≦10^9
op_i is either + or -.







InputThe input is given from Standard Input in the following format:
N
A_1 op_1 A_2 ... op_{N-1} A_N





OutputPrint the maximum possible evaluated value of the formula after inserting an arbitrary number of pairs of parentheses.






Sample Input 13
5 - 1 - 3





Sample Output 17

The maximum possible value is: 5 - (1 - 3) = 7.





Sample Input 25
1 - 2 + 3 - 4 + 5





Sample Output 25

The maximum possible value is: 1 - (2 + 3 - 4) + 5 = 5.





Sample Input 35
1 - 20 - 13 + 14 - 5





Sample Output 313

The maximum possible value is: 1 - (20 - (13 + 14) - 5) = 13.

",Addition and Subtraction Hard,"Dyanmic Programming, Greedy Algorithm, Prefix sum, Arithmetic, Parsing",0.667,6,3
1172,"
Score : 800 points


Problem StatementTakahashi is doing a research on sets of points in a plane.
Takahashi thinks a set S of points in a coordinate plane is a good set when S satisfies both of the following conditions:

The distance between any two points in S is not \sqrt{D_1}.
The distance between any two points in S is not \sqrt{D_2}.

Here, D_1 and D_2 are positive integer constants that Takahashi specified.
Let X be a set of points (i,j) on a coordinate plane where i and j are integers and satisfy 0 ≤ i,j < 2N.
Takahashi has proved that, for any choice of D_1 and D_2, there exists a way to choose N^2 points from X so that the chosen points form a good set.
However, he does not know the specific way to choose such points to form a good set.
Find a subset of X whose size is N^2 that forms a good set.




Constraints
1 ≤ N ≤ 300
1 ≤ D_1 ≤ 2×10^5
1 ≤ D_2 ≤ 2×10^5
All values in the input are integers.







InputInput is given from Standard Input in the following format:
N D_1 D_2





OutputPrint N^2 distinct points that satisfy the condition in the following format:
x_1 y_1
x_2 y_2
:
x_{N^2} y_{N^2}

Here, (x_i,y_i) represents the i-th chosen point.
0 ≤ x_i,y_i < 2N must hold, and they must be integers.
The chosen points may be printed in any order.
In case there are multiple possible solutions, you can output any.






Sample Input 12 1 2





Sample Output 10 0
0 2
2 0
2 2

Among these points, the distance between 2 points is either 2 or 2\sqrt{2}, thus it satisfies the condition.





Sample Input 23 1 5





Sample Output 20 0
0 2
0 4
1 1
1 3
1 5
2 0
2 2
2 4


",Choosing Points,"Geometry; 3d, Counting, Number Theory, Bipartite Graph, Graph Traversal, Combinatorics",0.1,46,6
1173,"
Score : 900 points


Problem StatementLet N be an even number.
There is a tree with N vertices.
The vertices are numbered 1, 2, ..., N.
For each i (1 \leq i \leq N - 1), the i-th edge connects Vertex x_i and y_i.
Snuke would like to decorate the tree with ribbons, as follows.
First, he will divide the N vertices into N / 2 pairs.
Here, each vertex must belong to exactly one pair.
Then, for each pair (u, v), put a ribbon through all the edges contained in the shortest path between u and v.
Snuke is trying to divide the vertices into pairs so that the following condition is satisfied: ""for every edge, there is at least one ribbon going through it.""
How many ways are there to divide the vertices into pairs, satisfying this condition?
Find the count modulo 10^9 + 7.
Here, two ways to divide the vertices into pairs are considered different when there is a pair that is contained in one of the two ways but not in the other.




Constraints
N is an even number.
2 \leq N \leq 5000
1 \leq x_i, y_i \leq N
The given graph is a tree.







InputInput is given from Standard Input in the following format:
N
x_1 y_1
x_2 y_2
:
x_{N - 1} y_{N - 1}





OutputPrint the number of the ways to divide the vertices into pairs, satisfying the condition, modulo 10^9 + 7.






Sample Input 14
1 2
2 3
3 4





Sample Output 12

There are three possible ways to divide the vertices into pairs, as shown below, and two satisfy the condition: the middle one and the right one.






Sample Input 24
1 2
1 3
1 4





Sample Output 23

There are three possible ways to divide the vertices into pairs, as shown below, and all of them satisfy the condition.






Sample Input 36
1 2
1 3
3 4
1 5
5 6





Sample Output 310






Sample Input 410
8 5
10 8
6 5
1 5
4 8
2 10
3 6
9 2
1 7





Sample Output 4672


",Ribbons on Tree,"Depth-first Search, Tree, Disjoint Set, Dynamic Programming On Trees, Fast Fourier Transform, Arithmetic, Combinatorics, Inclusion And Exclusion",0.333,8,3
1174,"
Score : 1000 points


Problem StatementProblem F and F2 are the same problem, but with different constraints and time limits.
We have a board divided into N horizontal rows and N vertical columns of square cells.
The cell at the i-th row from the top and the j-th column from the left is called Cell (i,j).
Each cell is either empty or occupied by an obstacle.
Also, each empty cell has a digit written on it.
If A_{i,j}= 1, 2, ..., or 9, Cell (i,j) is empty and the digit A_{i,j} is written on it.
If A_{i,j}= #, Cell (i,j) is occupied by an obstacle.
Cell Y is reachable from cell X when the following conditions are all met:

Cells X and Y are different.
Cells X and Y are both empty.
One can reach from Cell X to Cell Y by repeatedly moving right or down to an adjacent empty cell.

Consider all pairs of cells (X,Y) such that cell Y is reachable from cell X.
Find the sum of the products of the digits written on cell X and cell Y for all of those pairs.




Constraints
1 \leq N \leq 500
A_{i,j} is one of the following characters: 1, 2, ... 9 and #.







InputInput is given from Standard Input in the following format:
N
A_{1,1}A_{1,2}...A_{1,N}
A_{2,1}A_{2,2}...A_{2,N}
:
A_{N,1}A_{N,2}...A_{N,N}





OutputPrint the sum of the products of the digits written on cell X and cell Y for all pairs (X,Y) such that cell Y is reachable from cell X.






Sample Input 12
11
11





Sample Output 15

There are five pairs of cells (X,Y) such that cell Y is reachable from cell X, as follows:

X=(1,1), Y=(1,2)
X=(1,1), Y=(2,1)
X=(1,1), Y=(2,2)
X=(1,2), Y=(2,2)
X=(2,1), Y=(2,2)

The product of the digits written on cell X and cell Y is 1 for all of those pairs, so the answer is 5.





Sample Input 24
1111
11#1
1#11
1111





Sample Output 247






Sample Input 310
76##63##3#
8445669721
75#9542133
3#285##445
749632##89
2458##9515
5952578#77
1#3#44196#
4355#99#1#
#298#63587





Sample Output 336065






Sample Input 410
4177143673
7#########
5#1716155#
6#4#####5#
2#3#597#6#
6#9#8#3#5#
5#2#899#9#
1#6#####6#
6#5359657#
5#########





Sample Output 46525


",Reachable Cells,"Dyanmic Programming, Inclusion And Exclusion, Grid Graph, Dynamic Programming",0.333,3,1
1175,"
Score : 800 points


Problem StatementTakahashi and Aoki will play a game using a grid with H rows and W columns of square cells.
There are N obstacles on this grid; the i-th obstacle is at (X_i,Y_i).
Here, we represent the cell at the i-th row and j-th column (1 \leq i \leq H, 1 \leq j \leq W) by (i,j).
There is no obstacle at (1,1), and there is a piece placed there at (1,1).
Starting from Takahashi, he and Aoki alternately perform one of the following actions:

Move the piece to an adjacent cell.
    Here, let the position of the piece be (x,y). Then Takahashi can only move the piece to (x+1,y), and Aoki can only move the piece to (x,y+1).
    If the destination cell does not exist or it is occupied by an obstacle, this action cannot be taken.
Do not move the piece, and end his turn without affecting the grid.

The game ends when the piece does not move twice in a row.
Takahashi would like to perform as many actions (including not moving the piece) as possible before the game ends, while Aoki would like to perform as few actions as possible before the game ends.
How many actions will Takahashi end up performing?




Constraints
1 \leq H,W \leq 2\times 10^5
0 \leq N \leq 2\times 10^5
1 \leq X_i \leq H
1 \leq Y_i \leq W
If i \neq j, (X_i,Y_i) \neq (X_j,Y_j)
(X_i,Y_i) \neq (1,1)
X_i and Y_i are integers.







InputInput is given from Standard Input in the following format:
H W N
X_1 Y_1
:
X_N Y_N





OutputPrint the number of actions Takahashi will end up performing.






Sample Input 13 3 1
3 2





Sample Output 12

For example, the game proceeds as follows:

Takahashi moves the piece to (2,1).
Aoki does not move the piece.
Takahashi moves the piece to (3,1).
Aoki does not move the piece.
Takahashi does not move the piece.

Takahashi performs three actions in this case, but if both players play optimally, Takahashi will perform only two actions before the game ends.





Sample Input 210 10 14
4 3
2 2
7 3
9 10
7 7
8 1
10 10
5 4
3 4
2 8
6 4
4 4
5 8
9 2





Sample Output 26






Sample Input 3100000 100000 0





Sample Output 3100000


",Grid game,"Greedy Algorithm, Sorting, Binary Search, Data Structures, Bruteforcing, Set / Map, Tree, Two-pointer",0.5,19,9
1176,"
Score : 1200 points


Problem StatementTakahashi's office has N rooms. Each room has an ID from 1 to N.
There are also N-1 corridors, and the i-th corridor connects Room a_i and Room b_i.
It is known that we can travel between any two rooms using only these corridors.
Takahashi has got lost in one of the rooms. Let this room be r.
He decides to get back to his room, Room 1, by repeatedly traveling in the following manner:

Travel to the room with the smallest ID among the rooms that are adjacent to the rooms already visited, but not visited yet.

Let c_r be the number of travels required to get back to Room 1.
Find all of c_2,c_3,...,c_N.
Note that, no matter how many corridors he passes through in a travel, it still counts as one travel.




Constraints
2 \leq N \leq 2\times 10^5
1 \leq a_i,b_i \leq N
a_i \neq b_i
The graph given as input is a tree.







InputInput is given from Standard Input in the following format:
N
a_1 b_1
:
a_{N-1} b_{N-1}





OutputPrint c_r for each r, in the following format:
c_2 c_3 ... c_N







Sample Input 16
1 5
5 6
6 2
6 3
6 4





Sample Output 15 5 5 1 5

For example, if Takahashi was lost in Room 2, he will travel as follows:

Travel to Room 6.
Travel to Room 3.
Travel to Room 4.
Travel to Room 5.
Travel to Room 1.






Sample Input 26
1 2
2 3
3 4
4 5
5 6





Sample Output 21 2 3 4 5






Sample Input 310
1 5
5 6
6 10
6 4
10 3
10 8
8 2
4 7
4 9





Sample Output 37 5 3 1 3 4 7 4 5


",Wandering TKHS,"Graph Theory, Tree, Sorting, Shortest Path, Depth-first Search, Priority Queue, Graph Traversal",0.5,12,6
1177,"
Score : 1000 points


Problem StatementFor an n \times n grid, let (r, c) denote the square at the (r+1)-th row from the top and the (c+1)-th column from the left.
A good coloring of this grid using K colors is a coloring that satisfies the following:

Each square is painted in one of the K colors.
Each of the K colors is used for some squares.
Let us number the K colors 1, 2, ..., K. For any colors i and j (1 \leq i \leq K, 1 \leq j \leq K), every square in Color i has the same number of adjacent squares in Color j. Here, the squares adjacent to square (r, c) are ((r-1)\; mod\; n, c), ((r+1)\; mod\; n, c), (r, (c-1)\; mod\; n) and (r, (c+1)\; mod\; n) (if the same square appears multiple times among these four, the square is counted that number of times).

Given K, choose n between 1 and 500 (inclusive) freely and construct a good coloring of an n \times n grid using K colors.
It can be proved that this is always possible under the constraints of this problem,




Constraints
1 \leq K \leq 1000







InputInput is given from Standard Input in the following format:
K





OutputOutput should be in the following format:
n
c_{0,0} c_{0,1} ... c_{0,n-1}
c_{1,0} c_{1,1} ... c_{1,n-1}
:
c_{n-1,0} c_{n-1,1} ... c_{n-1,n-1}

n should represent the size of the grid, and 1 \leq n \leq 500 must hold.
c_{r,c} should be an integer such that 1 \leq c_{r,c} \leq K and represent the color for the square (r, c).






Sample Input 12





Sample Output 13
1 1 1
1 1 1
2 2 2


Every square in Color 1 has three adjacent squares in Color 1 and one adjacent square in Color 2.
Every square in Color 2 has two adjacent squares in Color 1 and two adjacent squares in Color 2.

Output such as the following will be judged incorrect:
2
1 2
2 2

3
1 1 1
1 1 1
1 1 1






Sample Input 29





Sample Output 23
1 2 3
4 5 6
7 8 9


",Coloring Torus,"Arithmetic, Constructive, Matrix, Implementation, Graph Theory",0.6,7,4
1178,"
Score : 1000 points


Problem StatementYou are given an integer sequence of length N: A_1,A_2,...,A_N. Let us perform Q operations in order.
The i-th operation is described by two integers X_i and Y_i. In this operation, we will choose one of the following two actions and perform it:

Swap the values of A_{X_i} and A_{Y_i}
Do nothing

There are 2^Q ways to perform these operations. Find the sum of the inversion numbers of the final sequences for all of these ways to perform operations, modulo 10^9+7.
Here, the inversion number of a sequence P_1,P_2,...,P_M is the number of pairs of integers (i,j) such that 1\leq i < j\leq M and P_i > P_j.




Constraints
1 \leq N \leq 3000
0 \leq Q \leq 3000
0 \leq A_i \leq 10^9(1\leq i\leq N)
1 \leq X_i,Y_i \leq N(1\leq i\leq Q)
X_i\neq Y_i(1\leq i\leq Q)
All values in input are integers.







InputInput is given from Standard Input in the following format:
N Q
A_1
:
A_N
X_1 Y_1
:
X_Q Y_Q





OutputPrint the sum of the inversion numbers of the final sequences, modulo 10^9+7.






Sample Input 13 2
1
2
3
1 2
1 3





Sample Output 16

There are four ways to perform operations, as follows:

Do nothing, both in the first and second operations. The final sequence would be 1,2,3, with the inversion number of 0.
Do nothing in the first operation, then perform the swap in the second. The final sequence would be 3,2,1, with the inversion number of 3.
Perform the swap in the first operation, then do nothing in the second. The final sequence would be 2,1,3, with the inversion number of 1.
Perform the swap, both in the first and second operations. The final sequence would be 3,1,2, with the inversion number of 2.

The sum of these inversion numbers, 0+3+1+2=6, should be printed.





Sample Input 25 3
3
2
3
1
4
1 5
2 3
4 2





Sample Output 236






Sample Input 39 5
3
1
4
1
5
9
2
6
5
3 5
8 9
7 9
3 2
3 8





Sample Output 3425


",Inversion Sum,"Dyanmic Programming, Probability Theory, Matrix, Arithmetic, Combinatorics",1.0,3,3
1179,"
Score : 1200 points


Problem StatementThere are N jewels, numbered 1 to N.
The color of these jewels are represented by integers between 1 and K (inclusive), and the color of Jewel i is C_i.
Also, these jewels have specified values, and the value of Jewel i is V_i.
Snuke would like to choose some of these jewels to exhibit.
Here, the set of the chosen jewels must satisfy the following condition:

For each chosen jewel, there is at least one more jewel of the same color that is chosen.

For each integer x such that 1 \leq x \leq N, determine if it is possible to choose exactly x jewels, and if it is possible, find the maximum possible sum of the values of chosen jewels in that case.




Constraints
1 \leq N \leq 2 \times 10^5
1 \leq K \leq \lfloor N/2 \rfloor
1 \leq C_i \leq K
1 \leq V_i \leq 10^9
For each of the colors, there are at least two jewels of that color.
All values in input are integers.







InputInput is given from Standard Input in the following format:
N K
C_1 V_1
C_2 V_2
:
C_N V_N





OutputPrint N lines.
In the i-th line, if it is possible to choose exactly i jewels, print the maximum possible sum of the values of chosen jewels in that case, and print -1 otherwise.






Sample Input 15 2
1 1
1 2
1 3
2 4
2 5





Sample Output 1-1
9
6
14
15

We cannot choose exactly one jewel.
When choosing exactly two jewels, the total value is maximized when Jewel 4 and 5 are chosen.
When choosing exactly three jewels, the total value is maximized when Jewel 1, 2 and 3 are chosen.
When choosing exactly four jewels, the total value is maximized when Jewel 2, 3, 4 and 5 are chosen.
When choosing exactly five jewels, the total value is maximized when Jewel 1, 2, 3, 4 and 5 are chosen.





Sample Input 25 2
1 1
1 2
2 3
2 4
2 5





Sample Output 2-1
9
12
12
15






Sample Input 38 4
3 2
2 3
4 5
1 7
3 11
4 13
1 17
2 19





Sample Output 3-1
24
-1
46
-1
64
-1
77






Sample Input 415 5
3 87
1 25
1 27
3 58
2 85
5 19
5 39
1 58
3 12
4 13
5 54
4 100
2 33
5 13
2 55





Sample Output 4-1
145
173
285
318
398
431
491
524
576
609
634
653
666
678


",Jewels,"Sorting, Prefix sum, Dyanmic Programming, Bitmask, Implementation, Combinatorics",0.0,10,1
1180,"
Score : 1000 points


Problem StatementFor two permutations p and q of the integers from 1 through N, let f(p,q) be the permutation that satisfies the following:

The p_i-th element (1 \leq i \leq N) in f(p,q) is q_i.
Here, p_i and q_i respectively denote the i-th element in p and q.

You are given two permutations p and q of the integers from 1 through N.
We will now define a sequence {a_n} of permutations of the integers from 1 through N, as follows:

a_1=p, a_2=q
a_{n+2}=f(a_n,a_{n+1}) ( n \geq 1 )

Given a positive integer K, find a_K.




Constraints
1 \leq N \leq 10^5
1 \leq K \leq 10^9
p and q are permutations of the integers from 1 through N.







InputInput is given from Standard Input in the following format:
N K
p_1 ... p_N
q_1 ... q_N





OutputPrint N integers, with spaces in between.
The i-th integer (1 \leq i \leq N) should be the i-th element in a_K.






Sample Input 13 3
1 2 3
3 2 1





Sample Output 13 2 1

Since a_3=f(p,q), we just need to find f(p,q).
We have p_i=i here, so f(p,q)=q.





Sample Input 25 5
4 5 1 2 3
3 2 1 5 4





Sample Output 24 3 2 1 5






Sample Input 310 1000000000
7 10 6 5 4 2 9 1 3 8
4 1 9 2 3 7 8 10 6 5





Sample Output 37 9 4 8 2 5 1 6 10 3


",A Sequence of Permutations,"Permutation Cycle Decomposition, Mathematics, Exponentiation By Squaring, Arithmetic, Combinatorics",1.0,3,3
1181,"
Score : 1200 points


Problem StatementLet M be a positive integer.
You are given 2 N integers a_1, a_2, \ldots, a_{2 N}, where 0 \leq a_i < M for each i.
Consider dividing the 2 N integers into N pairs.
Here, each integer must belong to exactly one pair.
We define the ugliness of a pair (x, y) as (x + y) \mod M.
Let Z be the largest ugliness of the N pairs. Find the minimum possible value of Z.




Constraints
All values in input are integers.
1 \leq N \leq 10^5
1 \leq M \leq 10^9
0 \leq a_i < M







InputInput is given from Standard Input in the following format:
N M
a_1 a_2 \cdots a_{2N}





OutputPrint the minimum possible value of Z, where Z is the largest ugliness of the N pairs.






Sample Input 13 10
0 2 3 4 5 9





Sample Output 15

One solution is to form pairs (0, 5), (2, 3) and (4, 9), with ugliness 5, 5 and 3, respectively.





Sample Input 22 10
1 9 1 9





Sample Output 20

Pairs (1, 9) and (1, 9) should be formed, with ugliness both 0.

",Modulo Pairing,"Sorting, Binary Search, Two-pointer, Greedy Algorithm, Arithmetic",0.2,10,3
1182,"
Score : 500 points


Problem StatementAtCoDeer is thinking of painting an infinite two-dimensional grid in a checked pattern of side K.
Here, a checked pattern of side K is a pattern where each square is painted black or white so that each connected component of each color is a K × K square.
Below is an example of a checked pattern of side 3:



AtCoDeer has N desires.
The i-th desire is represented by x_i, y_i and c_i.
If c_i is B, it means that he wants to paint the square (x_i,y_i) black; if c_i is W, he wants to paint the square (x_i,y_i) white.
At most how many desires can he satisfy at the same time?




Constraints
1 ≤ N ≤ 10^5
1 ≤ K ≤ 1000
0 ≤ x_i ≤ 10^9
0 ≤ y_i ≤ 10^9
If i ≠ j, then (x_i,y_i) ≠ (x_j,y_j).
c_i is B or W.
N, K, x_i and y_i are integers.







InputInput is given from Standard Input in the following format:
N K
x_1 y_1 c_1
x_2 y_2 c_2
:
x_N y_N c_N





OutputPrint the maximum number of desires that can be satisfied at the same time.






Sample Input 14 3
0 1 W
1 2 W
5 3 B
5 4 B





Sample Output 14

He can satisfy all his desires by painting as shown in the example above.





Sample Input 22 1000
0 0 B
0 1 W





Sample Output 22






Sample Input 36 2
1 2 B
2 1 W
2 2 B
1 0 B
0 6 W
4 5 W





Sample Output 34


",Checker,"Arithmetic, Prefix sum, Array, Sliding Window, Grid Graph, Bruteforcing",0.176,49,9
1183,"
Score : 600 points


Problem StatementGiven are an integer N and arrays S, T, U, and V, each of length N.
Construct an N×N matrix a that satisfy the following conditions:

a_{i,j} is an integer.
0 \leq a_{i,j}  \lt 2^{64}.
If S_{i} = 0, the bitwise AND of the elements in the i-th row is U_{i}.
If S_{i} = 1, the bitwise OR of the elements in the i-th row is U_{i}.
If T_{i} = 0, the bitwise AND of the elements in the i-th column is V_{i}.
If T_{i} = 1, the bitwise OR of the elements in the i-th column is V_{i}.

However, there may be cases where no matrix satisfies the conditions.




Constraints
All values in input are integers.
 1 \leq N \leq 500 
 0 \leq S_{i} \leq 1 
 0 \leq T_{i} \leq 1  
 0 \leq U_{i} \lt 2^{64}  
 0 \leq V_{i} \lt 2^{64}  







InputInput is given from Standard Input in the following format:
N
S_{1} S_{2} ...  S_{N}
T_{1} T_{2} ...  T_{N}
U_{1} U_{2} ...  U_{N}
V_{1} V_{2} ...  V_{N}





OutputIf there exists a matrix that satisfies the conditions, print one such matrix in the following format:
a_{1,1} ...  a_{1,N}
:
a_{N,1} ...  a_{N,N}

Note that any matrix satisfying the conditions is accepted.
If no matrix satisfies the conditions, print -1.






Sample Input 12
0 1
1 0
1 1
1 0





Sample Output 11 1
1 0

In Sample Input 1, we need to find a matrix such that:

the bitwise AND of the elements in the 1-st row is 1;
the bitwise OR of the elements in the 2-nd row is 1;
the bitwise OR of the elements in the 1-st column is 1;
the bitwise AND of the elements in the 2-nd column is 0.






Sample Input 22
1 1
1 0
15 15
15 11





Sample Output 215 11
15 11


",I hate Matrix Construction,"Bitmask, Greedy Algorithm, Array, Boolean Operations On Geometric Objects, 2-sat, Implementation",0.2,12,2
1184,"
Score : 600 points


Problem StatementThere are 2N balls, N white and N black, arranged in a row. The integers from 1 through N are written on the white balls, one on each ball, and they are also written on the black balls, one on each ball.
The integer written on the i-th ball from the left (1 ≤ i ≤ 2N) is a_i, and the color of this ball is represented by a letter c_i.
c_i = W represents the ball is white; c_i = B represents the ball is black.
Takahashi the human wants to achieve the following objective:

For every pair of integers (i,j) such that 1 ≤ i < j ≤ N, the white ball with i written on it is to the left of the white ball with j written on it.
For every pair of integers (i,j) such that 1 ≤ i < j ≤ N, the black ball with i written on it is to the left of the black ball with j written on it.

In order to achieve this, he can perform the following operation:

Swap two adjacent balls.

Find the minimum number of operations required to achieve the objective.




Constraints
1 ≤ N ≤ 2000
1 ≤ a_i ≤ N
c_i = W or c_i = B.
If i ≠ j, (a_i,c_i) ≠ (a_j,c_j).







InputInput is given from Standard Input in the following format:
N
c_1 a_1
c_2 a_2
:
c_{2N} a_{2N}





OutputPrint the minimum number of operations required to achieve the objective.






Sample Input 13
B 1
W 2
B 3
W 1
W 3
B 2





Sample Output 14

The objective can be achieved in four operations, for example, as follows:

Swap the black 3 and white 1.
Swap the white 1 and white 2.
Swap the black 3 and white 3.
Swap the black 3 and black 2.






Sample Input 24
B 4
W 4
B 3
W 3
B 2
W 2
B 1
W 1





Sample Output 218






Sample Input 39
W 3
B 1
B 4
W 1
B 5
W 9
W 2
B 6
W 5
B 3
W 8
B 9
W 7
B 2
B 8
W 4
W 6
B 7





Sample Output 341


",Sorted and Sorted,"Dyanmic Programming, Array, Binary Indexed Tree, Dynamic Programming",0.692,14,10
1185,"
Score : 800 points


Problem StatementThere is a tree with N vertices numbered 1 through N.
The i-th edge connects Vertex x_i and y_i.
Each vertex is painted white or black.
The initial color of Vertex i is represented by a letter c_i.
c_i = W represents the vertex is white; c_i = B represents the vertex is black.
A cat will walk along this tree.
More specifically, she performs one of the following in one second repeatedly:

Choose a vertex that is adjacent to the vertex where she is currently, and move to that vertex. Then, invert the color of the destination vertex.
Invert the color of the vertex where she is currently.

The cat's objective is to paint all the vertices black. She may start and end performing actions at any vertex.
At least how many seconds does it takes for the cat to achieve her objective?




Constraints
1 ≤ N ≤ 10^5
1 ≤ x_i,y_i ≤ N (1 ≤ i ≤ N-1)
The given graph is a tree.
c_i = W or c_i = B.







InputInput is given from Standard Input in the following format:
N
x_1 y_1
x_2 y_2
:
x_{N-1} y_{N-1}
c_1c_2..c_N





OutputPrint the minimum number of seconds required to achieve the objective.






Sample Input 15
1 2
2 3
2 4
4 5
WBBWW





Sample Output 15

The objective can be achieved in five seconds, for example, as follows:

Start at Vertex 1. Change the color of Vertex 1 to black.
Move to Vertex 2, then change the color of Vertex 2 to white.
Change the color of Vertex 2 to black.
Move to Vertex 4, then change the color of Vertex 4 to black.
Move to Vertex 5, then change the color of Vertex 5 to black.






Sample Input 26
3 1
4 5
2 6
6 1
3 4
WWBWBB





Sample Output 27






Sample Input 31
B





Sample Output 30






Sample Input 420
2 19
5 13
6 4
15 6
12 19
13 19
3 11
8 3
3 20
16 13
7 14
3 17
7 8
10 20
11 9
8 18
8 2
10 1
6 13
WBWBWBBWWWBBWWBBBBBW





Sample Output 421


",Monochrome Cat,"Graph Theory, Tree, Depth-first Search, Dynamic Programming On Trees, Diameter Of A Tree, Parity, Shortest Path",0.0,11,1
1186,"
Score : 1200 points


Problem StatementFind the number of the possible tuples of sequences (A_0,A_1,...,A_N) that satisfy all of the following conditions, modulo M:

For every i (0\leq i\leq N), A_i is a sequence of length i consisting of integers between 1 and K (inclusive);
For every i (1\leq i\leq N), A_{i-1} is a subsequence of A_i, that is, there exists 1\leq x_i\leq i such that the removal of the x_i-th element of A_i would result in a sequence equal to A_{i-1};
For every i (1\leq i\leq N), A_i is lexicographically larger than A_{i-1}.





Constraints
1 \leq N,K \leq 300
2 \leq M \leq 10^9
N, K and M are integers.







InputInput is given from Standard Input in the following format:
N K M





OutputPrint the number of the possible tuples of sequences (A_0,A_1,...,A_N), modulo M.






Sample Input 12 2 100





Sample Output 15

Five tuples below satisfy the conditions:

(),(1),(1,1)
(),(1),(1,2)
(),(1),(2,1)
(),(2),(2,1)
(),(2),(2,2)






Sample Input 24 3 999999999





Sample Output 2358






Sample Input 3150 150 998244353





Sample Output 3186248260


",Sequence Growing Hard,"Dyanmic Programming, Combinatorics, Memoization, Arithmetic, Sorting, Constructive",0.75,11,9
1187,"
Score : 1200 points


Problem StatementIn Takahashi's mind, there is always an integer sequence of length 2 \times 10^9 + 1: A = (A_{-10^9}, A_{-10^9 + 1}, ..., A_{10^9 - 1}, A_{10^9}) and an integer P.
Initially, all the elements in the sequence A in Takahashi's mind are 0, and the value of the integer P is 0.
When Takahashi eats symbols +, -, > and <, the sequence A and the integer P will change as follows:

When he eats +, the value of A_P increases by 1;
When he eats -, the value of A_P decreases by 1;
When he eats >, the value of P increases by 1;
When he eats <, the value of P decreases by 1.

Takahashi has a string S of length N. Each character in S is one of the symbols +, -, > and <.
He chose a pair of integers (i, j) such that 1 \leq i \leq j \leq N and ate the symbols that are the i-th, (i+1)-th, ..., j-th characters in S, in this order.
We heard that, after he finished eating, the sequence A became the same as if he had eaten all the symbols in S from first to last.
How many such possible pairs (i, j) are there?




Constraints
1 \leq N \leq 250000
|S| = N
Each character in S is +, -, > or <.







InputInput is given from Standard Input in the following format:
N
S





OutputPrint the answer.






Sample Input 15
+>+<-





Sample Output 13

If Takahashi eats all the symbols in S, A_1 = 1 and all other elements would be 0.
The pairs (i, j) that leads to the same sequence A are as follows:

(1, 5)
(2, 3)
(2, 4)






Sample Input 25
+>+-<





Sample Output 25

Note that the value of P may be different from the value when Takahashi eats all the symbols in S.





Sample Input 348
-+><<><><><>>>+-<<>->>><<><<-+<>><+<<>+><-+->><<





Sample Output 3475


",Eating Symbols Hard,"Prefix sum, Implementation, Hashing",0.0,2,0
1188,"
Score : 1100 points


Problem StatementLet us consider a grid of squares with 10^9 rows and N columns. Let (i, j) be the square at the i-th column (1 \leq i \leq N) from the left and j-th row (1 \leq j \leq 10^9) from the bottom.
Snuke has cut out some part of the grid so that, for each i = 1, 2, ..., N, the bottom-most h_i squares are remaining in the i-th column from the left.
Now, he will paint the remaining squares in red and blue.
Find the number of the ways to paint the squares so that the following condition is satisfied:

Every remaining square is painted either red or blue.
For all 1 \leq i \leq N-1 and 1 \leq j \leq min(h_i, h_{i+1})-1, there are exactly two squares painted red and two squares painted blue among the following four squares: (i, j), (i, j+1), (i+1, j) and (i+1, j+1).

Since the number of ways can be extremely large, print the count modulo 10^9+7.




Constraints
1 \leq N \leq 100
1 \leq h_i \leq 10^9







InputInput is given from Standard Input in the following format:
N
h_1 h_2 ... h_N





OutputPrint the number of the ways to paint the squares, modulo 10^9+7.






Sample Input 19
2 3 5 4 1 2 4 2 1





Sample Output 112800

One of the ways to paint the squares is shown below:

  #
  ##  #
 ###  #
#### ###
#########






Sample Input 22
2 2





Sample Output 26

There are six ways to paint the squares, as follows:

## ## ## ## ## ##
## ## ## ## ## ##






Sample Input 35
2 1 2 1 2





Sample Output 3256

Every way to paint the squares satisfies the condition.





Sample Input 49
27 18 28 18 28 45 90 45 23





Sample Output 4844733013

Remember to print the number of ways modulo 10^9 + 7.

",Histogram Coloring,"Divide And Conquer, Dyanmic Programming, Recursion",0.667,9,5
1189,"
Score : 1100 points


Problem StatementYou are given an integer N.
Construct any one N-by-N matrix a that satisfies the conditions below. It can be proved that a solution always exists under the constraints of this problem.

1 \leq a_{i,j} \leq 10^{15}
a_{i,j} are pairwise distinct integers.
There exists a positive integer m such that the following holds: Let x and y be two elements of the matrix that are vertically or horizontally adjacent. Then, {\rm max}(x,y) {\rm mod} {\rm min}(x,y) is always m.





Constraints
2 \leq N \leq 500







InputInput is given from Standard Input in the following format:
N





OutputPrint your solution in the following format:
a_{1,1} ... a_{1,N}
:
a_{N,1} ... a_{N,N}







Sample Input 12





Sample Output 14 7
23 10


For any two elements x and y that are vertically or horizontally adjacent, {\rm max}(x,y) {\rm mod} {\rm min}(x,y) is always 3.


",Modulo Matrix,"Bipartite Graph, Sieve Of Eratosthenes, Mathematics, Arithmetic, Hashing, Constructive",0.4,7,4
1190,"
Score : 1000 points


Problem StatementNote the unusual memory limit.
For a rectangular grid where each square is painted white or black, we define its complexity as follows:

If all the squares are black or all the squares are white, the complexity is 0.
Otherwise, divide the grid into two subgrids by a line parallel to one of the sides of the grid, and let c_1 and c_2 be the complexities of the subgrids. There can be multiple ways to perform the division, and let m be the minimum value of \max(c_1, c_2) in those divisions. The complexity of the grid is m+1.

You are given a grid with H horizontal rows and W vertical columns where each square is painted white or black.
HW characters from A_{11} to A_{HW} represent the colors of the squares.
A_{ij} is # if the square at the i-th row from the top and the j-th column from the left is black, and A_{ij} is . if that square is white.
Find the complexity of the given grid.




Constraints
1 \leq H,W \leq 185
A_{ij} is # or ..







InputInput is given from Standard Input in the following format:
H W
A_{11}A_{12}...A_{1W}
:
A_{H1}A_{H2}...A_{HW}





OutputPrint the complexity of the given grid.






Sample Input 13 3
...
.##
.##





Sample Output 12

Let us divide the grid by the boundary line between the first and second columns.
The subgrid consisting of the first column has the complexity of 0, and the subgrid consisting of the second and third columns has the complexity of 1, so the whole grid has the complexity of at most 2.





Sample Input 26 7
.####.#
#....#.
#....#.
#....#.
.####.#
#....##





Sample Output 24


",Complexity,"Dyanmic Programming, Prefix sum, Backtracking, Binary Search, Divide And Conquer, Game Theory, Bitmask",0.25,24,5
1191,"
Score : 1100 points


Problem StatementWe have a grid with N rows and M columns of squares.
Each integer from 1 to NM is written in this grid once.
The number written in the square at the i-th row from the top and the j-th column from the left is A_{ij}.
You need to rearrange these numbers as follows:

First, for each of the N rows, rearrange the numbers written in it as you like.
Second, for each of the M columns, rearrange the numbers written in it as you like.
Finally, for each of the N rows, rearrange the numbers written in it as you like.

After rearranging the numbers, you want the number written in the square at the i-th row from the top and the j-th column from the left to be M\times (i-1)+j.
Construct one such way to rearrange the numbers. The constraints guarantee that it is always possible to achieve the objective.




Constraints
1 \leq N,M \leq 100
1 \leq A_{ij} \leq NM
A_{ij} are distinct.







InputInput is given from Standard Input in the following format:
N M
A_{11} A_{12} ... A_{1M}
:
A_{N1} A_{N2} ... A_{NM}





OutputPrint one way to rearrange the numbers in the following format:
B_{11} B_{12} ... B_{1M}
:
B_{N1} B_{N2} ... B_{NM}
C_{11} C_{12} ... C_{1M}
:
C_{N1} C_{N2} ... C_{NM}

Here B_{ij} is the number written in the square at the i-th row from the top and the j-th column from the left after Step 1, and C_{ij} is the number written in that square after Step 2.






Sample Input 13 2
2 6
4 3
1 5





Sample Output 12 6 
4 3 
5 1 
2 1 
4 3 
5 6 






Sample Input 23 4
1 4 7 10
2 5 8 11
3 6 9 12





Sample Output 21 4 7 10 
5 8 11 2 
9 12 3 6 
1 4 3 2 
5 8 7 6 
9 12 11 10 


",Sorting a Grid,"Bipartite Graph, Graph Theory, Sorting, Array, Greedy Algorithm, Arithmetic",0.333,20,6
1192,"
Score : 800 points


Problem StatementGiven is a positive even number N.
Find the number of strings s of length N consisting of A, B, and C that satisfy the following condition:

s can be converted to the empty string by repeating the following operation:
Choose two consecutive characters in s and erase them. However, choosing AB or BA is not allowed.



For example, ABBC satisfies the condition for N=4, because we can convert it as follows: ABBC → (erase BB) → AC → (erase AC) → (empty).
The answer can be enormous, so compute the count modulo 998244353.




Constraints
2 \leq N \leq 10^7
N is an even number.







InputInput is given from Standard Input in the following format:
N





OutputPrint the number of strings that satisfy the conditions, modulo 998244353.






Sample Input 12





Sample Output 17

Except AB and BA, all possible strings satisfy the conditions.





Sample Input 210





Sample Output 250007






Sample Input 31000000





Sample Output 3210055358


",Neither AB nor BA,"Arithmetic, Exponentiation By Squaring, Combinatorics, Precomputation, Inclusion And Exclusion, Mathematics",0.857,7,6
1193,"
Score : 1100 points


Problem StatementThis is an interactive task.
You have to guess a secret password S. 
A password is a nonempty string whose length is at most L. 
The characters of a password can be lowercase and uppercase english letters (a, b, ... , z, A, B, ... , Z) and digits (0, 1, ... , 9).
In order to guess the secret password S you can ask queries.
A query is made of a valid password T, the answer to such query is the edit distance between S and T (the operations considered for the edit distance are: removal, insertion, substitution).
You can ask at most Q queries.
Note: For a definition of edit distance (with operations: removal, insertion, substitution), see this wikipedia page.




Constraints
L = 128
Q = 850
The secret password S is chosen before the beginning of the interaction.





InteractionTo ask a query, print on Standard Output (with a newline at the end)
? T

The string T must be a valid password.
The answer ans to each query shall be read from Standard Input in the form:
ans

As soon as you have determined the hidden password S, you should print on Standard Output (with a newline at the end)
! S

and terminate your program.




Judgement
After each output, you must flush Standard Output. Otherwise you may get TLE.
After you print (your guess of) the hidden password, the program must be terminated immediately. Otherwise, the behavior of the judge is undefined.
If the password you have determined is wrong, you will get WA.
If you ask a malformed query (for example because the string is not a valid password, or you forget to put ?) or if your program crashes or if you ask more than Q queries, the behavior of the judge is undefined (it does not necessarily give WA).





SamplesIn the only sample testcase of this problem the hidden password is Atcod3rIsGreat.
The following one is an example of interaction if S=Atcod3rIsGreat.



Input
Output





\texttt{? AtcoderIsBad}


5




\texttt{? AtcoderIsGreat}


1




\texttt{! Atcod3rIsGreat}




",Guess the Password,"Dynamic Programming, Binary Search, Greedy Algorithm, String, Interactive, Mathematics",0.5,3,2
1194,"
Score : 600 points


Problem StatementThere are N cities in Republic of AtCoder. The size of the i-th city is A_{i}.
Takahashi would like to build N-1 bidirectional roads connecting two cities so that any city can be reached from any other city by using these roads.
Assume that the cost of building a road connecting the i-th city and the j-th city is |i-j| \times D + A_{i} + A_{j}.
For Takahashi, find the minimum possible total cost to achieve the objective.




Constraints
1 \leq N \leq 2 \times 10^5
1 \leq D \leq 10^9
1 \leq A_{i} \leq 10^9
A_{i} and D are integers.







InputInput is given from Standard Input in the following format:
N D
A_1 A_2 ... A_N





OutputPrint the minimum possible total cost.






Sample Input 13 1
1 100 1





Sample Output 1106

This cost can be achieved by, for example, building roads connecting City 1, 2 and City 1, 3.





Sample Input 23 1000
1 100 1





Sample Output 22202






Sample Input 36 14
25 171 7 1 17 162





Sample Output 3497






Sample Input 412 5
43 94 27 3 69 99 56 25 8 15 46 8





Sample Output 4658


",Connecting Cities,"Minimum Spanning Tree, Disjoint Set, Greedy Algorithm, Array, Graph Theory",0.0,17,3
1195,"
Score : 900 points


Problem StatementTakahashi has an empty string S and a variable x whose initial value is 0.
Also, we have a string T consisting of 0 and 1.
Now, Takahashi will do the operation with the following two steps |T| times.

Insert a 0 or a 1 at any position of S of his choice.
Then, increment x by the sum of the digits in the odd positions (first, third, fifth, ...) of S. For example, if S is 01101, the digits in the odd positions are 0, 1, 1 from left to right, so x is incremented by 2.

Print the maximum possible final value of x in a sequence of operations such that S equals T in the end.




Constraints
1 \leq |T| \leq 2 \times 10^5
T consists of 0 and 1.







InputInput is given from Standard Input in the following format:
T





OutputPrint the maximum possible final value of x in a sequence of operations such that S equals T in the end.






Sample Input 11101





Sample Output 15

Below is one sequence of operations that maximizes the final value of x to 5.

Insert a 1 at the beginning of S. S becomes 1, and x is incremented by 1.
Insert a 0 to the immediate right of the first character of S. S becomes 10, and x is incremented by 1.
Insert a 1 to the immediate right of the second character of S. S becomes 101, and x is incremented by 2.
Insert a 1 at the beginning of S. S becomes 1101, and x is incremented by 1.






Sample Input 20111101101





Sample Output 226


",Binary Programming,"Parity, Dyanmic Programming, Prefix sum, Greedy Algorithm, Memoization, Bitmask",0.2,9,1
1196,"
Score : 500 points


Problem StatementConsider writing each of the integers from 1 to N \times M in a grid with N rows and M columns, without duplicates.
Takahashi thinks it is not fun enough, and he will write the numbers under the following conditions:

The largest among the values in the i-th row (1 \leq i \leq N) is A_i.
The largest among the values in the j-th column (1 \leq j \leq M) is B_j.

For him, find the number of ways to write the numbers under these conditions, modulo 10^9 + 7.




Constraints
1 \leq N \leq 1000
1 \leq M \leq 1000
1 \leq A_i \leq N \times M
1 \leq B_j \leq N \times M
A_i and B_j are integers.







InputInput is given from Standard Input in the following format:
N M
A_1 A_2 ... A_{N}
B_1 B_2 ... B_{M}





OutputPrint the number of ways to write the numbers under the conditions, modulo 10^9 + 7.






Sample Input 12 2
4 3
3 4





Sample Output 12

(A_1, A_2) = (4, 3) and (B_1, B_2) = (3, 4). In this case, there are two ways to write the numbers, as follows:

1 in (1, 1), 4 in (1, 2), 3 in (2, 1) and 2 in (2, 2).
2 in (1, 1), 4 in (1, 2), 3 in (2, 1) and 1 in (2, 2).

Here, (i, j) denotes the square at the i-th row and the j-th column.





Sample Input 23 3
5 9 7
3 6 9





Sample Output 20

Since there is no way to write the numbers under the condition, 0 should be printed. 





Sample Input 32 2
4 4
4 4





Sample Output 30






Sample Input 414 13
158 167 181 147 178 151 179 182 176 169 180 129 175 168
181 150 178 179 167 180 176 169 182 177 175 159 173





Sample Output 4343772227


",Double Landscape,"Sorting, Binary Search, Arithmetic, Combinatorics, Greedy Algorithm, Mathematics",0.5,13,6
1197,"
Score : 500 points


Problem StatementJumbo Takahashi will play golf on an infinite two-dimensional grid.
The ball is initially at the origin (0, 0), and the goal is a grid point (a point with integer coordinates) (X, Y). In one stroke, Jumbo Takahashi can perform the following operation:

Choose a grid point whose Manhattan distance from the current position of the ball is K, and send the ball to that point.

The game is finished when the ball reaches the goal, and the score will be the number of strokes so far. Jumbo Takahashi wants to finish the game with the lowest score possible.
Determine if the game can be finished. If the answer is yes, find one way to bring the ball to the goal with the lowest score possible.
What is Manhattan distance?
The Manhattan distance between two points (x_1, y_1) and (x_2, y_2) is defined as |x_1-x_2|+|y_1-y_2|.
",Golf,"Mathematics, Greedy Algorithm, Geometry; 3d, Constructive",0.0,6,0
1198,"
Score : 800 points


Problem Statement
Niwango-kun, an employee of Dwango Co., Ltd., likes Niconico TV-chan, so he collected a lot of soft toys of her and spread them on the floor.
Niwango-kun has N black rare soft toys of Niconico TV-chan and they are spread together with ordinary ones. He wanted these black rare soft toys to be close together, so he decided to rearrange them.
In an infinitely large two-dimensional plane, every lattice point has a soft toy on it. The coordinates (x_i,y_i) of N black rare soft toys are given. All soft toys are considered to be points (without a length, area, or volume).
He may perform the following operation arbitrarily many times:

Put an axis-aligned square with side length D, rotate the square by 90 degrees with four soft toys on the four corners of the square. More specifically, if the left bottom corner's coordinate is (x, y), rotate four points (x,y) \rightarrow (x+D,y) \rightarrow (x+D,y+D) \rightarrow (x,y+D) \rightarrow (x,y) in this order. Each of the four corners of the square must be on a lattice point.

Let's define the scatteredness of an arrangement by the minimum side length of an axis-aligned square enclosing all black rare soft toys. Black rare soft toys on the edges or the vertices of a square are considered to be enclosed by the square.
Find the minimum scatteredness after he performs arbitrarily many operations.




Constraints

2 \leq N \leq 10^5
1 \leq D \leq 1000
0 \leq x_i, y_i \leq 10^9
Given coordinates are pairwise distinct
All numbers given in input are integers





Partial Scores

500 points will be awarded for passing the test set satisfying 1 \leq D \leq 30.







Input
Input is given from Standard Input in the following format:
N D
x_1 y_1
:
x_N y_N





Output
Print the answer.






Sample Input 1
3 1
0 0
1 0
2 0





Sample Output 1
1






Sample Input 2
19 2
1 3
2 3
0 1
1 1
2 1
3 1
4 4
5 4
6 4
7 4
8 4
8 3
8 2
8 1
8 0
7 0
6 0
5 0
4 0





Sample Output 2
4






Sample Input 3
8 3
0 0
0 3
3 0
3 3
2 2
2 5
5 2
5 5





Sample Output 3
4


",Square Rotation,"Arithmetic, Graph Theory, Number Theory, Binary Search, Geometry; 3d, Permutation Cycle Decomposition",0.0,5,0
1199,"
Score : 1100 points


Problem StatementThere are N strings of lowercase alphabet only. The i-th string is S_i. Every string is unique.
Provide answers for the Q queries below. The i-th query has the following format:
Query: An integer k_i and a string p_{i,1}p_{i,2}...p_{i,26} that results from permuting {a,b,...,z} are given. Output the sequence of the string S_{k_i} among the N strings in lexicographical order when the literal sequence is p_{i,1}<p_{i,2}<...<p_{i,26}.




Constraints
1 ≦ N,Q ≦ 100000
1 ≦ |S_i| (1 ≦ i ≦ N)
S_i (1 ≦ i ≦ N) is a string of lowercase alphabet.
The sum of |S_i| is no more than 400000.
Every S_i is unique.
1 ≦ k_i ≦ N (1 ≦ i ≦ Q)
For all 1 ≦ i ≦ Q, p_{i,1}p_{i,2}...p_{i,26} is a permutation of abcd...z.







InputInputs are provided from standard inputs in the following form.
N
S_1
:
S_N
Q
k_1 p_{1,1}p_{1,2}...p_{1,26}
:
k_Q p_{Q,1}p_{Q,2}...p_{Q,26}





OutputOutput Q lines.
On line i, for the i-th query, output an integer indicating the sequence of the string S_{k_i} among the N strings in lexicographical order.






Sample Input 15
aa
abbaa
abbba
aaab
aaaaaba
5
1 abcdefghijklmnopqrstuvwxyz
2 bacdefghijklmnopqrstuvwxyz
3 abcdefghijklmnopqrstuvwxyz
4 bacdefghijklmnopqrstuvwxyz
5 abcdefghijklmnopqrstuvwxyz





Sample Output 11
2
5
4
2

When the literal sequence is a < b, sorting the input strings in lexicographical order yields aa, aaaaaba, aaab, abbaa, abbba. The answers to queries 1, 3, and 5 are thus 1, 5, and 2, respectively.
When the literal sequence is b < a, sorting the input strings in lexicographical order yields abbba, abbaa, aa, aaab, aaaaaba. The answers to queries 2 and 4 are thus 2 and 4, respectively.





Sample Input 28
abrakatabra
abadaba
abracadabra
atcoder
grand
contest
ababa
a
6
3 abcdefghijklmnopqrstuvwxyz
6 qwertyuiopasdfghjklzxcvbnm
8 poiuytrewqlkjhgfdsamnbvcxz
2 qazwsxedcrfvtgbyhnujmikolp
1 plokmijnuhbygvtfcrdxeszwaq
4 mnbvcxzasdfghjklpoiuytrewq





Sample Output 24
8
2
3
4
7


",Lexicographical disorder,"Trie, Depth-first Search, Tree, Hashing, String, Prefix sum, Offline Queries",0.0,52,2
1200,"
Score : 1000 points


Problem StatementWe will host a rock-paper-scissors tournament with N people. The participants are called Person 1, Person 2, \ldots, Person N.
For any two participants, the result of the match between them is determined in advance.
This information is represented by positive integers A_{i,j} ( 1 \leq j < i \leq N ) as follows:

If A_{i,j} = 0, Person j defeats Person i.
If A_{i,j} = 1, Person i defeats Person j.

The tournament proceeds as follows:

We will arrange the N participants in a row, in the order Person 1, Person 2, \ldots, Person N from left to right.
We will randomly choose two consecutive persons in the row. They will play a match against each other, and we will remove the loser from the row.
We will repeat this process N-1 times, and the last person remaining will be declared the champion.

Find the number of persons with the possibility of becoming the champion.




Constraints
1 \leq N \leq 2000
A_{i,j} is 0 or 1.







InputInput is given from Standard Input in the following format:
N
A_{2,1}
A_{3,1}A_{3,2}
:
A_{N,1}\ldotsA_{N,N-1}





OutputPrint the number of persons with the possibility of becoming the champion.






Sample Input 13
0
10





Sample Output 12

Person 1 defeats Person 2, Person 2 defeats Person 3 and Person 3 defeats Person 1.
If Person 1 and Person 2 play the first match, Person 3 will become the champion.
If Person 2 and Person 3 play the first match, Person 1 will become the champion.





Sample Input 26
0
11
111
1111
11001





Sample Output 23


",Random Tournament,"Dyanmic Programming, Bit Set, Matrix",1.0,1,1
1201,"
Score : 800 points


Problem StatementYou are given a polynomial of degree N with integer coefficients: f(x)=a_Nx^N+a_{N-1}x^{N-1}+...+a_0. Find all prime numbers p that divide f(x) for every integer x.




Constraints
0 \leq N \leq 10^4
|a_i| \leq 10^9(0\leq i\leq N)
a_N \neq 0
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
a_N
:
a_0





OutputPrint all prime numbers p that divide f(x) for every integer x, in ascending order.






Sample Input 12
7
-7
14





Sample Output 12
7

2 and 7 divide, for example, f(1)=14 and f(2)=28.





Sample Input 23
1
4
1
5





Sample Output 2
There may be no integers that satisfy the condition.





Sample Input 30
998244353





Sample Output 3998244353


",Polynomial Divisors,"Euclidean Algorithm, Prime Factorization, Arithmetic, Sorting",0.0,7,0
1202,"
Score : 600 points


Problem StatementThe server in company A has a structure where N devices numbered 1, 2, ..., N are connected with N - 1 cables.
The i-th cable connects Device U_i and Device V_i.
Any two different devices are connected through some number of cables.
Each device v (1 \leq v \leq N) has a non-zero integer A_v, which represents the following:

If A_v < 0, Device v is a computer that consumes an electric power of -A_v.
If A_v > 0, Device v is a battery that supplies an electric power of A_v.

You have decided to disconnect some number of cables (possibly zero) to disable the server.
When some cables are disconnected, the devices will be divided into some number of connected components.
The server will be disabled if all of these connected components satisfy one of the following conditions:

There is no computer in the connected component. That is, A_v is positive for every device v that belongs to the connected component.
There is not enough supply of electric power in the connected component. That is, the sum of A_v over all devices v that belong to the connected component is negative.

At least how many cables do you need to disconnect in order to disable the server?




Constraints
1 \leq N \leq 5 000
1 \leq |A_i| \leq 10^9 (1 \leq i \leq N)
1 \leq U_i, V_i \leq N (1 \leq i \leq N - 1)
U_i \neq V_i (1 \leq i \leq N - 1)
Any two different devices are connected through some number of cables.
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
A_1 A_2 ... A_N
U_1 V_1
U_2 V_2
:
U_{N - 1} V_{N - 1}





OutputPrint the answer.






Sample Input 17
-2 7 5 6 -8 3 4
1 2
2 3
2 4
1 5
5 6
5 7





Sample Output 11

We should disconnect the cable connecting Device 1 and Device 2.





Sample Input 24
1 2 3 4
1 2
1 3
1 4





Sample Output 20






Sample Input 36
10 -1 10 -1 10 -1
1 2
2 3
3 4
4 5
5 6





Sample Output 35






Sample Input 48
-2 3 6 -2 -2 -5 3 2
3 4
7 6
6 2
8 2
5 3
1 8
3 7





Sample Output 43






Sample Input 510
3 4 9 6 1 5 -1 10 -10 -10
7 4
5 6
8 1
9 5
7 1
10 3
2 8
4 10
9 2





Sample Output 53


",Attack to a Tree,"Depth-first Search, Dynamic Programming On Trees, Tree, Greedy Algorithm",0.0,3,0
1203,"
Score : 1100 points


Problem StatementColoring of the vertices of a tree G is called a good coloring when, for every pair of two vertices u and v painted in the same color, picking u as the root and picking v as the root would result in isomorphic rooted trees.
Also, the colorfulness of G is defined as the minimum possible number of different colors used in a good coloring of G.
You are given a tree with N vertices. The vertices are numbered 1 through N, and the i-th edge connects Vertex a_i and Vertex b_i. We will construct a new tree T by repeating the following operation on this tree some number of times:

Add a new vertex to the tree by connecting it to one of the vertices in the current tree with an edge.

Find the minimum possible colorfulness of T.
Additionally, print the minimum number of leaves (vertices with degree 1) in a tree T that achieves the minimum colorfulness.




NotesThe phrase ""picking u as the root and picking v as the root would result in isomorphic rooted trees"" for a tree G means that there exists a bijective function f_{uv} from the vertex set of G to itself such that both of the following conditions are met:

f_{uv}(u)=v
For every pair of two vertices (a,b), edge (a,b) exists if and only if edge (f_{uv}(a),f_{uv}(b)) exists.





Constraints
2 \leq N \leq 100
1 \leq a_i,b_i \leq N(1\leq i\leq N-1)
The given graph is a tree.







InputInput is given from Standard Input in the following format:
N
a_1 b_1
:
a_{N-1} b_{N-1}





OutputPrint two integers with a space in between.
First, print the minimum possible colorfulness of a tree T that can be constructed.
Second, print the minimum number of leaves in a tree that achieves it.
It can be shown that, under the constraints of this problem, the values that should be printed fit into 64-bit signed integers.






Sample Input 15
1 2
2 3
3 4
3 5





Sample Output 12 4

If we connect a new vertex 6 to vertex 2, painting the vertices (1,4,5,6) red and painting the vertices (2,3) blue is a good coloring.
Since painting all the vertices in a single color is not a good coloring, we can see that the colorfulness of this tree is 2.
This is actually the optimal solution. There are four leaves, so we should print 2 and 4.





Sample Input 28
1 2
2 3
4 3
5 4
6 7
6 8
3 6





Sample Output 23 4






Sample Input 310
1 2
2 3
3 4
4 5
5 6
6 7
3 8
5 9
3 10





Sample Output 34 6






Sample Input 413
5 6
6 4
2 8
4 7
8 9
3 2
10 4
11 10
2 4
13 10
1 8
12 1





Sample Output 44 12


",Isomorphism Freak,"Graph Theory, Graph Traversal, Floyd-warshall, Diameter Of A Tree, Tree, Combinatorics, Enumeration",0.571,11,6
1204,"
Score : 900 points


Problem StatementThere are N pinholes on the xy-plane. The i-th pinhole is located at (x_i,y_i).
We will denote the Manhattan distance between the i-th and j-th pinholes as d(i,j)(=|x_i-x_j|+|y_i-y_j|).
You have a peculiar pair of compasses, called Manhattan Compass.
This instrument always points at two of the pinholes.
The two legs of the compass are indistinguishable, thus we do not distinguish the following two states: the state where the compass points at the p-th and q-th pinholes, and the state where it points at the q-th and p-th pinholes.
When the compass points at the p-th and q-th pinholes and d(p,q)=d(p,r), one of the legs can be moved so that the compass will point at the p-th and r-th pinholes.
Initially, the compass points at the a-th and b-th pinholes.
Find the number of the pairs of pinholes that can be pointed by the compass.




Constraints
2≦N≦10^5
1≦x_i, y_i≦10^9
1≦a < b≦N
When i ≠ j, (x_i, y_i) ≠ (x_j, y_j)
x_i and y_i are integers.







InputThe input is given from Standard Input in the following format:
N a b
x_1 y_1
:
x_N y_N





OutputPrint the number of the pairs of pinholes that can be pointed by the compass.






Sample Input 15 1 2
1 1
4 3
6 1
5 5
4 8





Sample Output 14

Initially, the compass points at the first and second pinholes.
Since d(1,2) = d(1,3), the compass can be moved so that it will point at the first and third pinholes.
Since d(1,3) = d(3,4), the compass can also point at the third and fourth pinholes.
Since d(1,2) = d(2,5), the compass can also point at the second and fifth pinholes.
No other pairs of pinholes can be pointed by the compass, thus the answer is 4.





Sample Input 26 2 3
1 3
5 3
3 5
8 4
4 7
2 5





Sample Output 24






Sample Input 38 1 2
1 5
4 3
8 2
4 7
8 8
3 3
6 6
4 8





Sample Output 37


",Manhattan Compass,"Geometry; 3d, Graph Theory, Depth-first Search, Binary Search, Segment Tree, Bit Set",0.25,9,5
1205,"
Score : 700 points


Problem StatementTakahashi throws N dice, each having K sides with all integers from 1 to K. The dice are NOT pairwise distinguishable.
For each i=2,3,...,2K, find the following value modulo 998244353:

The number of combinations of N sides shown by the dice such that the sum of no two different sides is i.

Note that the dice are NOT distinguishable, that is, two combinations are considered different when there exists an integer k such that the number of dice showing k is different in those two.




Constraints
1 \leq K \leq 2000
2 \leq N \leq 2000
K and N are integers.







InputInput is given from Standard Input in the following format:
K N





OutputPrint 2K-1 integers. The t-th of them (1\leq t\leq 2K-1) should be the answer for i=t+1.






Sample Input 13 3





Sample Output 17
7
4
7
7


For i=2, the combinations (1,2,2),(1,2,3),(1,3,3),(2,2,2),(2,2,3),(2,3,3),(3,3,3) satisfy the condition, so the answer is 7.
For i=3, the combinations (1,1,1),(1,1,3),(1,3,3),(2,2,2),(2,2,3),(2,3,3),(3,3,3) satisfy the condition, so the answer is 7.
For i=4, the combinations (1,1,1),(1,1,2),(2,3,3),(3,3,3) satisfy the condition, so the answer is 4.






Sample Input 24 5





Sample Output 236
36
20
20
20
36
36






Sample Input 36 1000





Sample Output 3149393349
149393349
668669001
668669001
4000002
4000002
4000002
668669001
668669001
149393349
149393349


",Stop. Otherwise...,"Combinatorics, Arithmetic",0.5,8,4
1206,"
Score : 600 points


Problem StatementYou are given a positive integer N.
Find the number of the pairs of integers u and v (0≦u,v≦N) such that there exist two non-negative integers a and b satisfying a xor b=u and a+b=v.
Here, xor denotes the bitwise exclusive OR.
Since it can be extremely large, compute the answer modulo 10^9+7.




Constraints
1≦N≦10^{18}







InputThe input is given from Standard Input in the following format:
N





OutputPrint the number of the possible pairs of integers u and v, modulo 10^9+7.






Sample Input 13





Sample Output 15

The five possible pairs of u and v are:


u=0,v=0 (Let a=0,b=0, then 0 xor 0=0, 0+0=0.)


u=0,v=2 (Let a=1,b=1, then 1 xor 1=0, 1+1=2.）


u=1,v=1 (Let a=1,b=0, then 1 xor 0=1, 1+0=1.）


u=2,v=2 (Let a=2,b=0, then 2 xor 0=2, 2+0=2.）


u=3,v=3 (Let a=3,b=0, then 3 xor 0=3, 3+0=3.）







Sample Input 21422





Sample Output 252277






Sample Input 31000000000000000000





Sample Output 3787014179


",Xor Sum,"Dynamic Programming Using Bitfield, Dynamic Programming, Arithmetic, Bitmask, Mathematics",0.714,10,8
1207,"
Score : 900 points


Problem StatementYou are developing frog-shaped robots, and decided to race them against each other.
First, you placed N robots onto a number line.
These robots are numbered 1 through N.
The current coordinate of robot i is x_i.
Here, all x_i are integers, and 0 < x_1 < x_2 < ... < x_N.
You will repeatedly perform the following operation:

Select a robot on the number line. Let the coordinate of the robot be x. Select the destination coordinate, either x-1 or x-2, that is not occupied by another robot. The robot now jumps to the selected coordinate.

When the coordinate of a robot becomes 0 or less, the robot is considered finished and will be removed from the number line immediately.
You will repeat the operation until all the robots finish the race.
Depending on your choice in the operation, the N robots can finish the race in different orders.
In how many different orders can the N robots finish the race?
Find the answer modulo 10^9+7.




Constraints
2 ≤ N ≤ 10^5
x_i is an integer.
0 < x_1 < x_2 < ... < x_N ≤ 10^9





Partial Score
In a test set worth 500 points, N ≤ 8.







InputThe input is given from Standard Input in the following format:
N
x_1 x_2 ... x_N





OutputPrint the number of the different orders in which the N robots can finish the race, modulo 10^9+7.






Sample Input 13
1 2 3





Sample Output 14

There are four different orders in which the three robots can finish the race:

(Robot 1 → Robot 2 → Robot 3)
(Robot 1 → Robot 3 → Robot 2)
(Robot 2 → Robot 1 → Robot 3)
(Robot 2 → Robot 3 → Robot 1)






Sample Input 23
2 3 4





Sample Output 26

There are six different orders in which the three robots can finish the race:

(Robot 1 → Robot 2 → Robot 3)
(Robot 1 → Robot 3 → Robot 2)
(Robot 2 → Robot 1 → Robot 3)
(Robot 2 → Robot 3 → Robot 1)
(Robot 3 → Robot 1 → Robot 2)
(Robot 3 → Robot 2 → Robot 1)

For example, the order (Robot 3 → Robot 2 → Robot 1) can be achieved as shown in the figure below:








Sample Input 38
1 2 3 5 7 11 13 17





Sample Output 310080






Sample Input 413
4 6 8 9 10 12 14 15 16 18 20 21 22





Sample Output 4311014372

Remember to print the answer modulo 10^9+7.
This case is not included in the test set for the partial score.

",Robot Racing,"Arithmetic, Combinatorics, Greedy Algorithm, Stack, Mathematics",0.667,10,6
1208,"
Score : 800 points


Problem StatementThere is a square grid with N rows and M columns.
Each square contains an integer: 0 or 1. The square at the i-th row from the top and the j-th column from the left contains a_{ij}.
Among the 2^{N+M} possible pairs of a subset A of the rows and a subset B of the columns, find the number of the pairs that satisfy the following condition, modulo 998244353:

The sum of the |A||B| numbers contained in the intersection of the rows belonging to A and the columns belonging to B, is odd.





Constraints
1 \leq N,M \leq 300
0 \leq a_{i,j} \leq 1(1\leq i\leq N,1\leq j\leq M)
All values in input are integers.







InputInput is given from Standard Input in the following format:
N M
a_{11} ... a_{1M}
:
a_{N1} ... a_{NM}





OutputPrint the number of the pairs of a subset of the rows and a subset of the columns that satisfy the condition, modulo 998244353.






Sample Input 12 2
0 1
1 0





Sample Output 16

For example, if A consists of the first row and B consists of both columns, the sum of the numbers contained in the intersection is 0+1=1.





Sample Input 22 3
0 0 0
0 1 0





Sample Output 28


",Odd Subrectangles,"Xor Basis (gf(2)), Bitmask, Combinatorics, Arithmetic",0.333,7,3
1209,"
Score : 800 points


Problem StatementTakahashi and Aoki will take N exams numbered 1 to N.
They have decided to compete in these exams.
The winner will be determined as follows:


For each exam i, Takahashi decides its importance c_i, which must be an integer between l_i and u_i (inclusive).


Let A be \sum_{i=1}^{N} c_i \times (Takahashi's score on Exam i), and B be \sum_{i=1}^{N} c_i \times (Aoki's score on Exam i). Takahashi wins if A \geq B, and Aoki wins if A < B.


Takahashi knows that Aoki will score b_i on Exam i, with his supernatural power.
Takahashi himself, on the other hand, will score 0 on all the exams without studying more. For each hour of study, he can increase his score on some exam by 1. (He can only study for an integer number of hours.)
However, he cannot score more than X on an exam, since the perfect score for all the exams is X.
Print the minimum number of study hours required for Takahashi to win.




Constraints
1 \leq N \leq 10^5
1 \leq X \leq 10^5
0 \leq b_i \leq X (1 \leq i \leq N)
1 \leq l_i \leq u_i \leq 10^5 (1 \leq i \leq N)
All values in input are integers.







InputInput is given from Standard Input in the following format:
N X
b_1 l_1 u_1
b_2 l_2 u_2
:
b_N l_N u_N





OutputPrint the minimum number of study hours required for Takahashi to win.






Sample Input 12 100
85 2 3
60 1 1





Sample Output 1115

One optimal strategy is as follows:


Choose c_1 = 3, c_2 = 1.


Study to score 100 on Exam 1 and 15 on Exam 2.


Then, A = 3 \times 100 + 1 \times 15 = 315, B = 3 \times 85 + 1 \times 60 = 315 and Takahashi will win.





Sample Input 22 100
85 2 3
60 10 10





Sample Output 277






Sample Input 31 100000
31415 2718 2818





Sample Output 331415






Sample Input 410 1000
451 4593 6263
324 310 6991
378 1431 7068
71 1757 9218
204 3676 4328
840 6221 9080
684 1545 8511
709 5467 8674
862 6504 9835
283 4965 9980





Sample Output 42540


",Tests,"Greedy Algorithm, Sorting, Prefix sum",0.231,30,10
1210,"
Score : 1500 points


Problem StatementYou are given a tree with N vertices numbered 1, 2, ..., N. The i-th edge connects Vertex a_i and Vertex b_i.
You are also given a string S of length N consisting of 0 and 1. The i-th character of S represents the number of pieces placed on Vertex i.
Snuke will perform the following operation some number of times:

Choose two pieces the distance between which is at least 2, and bring these pieces closer to each other by 1. More formally, choose two vertices u and v, each with one or more pieces, and consider the shortest path between them. Here the path must contain at least two edges. Then, move one piece from u to its adjacent vertex on the path, and move one piece from v to its adjacent vertex on the path.

By repeating this operation, Snuke wants to have all the pieces on the same vertex. Is this possible?
If the answer is yes, also find the minimum number of operations required to achieve it.




Constraints
2 \leq N \leq 2000
|S| = N
S consists of 0 and 1, and contains at least one 1.
1 \leq a_i, b_i \leq N(a_i \neq b_i)
The edges (a_1, b_1), (a_2, b_2), ..., (a_{N - 1}, b_{N - 1}) forms a tree.







InputInput is given from Standard Input in the following format:
N
S
a_1 b_1
a_2 b_2
:
a_{N - 1} b_{N - 1}





OutputIf it is impossible to have all the pieces on the same vertex, print -1. If it is possible, print the minimum number of operations required.






Sample Input 17
0010101
1 2
2 3
1 4
4 5
1 6
6 7





Sample Output 13

We can gather all the pieces in three operations as follows:

Choose the pieces on Vertex 3 and 5.
Choose the pieces on Vertex 2 and 7.
Choose the pieces on Vertex 4 and 6.






Sample Input 27
0010110
1 2
2 3
1 4
4 5
1 6
6 7





Sample Output 2-1






Sample Input 32
01
1 2





Sample Output 30


",Complete Compress,"Graph Theory, Depth-first Search, Dynamic Programming On Trees, Recursion, Arithmetic, Combinatorics, Dyanmic Programming, Tree",0.5,10,5
1211,"


Problem Setting



Overview

Concept: In this programming contest, you will run a delivery service. Customers will place orders with your shop. Each order has a unique \text{ID} and should be delivered to the corresponding customer. Your delivery service has one car. The car will fetch the ordered item from the shop and deliver it to the customer.
Score: Your goal is to deliver as many items as possible, as quickly as possible in a given amount of time T_{\text{max}}. (Orders are expected until 0.95 \times T_{\text{max}}).
Constraint: In this contest there is no constraint on the number of items you can place in the car. However, an item can only be loaded in the car, by fetching it from the shop, after the order has been placed.
Problem A/B: In problem A all order positions and times are given to the contestant in advance and the contestant algorithm shall optimize the moves of the car to make as many deliveries as possible as fast as possible. On the other hand, in problem B orders appear online, that is new orders appear, while you move your car to make as many deliveries as possible as fast as possible.








Specification of Time and Space:

Time: In this contest we model the progress of time by integer values 0 \le t < T_{\text{max}}.
Map: In this contest we model a map by a simple, undirected, and connected graph G=(V, E), consisting of a set of vertices V and a set of edges E
Shop and customer locations: The vertices u \in V are labeled from 1 to |V| and the vertex u=1 denotes the location of your shop, while vertices u = 2,...,|V| denote locations of potential customers. Here, |V| denotes the number of elements of the set V.
Streets: Each edge \left\{ u, v \right\} \in E represents a street connecting the vertices u, v \in V. The corresponding length is given by an integer edge weight d_{u, v} \ge 1.
Graph creation: The algorithm for generating the map graph based on a random seed is specified in the following pseudo-code. For further details, please see the sample code below.


 Pseudo code: Map graph generator 

 Input:|V|, |E|, \mathrm{MaxDegree}=5
 2d vertex grid:

 First, find the largest integer R>0 such that |V| = R^{2} + r, with r being the smallest possible non-negative integer.
 Then we plot points (x, y) on the 2d vertex grid (0 \leq x, y \lt R).
 For each point (x, y) add a uniform random offset dx, dy \in [0, 1] , giving the final vertex position (x + dx, y + dy)\in [0,R] \times [0,R].
 Finally, add the remaining r vertices at a uniform random position (x, y) with 0 \leq x, y \leq R.
 Vertex labels u \in V are assigned by random shuffling. The shop is the vertex u=1.


 How we create Highways:

 To generate a highway network, we create a complete graph G_{\text{comp}} on the vertex set u \in V, assigning each vertex pair u, v \in V \times V the Euclidean distance W_{u, v} as an edge weight.
 Next, we construct a  minimum spanning  tree of G_{\text{comp}}. The |V|-1 edges of the minimum spanning tree are the highway network of the graph G. We assign each of those edges \left\{ u, v \right\} an edge weight d_{u,v} \leftarrow \lceil 2 \times W_{u, v} \rceil .
  


 How we add side roads:

 To create a network of side roads, we successively add |E|-(|V|-1) edges to the graph G as follows:
  
 Update \mathrm{cost}(u,v). 
 Among the vertex pairs \left( u, v \right) \in V\times V, not yet connected by an edge, select a pair with minimal \mathrm{cost}(u,v).
 Assign the edge weight d_{u,v} \leftarrow \lceil 4 \times W_{u, v} \rceil .



  Here, \mathrm{cost}(u,v) is essentially based on the Euclidean distance of vertices, giving preference to connecting nearby vertices with low degree. In addition, preference is given to side roads along the rectangular grid, to avoid too many bridges. The detailed definitions are as follows:
  
 Define \mathrm{degree}(u), the degree of vertex u\in V as the number of incident edges. 
 Define \mathrm{color}(u) for each vertex u\in V according to its original position (x,y) on the vertex grid as:
    
 If x+y is even : \mathrm{color}(u) = 0 
 If x+y is odd : \mathrm{color}(u) = 1 
 For the remaining r vertices : Assign a color \mathrm{color}(u) \in \left\{0,1\right\} at random. 


 Define a factor f(u,v) as follows:
    
 If \mathrm{color}(u) and \mathrm{color}(v) are the same : Set \mathrm{f}(u,v) = 5 
 If \mathrm{color}(u) and \mathrm{color}(v) are different : Set \mathrm{f}(u,v) = 1 


 Define a factor g(u) as follows:
    
 If \mathrm{degree}(u) \lt \mathrm{MaxDegree} : Set g(u)=1 
 If \mathrm{degree}(u) \geq \mathrm{MaxDegree} : Set g(u)=\infty 


 Finally, the cost is defined as follows:
    
 \mathrm{cost}(u,v) = W_{u,v}\times \mathrm{degree}(u) \times \mathrm{degree}(v) \times f(u,v) \times g(u) \times g(v). 






  How we assign order frequencies: 

 Assign each vertex u \in V an order frequency f_u \in \left\{0,1,2\right\}.
 Init the order frequency of the shop vertex: f_1 \leftarrow 0. 
 Init the order frequency of the other vertices: f_u \leftarrow 1
 Now determine vertices with order frequency 2. For this draw a uniform random center point c=(c_x,c_y)\in [R/4,3R/4]\times[R/4,3R/4] and then for all vertices u=2,...,|V| do:  
    
 If \mathrm{EuclideanDistance}(c,u)\le R/8 + \mathrm{uniformRandom}[0,R/8]: f_{u} \leftarrow 2 










Specification of Car Locations and Moves:
In order to make deliveries you will operate a delivery car, which can take positions and make moves as specified below.


Car position: A car can generally take two types of position:

on a vertex u \in V.
on an edge \left\{ u, v \right\} \in E. More specifically, it is located at a distance x (0 \lt x \lt d_{u, v}) from  u  to  v .



Car move: At each step   0 \le t < T_{\text{max}}  you have to choose one of the following actions in order to control your delivery car.

stay: stay at the current position.
move w: Take one step towards vertex w \in V.

In case of choosing move w, w must obey the following constraints. A failure to obey these constraints results in a wrong answer WA.

 w must be a vertex, i.e., w \in V.
 If the car is on vertex u \in V, there must be an edge connecting u and v, i.e., \left\{ u, w \right\} \in E.
 If the car is on the edge \left\{ u, v \right\} \in E, w must either be w = u or w = v.










Orders, Deliveries, and Constraints:

Orders: Throughout the contest each order is characterized by three quantities: A unique order ID, a vertex v \in V indicating the order destination, and the order time t at which the order appeared. For the detailed format see below.
Order generation: At each time  0 \le t \le T_{\text{last}} = 0.95 \times T_{\text{max}} up to one new order can appear with probability p_{\text{order}}(t). In case there is an order, the order destination i is chosen from the vertex set V with probability proportional to the order frequency f_i. For details, see the pseudo-code below or the sample code further below.


 Pseudo code: Order generation 

 Input: Last order time T_{\text{last}} and average order probability p_{\text{order}}(t). 
 Init:  \mathrm{ID} \leftarrow 0. 
 For each step t = 0, ..., T_{\text{last}}  do:
    
 Generate a uniform random number r \in [0,1] . 
 If  r \le p_{\text{order}}(t) :
      
 Select a vertex position  u \in V  at random with probability proportional to the order frequency  f_{u}  of the vertex. 
 \mathrm{ID} \leftarrow \mathrm{ID} + 1 
 place order (new order ID, order time t, vertex position
       u \in V )


 Else: place no order




 Note: The average order probability is defined as follows:

 p_{\text{order}}(t) =
\begin{cases}
t / T_{\text{peak}},  &
\text{if } 0\le t \lt T_{\text{peak}}, \\
(T_{\text{last}} - t) / (T_{\text{last}}- T_{\text{peak}}),  &
\text{if } T_{\text{peak}} \le t \lt T_{\text{last}}, \\
0, &
\text{if } T_{\text{last}} \le t,
\end{cases}

where T_{\text{last}}:=0.95 \times T_{\max} and T_{\text{peak}} is drawn randomly uniform from the interval [0, T_{\text{last}}].
 Note: The value of T_{\text{peak}} will not be given as an input. 






Delivery: To deliver an order, the contestant must do the following steps after the order has been placed:
(1st) Move the car onto the shop: Note: When moving a car onto the shop, all orders with order time less than or equal to the current time, will be transfered into the car. On the other hand, orders which have not appeared yet, cannot be placed into the car.
(2nd) Move the car to the customer position: To finalize a delivery, move the car onto the vertex of the customer position. Note: Orders which have not been transfered into the car yet, will not be delivered, even if you arrive at the customer position.







Constraints: Throughout the contest, we assume each order has a unique \text{ID} and should be delivered to the corresponding customer. It is further assumed that an unlimited number of orders can be placed in the car.





Scoring

 During the contest the total score of a submission is determined by summing the score of the submission with respect to 30 input cases.
 After the contest a system test will be performed. To this end, the contestant's last submission will be scored by summing the score of the submission on 100 previously unseen input cases.
 For each input case, the score is calculated as follows:

 \text{Score} =
    \sum_{i \in D} {(T_{\text{max}})}^{2} - {(\mathrm{waitingTime}_i)}^{2}, 

Here we use the following definitions:

  D  : the set of orders delivered until t=T_{\text{max}}
 the waiting time of the ith order: \mathrm{waitingTime}_i = \mathrm{deliveredTime}_i - \mathrm{orderedTime}_i.
Note that an input case giving the output WA will receive 0 points.






Particulars of Problem A
In problem A we pass all orders which appear at time  0 \le t < 0.95 \times T_{\text{max}}  as an input to the contestant code. The task is to provide an algorithm which optimizes the moves of the car such that the above score becomes maximal.





Input Format
Input is provided in the following form:
|V| |E|
u_{1} v_{1} d_{u_{1}, v_{1}}
u_{2} v_{2} d_{u_{2}, v_{2}}
:
u_{|E|} v_{|E|} d_{u_{|E|}, v_{|E|}}
T_{\text{max}}
\mathrm{info}_{0}
\mathrm{info}_{1}
:
\mathrm{info}_{T_{\text{max}}-1}


 In the first line |V| denotes the number of vertices, while |E| denotes the number of edges.
 The following |E| lines denote the edges of the graph. In particular, in the ith line u_{i} and v_{i} denote the edge connecting u_{i} and v_{i} and d_{u_{i}, v_{i}} the corresponding distance.
 The following line denotes the number of steps T_{\text{max}}.

In the following line, \mathrm{info}_t is information about the order from the customer that occurs at time t. \mathrm{info}_t is given in the form:
N_{\text{new}}
\mathrm{new\_id}_1 \mathrm{dst}_1
\mathrm{new\_id}_2 \mathrm{dst}_2
\vdots
\mathrm{new\_id}_{N_{\text{new}}} \mathrm{dst}_{N_{\text{new}}}


 N_{\text{new}} represents the number of new orders which appear at time t.
 The next N_{\text{new}} lines give the newly generated order information. The i-th order information indicates that the order ID \mathrm{new\_{id}}_i of the new order, while \mathrm{dst}_i
denotes the vertex to which the customer wishes the order to be delivered.
 Note: If N_{\text{new}}=0, there are no new lines. 





Requirements

 All inputs are of non-negative integer value. 
 T_{\text{max}} = 10000
 200 \leq |V| \leq 400 
 1.5 |V| \leq |E| \leq  2 |V|
1 \leq u_{i}, v_{i} \leq |V| (1 \leq i \leq |E|)
1 \leq d_{u_i, v_i} \leq \lceil 4\sqrt{2|V|} \rceil (1 \leq i \leq |E|)
The given graph has no self-loops / multiple edges and is guaranteed to be connected.
0 \leq N_{\text{new}} \leq 1
1 \leq \mathrm{new\_id}_{i} \leq T_{\text{last}}+1 (1 \leq i \leq N_{\text{new}}). Note: If all orders are generated by the order generation rule as explained above, the total number of orders is at most T_{\text{last}}+1. Therefore, the possible range of \mathrm{new\_id}_{i} should be from 1 to T_{\text{last}}+1.
2 \leq \mathrm{dst}_i \leq |V| (1 \leq i \leq N_{\text{new}})
The order IDs \mathrm{new\_{id}}_i are unique. 





Output Format
The Output expects T_{\text{max}} integers in the format specified below.
\mathrm{command}_{0}
\mathrm{command}_{1}
:
\mathrm{command}_{T_{\text{max}}-1}

In particular, \mathrm{command}_{i} shall specify the movement of the delivery car by using one of the following two options:
1) stay, if the car shall not move:
-1

2) move w, if the car shall be moved one step towards the neighboring vertex w
w

Note that in case of 2) w has to satisfy the following conditions:

w \in V
If the car is at vertex u: \left\{ u, w \right\} \in E .
If the car is on the edge \left\{ u, v \right\}, w must either satisfy u = w or v = w.







Input Example
5 7
1 2 5
5 3 4
2 4 8
1 5 1
2 3 3
4 5 3
4 3 9
4
1
1 2
1
2 5
1
3 4
0

Note that this input is an example of small size and does not meet the constraints of the contest.




Output Example
2
-1
1
5





Explanation
The example operates on a graph with |V| = 5 vertices, |E| = 7 edges, and T_{\text{max}} = 4 time steps. We now describe the orders which have occured and the movement of the car.
Time t=0
At time t=0 an order is placed at the shop. This order has ID= 1 and should be delivered to vertex  2. Because your car is currently at vertex one, the order will be automatically transfered into your car. In this way, when your car is at the shop, all orders which have been made at present and before, will automatically be loaded into your car.
Time 0 → 1
You choose to move towards vertex move 2. You will now move one step towards vertex 2.
Time t=1
A new order has appeared. It has ID =2 and shall be delivered at  vertex 5.
Time 1 → 2
You decided to stay. You can now stay on the edge where you are.
Time t=2
A new order has appeared. It has ID =3 and shall be delivered at  vertex 4.
Time 2 → 3
You decided to move move 1 back to vertex 1.
You are approaching one step towards vertex 1.
Doing a U-turn in this way is explicitly allowed.
Time t=3
New orders have not occurred. Now that you are at the vertex  1  (store), the orders with order ID  2, 3  are loaded into your car. In a similar way, whenever you return to the store, all the orders that have already been placed are loaded into your car automatically.
Time 3 → 4
Being at vertex 1 you choose move 5. You are moving your car one step towards vertex 5. You arrive at vertex 5.
Time t=4
Since you arrived at vertex 5, the order with order ID 2 can be delivered.




Sample Code A
A software toolkit for generation of input samples, scoring and testing on a local contestant environment, and  sample codes for beginners
is provided through the following link. In addition we provide software for visualizing the contestants results.

",Problem A,"Graph Theory, Floyd-warshall, Dijkstra's, Greedy Algorithm, Heuristics, Priority Queue",1.0,15,12
1212,"


Problem Setting



Overview

Concept: In this programming contest, you will run a delivery service. Customers will place orders with your shop. Each order has a unique \text{ID} and should be delivered to the corresponding customer. Your delivery service has one car. The car will fetch the ordered item from the shop and deliver it to the customer.
Score: Your goal is to deliver as many items as possible, as quickly as possible in a given amount of time T_{\text{max}}. (Orders are expected until 0.95 \times T_{\text{max}}).
Constraint: In this contest there is no constraint on the number of items you can place in the car. However, an item can only be loaded in the car, by fetching it from the shop, after the order has been placed.
Problem A/B: In problem A all order positions and times are given to the contestant in advance and the contestant algorithm shall optimize the moves of the car to make as many deliveries as possible as fast as possible. On the other hand, in problem B orders appear online, that is new orders appear, while you move your car to make as many deliveries as possible as fast as possible.








Specification of Time and Space:

Time: In this contest we model the progress of time by integer values 0 \le t < T_{\text{max}}.
Map: In this contest we model a map by a simple, undirected, and connected graph G=(V, E), consisting of a set of vertices V and a set of edges E
Shop and customer locations: The vertices u \in V are labeled from 1 to |V| and the vertex u=1 denotes the location of your shop, while vertices u = 2,...,|V| denote locations of potential customers. Here, |V| denotes the number of elements of the set V.
Streets: Each edge \left\{ u, v \right\} \in E represents a street connecting the vertices u, v \in V. The corresponding length is given by an integer edge weight d_{u, v} \ge 1.
Graph creation: The algorithm for generating the map graph based on a random seed is specified in the following pseudo-code. For further details, please see the sample code below.


 Pseudo code: Map graph generator 

 Input:|V|, |E|, \mathrm{MaxDegree}=5
 2d vertex grid:

 First, find the largest integer R>0 such that |V| = R^{2} + r, with r being the smallest possible non-negative integer.
 Then we plot points (x, y) on the 2d vertex grid (0 \leq x, y \lt R).
 For each point (x, y) add a uniform random offset dx, dy \in [0, 1] , giving the final vertex position (x + dx, y + dy)\in [0,R] \times [0,R].
 Finally, add the remaining r vertices at a uniform random position (x, y) with 0 \leq x, y \leq R.
 Vertex labels u \in V are assigned by random shuffling. The shop is the vertex u=1.


 How we create Highways:

 To generate a highway network, we create a complete graph G_{\text{comp}} on the vertex set u \in V, assigning each vertex pair u, v \in V \times V the Euclidean distance W_{u, v} as an edge weight.
 Next, we construct a  minimum spanning  tree of G_{\text{comp}}. The |V|-1 edges of the minimum spanning tree are the highway network of the graph G. We assign each of those edges \left\{ u, v \right\} an edge weight d_{u,v} \leftarrow \lceil 2 \times W_{u, v} \rceil .
  


 How we add side roads:

 To create a network of side roads, we successively add |E|-(|V|-1) edges to the graph G as follows:
  
 Update \mathrm{cost}(u,v). 
 Among the vertex pairs \left( u, v \right) \in V\times V, not yet connected by an edge, select a pair with minimal \mathrm{cost}(u,v).
 Assign the edge weight d_{u,v} \leftarrow \lceil 4 \times W_{u, v} \rceil .



  Here, \mathrm{cost}(u,v) is essentially based on the Euclidean distance of vertices, giving preference to connecting nearby vertices with low degree. In addition, preference is given to side roads along the rectangular grid, to avoid too many bridges. The detailed definitions are as follows:
  
 Define \mathrm{degree}(u), the degree of vertex u\in V as the number of incident edges. 
 Define \mathrm{color}(u) for each vertex u\in V according to its original position (x,y) on the vertex grid as:
    
 If x+y is even : \mathrm{color}(u) = 0 
 If x+y is odd : \mathrm{color}(u) = 1 
 For the remaining r vertices : Assign a color \mathrm{color}(u) \in \left\{0,1\right\} at random. 


 Define a factor f(u,v) as follows:
    
 If \mathrm{color}(u) and \mathrm{color}(v) are the same : Set \mathrm{f}(u,v) = 5 
 If \mathrm{color}(u) and \mathrm{color}(v) are different : Set \mathrm{f}(u,v) = 1 


 Define a factor g(u) as follows:
    
 If \mathrm{degree}(u) \lt \mathrm{MaxDegree} : Set g(u)=1 
 If \mathrm{degree}(u) \geq \mathrm{MaxDegree} : Set g(u)=\infty 


 Finally, the cost is defined as follows:
    
 \mathrm{cost}(u,v) = W_{u,v}\times \mathrm{degree}(u) \times \mathrm{degree}(v) \times f(u,v) \times g(u) \times g(v). 






  How we assign order frequencies: 

 Assign each vertex u \in V an order frequency f_u \in \left\{0,1,2\right\}.
 Init the order frequency of the shop vertex: f_1 \leftarrow 0. 
 Init the order frequency of the other vertices: f_u \leftarrow 1
 Now determine vertices with order frequency 2. For this draw a uniform random center point c=(c_x,c_y)\in [R/4,3R/4]\times[R/4,3R/4] and then for all vertices u=2,...,|V| do:  
    
 If \mathrm{EuclideanDistance}(c,u)\le R/8 + \mathrm{uniformRandom}[0,R/8]: f_{u} \leftarrow 2 










Specification of Car Locations and Moves:
In order to make deliveries you will operate a delivery car, which can take positions and make moves as specified below.


Car position: A car can generally take two types of position:

on a vertex u \in V.
on an edge \left\{ u, v \right\} \in E. More specifically, it is located at a distance x (0 \lt x \lt d_{u, v}) from  u  to  v .



Car move: At each step   0 \le t < T_{\text{max}}  you have to choose one of the following actions in order to control your delivery car.

stay: stay at the current position.
move w: Take one step towards vertex w \in V.

In case of choosing move w, w must obey the following constraints. A failure to obey these constraints results in a wrong answer WA.

 w must be a vertex, i.e., w \in V.
 If the car is on vertex u \in V, there must be an edge connecting u and v, i.e., \left\{ u, w \right\} \in E.
 If the car is on the edge \left\{ u, v \right\} \in E, w must either be w = u or w = v.










Orders, Deliveries, and Constraints:

Orders: Throughout the contest each order is characterized by three quantities: A unique order ID, a vertex v \in V indicating the order destination, and the order time t at which the order appeared. For the detailed format see below.
Order generation: At each time  0 \le t \le T_{\text{last}} = 0.95 \times T_{\text{max}} up to one new order can appear with probability p_{\text{order}}(t). In case there is an order, the order destination i is chosen from the vertex set V with probability proportional to the order frequency f_i. For details, see the pseudo-code below or the sample code further below.


 Pseudo code: Order generation 

 Input: Last order time T_{\text{last}} and average order probability p_{\text{order}}(t). 
 Init:  \mathrm{ID} \leftarrow 0. 
 For each step t = 0, ..., T_{\text{last}}  do:
    
 Generate a uniform random number r \in [0,1] . 
 If  r \le p_{\text{order}}(t) :
      
 Select a vertex position  u \in V  at random with probability proportional to the order frequency  f_{u}  of the vertex. 
 \mathrm{ID} \leftarrow \mathrm{ID} + 1 
 place order (new order ID, order time t, vertex position
       u \in V )


 Else: place no order




 Note: The average order probability is defined as follows:

 p_{\text{order}}(t) =
\begin{cases}
t / T_{\text{peak}},  &
\text{if } 0\le t \lt T_{\text{peak}}, \\
(T_{\text{last}} - t) / (T_{\text{last}}- T_{\text{peak}}),  &
\text{if } T_{\text{peak}} \le t \lt T_{\text{last}}, \\
0, &
\text{if } T_{\text{last}} \le t,
\end{cases}

where T_{\text{last}}:=0.95 \times T_{\max} and T_{\text{peak}} is drawn randomly uniform from the interval [0, T_{\text{last}}].
 Note: The value of T_{\text{peak}} will not be given as an input. 






Delivery: To deliver an order, the contestant must do the following steps after the order has been placed:
(1st) Move the car onto the shop: Note: When moving a car onto the shop, all orders with order time less than or equal to the current time, will be transfered into the car. On the other hand, orders which have not appeared yet, cannot be placed into the car.
(2nd) Move the car to the customer position: To finalize a delivery, move the car onto the vertex of the customer position. Note: Orders which have not been transfered into the car yet, will not be delivered, even if you arrive at the customer position.







Constraints: Throughout the contest, we assume each order has a unique \text{ID} and should be delivered to the corresponding customer. It is further assumed that an unlimited number of orders can be placed in the car.





Scoring

 During the contest the total score of a submission is determined by summing the score of the submission with respect to 30 input cases.
 After the contest a system test will be performed. To this end, the contestant's last submission will be scored by summing the score of the submission on 100 previously unseen input cases.
 For each input case, the score is calculated as follows:

 \text{Score} =
    \sum_{i \in D} {(T_{\text{max}})}^{2} - {(\mathrm{waitingTime}_i)}^{2}, 

Here we use the following definitions:

  D  : the set of orders delivered until t=T_{\text{max}}
 the waiting time of the ith order: \mathrm{waitingTime}_i = \mathrm{deliveredTime}_i - \mathrm{orderedTime}_i.
Note that an input case giving the output WA will receive 0 points.






Particulars of Problem B:

Problem B is an  interactive  contest, where the contestant code successively receives updates on newly generated and delivered orders from a host code, while simultaneously servicing the customer by moving the car to a neighboring position in every step t=0,...,T_{\max}-1. The precise flow which details the interaction of the contestant and host code is shown below.





Contestant Code
Host Code






Generate and output graph G


+

Time t: Generate and output new orders


+

Time t: If on shop, output orders loaded into car


+
Time t: Determine and output a move



+

Check feasibility of move; If move unfeasible: output NG, If feasible: output OK


+

Time t+1: update and output information on delivered items (if any)



Note: The host code outputs the graph only once. The processes marked by a ""+"" on the left side of the table are repeated iteratively for integers t in  t = 0,..., T_{\max} - 1.





Input/Output Format for the Standard IO
At first, the host code will output a graph G, the order frequencies f_{i} for each vertex i, which are proportional to the probability of an order to appear at vertex i, and the total number of steps T_{\max}.
|V| |E|
u_1 v_1 d_{u_1, v_1}
u_2 v_2 d_{u_2, v_2}
\vdots
u_{|E|} v_{|E|} d_{u_{|E|}, v_{|E|}}
f_1 f_2 \ldots f_{|V|}
T_{\max}


First line: |V| number of vertices, |E| number of edges
The next |E| lines: The edges of the graph. In particular, the ith line denotes the vertices u_i and v_i which form an edge, along with the corresponding edge weight d_{u_i, v_i}.
The next line: The order frequencies f_i which determine the probability of an order at vertex i as p_{i}=\frac{f_{i}}{\sum_{i}f_{i}}.
The last line: The total number of car updates T_{\max}.

At time t we first obtain the following information through the standard input.
N_{\text{new}}
\mathrm{new\_id}_1 \mathrm{dst}_1
\mathrm{new\_id}_2 \mathrm{dst}_2
\vdots
\mathrm{new\_id}_{N_{\text{new}}} \mathrm{dst}_{N_{\text{new}}}
N_{\text{put}}
\mathrm{put\_id}_1
\mathrm{put\_id}_2
\mathrm{put\_id}_{N_{\text{put}}}


N_{\text{new}} represents the number of new orders which appeared at time t.
The next N_{\text{new}} lines give the newly generated order information. The ith order information indicates that the order ID \mathrm{new_{id}}_i of the new order, while \mathrm{dst}_i denotes the vertex to which the customer wishes the order to be delivered.
N_{\text{put}} represents the number of items transfered into the car at time t.
If the car is not at the vertex of the store N_{\text{put}} will be zero.


The subsequent N_{\text{put}} lines indicate the order information for the newly loaded items. In particular, the ith line indicates that the order ID corresponding to the product loaded in the car is \mathrm{put_{id}}_i.

Next, in order to move the delivery car to a neighboring position the contestant code must at every time t (0 \leq t \lt T_{\max}) output the following \mathrm{command} to the standard output.
\mathrm{command}

Here, \mathrm{command} must be of the following form

If you want the car to stay at its current position, send -1 to the standard output
If you want the car to move one step towards a neigboring vertex move w, send w to the standard output

Note: In case you choose move w, w must meet all of the following conditions. If any of the following conditions is violated, the host code will output NG and the contestant should terminate the program, ultimately leading to WA (incorrect).

w is a vertex index with w \in \left\{1, ... , |V|\right\}
If the car is on a vertex u, the edge \left\{ u, w \right\} \in E must exist
If the car is on an edge \left\{ u, v \right\}, w must either be w = u or w = v

After your action at time  t  is send to the standard output, the host code will send the following information about time  t + 1  to the standard input.
\mathrm{verdict}
N_{\text{achieve}}
\mathrm{achieve\_id}_1
\mathrm{achieve\_id}_2
\vdots
\mathrm{achieve\_id}_{N_{\text{achieve}}}


\mathrm{verdict} is a string indicating whether your action at time  t  was valid. It can be one of the two following options.
OK: Indicating that your action was feasible
NG: Indicates that your action is infeasible. If you receive this input, you must terminate the program immediately. It is guaranteed to be WA (incorrect), if it is terminated immediately.If you do not terminate immediately the behavior is undefined.


N_{\text{achieve}} represents the number of orders that have been delivered at  time t.
If the car is not at a delivery vertex, no orders have been delivered and N_{\text{achieve}}=0.


The subsequent N_{\text{achieve}} lines indicate the delivered orders. In particular, the ith line indicates the order ID \mathrm{achieve\_{id}}_i.

Finally, after receiving the standard input of the host code after the last step T_{\max} you must terminate the program immediately.




Constraints
I/O Constraints

 All numbers given through the standard input are integers. 
 All outputs must be integers 
 T_{\text{max}} = 10000 
 200 \leq |V| \leq 400 
 1.5 |V| \leq |E| \leq 2|V|
1 \leq u_{i}, v_{i} \leq |V| (1 \leq i \leq |E|)
1 \leq d_{u_i, v_i} \leq \lceil 4\sqrt{2|V|} \rceil (1 \leq i \leq |E|)
The given graph has no self-loops, no multiple edges and is guaranteed to be connected.
 f_1 = 0 
 f_i \in \left\{ 1, 2 \right\} (2 \leq i \leq |V|) 
 \mathrm{verdict} \in \left\{ \text{""OK""}, \text{""NG""} \right\} 
0 \leq N_{\text{new}} \leq 1
1 \leq \mathrm{new\_id}_{i} \leq T_{\text{last}}+1 (1 \leq i \leq N_{\text{new}}). Note: If all orders are generated by the order generation rule as explained above, the total number of orders is at most T_{\text{last}}+1. Therefore, the possible range of \mathrm{new\_id}_{i} should be from 1 to T_{\text{last}}+1.
The order IDs \mathrm{new\_{id}}_i are unique. 
2 \leq \mathrm{dst}_i \leq |V| (1 \leq i \leq N_{\text{new}})
 The integer which the contestant outputs to the standard output at time t must either be -1 or 1 \leq w \leq |V| 






Input/Output Example



Time
Contestant
Host Code
Explanation






5 7
1 2 5
5 3 4
2 4 8
1 5 1
2 3 3
4 5 3
4 3 9
0 1 1 5 5
500


 At first, the host code provides the graph data through the standard input. In this example, the graph has |V| = 5 vertices and | E | = 7 edges. Next, the order frequency for each vertex is given in one line. Finally, T_{\max} is given.



0 \rightarrow 1



1
1 5
1
1


 At time t=0 we get one order. This order has ID= 1 and should be delivered to vertex  5. Because your car is currently at vertex one, the order will be automatically transfered into your car. In this way, when your car is at the shop, all orders which have been made at present and before, will automatically be loaded into your car.




2



You decided to move one step towards vertex.





OK
0


The first line indicates that your move was feasible. The second line shows that no orders have been delivered.


1 \rightarrow 2



1
2 2
0


 One new order (ID =2, delivery vertex  =2) has occured. Your car is on the edge between vertex 1 and 2, so zero orders have been transfered to your car.




-1



You decided to keep your car in the same position.





OK
0


 Your move was valid. No orders will be delivered, because you are not at a delivery item position.


2 \rightarrow 3



1
3 4
0


A new order (ID =3, delivery vertex =4) has appeared. 




1



You decided to move back one step towards vertex 1. In this way you are allowed to perform a U-turn.





OK
0


No orders have been delivered.


3 \rightarrow 4



0
2
2
3


Since the car has returned to the store, products corresponding to order ID 2 and 3 are loaded onto the car.




5



The contestant has decided to move one step towards vertex 5.





OK
1
1


Since you arrived at vertex 5, the order with ID 1 was delivered.


4 \rightarrow 5



0
0


There is no new order. 




5



The contestant decides to move one step towards vertex 5.





NG


The input was invalid and you should terminate your program. 






Using the Standard Output
When returning your move instruction to the standard output, please use the flush command. As an example, consider the case where you want to output -1. This is how to do it in some of the major programming languages.
C++

std::cout << ""-1"" << std::endl;

Java

System.out.println(""-1"");

Python 3.4

print(""-1"", flush=True)





Sample Code B
A software toolkit for generation of input samples, scoring and testing on a local contestant environment, and  sample codes for beginners
is provided through the following link. In addition we provide software for visualizing the contestants results.

",Problem B,"Floyd-warshall, Graph Theory, Greedy Algorithm, Mathematics, Data Structures, Simulation, Mathematics",0.0,4,2
1213,"
Score : 1000 points


Problem StatementThere is a stack of N cards, each of which has a non-negative integer written on it. The integer written on the i-th card from the top is A_i.
Snuke will repeat the following operation until two cards remain:

Choose three consecutive cards from the stack.
Eat the middle card of the three.
For each of the other two cards, replace the integer written on it by the sum of that integer and the integer written on the card eaten.
Return the two cards to the original position in the stack, without swapping them.

Find the minimum possible sum of the integers written on the last two cards remaining.




Constraints
2 \leq N \leq 18
0 \leq A_i \leq 10^9 (1\leq i\leq N)
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
A_1 A_2 ... A_N





OutputPrint the minimum possible sum of the integers written on the last two cards remaining.






Sample Input 14
3 1 4 2





Sample Output 116

We can minimize the sum of the integers written on the last two cards remaining by doing as follows:

Initially, the integers written on the cards are 3, 1, 4, and 2 from top to bottom.
Choose the first, second, and third card from the top. Eat the second card with 1 written on it, add 1 to each of the other two cards, and return them to the original position in the stack. The integers written on the cards are now 4, 5, and 2 from top to bottom.
Choose the first, second, and third card from the top. Eat the second card with 5 written on it, add 5 to each of the other two cards, and return them to the original position in the stack. The integers written on the cards are now 9 and 7 from top to bottom.
The sum of the integers written on the last two cards remaining is 16.






Sample Input 26
5 2 4 1 6 9





Sample Output 251






Sample Input 310
3 1 4 1 5 9 2 6 5 3





Sample Output 3115


",Add and Remove,"Dyanmic Programming, Memoization, Divide And Conquer, Recursion",0.455,16,6
1214,"
Score : 600 points


Problem StatementYou are given N integers. The i-th integer is a_i.
Find the number, modulo 998244353, of ways to paint each of the integers red, green or blue so that the following condition is satisfied:

Let R, G and B be the sums of the integers painted red, green and blue, respectively. There exists a triangle with positive area whose sides have lengths R, G and B.





Constraints
3 \leq N \leq 300
1 \leq a_i \leq 300(1\leq i\leq N)
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
a_1
:
a_N





OutputPrint the number, modulo 998244353, of ways to paint each of the integers red, green or blue so that the condition is satisfied.






Sample Input 14
1
1
1
2





Sample Output 118

We can only paint the integers so that the lengths of the sides of the triangle will be 1, 2 and 2, and there are 18 such ways.





Sample Input 26
1
3
2
3
5
2





Sample Output 2150






Sample Input 320
3
1
4
1
5
9
2
6
5
3
5
8
9
7
9
3
2
3
8
4





Sample Output 3563038556


",Three Colors,"Dyanmic Programming, Arithmetic, Combinatorics, Inclusion And Exclusion",0.5,7,3
1215,"
Score : 1100 points


Problem StatementThere is a tree with N vertices, numbered 1 through N.
The i-th edge in this tree connects Vertices A_i and B_i and has a length of C_i.
Joisino created a complete graph with N vertices.
The length of the edge connecting Vertices u and v in this graph, is equal to the shortest distance between Vertices u and v in the tree above.
Joisino would like to know the length of the longest Hamiltonian path (see Notes) in this complete graph.
Find the length of that path.




NotesA Hamiltonian path in a graph is a path in the graph that visits each vertex exactly once.




Constraints
2 \leq N \leq 10^5
1 \leq A_i < B_i \leq N
The given graph is a tree.
1 \leq C_i \leq 10^8
All input values are integers.







InputInput is given from Standard Input in the following format:
N
A_1 B_1 C_1
A_2 B_2 C_2
:
A_{N-1} B_{N-1} C_{N-1}





OutputPrint the length of the longest Hamiltonian path in the complete graph created by Joisino.






Sample Input 15
1 2 5
3 4 7
2 3 3
2 5 2





Sample Output 138

The length of the Hamiltonian path 5 → 3 → 1 → 4 → 2 is 5+8+15+10=38. Since there is no Hamiltonian path with length 39 or greater in the graph, the answer is 38.





Sample Input 28
2 8 8
1 5 1
4 8 2
2 5 4
3 8 6
6 8 9
2 7 12





Sample Output 2132


",Tree and Hamilton Path,"Depth-first Search, Tree, Graph Theory, Arithmetic, Diameter Of A Tree",1.0,5,4
1216,"
Score: 600 points


Problem Statement
There is a grass field that stretches infinitely.
In this field, there is a negligibly small cow. Let (x, y) denote the point that is x\ \mathrm{cm} south and y\ \mathrm{cm} east of the point where the cow stands now. The cow itself is standing at (0, 0).
There are also N north-south lines and M east-west lines drawn on the field. The i-th north-south line is the segment connecting the points (A_i, C_i) and (B_i, C_i), and the j-th east-west line is the segment connecting the points (D_j, E_j) and (D_j, F_j).
What is the area of the region the cow can reach when it can move around as long as it does not cross the segments (including the endpoints)? If this area is infinite, print INF instead.




Constraints

All values in input are integers between -10^9 and 10^9  (inclusive).
1 \leq N, M \leq 1000
A_i < B_i\ (1 \leq i \leq N)
E_j < F_j\ (1 \leq j \leq M)
The point (0, 0) does not lie on any of the given segments.







Input
Input is given from Standard Input in the following format:
N M
A_1 B_1 C_1
:
A_N B_N C_N
D_1 E_1 F_1
:
D_M E_M F_M





Output
If the area of the region the cow can reach is infinite, print INF; otherwise, print an integer representing the area in \mathrm{cm^2}.
(Under the constraints, it can be proved that the area of the region is always an integer if it is not infinite.)






Sample Input 15 6
1 2 0
0 1 1
0 2 2
-3 4 -1
-2 6 3
1 0 1
0 1 2
2 0 2
-1 -4 5
3 -2 4
1 2 4





Sample Output 113

The area of the region the cow can reach is 13\ \mathrm{cm^2}.






Sample Input 26 1
-3 -1 -2
-3 -1 1
-2 -1 2
1 4 -2
1 4 -1
1 4 1
3 1 4





Sample Output 2INF

The area of the region the cow can reach is infinite.

",. (Single Dot),"Value / Coordinate Compression, Grid Graph, Graph Traversal, Geometry; 3d",0.167,22,9
1217,"
Score : 700 points


Problem StatementSnuke's mother gave Snuke an undirected graph consisting of N vertices numbered 0 to N-1 and M edges.
This graph was connected and contained no parallel edges or self-loops.
One day, Snuke broke this graph.
Fortunately, he remembered Q clues about the graph.
The i-th clue (0 \leq i \leq Q-1) is represented as integers A_i,B_i,C_i and means the following:

If C_i=0: there was exactly one simple path (a path that never visits the same vertex twice) from Vertex A_i to B_i.
If C_i=1: there were two or more simple paths from Vertex A_i to B_i.

Snuke is not sure if his memory is correct, and worried whether there is a graph that matches these Q clues.
Determine if there exists a graph that matches Snuke's memory.




Constraints
2 \leq N \leq 10^5
N-1 \leq M \leq N \times (N-1)/2
1 \leq Q \leq 10^5
0 \leq A_i,B_i \leq N-1
A_i \neq B_i
0 \leq C_i \leq 1
All values in input are integers.







InputInput is given from Standard Input in the following format:
N M Q
A_0 B_0 C_0
A_1 B_1 C_1
\vdots
A_{Q-1} B_{Q-1} C_{Q-1}





OutputIf there exists a graph that matches Snuke's memory, print Yes; otherwise, print No.






Sample Input 15 5 3
0 1 0
1 2 1
2 3 0





Sample Output 1Yes

For example, consider a graph with edges (0,1),(1,2),(1,4),(2,3),(2,4). This graph matches the clues.





Sample Input 24 4 3
0 1 0
1 2 1
2 3 0





Sample Output 2No






Sample Input 310 9 9
7 6 0
4 5 1
9 7 0
2 9 0
2 3 0
4 1 0
8 0 0
9 1 0
3 0 0





Sample Output 3No


",Unique Path,"Graph Theory, Disjoint Set, Sorting, Game Theory, Mathematics",0.0,17,2
1218,"
Score : 900 points


Problem StatementWe have a connected undirected graph with N vertices and M edges.
Edge i in this graph (1 \leq i \leq M) connects Vertex U_i and Vertex V_i bidirectionally.
We are additionally given N integers D_1, D_2, ..., D_N.
Determine whether the conditions below can be satisfied by assigning a color - white or black - to each vertex and an integer weight between 1 and 10^9 (inclusive) to each edge in this graph.
If the answer is yes, find one such assignment of colors and integers, too.

There is at least one vertex assigned white and at least one vertex assigned black.
For each vertex v (1 \leq v \leq N), the following holds.
The minimum cost to travel from Vertex v to a vertex whose color assigned is different from that of Vertex v by traversing the edges is equal to D_v.



Here, the cost of traversing the edges is the sum of the weights of the edges traversed.




Constraints
2 \leq N \leq 100,000
1 \leq M \leq 200,000
1 \leq D_i \leq 10^9
1 \leq U_i, V_i \leq N
The given graph is connected and has no self-loops or multiple edges.
All values in input are integers.







InputInput is given from Standard Input in the following format:
N M
D_1 D_2 ... D_N
U_1 V_1
U_2 V_2
\vdots
U_M V_M





OutputIf there is no assignment satisfying the conditions, print a single line containing -1.
If such an assignment exists, print one such assignment in the following format:
S
C_1
C_2
\vdots
C_M

Here,

the first line should contain the string S of length N. Its i-th character (1 \leq i \leq N) should be W if Vertex i is assigned white and B if it is assigned black.
The (i + 1)-th line (1 \leq i \leq M) should contain the integer weight C_i assigned to Edge i.







Sample Input 15 5
3 4 3 5 7
1 2
1 3
3 2
4 2
4 5





Sample Output 1BWWBB
4
3
1
5
2

Assume that we assign the colors and integers as the sample output, and let us consider Vertex 5, for example. To travel from Vertex 5, which is assigned black, to a vertex that is assigned white with the minimum cost, we should make these moves: Vertex 5 \to Vertex 4 \to Vertex 2. The total cost of these moves is 7, which satisfies the condition. We can also verify that the condition is satisfied for other vertices.





Sample Input 25 7
1 2 3 4 5
1 2
1 3
1 4
2 3
2 5
3 5
4 5





Sample Output 2-1






Sample Input 34 6
1 1 1 1
1 2
1 3
1 4
2 3
2 4
3 4





Sample Output 3BBBW
1
1
1
2
1
1


",Bichromization,"Graph Theory, Sorting, Disjoint Set, Greedy Algorithm, Depth-first Search, Bipartite Graph, Implementation",0.0,15,3
1219,"
Score : 900 points


Problem StatementLet x be a string of length at least 1.
We will call x a good string, if for any string y and any integer k (k \geq 2), the string obtained by concatenating k copies of y is different from x.
For example, a, bbc and cdcdc are good strings, while aa, bbbb and cdcdcd are not.
Let w be a string of length at least 1.
For a sequence F=(\,f_1,\,f_2,\,...,\,f_m) consisting of m elements,
we will call F a good representation of w, if the following conditions are both satisfied:

For any i \, (1 \leq i \leq m), f_i is a good string.
The string obtained by concatenating f_1,\,f_2,\,...,\,f_m in this order, is w.

For example, when w=aabb, there are five good representations of w:

(aabb)
(a,abb)
(aab,b)
(a,ab,b)
(a,a,b,b)

Among the good representations of w, the ones with the smallest number of elements are called the best representations of w.
For example, there are only one best representation of w=aabb: (aabb).
You are given a string w. Find the following:

the number of elements of a best representation of w
the number of the best representations of w, modulo 1000000007 \, (=10^9+7)

(It is guaranteed that a good representation of w always exists.)




Constraints
1 \leq |w| \leq 500000 \, (=5 \times 10^5)
w consists of lowercase letters (a-z).





Partial Score
400 points will be awarded for passing the test set satisfying 1 \leq |w| \leq 4000.







InputThe input is given from Standard Input in the following format:
w





OutputPrint 2 lines.

In the first line, print the number of elements of a best representation of w.
In the second line, print the number of the best representations of w, modulo 1000000007.







Sample Input 1aab





Sample Output 11
1






Sample Input 2bcbc





Sample Output 22
3


In this case, there are 3 best representations of 2 elements:
(b,cbc)
(bc,bc)
(bcb,c)








Sample Input 3ddd





Sample Output 33
1


",Best Representation,"String, Dyanmic Programming, Number Theory, Arithmetic",0.0,14,3
1220,"
Score : 900 points


Problem StatementFor a positive integer n, let us define f(n) as the number of digits in base 10.
You are given an integer S.
Count the number of the pairs of positive integers (l, r) (l \leq r) such that f(l) + f(l + 1) + ... + f(r) = S, and find the count modulo 10^9 + 7.




Constraints
1 \leq S \leq 10^8







InputInput is given from Standard Input in the following format:
S





OutputPrint the answer.






Sample Input 11





Sample Output 19

There are nine pairs (l, r) that satisfies the condition: (1, 1), (2, 2), ..., (9, 9).





Sample Input 22





Sample Output 298

There are 98 pairs (l, r) that satisfies the condition, such as (1, 2) and (33, 33).





Sample Input 3123





Sample Output 3460191684






Sample Input 436018





Sample Output 4966522825






Sample Input 51000





Sample Output 5184984484


",Number of Digits,Number Theory,1.0,1,1
1221,"
Score : 900 points


Problem StatementAtCoDeer the deer wants a directed graph that satisfies the following conditions:

The number of vertices, N, is at most 300.
There must not be self-loops or multiple edges.
The vertices are numbered from 1 through N.
Each edge has either an integer weight between 0 and 100 (inclusive), or a label X or Y.
For every pair of two integers (x,y) such that 1 ≤ x ≤ A, 1 ≤ y ≤ B,
    the shortest distance from Vertex S to Vertex T in the graph where the edges labeled X have the weight x and the edges labeled Y have the weight y, is d_{x,y}.

Construct such a graph (and a pair of S and T) for him, or report that it does not exist.
Refer to Output section for output format.




Constraints
1 ≤ A,B ≤ 10
1 ≤ d_{x,y} ≤ 100 (1 ≤ x ≤ A, 1 ≤ y ≤ B)
All input values are integers.







InputInput is given from Standard Input in the following format:
A B
d_{1,1} d_{1,2} .. d_{1,B}
d_{2,1} d_{2,2} .. d_{2,B}
:
d_{A,1} d_{A,2} .. d_{A,B}





OutputIf no graph satisfies the condition, print Impossible.
If there exists a graph that satisfies the condition, print Possible in the first line.
Then, in the subsequent lines, print the constructed graph in the following format:
N M
u_1 v_1 c_1
u_2 v_2 c_2
:
u_M v_M c_M
S T

Here, M is the number of the edges, and u_i, v_i, c_i represent edges as follows: there is an edge from Vertex u_i to Vertex v_i whose weight or label is c_i.
Also refer to Sample Outputs.






Sample Input 12 3
1 2 2
1 2 3





Sample Output 1Possible
3 4
1 2 X
2 3 1
3 2 Y
1 3 Y
1 3






Sample Input 21 3
100 50 1





Sample Output 2Impossible


",GraphXY,"Mathematics, Geometry; 3d, Set / Map, Convex Hull Trick, Graph Theory, Shortest Path, Matrix",0.0,12,2
1222,"
Score : 900 points


Problem StatementThere is a string S of length N consisting of characters 0 and 1. You will perform the following operation for each i = 1, 2, ..., m:

Arbitrarily permute the characters within the substring of S starting at the l_i-th character from the left and extending through the r_i-th character.

Here, the sequence l_i is non-decreasing.
How many values are possible for S after the M operations, modulo 1000000007(= 10^9+7)?




Constraints
2≦N≦3000
1≦M≦3000
S consists of characters 0 and 1.
The length of S equals N.
1≦l_i < r_i≦N
l_i ≦ l_{i+1}







InputThe input is given from Standard Input in the following format:
N M
S
l_1 r_1
:
l_M r_M





OutputPrint the number of the possible values for S after the M operations, modulo 1000000007.






Sample Input 15 2
01001
2 4
3 5





Sample Output 16

After the first operation, S can be one of the following three: 01001, 00101 and 00011.
After the second operation, S can be one of the following six: 01100, 01010, 01001, 00011, 00101 and 00110.





Sample Input 29 3
110111110
1 4
4 6
6 9





Sample Output 226






Sample Input 311 6
00101000110
2 4
2 3
4 7
5 6
6 10
10 11





Sample Output 3143


",Shuffling,"Array, Prefix sum, Dyanmic Programming, Combinatorics, Arithmetic",0.667,8,5
1223,"
Score : 1600 points


Problem StatementThere is a tree with N vertices, numbered 1 through N.
The i-th of the N-1 edges connects vertices a_i and b_i.
Currently, there are A_i stones placed on vertex i.
Takahashi and Aoki will play a game using this tree.
First, Takahashi will select a vertex and place a piece on it.
Then, starting from Takahashi, they will alternately perform the following operation:

Remove one stone from the vertex currently occupied by the piece.
Then, move the piece to a vertex that is adjacent to the currently occupied vertex.

The player who is left with no stone on the vertex occupied by the piece and thus cannot perform the operation, loses the game.
Find all the vertices v such that Takahashi can place the piece on v at the beginning and win the game.




Constraints
2 ≦ N ≦ 3000
1 ≦ a_i,b_i ≦ N
0 ≦ A_i ≦ 10^9
The given graph is a tree.







InputThe input is given from Standard Input in the following format:
N
A_1 A_2 … A_N
a_1 b_1
:
a_{N-1} b_{N-1}





OutputPrint the indices of the vertices v such that Takahashi can place the piece on v at the beginning and win the game, in a line, in ascending order.






Sample Input 13
1 2 3
1 2
2 3





Sample Output 12

The following is one possible progress of the game when Takahashi places the piece on vertex 2:

Takahashi moves the piece to vertex 1. The number of the stones on each vertex is now: (1,1,3).
Aoki moves the piece to vertex 2. The number of the stones on each vertex is now: (0,1,3).
Takahashi moves the piece to vertex 1. The number of the stones on each vertex is now: (0,0,3).
Aoki cannot take a stone from the vertex, and thus Takahashi wins.






Sample Input 25
5 4 1 2 3
1 2
1 3
2 4
2 5





Sample Output 21 2






Sample Input 33
1 1 1
1 2
2 3





Sample Output 3

Note that the correct output may be an empty line.

",Tree Game,"Graph Theory, Depth-first Search, Game Theory, Recursion, Tree, Graph Traversal, Sorting",0.5,4,2
1224,"
Score : 1000 points


Problem StatementThere are N towns in Takahashi Kingdom. They are conveniently numbered 1 through N.
Takahashi the king is planning to go on a tour of inspection for M days. He will determine a sequence of towns c, and visit town c_i on the i-th day. That is, on the i-th day, he will travel from his current location to town c_i. If he is already at town c_i, he will stay at that town. His location just before the beginning of the tour is town 1, the capital. The tour ends at town c_M, without getting back to the capital. 
The problem is that there is no paved road in this kingdom. He decided to resolve this issue by paving the road himself while traveling. When he travels from town a to town b, there will be a newly paved one-way road from town a to town b.
Since he cares for his people, he wants the following condition to be satisfied after his tour is over: ""it is possible to travel from any town to any other town by traversing roads paved by him"". How many sequences of towns c satisfy this condition?




Constraints
2≦N≦300
1≦M≦300







InputThe input is given from Standard Input in the following format:
N M





OutputPrint the number of sequences of towns satisfying the condition, modulo 1000000007 (=10^9+7).






Sample Input 13 3





Sample Output 12

As shown below, the condition is satisfied only when c = (2,3,1) or c = (3,2,1). Sequences such as c = (2,3,2), c = (2,1,3), c = (1,2,2) do not satisfy the condition.






Sample Input 2150 300





Sample Output 2734286322






Sample Input 3300 150





Sample Output 30


",Road of the King,"Dyanmic Programming, Arithmetic, Strongly Connected Component, Combinatorics, Mathematics",1.0,3,3
1225,"
Score : 100 points


Problem StatementThere is a grid with H rows and W columns.
The square at the i-th row and j-th column contains a string S_{i,j} of length 5.
The rows are labeled with the numbers from 1 through H, and the columns are labeled with the uppercase English letters from A through the W-th letter of the alphabet.

Exactly one of the squares in the grid contains the string snuke. Find this square and report its location.
For example, the square at the 6-th row and 8-th column should be reported as H6.




Constraints
1≦H, W≦26
The length of S_{i,j} is 5.
S_{i,j} consists of lowercase English letters (a-z).
Exactly one of the given strings is equal to snuke.







InputThe input is given from Standard Input in the following format:
H W
S_{1,1} S_{1,2} ... S_{1,W}
S_{2,1} S_{2,2} ... S_{2,W}
:
S_{H,1} S_{H,2} ... S_{H,W}





OutputPrint the labels of the row and the column of the square containing the string snuke, with no space inbetween.






Sample Input 115 10
snake snake snake snake snake snake snake snake snake snake
snake snake snake snake snake snake snake snake snake snake
snake snake snake snake snake snake snake snake snake snake
snake snake snake snake snake snake snake snake snake snake
snake snake snake snake snake snake snake snake snake snake
snake snake snake snake snake snake snake snuke snake snake
snake snake snake snake snake snake snake snake snake snake
snake snake snake snake snake snake snake snake snake snake
snake snake snake snake snake snake snake snake snake snake
snake snake snake snake snake snake snake snake snake snake
snake snake snake snake snake snake snake snake snake snake
snake snake snake snake snake snake snake snake snake snake
snake snake snake snake snake snake snake snake snake snake
snake snake snake snake snake snake snake snake snake snake
snake snake snake snake snake snake snake snake snake snake





Sample Output 1H6






Sample Input 21 1
snuke





Sample Output 2A1


",Where's Snuke?,"Bruteforcing, String, Arithmetic",0.769,19,14
1226,"
Score : 700 points


Problem StatementSnuke is buying a lamp.
The light of the lamp can be adjusted to m levels of brightness, represented by integers from 1 through m, by the two buttons on the remote control.
The first button is a ""forward"" button. When this button is pressed, the brightness level is increased by 1, except when the brightness level is m, in which case the brightness level becomes 1.
The second button is a ""favorite"" button. When this button is pressed, the brightness level becomes the favorite brightness level x, which is set when the lamp is purchased.
Snuke is thinking of setting the favorite brightness level x so that he can efficiently adjust the brightness.
He is planning to change the brightness n-1 times. In the i-th change, the brightness level is changed from a_i to a_{i+1}. The initial brightness level is a_1.
Find the number of times Snuke needs to press the buttons when x is set to minimize this number.




Constraints
2 \leq n,m \leq 10^5
1 \leq a_i\leq m
a_i \neq a_{i+1}
n, m and a_i are integers.







InputInput is given from Standard Input in the following format:
n m
a_1 a_2 … a_n





OutputPrint the minimum number of times Snuke needs to press the buttons.






Sample Input 14 6
1 5 1 4





Sample Output 15

When the favorite brightness level is set to 1, 2, 3, 4, 5 and 6, Snuke needs to press the buttons 8, 9, 7, 5, 6 and 9 times, respectively.
Thus, Snuke should set the favorite brightness level to 4.
In this case, the brightness is adjusted as follows:

In the first change, press the favorite button once, then press the forward button once.
In the second change, press the forward button twice.
In the third change, press the favorite button once.






Sample Input 210 10
10 9 8 7 6 5 4 3 2 1





Sample Output 245


",guruguru,"Arithmetic, Prefix sum, Binary Indexed Tree, Segment Tree With Lazy Propagation, Mathematics, Precomputation",0.333,24,7
1227,"
Score : 900 points


Problem StatementTakahashi has a lot of peculiar devices.
These cylindrical devices receive balls from left and right.
Each device is in one of the two states A and B, and for each state, the device operates as follows:

When a device in state A receives a ball from either side (left or right), the device throws out the ball from the same side, then immediately goes into state B.
When a device in state B receives a ball from either side, the device throws out the ball from the other side, then immediately goes into state A.

The transition of the state of a device happens momentarily and always completes before it receives another ball.
Takahashi built a contraption by concatenating N of these devices. In this contraption,

A ball that was thrown out from the right side of the i-th device from the left (1 \leq i \leq N-1) immediately enters the (i+1)-th device from the left side.
A ball that was thrown out from the left side of the i-th device from the left (2 \leq i \leq N) immediately enters the (i-1)-th device from the right side.

The initial state of the i-th device from the left is represented by the i-th character in a string S.
From this situation, Takahashi performed the following K times: put a ball into the leftmost device from the left side, then wait until the ball comes out of the contraption from either end.
Here, it can be proved that the ball always comes out of the contraption after a finite time.
Find the state of each device after K balls are processed.




Constraints
1 \leq N \leq 200,000
1 \leq K \leq 10^9
|S|=N
Each character in S is either A or B.







InputThe input is given from Standard Input in the following format:
N K
S





OutputPrint a string that represents the state of each device after K balls are processed.
The string must be N characters long, and the i-th character must correspond to the state of the i-th device from the left.






Sample Input 15 1
ABAAA





Sample Output 1BBAAA

In this input, we put a ball into the leftmost device from the left side, then it is returned from the same place.





Sample Input 25 2
ABAAA





Sample Output 2ABBBA






Sample Input 34 123456789
AABB





Sample Output 3BABA


",Half Reflector,"Simulation, Arithmetic, Machine Learning, Mathematics, Boolean Operations On Geometric Objects, Greedy Algorithm",0.333,25,6
1228,"
Score : 800 points


Problem StatementTakahashi has received an undirected graph with N vertices, numbered 1, 2, ..., N.
The edges in this graph are represented by (u_i, v_i).
There are no self-loops and multiple edges in this graph.
Based on this graph, Takahashi is now constructing a new graph with N^2 vertices, where each vertex is labeled with a pair of integers (a, b) (1 \leq a \leq N, 1 \leq b \leq N).
The edges in this new graph are generated by the following rule:

Span an edge between vertices (a, b) and (a', b') if and only if both of the following two edges exist in the original graph: an edge between vertices a and a', and an edge between vertices b and b'.

How many connected components are there in this new graph?




Constraints
2 \leq N \leq 100,000
0 \leq M \leq 200,000
1 \leq u_i < v_i \leq N
There exists no pair of distinct integers i and j such that u_i = u_j and v_i = v_j.







InputThe input is given from Standard Input in the following format:
N M
u_1 v_1
u_2 v_2
:
u_M v_M





OutputPrint the number of the connected components in the graph constructed by Takahashi.






Sample Input 13 1
1 2





Sample Output 17

The graph constructed by Takahashi is as follows.






Sample Input 27 5
1 2
3 4
3 5
4 5
2 6





Sample Output 218


",Squared Graph,"Graph Theory, Depth-first Search, Bipartite Graph, Combinatorics",0.286,14,5
1229,"
Score : 1000 points


Problem StatementRng is baking cookies.
Initially, he can bake one cookie per second.
He can also eat the cookies baked by himself.
When there are x cookies not yet eaten, he can choose to eat all those cookies. After he finishes eating those cookies, the number of cookies he can bake per second becomes x. Note that a cookie always needs to be baked for 1 second, that is, he cannot bake a cookie in 1/x seconds when x > 1.
When he choose to eat the cookies, he must eat all of them; he cannot choose to eat only part of them.
It takes him A seconds to eat the cookies regardless of how many, during which no cookies can be baked.
He wants to give N cookies to Grandma.
Find the shortest time needed to produce at least N cookies not yet eaten.




Constraints
1≦N≦10^{12}
0≦A≦10^{12}
A is an integer.





Partial Score
500 points will be awarded for passing the test set satisfying N≦10^6 and A≦10^6.
Additional 500 points will be awarded for passing the test set without additional constraints.







InputThe input is given from Standard Input in the following format:
N A





OutputPrint the shortest time needed to produce at least N cookies not yet eaten.






Sample Input 18 1





Sample Output 17

It is possible to produce 8 cookies in 7 seconds, as follows:

After 1 second: 1 cookie is done.
After 2 seconds: 1 more cookie is done, totaling 2. Now, Rng starts eating those 2 cookies.
After 3 seconds: He finishes eating the cookies, and he can now bake 2 cookies per second.
After 4 seconds: 2 cookies are done.
After 5 seconds: 2 more cookies are done, totaling 4.
After 6 seconds: 2 more cookies are done, totaling 6.
After 7 seconds: 2 more cookies are done, totaling 8.






Sample Input 21000000000000 1000000000000





Sample Output 21000000000000


",Cookies,"Mathematics, Exponentiation By Squaring, Bruteforcing",0.333,8,1
1230,"
Score : 1200 points


Problem StatementOne day Mr. Takahashi picked up a dictionary containing all of the N! permutations of integers 1 through N.
The dictionary has N! pages, and page i (1 ≤ i ≤ N!) contains the i-th permutation in the lexicographical order.
Mr. Takahashi wanted to look up a certain permutation of length N in this dictionary, but he forgot some part of it.
His memory of the permutation is described by a sequence P_1, P_2, ..., P_N.
If P_i = 0, it means that he forgot the i-th element of the permutation; otherwise, it means that he remembered the i-th element of the permutation and it is P_i.
He decided to look up all the possible permutations in the dictionary.
Compute the sum of the page numbers of the pages he has to check, modulo 10^9 + 7.




Constraints
1 ≤ N ≤ 500000
0 ≤ P_i ≤ N
P_i ≠ P_j if i ≠ j (1 ≤ i, j ≤ N), P_i ≠ 0 and P_j ≠ 0.





Partial Score
In test cases worth 500 points, 1 ≤ N ≤ 3000.







InputThe input is given from Standard Input in the following format:
N
P_1 P_2 ... P_N





OutputPrint the sum of the page numbers of the pages he has to check, as modulo 10^9 + 7.






Sample Input 14
0 2 3 0





Sample Output 123

The possible permutations are [1, 2, 3, 4] and [4, 2, 3, 1].
Since the former is on page 1 and the latter is on page 22, the answer is 23.





Sample Input 23
0 0 0





Sample Output 221

Since all permutations of length 3 are possible, the answer is 1 + 2 + 3 + 4 + 5 + 6 = 21.





Sample Input 35
1 2 3 5 4





Sample Output 32

Mr. Takahashi remembered all the elements of the permutation.





Sample Input 41
0





Sample Output 41

The dictionary consists of one page.





Sample Input 510
0 3 0 0 1 0 4 0 0 0





Sample Output 5953330050


",Encyclopedia of Permutations,"Precomputation, Binary Indexed Tree, Binary Search, Combinatorics, Prefix sum, Arithmetic, Set / Map, Tree",0.0,17,1
1231,"
Score : 600 points


Problem StatementYou are given a positive integer N.
Find the number of the pairs of integers u and v (0≦u,v≦N) such that there exist two non-negative integers a and b satisfying a xor b=u and a+b=v.
Here, xor denotes the bitwise exclusive OR.
Since it can be extremely large, compute the answer modulo 10^9+7.




Constraints
1≦N≦10^{18}







InputThe input is given from Standard Input in the following format:
N





OutputPrint the number of the possible pairs of integers u and v, modulo 10^9+7.






Sample Input 13





Sample Output 15

The five possible pairs of u and v are:


u=0,v=0 (Let a=0,b=0, then 0 xor 0=0, 0+0=0.)


u=0,v=2 (Let a=1,b=1, then 1 xor 1=0, 1+1=2.）


u=1,v=1 (Let a=1,b=0, then 1 xor 0=1, 1+0=1.）


u=2,v=2 (Let a=2,b=0, then 2 xor 0=2, 2+0=2.）


u=3,v=3 (Let a=3,b=0, then 3 xor 0=3, 3+0=3.）







Sample Input 21422





Sample Output 252277






Sample Input 31000000000000000000





Sample Output 3787014179


",Xor Sum,"Bitmask, Digit Dp, Memoization, Arithmetic, Mathematics",1.0,3,3
1232,"
Score : 1000 points


Problem StatementThere are N integers written on a blackboard. The i-th integer is A_i, and the greatest common divisor of these integers is 1.
Takahashi and Aoki will play a game using these integers. In this game, starting from Takahashi the two player alternately perform the following operation:

Select one integer on the blackboard that is not less than 2, and subtract 1 from the integer.
Then, divide all the integers on the black board by g, where g is the greatest common divisor of the integers written on the blackboard.

The player who is left with only 1s on the blackboard and thus cannot perform the operation, loses the game.
Assuming that both players play optimally, determine the winner of the game.




Constraints
1 ≦ N ≦ 10^5
1 ≦ A_i ≦ 10^9
The greatest common divisor of the integers from A_1 through A_N is 1.







InputThe input is given from Standard Input in the following format:
N
A_1 A_2 … A_N





OutputIf Takahashi will win, print First. If Aoki will win, print Second.






Sample Input 13
3 6 7





Sample Output 1First

Takahashi, the first player, can win as follows:

Takahashi subtracts 1 from 7. Then, the integers become: (1,2,2).
Aoki subtracts 1 from 2. Then, the integers become: (1,1,2).
Takahashi subtracts 1 from 2. Then, the integers become: (1,1,1).






Sample Input 24
1 2 4 8





Sample Output 2First






Sample Input 35
7 8 8 8 8





Sample Output 3Second


",Decrementing,"Game Theory, Bitmask, Euclidean Algorithm, Array",0.0,1,0
1233,"
Score : 1500 points


Problem Statement
Shik's job is very boring. At day 0, his boss gives him a string S_0 of length N which consists of only lowercase English letters. In the i-th day after day 0, Shik's job is to copy the string S_{i-1} to a string S_i. We denote the j-th letter of S_i as S_i[j].
Shik is inexperienced in this job. In each day, when he is copying letters one by one from the first letter to the last letter, he would make mistakes. That is, he sometimes accidentally writes down the same letter that he wrote previously instead of the correct one. More specifically, S_i[j] is equal to either S_{i-1}[j] or S_{i}[j-1]. (Note that S_i[1] always equals to S_{i-1}[1].)
You are given the string S_0 and another string T.
Please determine the smallest integer i such that S_i could be equal to T. If no such i exists, please print -1.




Constraints
1 \leq N \leq 1,000,000
The lengths of S_0 and T are both N.
Both S_0 and T consist of lowercase English letters.







InputThe input is given from Standard Input in the following format:
N
S_0
T





OutputPrint the smallest integer i such that S_i could be equal to T. If no such i exists, print -1 instead.






Sample Input 15
abcde
aaacc





Sample Output 12

S_0 = abcde, S_1 = aaccc and S_2 = aaacc is a possible sequence such that S_2 = T.





Sample Input 25
abcde
abcde





Sample Output 20






Sample Input 34
acaa
aaca





Sample Output 32






Sample Input 45
abcde
bbbbb





Sample Output 4-1


",Shik and Copying String,"Two-pointer, Greedy Algorithm, String, Dynamic Programming, Sliding Window, Counting",0.0,3,1
1234,"
Score : 1300 points


Problem StatementYou are developing a robot that processes strings.
When the robot is given a string t consisting of lowercase English letters, it processes the string by following the procedure below:

Let i be the smallest index such that t_i = t_{i + 1}. If such an index does not exist, terminate the procedure.
If t_i is z, remove t_i and t_{i + 1} from t. Otherwise, let c be the next letter of t_i in the English alphabet, and replace t_i and t_{i + 1} together with c, reducing the length of t by 1.
Go back to step 1.

For example, when the robot is given the string axxxxza, it will be processed as follows: axxxxza → ayxxza → ayyza → azza → aa → b.
You are given a string s consisting of lowercase English letters.
Answer Q queries. The i-th query is as follows:

Assume that the robot is given a substring of s that runs from the l_i-th character and up to the r_i-th character (inclusive). Will the string be empty after processing?





Constraints
1 ≤ |s| ≤ 5 × 10^5
s consists of lowercase English letters.
1 ≤ Q ≤ 10^5
1 ≤ l_i ≤ r_i ≤ |s|







InputThe input is given from Standard Input in the following format:
s
Q
l_1 r_1
l_2 r_2
:
l_Q r_Q





OutputPrint Q lines.
The i-th line should contain the answer to the i-th query: Yes or No.






Sample Input 1axxxxza
2
1 7
2 6





Sample Output 1No
Yes


Regarding the first query, the string will be processed as follows: axxxxza → ayxxza → ayyza → azza → aa → b.
Regarding the second query, the string will be processed as follows: xxxxz → yxxz → yyz → zz → .






Sample Input 2aabcdefghijklmnopqrstuvwxyz
1
1 27





Sample Output 2Yes






Sample Input 3yzyyyzyzyyyz
8
1 6
7 12
1 12
6 11
1 1
1 3
4 9
3 8





Sample Output 3Yes
Yes
Yes
Yes
No
No
No
No


",Robot and String,"Stack, Segment Tree, String, Divide And Conquer, Mathematics",0.0,8,0
1235,"
Score : 900 points


Problem StatementThere is a tree with N vertices numbered 1 through N.
The i-th of the N-1 edges connects vertices a_i and b_i.
Initially, each vertex is uncolored.
Takahashi and Aoki is playing a game by painting the vertices. In this game, they alternately perform the following operation, starting from Takahashi:

Select a vertex that is not painted yet.
If it is Takahashi who is performing this operation, paint the vertex white; paint it black if it is Aoki.

Then, after all the vertices are colored, the following procedure takes place:

Repaint every white vertex that is adjacent to a black vertex, in black.

Note that all such white vertices are repainted simultaneously, not one at a time.
If there are still one or more white vertices remaining, Takahashi wins; if all the vertices are now black, Aoki wins.
Determine the winner of the game, assuming that both persons play optimally.




Constraints
2 ≤ N ≤ 10^5
1 ≤ a_i,b_i ≤ N
a_i ≠ b_i
The input graph is a tree.







InputInput is given from Standard Input in the following format:
N
a_1 b_1
:
a_{N-1} b_{N-1}





OutputPrint First if Takahashi wins; print Second if Aoki wins.






Sample Input 13
1 2
2 3





Sample Output 1First

Below is a possible progress of the game:

First, Takahashi paint vertex 2 white.
Then, Aoki paint vertex 1 black.
Lastly, Takahashi paint vertex 3 white.

In this case, the colors of vertices 1, 2 and 3 after the final procedure are black, black and white, resulting in Takahashi's victory.





Sample Input 24
1 2
2 3
2 4





Sample Output 2First






Sample Input 36
1 2
2 3
3 4
2 5
5 6





Sample Output 3Second


",Black and White Tree,"Graph Theory, Depth-first Search, Diameter Of A Tree, Tree, Priority Queue, Sorting, Game Theory",0.333,15,5
1236,"
Score : 500 points


Problem StatementTakahashi and Aoki will play a game. They will repeatedly play it until one of them have N wins in total.
When they play the game once, Takahashi wins with probability A %, Aoki wins with probability B %, and the game ends in a draw (that is, nobody wins) with probability C %.
Find the expected number of games that will be played, and print it as follows.
We can represent the expected value as P/Q with coprime integers P and Q.
Print the integer R between 0 and 10^9+6 (inclusive) such that R \times Q \equiv P\pmod {10^9+7}.
(Such an integer R always uniquely exists under the constraints of this problem.)




Constraints
1 \leq N \leq 100000
0 \leq A,B,C \leq 100
1 \leq A+B
A+B+C=100
All values in input are integers.







InputInput is given from Standard Input in the following format:
N A B C





OutputPrint the expected number of games that will be played, in the manner specified in the statement.






Sample Input 11 25 25 50





Sample Output 12

Since N=1, they will repeat the game until one of them wins.
The expected number of games played is 2.





Sample Input 24 50 50 0





Sample Output 2312500008

C may be 0.





Sample Input 31 100 0 0





Sample Output 31

B may also be 0.





Sample Input 4100000 31 41 28





Sample Output 4104136146


",Best-of-(2n-1),"Probability Theory, Combinatorics, Arithmetic, Modular Multiplicative Inverse, Precomputation, Exponentiation By Squaring",0.429,11,4
1237,"
Score : 600 points


Problem Statement
Snuke has a blackboard and a set S consisting of N integers.
The i-th element in S is S_i.
He wrote an integer X on the blackboard, then performed the following operation N times:

Choose one element from S and remove it.
Let x be the number written on the blackboard now, and y be the integer removed from S. Replace the number on the blackboard with x \bmod {y}.

There are N! possible orders in which the elements are removed from S.
For each of them, find the number that would be written on the blackboard after the N operations, and compute the sum of all those N! numbers modulo 10^{9}+7.




Constraints
All values in input are integers.
1 \leq N \leq 200
1 \leq S_i, X \leq 10^{5}
S_i are pairwise distinct.







InputInput is given from Standard Input in the following format:
N X
S_1 S_2 \ldots S_{N}





OutputPrint the answer.






Sample Input 12 19
3 7





Sample Output 13


There are two possible orders in which we remove the numbers from S.
If we remove 3 and 7 in this order, the number on the blackboard changes as follows: 19 \rightarrow 1 \rightarrow 1.
If we remove 7 and 3 in this order, the number on the blackboard changes as follows: 19 \rightarrow 5 \rightarrow 2.
The output should be the sum of these: 3.






Sample Input 25 82
22 11 6 5 13





Sample Output 2288






Sample Input 310 100000
50000 50001 50002 50003 50004 50005 50006 50007 50008 50009





Sample Output 3279669259


Be sure to compute the sum modulo 10^{9}+7.


",Modulo Operations,"Dyanmic Programming, Combinatorics, Arithmetic, Sorting, Memoization",0.286,17,3
1238,"
Score : 800 points


Problem StatementThe beauty of a sequence a of length n is defined as a_1 \oplus \cdots \oplus a_n, where \oplus denotes the bitwise exclusive or (XOR).
You are given a sequence A of length N.
Snuke will insert zero or more partitions in A to divide it into some number of non-empty contiguous subsequences.
There are 2^{N-1} possible ways to insert partitions.
How many of them divide A into sequences whose beauties are all equal? Find this count modulo 10^{9}+7.




Constraints
All values in input are integers.
1 \leq N \leq 5 \times 10^5
0 \leq A_i < 2^{20}







InputInput is given from Standard Input in the following format:
N
A_1 A_2 \ldots A_{N}





OutputPrint the answer.






Sample Input 13
1 2 3





Sample Output 13

Four ways of dividing A shown below satisfy the condition. The condition is not satisfied only if A is divided into (1),(2),(3).

(1,2,3)
(1),(2,3)
(1,2),(3)






Sample Input 23
1 2 2





Sample Output 21






Sample Input 332
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0





Sample Output 3147483634

Find the count modulo 10^{9}+7.





Sample Input 424
1 2 5 3 3 6 1 1 8 8 0 3 3 4 6 6 4 0 7 2 5 4 6 2





Sample Output 4292


",XOR Partitioning,"Array, Dyanmic Programming, Arithmetic, Set / Map, Bitmask, Counting, Data Structure",0.167,12,3
1239,"
Score : 1400 points


Problem StatementThere are N turkeys.
We number them from 1 through N.
M men will visit here one by one.
The i-th man to visit will take the following action:

If both turkeys x_i and y_i are alive: selects one of them with equal probability, then eats it.
If either turkey x_i or y_i is alive (but not both): eats the alive one.
If neither turkey x_i nor y_i is alive: does nothing.

Find the number of pairs (i,\ j) (1 ≤ i < j ≤ N) such that the following condition is held:

The probability of both turkeys i and j being alive after all the men took actions, is greater than 0.





Constraints
2 ≤ N ≤ 400
1 ≤ M ≤ 10^5
1 ≤ x_i < y_i ≤ N







InputInput is given from Standard Input in the following format:
N M
x_1 y_1
x_2 y_2
:
x_M y_M





OutputPrint the number of pairs (i,\ j) (1 ≤ i < j ≤ N) such that the condition is held.






Sample Input 13 1
1 2





Sample Output 12

(i,\ j) = (1,\ 3), (2,\ 3) satisfy the condition.





Sample Input 24 3
1 2
3 4
2 3





Sample Output 21

(i,\ j) = (1,\ 4) satisfies the condition.
Both turkeys 1 and 4 are alive if:

The first man eats turkey 2.
The second man eats turkey 3.
The third man does nothing.






Sample Input 33 2
1 2
1 2





Sample Output 30






Sample Input 410 10
8 9
2 8
4 6
4 9
7 8
2 8
1 8
3 4
3 4
2 7





Sample Output 45


",Poor Turkeys,"Graph Theory, Depth-first Search, Graph Traversal, 2-sat",0.5,2,1
1240,"
Score : 1600 points


Problem StatementTaichi thinks a binary string X of odd length N is beautiful if it is possible to apply the following operation \frac{N-1}{2} times so that the only character of the resulting string is 1 :

Choose three consecutive bits of X and replace them by their median. For example, we can turn 00110 into 010 by applying the operation to the middle three bits.

Taichi has a string S consisting of characters 0, 1 and ?. Taichi wants to know the number of ways to replace the question marks with 1 or 0 so that the resulting string is beautiful, modulo 10^{9} + 7.




Constraints
1 \leq |S| \leq 300000
|S| is odd.
All characters of S are either 0, 1 or ?.







InputInput is given from Standard Input in the following format:
S





OutputPrint the number of ways to replace the question marks so that the resulting string is beautiful, modulo 10^{9} + 7.






Sample Input 11??00





Sample Output 12

There are 4 ways to replace the question marks with 0 or 1 :


11100 : This string is beautiful because we can first perform the operation on the last 3 bits to get 110 and then on the only 3 bits to get 1.


11000 : This string is beautiful because we can first perform the operation on the last 3 bits to get 110 and then on the only 3 bits to get 1.


10100 : This string is not beautiful because there is no sequence of operations such that the final string is 1.


10000 :  This string is not beautiful because there is no sequence of operations such that the final string is 1.


Thus, there are 2 ways to form a beautiful string.





Sample Input 2?





Sample Output 21

In this case, 1 is the only beautiful string.





Sample Input 3?0101???10???00?1???????????????0????????????1????0





Sample Output 3402589311

Remember to output your answer modulo 10^{9} + 7.

",Median Replace,"Dyanmic Programming, Bitmask, Arithmetic, Combinatorics, Sliding Window, Data Structure, Backtracking",1.0,1,1
1241,"
Score : 1600 points


Problem StatementYou are given a string S of length 2N, containing N occurrences of a and N occurrences of b.
You will choose some of the characters in S. Here, for each i = 1,2,...,N, it is not allowed to choose exactly one of the following two: the i-th occurrence of a and the i-th occurrence of b. (That is, you can only choose both or neither.) Then, you will concatenate the chosen characters (without changing the order).
Find the lexicographically largest string that can be obtained in this way.




Constraints
1 \leq N \leq 3000
S is a string of length 2N containing N occurrences of a and N occurrences of b.







InputInput is given from Standard Input in the following format:
N
S





OutputPrint the lexicographically largest string that satisfies the condition.






Sample Input 13
aababb





Sample Output 1abab

A subsequence of T obtained from taking the first, third, fourth and sixth characters in S, satisfies the condition.





Sample Input 23
bbabaa





Sample Output 2bbabaa

You can choose all the characters.





Sample Input 36
bbbaabbabaaa





Sample Output 3bbbabaaa






Sample Input 49
abbbaababaababbaba





Sample Output 4bbaababababa


",Synchronized Subsequence,"Two-pointer, Greedy Algorithm, String, Sorting, Dynamic Programming",1.0,2,2
1242,"


Problem StatementSnuke loves colorful balls. He has a total of N×K balls, K in each of his favorite N colors. The colors are numbered 1 through N.
He will arrange all of the balls in a row from left to right, in arbitrary order. Then, for each of the N colors, he will paint the leftmost ball of that color into color 0, a color different from any of the N original colors.
After painting, how many sequences of the colors of the balls are possible? Find this number modulo 10^9+7.




Constraints
1≤N,K≤2,000







InputThe input is given from Standard Input in the following format:
N K





OutputPrint the number of the possible sequences of the colors of the balls after painting, modulo 10^9+7.






Sample Input 12 2





Sample Output 14

The following 4 sequences are possible:

(0,1,0,2)
(0,0,1,2)
(0,2,0,1)
(0,0,2,1)






Sample Input 23 1





Sample Output 21

The following 1 sequence is possible:

(0,0,0)






Sample Input 32 3





Sample Output 314






Sample Input 42000 2000





Sample Output 4546381702


",Leftmost Ball,"Counting, Combinatorics, Arithmetic",0.0,1,0
1243,"
Score : 900 points


Problem StatementSnuke loves permutations. He is making a permutation of length N.
Since he hates the integer K, his permutation will satisfy the following:

Let the permutation be a_1, a_2, ..., a_N. For each i = 1,2,...,N, |a_i - i| \neq K.

Among the N! permutations of length N, how many satisfies this condition?
Since the answer may be extremely large, find the answer modulo 924844033(prime).




Constraints
2 ≦ N ≦ 2000
1 ≦ K ≦ N-1







InputThe input is given from Standard Input in the following format:
N K





OutputPrint the answer modulo 924844033.






Sample Input 13 1





Sample Output 12

2 permutations (1, 2, 3), (3, 2, 1) satisfy the condition.





Sample Input 24 1





Sample Output 25

5 permutations (1, 2, 3, 4), (1, 4, 3, 2), (3, 2, 1, 4), (3, 4, 1, 2), (4, 2, 3, 1) satisfy the condition.





Sample Input 34 2





Sample Output 39






Sample Input 44 3





Sample Output 414






Sample Input 5425 48





Sample Output 5756765083


",~K Perm Counting,"Dyanmic Programming, Inclusion And Exclusion, Combinatorics, Arithmetic, Depth-first Search",0.5,5,3
1244,"
Score : 1400 points


Problem StatementSigma and Sugim are playing a game.
The game is played on a graph with N vertices numbered 1 through N. The graph has N-1 red edges and N-1 blue edges, and the N-1 edges in each color forms a tree. The red edges are represented by pairs of integers (a_i, b_i), and the blue edges are represented by pairs of integers (c_i, d_i).
Each player has his own piece. Initially, Sigma's piece is at vertex X, and Sugim's piece is at vertex Y.
The game is played in turns, where turns are numbered starting from turn 1. Sigma takes turns 1, 3, 5, ..., and Sugim takes turns 2, 4, 6, ....
In each turn, the current player either moves his piece, or does nothing. Here, Sigma can only move his piece to a vertex that is directly connected to the current vertex by a red edge. Similarly, Sugim can only move his piece to a vertex that is directly connected to the current vertex by a blue edge.
When the two pieces come to the same vertex, the game ends immediately. If the game ends just after the operation in turn i, let i be the total number of turns in the game.
Sigma's objective is to make the total number of turns as large as possible, while Sugim's objective is to make it as small as possible.
Determine whether the game will end in a finite number of turns, assuming both players plays optimally to achieve their respective objectives. If the answer is positive, find the number of turns in the game.




Constraints
2 ≦ N ≦ 200,000
1 ≦ X, Y ≦ N
X \neq Y
1 ≦ a_i, b_i, c_i, d_i ≦ N
The N-1 edges in each color (red and blue) forms a tree.







InputThe input is given from Standard Input in the following format:
N X Y
a_1 b_1
a_2 b_2
:
a_{N-1} b_{N-1}
c_1 d_1
c_2 d_2
:
c_{N-1} d_{N-1}





OutputIf the game will end in a finite number of turns, print the number of turns.
Otherwise, print -1.






Sample Input 14 1 2
1 2
1 3
1 4
2 1
2 3
1 4





Sample Output 14







Sample Input 23 3 1
1 2
2 3
1 2
2 3





Sample Output 24







Sample Input 34 1 2
1 2
3 4
2 4
1 2
3 4
1 3





Sample Output 32







Sample Input 44 2 1
1 2
3 4
2 4
1 2
3 4
1 3





Sample Output 4-1






Sample Input 55 1 2
1 2
1 3
1 4
4 5
2 1
1 3
1 5
5 4





Sample Output 56


",Sugigma: The Showdown,"Graph Theory, Depth-first Search, Tree, Breadth-first Search, Mathematics, Game Theory",0.0,2,1
1245,"
Score : 1200 points


Problem StatementThere are infinitely many cards, numbered 1, 2, 3, ...
Initially, Cards x_1, x_2, ..., x_N are face up, and the others are face down.
Snuke can perform the following operation repeatedly:

Select a prime p greater than or equal to 3. Then, select p consecutive cards and flip all of them.

Snuke's objective is to have all the cards face down.
Find the minimum number of operations required to achieve the objective.




Constraints
1 ≤ N ≤ 100
1 ≤ x_1 < x_2 < ... < x_N ≤ 10^7







InputInput is given from Standard Input in the following format:
N
x_1 x_2 ... x_N





OutputPrint the minimum number of operations required to achieve the objective.






Sample Input 12
4 5





Sample Output 12

Below is one way to achieve the objective in two operations:

Select p = 5 and flip Cards 1, 2, 3, 4 and 5.
Select p = 3 and flip Cards 1, 2 and 3.






Sample Input 29
1 2 3 4 5 6 7 8 9





Sample Output 23

Below is one way to achieve the objective in three operations:

Select p = 3 and flip Cards 1, 2 and 3.
Select p = 3 and flip Cards 4, 5 and 6.
Select p = 3 and flip Cards 7, 8 and 9.






Sample Input 32
1 10000000





Sample Output 34


",Prime Flip,"Xor Basis (gf(2)), Bitmask, Graph Theory, Breadth-first Search, Dyanmic Programming, Sieve Of Eratosthenes, Divide And Conquer",0.0,1,0
1246,"
Score : 1000 points


Problem StatementThere is a sequence of length N: a = (a_1, a_2, ..., a_N).
Here, each a_i is a non-negative integer.
Snuke can repeatedly perform the following operation:

Let the XOR of all the elements in a be x. Select an integer i (1 ≤ i ≤ N) and replace a_i with x.

Snuke's objective is to match a with another sequence b = (b_1, b_2, ..., b_N).
Here, each b_i is a non-negative integer.
Determine whether the objective is achievable, and find the minimum necessary number of operations if the answer is positive.




Constraints
2 ≤ N ≤ 10^5
a_i and b_i are integers.
0 ≤ a_i, b_i < 2^{30}







InputInput is given from Standard Input in the following format:
N
a_1 a_2 ... a_N
b_1 b_2 ... b_N





OutputIf the objective is achievable, print the minimum necessary number of operations.
Otherwise, print -1 instead.






Sample Input 13
0 1 2
3 1 0





Sample Output 12

At first, the XOR of all the elements of a is 3.
If we replace a_1 with 3, a becomes (3, 1, 2).
Now, the XOR of all the elements of a is 0.
If we replace a_3 with 0, a becomes (3, 1, 0), which matches b.





Sample Input 23
0 1 2
0 1 2





Sample Output 20






Sample Input 32
1 1
0 0





Sample Output 3-1






Sample Input 44
0 1 2 3
1 0 3 2





Sample Output 45


",XOR Replace,"Bitmask, Greedy Algorithm, Counting, Boolean Operations On Geometric Objects",0.0,4,0
1247,"
Score : 700 points


Problem StatementAoki is in search of Takahashi, who is missing in a one-dimentional world.
Initially, the coordinate of Aoki is 0, and the coordinate of Takahashi is known to be x, but his coordinate afterwards cannot be known to Aoki.
Time is divided into turns. In each turn, Aoki and Takahashi take the following actions simultaneously:


Let the current coordinate of Aoki be a, then Aoki moves to a coordinate he selects from a-1, a and a+1.


Let the current coordinate of Takahashi be b, then Takahashi moves to the coordinate b-1 with probability of p percent, and moves to the coordinate b+1 with probability of 100-p percent.


When the coordinates of Aoki and Takahashi coincide, Aoki can find Takahashi.
When they pass by each other, Aoki cannot find Takahashi.
Aoki wants to minimize the expected number of turns taken until he finds Takahashi. Find the minimum possible expected number of turns.




Constraints
1 ≦ x ≦ 1,000,000,000
1 ≦ p ≦ 100
x and p are integers.





Partial Scores
In the test set worth 200 points, p=100.
In the test set worth 300 points, x ≦ 10.







InputThe input is given from Standard Input in the following format:
x
p





OutputPrint the minimum possible expected number of turns.
The output is considered correct if the absolute or relative error is at most 10^{-6}.






Sample Input 13
100





Sample Output 12.0000000

Takahashi always moves by -1.
Thus, by moving to the coordinate 1 in the 1-st turn and staying at that position in the 2-nd turn, Aoki can find Takahashi in 2 turns.





Sample Input 26
40





Sample Output 27.5000000






Sample Input 3101
80





Sample Output 363.7500000


",Takahashi is Missing!,"Probability Theory, Parity, Mathematics, Numerical Analysis",0.333,3,1
1248,"
Score : 1200 points


Problem StatementTakahashi is a magician. He can cast a spell on an integer sequence (a_1,a_2,...,a_M) with M terms, to turn it into another sequence (s_1,s_2,...,s_M), where s_i is the sum of the first i terms in the original sequence.
One day, he received N integer sequences, each with M terms, and named those sequences A_1,A_2,...,A_N. He will try to cast the spell on those sequences so that A_1 < A_2 < ... < A_N will hold, where sequences are compared lexicographically.
Let the action of casting the spell on a selected sequence be one cast of the spell. Find the minimum number of casts of the spell he needs to perform in order to achieve his objective.
Here, for two sequences a = (a_1,a_2,...,a_M), b = (b_1,b_2,...,b_M) with M terms each, a < b holds lexicographically if and only if there exists i (1 ≦ i ≦ M) such that a_j = b_j (1 ≦ j < i) and a_i < b_i.




Constraints
1 ≦ N ≦ 10^3
1 ≦ M ≦ 10^3
Let the j-th term in A_i be A_{(i,j)}, then 1 ≦ A_{(i,j)} ≦ 10^9.





Partial Scores
In the test set worth 200 points, Takahashi can achieve his objective by at most 10^4 casts of the spell, while keeping the values of all terms at most 10^9.
In the test set worth another 800 points, A_{(i,j)} ≦ 80.







InputThe input is given from Standard Input in the following format:
N M
A_{(1,1)} A_{(1,2)} … A_{(1,M)}
A_{(2,1)} A_{(2,2)} … A_{(2,M)}
:
A_{(N,1)} A_{(N,2)} … A_{(N,M)}





OutputPrint the minimum number of casts of the spell Takahashi needs to perform. If he cannot achieve his objective, print -1 instead.






Sample Input 13 3
2 3 1
2 1 2
2 6 3





Sample Output 11

Takahashi can achieve his objective by casting the spell on A_2 once to turn it into (2 , 3 , 5).





Sample Input 23 3
3 2 10
10 5 4
9 1 9





Sample Output 2-1

In this case, Takahashi cannot achieve his objective by casting the spell any number of times.





Sample Input 35 5
2 6 5 6 9
2 6 4 9 10
2 6 8 6 7
2 1 7 3 8
2 1 4 8 3





Sample Output 311


",Takahashi the Magician,"Prefix sum, String, Binary Search, Dyanmic Programming",0.0,7,0
1249,"
Score : 600 points


Problem StatementThere are N people, conveniently numbered 1 through N.
We want to divide them into some number of groups, under the following two conditions:


Every group contains between A and B people, inclusive.


Let F_i be the number of the groups containing exactly i people. Then, for all i, either F_i=0 or C≤F_i≤D holds.


Find the number of these ways to divide the people into groups.
Here, two ways to divide them into groups is considered different if and only if there exists two people such that they belong to the same group in exactly one of the two ways.
Since the number of these ways can be extremely large, print the count modulo 10^9+7.




Constraints
1≤N≤10^3
1≤A≤B≤N
1≤C≤D≤N







InputThe input is given from Standard Input in the following format:
N A B C D





OutputPrint the number of ways to divide the people into groups under the conditions, modulo 10^9+7.






Sample Input 13 1 3 1 2





Sample Output 14

There are four ways to divide the people:

(1,2),(3)
(1,3),(2)
(2,3),(1)
(1,2,3)

The following way to divide the people does not count: (1),(2),(3). This is because it only satisfies the first condition and not the second.





Sample Input 27 2 3 1 3





Sample Output 2105

The only ways to divide the people under the conditions are the ones where there are two groups of two people, and one group of three people.
There are 105 such ways.





Sample Input 31000 1 1000 1 1000





Sample Output 3465231251






Sample Input 410 3 4 2 5





Sample Output 40

The answer can be 0.

",Grouping,"Dyanmic Programming, Combinatorics, Arithmetic, Dynamic Programming, Counting",0.6,13,11
1250,"
Score : 1000 points


Problem StatementWe will call a string x good if it satisfies the following condition:

Condition: x can be represented as a concatenation of two copies of another string y of length at least 1.

For example, aa and bubobubo are good; an empty string, a, abcabcabc and abba are not good.
Eagle and Owl created a puzzle on good strings.
Find one string s that satisfies the following conditions. It can be proved that such a string always exists under the constraints in this problem.

1 ≤ |s| ≤ 200
Each character of s is one of the 100 characters represented by the integers 1 through 100.
Among the 2^{|s|} subsequences of s, exactly N are good strings.





Constraints
1 ≤ N ≤ 10^{12}







InputInput is given from Standard Input in the following format:
N





OutputIn the first line, print |s|, the length of s.
In the second line, print the elements in s in order, with spaces in between. Any string that satisfies the above conditions will be accepted.






Sample Input 17





Sample Output 14
1 1 1 1

There are two good strings that appear as subsequences of s: (1,1) and (1,1,1,1). There are six occurrences of (1,1) and one occurrence of (1,1,1,1), for a total of seven.





Sample Input 2299





Sample Output 223
32 11 11 73 45 8 11 83 83 8 45 32 32 10 100 73 32 83 45 73 32 11 10


",Tautonym Puzzle,"Bitmask, Greedy Algorithm, Mathematics, Constructive, Counting",0.0,14,1
1251,"
Score : 700 points


Problem StatementSnuke is playing a puzzle game.
In this game, you are given a rectangular board of dimensions R × C, filled with numbers. Each integer i from 1 through N is written twice, at the coordinates (x_{i,1},y_{i,1}) and (x_{i,2},y_{i,2}).
The objective is to draw a curve connecting the pair of points where the same integer is written, for every integer from 1 through N.
Here, the curves may not go outside the board or cross each other.
Determine whether this is possible.




Constraints
1 ≤ R,C ≤ 10^8
1 ≤ N ≤ 10^5
0 ≤ x_{i,1},x_{i,2} ≤ R(1 ≤ i ≤ N)
0 ≤ y_{i,1},y_{i,2} ≤ C(1 ≤ i ≤ N)
All given points are distinct.
All input values are integers.







InputInput is given from Standard Input in the following format:
R C N
x_{1,1} y_{1,1} x_{1,2} y_{1,2}
:
x_{N,1} y_{N,1} x_{N,2} y_{N,2}





OutputPrint YES if the objective is achievable; print NO otherwise.






Sample Input 14 2 3
0 1 3 1
1 1 4 1
2 0 2 2





Sample Output 1YES


The above figure shows a possible solution.





Sample Input 22 2 4
0 0 2 2
2 0 0 1
0 2 1 2
1 1 2 1





Sample Output 2NO






Sample Input 35 5 7
0 0 2 4
2 3 4 5
3 5 5 2
5 5 5 4
0 3 5 1
2 2 4 4
0 5 4 1





Sample Output 3YES






Sample Input 41 1 2
0 0 1 1
1 0 0 1





Sample Output 4NO


",Connected?,"Sorting, Stack, Geometry; 3d, Greedy Algorithm",0.5,7,4
1252,"
Score : 1100 points


Problem StatementThere is a set consisting of N distinct integers. The i-th smallest element in this set is S_i. We want to divide this set into two sets, X and Y, such that:

The absolute difference of any two distinct elements in X is A or greater.
The absolute difference of any two distinct elements in Y is B or greater.

How many ways are there to perform such division, modulo 10^9 + 7? Note that one of X and Y may be empty.




Constraints
All input values are integers.
1 ≦ N ≦ 10^5
1 ≦ A , B ≦ 10^{18}
0 ≦ S_i ≦ 10^{18}(1 ≦ i ≦ N)
S_i < S_{i+1}(1 ≦ i ≦ N - 1)







InputThe input is given from Standard Input in the following format:
N A B
S_1
:
S_N





OutputPrint the number of the different divisions under the conditions, modulo 10^9 + 7.






Sample Input 15 3 7
1
3
6
9
12





Sample Output 15

There are five ways to perform division:

X={1,6,9,12}, Y={3}
X={1,6,9}, Y={3,12}
X={3,6,9,12}, Y={1}
X={3,6,9}, Y={1,12}
X={3,6,12}, Y={1,9}






Sample Input 27 5 3
0
2
4
7
8
11
15





Sample Output 24






Sample Input 38 2 9
3
4
5
13
15
22
26
32





Sample Output 313






Sample Input 43 3 4
5
6
7





Sample Output 40


",Division into Two,"Dyanmic Programming, Two-pointer, Binary Search, Prefix sum, Binary Indexed Tree, Arithmetic",0.5,7,5
1253,"
Score : 1200 points


Problem StatementSnuke loves flags.
Snuke is placing N flags on a line.
The i-th flag can be placed at either coordinate x_i or coordinate y_i.
Snuke thinks that the flags look nicer when the smallest distance between two of them, d, is larger. Find the maximum possible value of d.




Constraints
2 ≤ N ≤ 10^{4}
1 ≤ x_i, y_i ≤ 10^{9}
x_i and y_i are integers.







InputThe input is given from Standard Input in the following format:
N
x_1 y_1
:
x_N y_N





OutputPrint the answer.






Sample Input 13
1 3
2 5
1 9





Sample Output 14

The optimal solution is to place the first flag at coordinate 1, the second flag at coordinate 5 and the third flag at coordinate 9. The smallest distance between two of the flags is 4 in this case.





Sample Input 25
2 2
2 2
2 2
2 2
2 2





Sample Output 20

There can be more than one flag at the same position.





Sample Input 322
93 6440
78 6647
862 11
8306 9689
798 99
801 521
188 206
6079 971
4559 209
50 94
92 6270
5403 560
803 83
1855 99
42 504
75 484
629 11
92 122
3359 37
28 16
648 14
11 269





Sample Output 317


",Flags,"Binary Search, 2-sat, Strongly Connected Component, Depth-first Search, Segment Tree",0.0,3,1
1254,"
Score : 1300 points


Problem StatementWe will call a non-negative integer increasing if, for any two adjacent digits in its decimal representation, the digit to the right is greater than or equal to the digit to the left.
For example, 1558, 11, 3 and 0 are all increasing; 10 and 20170312 are not.
Snuke has an integer N. Find the minimum number of increasing integers that can represent N as their sum.




Constraints
1 \leq N \leq 10^{500000}







InputThe input is given from Standard Input in the following format:
N





OutputPrint the minimum number of increasing integers that can represent N as their sum.






Sample Input 180





Sample Output 12

One possible representation is 80 = 77 + 3.





Sample Input 2123456789





Sample Output 21

123456789 in itself is increasing, and thus it can be represented as the sum of one increasing integer.





Sample Input 320170312





Sample Output 34






Sample Input 47204647845201772120166980358816078279571541735614841625060678056933503





Sample Output 431


",Increasing Numbers,"String, Greedy Algorithm",0.0,4,0
1255,"
Score : 900 points


Problem StatementJoisino has a lot of red and blue bricks and a large box.
She will build a tower of these bricks in the following manner.
First, she will pick a total of N bricks and put them into the box.
Here, there may be any number of bricks of each color in the box, as long as there are N bricks in total.
Particularly, there may be zero red bricks or zero blue bricks.
Then, she will repeat an operation M times, which consists of the following three steps:

Take out an arbitrary brick from the box.
Put one red brick and one blue brick into the box.
Take out another arbitrary brick from the box.

After the M operations, Joisino will build a tower by stacking the 2 \times M bricks removed from the box, in the order they are taken out.
She is interested in the following question: how many different sequences of colors of these 2 \times M bricks are possible?
Write a program to find the answer.
Since it can be extremely large, print the count modulo 10^9+7.




Constraints
1 \leq N \leq 3000
1 \leq M \leq 3000







InputInput is given from Standard Input in the following format:
N M





OutputPrint the count of the different possible sequences of colors of 2 \times M bricks that will be stacked, modulo 10^9+7.






Sample Input 12 3





Sample Output 156

A total of six bricks will be removed from the box. The only impossible sequences of colors of these bricks are the ones where the colors of the second, third, fourth and fifth bricks are all the same. Therefore, there are 2^6 - 2 \times 2 \times 2 = 56 possible sequences of colors.





Sample Input 21000 10





Sample Output 21048576






Sample Input 31000 3000





Sample Output 3693347555


",Piling Up,"Dyanmic Programming, Mathematics, Combinatorics, Arithmetic, Bruteforcing, Dynamic Programming",0.5,7,2
1256,"
Score : 1200 points


Problem StatementWe have N irregular jigsaw pieces. Each piece is composed of three rectangular parts of width 1 and various heights joined together. More specifically:

The i-th piece is a part of height H, with another part of height A_i joined to the left, and yet another part of height B_i joined to the right, as shown below. Here, the bottom sides of the left and right parts are respectively at C_i and D_i units length above the bottom side of the center part.


Snuke is arranging these pieces on a square table of side 10^{100}. Here, the following conditions must be held:

All pieces must be put on the table.
The entire bottom side of the center part of each piece must touch the front side of the table.
The entire bottom side of the non-center parts of each piece must either touch the front side of the table, or touch the top side of a part of some other piece.
The pieces must not be rotated or flipped.

Determine whether such an arrangement is possible.




Constraints
1 \leq N \leq 100000
1 \leq H \leq 200
1 \leq A_i \leq H
1 \leq B_i \leq H
0 \leq C_i \leq H - A_i
0 \leq D_i \leq H - B_i
All input values are integers.







InputInput is given from Standard Input in the following format:
N H
A_1 B_1 C_1 D_1
A_2 B_2 C_2 D_2
:
A_N B_N C_N D_N





OutputIf it is possible to arrange the pieces under the conditions, print YES; if it is impossible, print NO.






Sample Input 13 4
1 1 0 0
2 2 0 1
3 3 1 0





Sample Output 1YES

The figure below shows a possible arrangement.






Sample Input 24 2
1 1 0 1
1 1 0 1
1 1 0 1
1 1 0 1





Sample Output 2NO






Sample Input 310 4
1 1 0 3
2 3 2 0
1 2 3 0
2 1 0 0
3 2 0 2
1 1 3 0
3 2 0 0
1 3 2 0
1 1 1 3
2 3 0 0





Sample Output 3YES


",Jigsaw,"Difference Array, Graph Theory, Depth-first Search, Mathematics",0.0,2,1
1257,"
Score : 700 points


Problem StatementThere are N towns numbered 1, 2, \cdots, N.
Some roads are planned to be built so that each of them connects two distinct towns bidirectionally. Currently, there are no roads connecting towns.
In the planning of construction, each town chooses one town different from itself and requests the following: roads are built so that the chosen town is reachable from itself using one or more roads.
These requests from the towns are represented by an array P_1, P_2, \cdots, P_N. If P_i = -1, it means that Town i has not chosen the request; if 1 \leq P_i \leq N, it means that Town i has chosen Town P_i.
Let K be the number of towns i such that P_i = -1. There are (N-1)^K ways in which the towns can make the requests. For each way to make requests, find the minimum number of roads needed to meet all the requests, and print the sum of those (N-1)^K numbers, modulo (10^9+7).




Constraints
2 \leq N \leq 5000
P_i = -1 or 1 \leq P_i \leq N.
P_i \neq i
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
P_1 P_2 \cdots P_N





OutputFor each way to make requests, find the minimum number of roads needed to meet all the requests, and print the sum of those (N-1)^K numbers, modulo (10^9+7).






Sample Input 14
2 1 -1 3





Sample Output 18

There are three ways to make requests, as follows:

Choose P_1 = 2, P_2 = 1, P_3 = 1, P_4 = 3. In this case, at least three roads - for example, (1,2),(1,3),(3,4) - are needed to meet the requests.
Choose P_1 = 2, P_2 = 1, P_3 = 2, P_4 = 3. In this case, at least three roads - for example, (1,2),(1,3),(3,4) - are needed to meet the requests.
Choose P_1 = 2, P_2 = 1, P_3 = 4, P_4 = 3. In this case, at least two roads - for example, (1,2),(3,4) - are needed to meet the requests.

Note that it is not mandatory to connect Town i and Town P_i directly.
The sum of the above numbers is 8.





Sample Input 22
2 1





Sample Output 21

There may be just one fixed way to make requests.





Sample Input 310
2 6 9 -1 6 9 -1 -1 -1 -1





Sample Output 3527841


",Urban Planning,"Graph Theory, Graph Traversal, Combinatorics, Dyanmic Programming, Arithmetic, Inclusion And Exclusion",0.5,4,3
1258,"
Score : 1100 points


Problem StatementWe have N balance beams numbered 1 to N.
The length of each beam is 1 meters.
Snuke walks on Beam i at a speed of 1/A_i meters per second, and Ringo walks on Beam i at a speed of 1/B_i meters per second.
Snuke and Ringo will play the following game:

First, Snuke connects the N beams in any order of his choice and makes a long beam of length N meters.
Then, Snuke starts at the left end of the long beam. At the same time, Ringo starts at a point chosen uniformly at random on the long beam. Both of them walk to the right end of the long beam.
Snuke wins if and only if he catches up to Ringo before Ringo reaches the right end of the long beam. That is, Snuke wins if there is a moment when Snuke and Ringo stand at the same position, and Ringo wins otherwise.

Find the probability that Snuke wins when Snuke arranges the N beams so that the probability of his winning is maximized.
This probability is a rational number, so we ask you to represent it as an irreducible fraction P/Q (to represent 0, use P=0, Q=1).




Constraints
1 \leq N \leq 10^5
1 \leq A_i,B_i \leq 10^9
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
A_1 B_1
A_2 B_2
\vdots
A_N B_N





OutputPrint the numerator and denominator of the irreducible fraction that represents the maximum probability of Snuke's winning.






Sample Input 12
3 2
1 2





Sample Output 11 4

When the beams are connected in the order 2,1 from left to right, the probability of Snuke's winning is 1/4, which is the maximum possible value.





Sample Input 24
1 5
4 7
2 1
8 4





Sample Output 21 2






Sample Input 33
4 1
5 2
6 3





Sample Output 30 1






Sample Input 410
866111664 178537096
705445072 318106937
472381277 579910117
353498483 865935868
383133839 231371336
378371075 681212831
304570952 16537461
955719384 267238505
844917655 218662351
550309930 62731178





Sample Output 4697461712 2899550585


",Balance Beam,"Greedy Algorithm, Prefix sum, Binary Search, Number Theory, Sorting",0.0,18,1
1259,"
Score : 1500 points


Problem StatementConsider a circle whose perimeter is divided by N points into N arcs of equal length, and each of the arcs is painted red or blue. Such a circle is said to generate a string S from every point when the following condition is satisfied:

We will arbitrarily choose one of the N points on the perimeter and place a piece on it.
Then, we will perform the following move M times: move the piece clockwise or counter-clockwise to an adjacent point.
Here, whatever point we choose initially, it is always possible to move the piece so that the color of the i-th arc the piece goes along is S_i, by properly deciding the directions of the moves.

Assume that, if S_i is R, it represents red; if S_i is B, it represents blue.
Note that the directions of the moves can be decided separately for each choice of the initial point.
You are given a string S of length M consisting of R and B.
Out of the 2^N ways to paint each of the arcs red or blue in a circle whose perimeter is divided into N arcs of equal length, find the number of ways resulting in a circle that generates S from every point, modulo 10^9+7.
Note that the rotations of the same coloring are also distinguished.




Constraints
2 \leq N \leq 2 \times 10^5
1 \leq M \leq 2 \times 10^5
|S|=M
S_i is R or B.







InputInput is given from Standard Input in the following format:
N M
S





OutputPrint the number of ways to paint each of the arcs that satisfy the condition, modulo 10^9+7.






Sample Input 14 7
RBRRBRR





Sample Output 12

The condition is satisfied only if the arcs are alternately painted red and blue, so the answer here is 2.





Sample Input 23 3
BBB





Sample Output 24






Sample Input 312 10
RRRRBRRRRB





Sample Output 378


",Go around a Circle,"String, Arithmetic, Dyanmic Programming, Combinatorics, Constructive, Boolean Operations On Geometric Objects",0.25,14,4
1260,"
Score : 1000 points


Problem StatementGiven are N points on the circumference of a circle centered at (0,0) in an xy-plane.
The coordinates of the i-th point are (\cos(\frac{2\pi T_i}{L}),\sin(\frac{2\pi T_i}{L})).
Three distinct points will be chosen uniformly at random from these N points.
Find the expected x- and y-coordinates of the center of the circle inscribed in the triangle formed by the chosen points.




Constraints
3 \leq N \leq 3000
N \leq L \leq 10^9
0 \leq T_i \leq L-1
T_i<T_{i+1}
All values in input are integers.







InputInput is given from Standard Input in the following format:
N L
T_1
:
T_N





OutputPrint the expected x- and y-coordinates of the center of the circle inscribed in the triangle formed by the chosen points.
Your output will be considered correct when the absolute or relative error is at most 10^{-9}.






Sample Input 13 4
0
1
3





Sample Output 10.414213562373095 -0.000000000000000

The three points have the coordinates (1,0), (0,1), and (0,-1). The center of the circle inscribed in the triangle formed by these points is (\sqrt{2}-1,0).





Sample Input 24 8
1
3
5
6





Sample Output 2-0.229401949926902 -0.153281482438188






Sample Input 310 100
2
11
35
42
54
69
89
91
93
99





Sample Output 30.352886583546338 -0.109065017701873


",Incenters,"Mathematics, Combinatorics, Bruteforcing, Arithmetic, Prefix sum, Numerical Analysis",0.333,10,2
1261,"
Score : 900 points


Problem StatementWe have a sequence of N integers: x=(x_0,x_1,\cdots,x_{N-1}).
Initially, x_i=0 for each i (0 \leq i \leq N-1).
Snuke will perform the following operation exactly M times:

Choose two distinct indices i, j (0 \leq i,j \leq N-1,\ i \neq j).
Then, replace x_i with x_i+2 and x_j with x_j+1.

Find the number of different sequences that can result after M operations.
Since it can be enormous, compute the count modulo 998244353.




Constraints
2 \leq N \leq 10^6
1 \leq M \leq 5 \times 10^5
All values in input are integers.







InputInput is given from Standard Input in the following format:
N M





OutputPrint the number of different sequences that can result after M operations, modulo 998244353.






Sample Input 12 2





Sample Output 13

After two operations, there are three possible outcomes:

x=(2,4)
x=(3,3)
x=(4,2)

For example, x=(3,3) can result after the following sequence of operations:

First, choose i=0,j=1, changing x from (0,0) to (2,1).
Second, choose i=1,j=0, changing x from (2,1) to (3,3).






Sample Input 23 2





Sample Output 219






Sample Input 310 10





Sample Output 3211428932






Sample Input 4100000 50000





Sample Output 43463133


",GP 2,"Combinatorics, Arithmetic, Precomputation, Inclusion And Exclusion, Exponentiation By Squaring",1.0,3,3
1262,"
Score : 1600 points


Problem StatementA balancing network is an abstract device built up of N wires, thought of as running from left to right,
and M balancers that connect pairs of wires. The wires are numbered from 1 to N from top to bottom,
and the balancers are numbered from 1 to M from left to right.
Balancer i connects wires x_i and y_i (x_i < y_i).



Each balancer must be in one of two states: up or down.
Consider a token that starts moving to the right along some wire at a point to the left of all balancers.
During the process, the token passes through each balancer exactly once.
Whenever the token encounters balancer i, the following happens:

If the token is moving along wire x_i and balancer i is in the down state, the token moves down to wire y_i and continues moving to the right.
If the token is moving along wire y_i and balancer i is in the up state, the token moves up to wire x_i and continues moving to the right.
Otherwise, the token doesn't change the wire it's moving along.

Let a state of the balancing network be a string of length M, describing the states of all balancers.
The i-th character is ^ if balancer i is in the up state, and v if balancer i is in the down state.
A state of the balancing network is called uniforming if a wire w exists such that, regardless of the starting wire,
the token will always end up at wire w and run to infinity along it. Any other state is called non-uniforming.
You are given an integer T (1 \le T \le 2). Answer the following question:

If T = 1, find any uniforming state of the network or determine that it doesn't exist.
If T = 2, find any non-uniforming state of the network or determine that it doesn't exist.

Note that if you answer just one kind of questions correctly, you can get partial score.




Constraints
2 \leq N \leq 50000
1 \leq M \leq 100000
1 \leq T \leq 2
1 \leq x_i < y_i \leq N
All input values are integers.





Partial Score
800 points will be awarded for passing the testset satisfying T = 1.
800 points will be awarded for passing the testset satisfying T = 2.







InputInput is given from Standard Input in the following format:
N M T
x_1 y_1
x_2 y_2
:
x_M y_M





OutputPrint any uniforming state of the given network if T = 1, or any non-uniforming state if T = 2. If the required state doesn't exist, output -1.






Sample Input 14 5 1
1 3
2 4
1 2
3 4
2 3





Sample Output 1^^^^^

This state is uniforming: regardless of the starting wire, the token ends up at wire 1.








Sample Input 24 5 2
1 3
2 4
1 2
3 4
2 3





Sample Output 2v^^^^

This state is non-uniforming: depending on the starting wire, the token might end up at wire 1 or wire 2.








Sample Input 33 1 1
1 2





Sample Output 3-1

A uniforming state doesn't exist.





Sample Input 42 1 2
1 2





Sample Output 4-1

A non-uniforming state doesn't exist.

",Balancing Network,"Bit Set, Graph Theory, Backtracking, Two-pointer, Greedy Algorithm",0.333,4,2
1263,"
Score : 1000 points


Problem StatementThere are 3^N people dancing in circle.
We denote with 0,1,\dots, 3^{N}-1 the positions in the circle, starting from an arbitrary position and going around clockwise. Initially each position in the circle is occupied by one person.
The people are going to dance on two kinds of songs: salsa and rumba.

When a salsa is played, the person in position i goes to position j, where j is the number obtained replacing all digits 1 with 2 and all digits 2 with 1 when reading i in base 3 (e.g., the person in position 46 goes to position 65).
When a rumba is played, the person in position i moves to position i+1 (with the identification 3^N = 0).

You are given a string T=T_1T_2\cdots T_{|T|} such that T_i=S if the i-th song is a salsa and T_i=R if it is a rumba.
After all the songs have been played, the person that initially was in position i is in position P_i.
Compute the array P_0,P_1,\dots, P_{3^N-1}.




Constraints
1 \le N \le 12
1 \le |T| \le 200,000
T contains only the characters S and R.







InputInput is given from Standard Input in the following format:
N
T





OutputYou should print on Standard Output:
P_0 P_1 \cdots P_{3^N-1}







Sample Input 11
SRS





Sample Output 12 0 1 

Before any song is played, the positions are: 0, 1, 2.
When we say ""person i"", we mean ""the person that was initially in position i"".

After the first salsa, the positions are: 0, 2, 1.
After the rumba, the positions are: 1, 0, 2 (so, person 0 is in position 1, person 1 is in position 0 and person 2 is in position 2).
After the second salsa, the positions are 2, 0, 1 (so, person 0 is in position 2, person 1 is in position 0 and person 2 is in position 1).






Sample Input 22
RRSRSSSSR





Sample Output 23 8 1 0 5 7 6 2 4 






Sample Input 33
SRSRRSRRRSRRRR





Sample Output 323 9 22 8 3 7 20 24 19 5 18 4 17 12 16 2 6 1 14 0 13 26 21 25 11 15 10 


",Strange Dance,"Permutation Cycle Decomposition, Arithmetic, Mathematics, Parity",0.0,14,0
1264,"
Score : 500 points


Problem Statement
There are N computers and N sockets in a one-dimensional world.
The coordinate of the i-th computer is a_i, and the coordinate of the i-th socket is b_i.
It is guaranteed that these 2N coordinates are pairwise distinct.
Snuke wants to connect each computer to a socket using a cable.
Each socket can be connected to only one computer.
In how many ways can he minimize the total length of the cables?
Compute the answer modulo 10^9+7.




Constraints
1 ≤ N ≤ 10^5
0 ≤ a_i, b_i ≤ 10^9
The coordinates are integers.
The coordinates are pairwise distinct.







InputThe input is given from Standard Input in the following format:
N
a_1
:
a_N
b_1
:
b_N





OutputPrint the number of ways to minimize the total length of the cables, modulo 10^9+7.






Sample Input 12
0
10
20
30





Sample Output 12

There are two optimal connections: 0-20, 10-30 and 0-30, 10-20.
In both connections the total length of the cables is 40.





Sample Input 23
3
10
8
7
12
5





Sample Output 21


",1D Matching,"Sorting, Two-pointer, Greedy Algorithm, Arithmetic, Combinatorics",0.5,10,3
1265,"
Score : 500 points


Problem Statement
A cheetah and a cheater are going to play the game of Nim.
In this game they use N piles of stones.
Initially the i-th pile contains a_i stones.
The players take turns alternately, and the cheetah plays first.
In each turn, the player chooses one of the piles, and takes one or more stones from the pile.
The player who can't make a move loses.
However, before the game starts, the cheater wants to cheat a bit to make sure that he can win regardless of the moves by the cheetah.
From each pile, the cheater takes zero or one stone and eats it before the game.
In case there are multiple ways to guarantee his winning, he wants to minimize the number of stones he eats.
Compute the number of stones the cheater will eat.
In case there is no way for the cheater to win the game even with the cheating, print -1 instead.




Constraints
1 ≤ N ≤ 10^5
2 ≤ a_i ≤ 10^9







InputThe input is given from Standard Input in the following format:
N
a_1
:
a_N





OutputPrint the answer.






Sample Input 13
2
3
4





Sample Output 13

The only way for the cheater to win the game is to take stones from all piles and eat them.





Sample Input 23
100
100
100





Sample Output 2-1


",Cheating Nim,"Bitmask, Greedy Algorithm, Set / Map, Simulation",0.5,3,2
1266,"
Score : 500 points


Problem Statement
Snuke received a triangle as a birthday present.
The coordinates of the three vertices were (x_1, y_1), (x_2, y_2), and (x_3, y_3).
He wants to draw two circles with the same radius inside the triangle such that the two circles do not overlap (but they may touch).
Compute the maximum possible radius of the circles.




Constraints
0 ≤ x_i, y_i ≤ 1000
The coordinates are integers.
The three points are not on the same line.







InputThe input is given from Standard Input in the following format:
x_1 y_1
x_2 y_2
x_3 y_3





OutputPrint the maximum possible radius of the circles.
The absolute error or the relative error must be at most 10^{-9}.






Sample Input 10 0
1 1
2 0





Sample Output 10.292893218813






Sample Input 23 1
1 5
4 9





Sample Output 20.889055514217


",Inscribed Bicycle,"Mathematics, Geometry; 3d, Numerical Analysis",1.0,1,1
1267,"
Score : 1000 points


Problem StatementSnuke arranged N colorful balls in a row.
The i-th ball from the left has color c_i and weight w_i.
He can rearrange the balls by performing the following two operations any number of times, in any order:

Operation 1: Select two balls with the same color. If the total weight of these balls is at most X, swap the positions of these balls.
Operation 2: Select two balls with different colors. If the total weight of these balls is at most Y, swap the positions of these balls.

How many different sequences of colors of balls can be obtained? Find the count modulo 10^9 + 7.




Constraints
1 ≤ N ≤ 2 × 10^5
1 ≤ X, Y ≤ 10^9
1 ≤ c_i ≤ N
1 ≤ w_i ≤ 10^9
X, Y, c_i, w_i are all integers.







InputInput is given from Standard Input in the following format:
N X Y
c_1 w_1
:
c_N w_N





OutputPrint the answer.






Sample Input 14 7 3
3 2
4 3
2 1
4 4





Sample Output 12


The sequence of colors (2,4,3,4) can be obtained by swapping the positions of the first and third balls by operation 2.
It is also possible to swap the positions of the second and fourth balls by operation 1, but it does not affect the sequence of colors.






Sample Input 21 1 1
1 1





Sample Output 21






Sample Input 321 77 68
16 73
16 99
19 66
2 87
2 16
7 17
10 36
10 68
2 38
10 74
13 55
21 21
3 7
12 41
13 88
18 6
2 12
13 87
1 9
2 27
13 15





Sample Output 3129729600


",Colorful Balls,"Disjoint Set, Arithmetic, Combinatorics, Greedy Algorithm, Graph Theory",0.333,7,2
1268,"
Score : 700 points


Problem StatementTakahashi is playing with N cards.
The i-th card has an integer X_i on it.
Takahashi is trying to create as many pairs of cards as possible satisfying one of the following conditions:

The integers on the two cards are the same.
The sum of the integers on the two cards is a multiple of M.

Find the maximum number of pairs that can be created.
Note that a card cannot be used in more than one pair.




Constraints
2≦N≦10^5
1≦M≦10^5
1≦X_i≦10^5







InputThe input is given from Standard Input in the following format:
N M
X_1 X_2 ... X_N





OutputPrint the maximum number of pairs that can be created.






Sample Input 17 5
3 1 4 1 5 9 2





Sample Output 13

Three pairs (3,2), (1,4) and (1,9) can be created.
It is possible to create pairs (3,2) and (1,1), but the number of pairs is not maximized with this.





Sample Input 215 10
1 5 6 10 11 11 11 20 21 25 25 26 99 99 99





Sample Output 26


",Pair Cards,"Counting, Arithmetic, Greedy Algorithm, Game Theory, Bruteforcing",0.667,5,3
1269,"
Score : 700 points


Problem StatementThere are N panels arranged in a row in Takahashi's house, numbered 1 through N. The i-th panel has a number A_i written on it. Takahashi is playing by throwing balls at these panels.
Takahashi threw a ball K times. Let the panel hit by a boll in the i-th throw be panel p_i. He set the score for the i-th throw as i \times A_{p_i}.
He was about to calculate the total score for his throws, when he realized that he forgot the panels hit by balls, p_1,p_2,...,p_K. The only fact he remembers is that for every i (1 ≦ i ≦ K-1), 1 ≦ p_{i+1}-p_i ≦ M holds. Based on this fact, find the maximum possible total score for his throws.




Constraints
1 ≦ M ≦ N ≦ 100,000
1 ≦ K ≦ min(300,N)
1 ≦ A_i ≦ 10^{9}





Partial Scores
In the test set worth 100 points, M = N.
In the test set worth another 200 points, N ≦ 300 and K ≦ 30.
In the test set worth another 300 points, K ≦ 30.







InputThe input is given from Standard Input in the following format:
N M K
A_1 A_2 … A_N





OutputPrint the maximum possible total score for Takahashi's throws.






Sample Input 15 2 3
10 2 8 10 2





Sample Output 156

The total score is maximized when panels 1,3 and 4 are hit, in this order.





Sample Input 25 5 2
5 2 10 5 9





Sample Output 228

This case satisfies the additional constraint M = N for a partial score.





Sample Input 310 3 5
3 7 2 6 9 4 8 5 1 1000000000





Sample Output 35000000078


",Struck Out,"Dyanmic Programming, Segment Tree, Data Structures, Sliding Window",0.333,9,3
1270,"
Score : 1400 points


Problem StatementTakahashi found an integer sequence (A_1,A_2,...,A_N) with N terms. Since it was too heavy to carry, he decided to compress it into a single integer.
The compression takes place in N-1 steps, each of which shorten the length of the sequence by 1. Let S be a string describing the steps, and the sequence on which the i-th step is performed be (a_1,a_2,...,a_K), then the i-th step will be as follows:

When the i-th character in S is M, let b_i = max(a_i,a_{i+1}) (1 ≦ i ≦ K-1), and replace the current sequence by (b_1,b_2,...,b_{K-1}).
When the i-th character in S is m, let b_i = min(a_i,a_{i+1}) (1 ≦ i ≦ K-1), and replace the current sequence by (b_1,b_2,...,b_{K-1}).

Takahashi decided the steps S, but he is too tired to carry out the compression. On behalf of him, find the single integer obtained from the compression.




Constraints
2 ≦ N ≦ 10^5
1 ≦ A_i ≦ N
S consists of N-1 characters.
Each character in S is either M or m.





Partial Scores
In the test set worth 400 points, there exists i (1 ≦ i < N-1) such that the first i characters in S are M, and the remaining characters are m, that is, S is in the form M...Mm...m.
In the test set worth 800 points, the odd-number-th characters in S are M, and the even-number-th characters are m, that is, S is in the form MmMmMm....







InputThe input is given from Standard Input in the following format:
N
A_1 A_2 … A_N
S





OutputPrint the single integer obtained from the compression.






Sample Input 14
1 2 3 4
MmM





Sample Output 13

The initial sequence ( 1 , 2 , 3 , 4 ) is compressed as follows:

After the first step, the sequence is ( 2 , 3 , 4 ).
After the second step, the sequence is ( 2 , 3 ).
After the third step, the sequence is ( 3 ).

Thus, the single integer obtained from the compression is 3.





Sample Input 25
3 4 2 2 1
MMmm





Sample Output 22






Sample Input 310
1 8 7 6 8 5 2 2 6 1
MmmmmMMMm





Sample Output 35






Sample Input 420
12 7 16 8 7 19 8 19 20 11 7 13 20 3 4 11 19 11 15 5
mMMmmmMMMMMMmMmmmMM





Sample Output 411


",Compression,"Segment Tree, Data Structures, Dyanmic Programming, Divide And Conquer, Monotonic Stack, Sliding Window",0.0,1,0
1271,"
Score : 700 points


Problem StatementTakahashi found an undirected connected graph with N vertices and M edges. The vertices are numbered 1 through N. The i-th edge connects vertices a_i and b_i, and has a weight of c_i.
He will play Q rounds of a game using this graph. In the i-th round, two vertices S_i and T_i are specified, and he will choose a subset of the edges such that any vertex can be reached from at least one of the vertices S_i or T_i by traversing chosen edges.
For each round, find the minimum possible total weight of the edges chosen by Takahashi.




Constraints
1 ≦ N ≦ 4,000
1 ≦ M ≦ 400,000
1 ≦ Q ≦ 100,000
1 ≦ a_i,b_i,S_i,T_i ≦ N
1 ≦ c_i ≦ 10^{9}
a_i \neq b_i
S_i \neq T_i
The given graph is connected.





Partial Scores
In the test set worth 200 points, Q = 1.
In the test set worth another 300 points, Q ≦ 3000.







InputThe input is given from Standard Input in the following format:
N M
a_1 b_1 c_1
a_2 b_2 c_2
:
a_M b_M c_M
Q
S_1 T_1
S_2 T_2
:
S_Q T_Q





OutputPrint Q lines. The i-th line should contain the minimum possible total weight of the edges chosen by Takahashi.






Sample Input 14 3
1 2 3
2 3 4
3 4 5
2
2 3
1 4





Sample Output 18
7

We will examine each round:

In the 1-st round, choosing edges 1 and 3 achieves the minimum total weight of 8.
In the 2-nd round, choosing edges 1 and 2 achieves the minimum total weight of 7.






Sample Input 24 6
1 3 5
4 1 10
2 4 6
3 2 2
3 4 5
2 1 3
1
2 3





Sample Output 28

This input satisfies the additional constraints for both partial scores.

",Graph,"Minimum Spanning Tree, Disjoint Set, Depth-first Search, Precomputation, Tree, Offline Queries",0.0,2,1
1272,"
Score : 600 points


Problem StatementGiven are a prime number p and a sequence of p integers a_0, \ldots, a_{p-1} consisting of zeros and ones.
Find a polynomial of degree at most p-1, f(x) = b_{p-1} x^{p-1} + b_{p-2} x^{p-2} + \ldots + b_0, satisfying the following conditions:

For each i (0 \leq i \leq p-1), b_i is an integer such that 0 \leq b_i \leq p-1.
For each i (0 \leq i \leq p-1), f(i) \equiv a_i \pmod p.





Constraints
2 \leq p \leq 2999
p is a prime number.
0 \leq a_i \leq 1







InputInput is given from Standard Input in the following format:
p
a_0 a_1 \ldots a_{p-1}





OutputPrint b_0, b_1, \ldots, b_{p-1} of a polynomial f(x) satisfying the conditions, in this order, with spaces in between.
It can be proved that a solution always exists. If multiple solutions exist, any of them will be accepted.






Sample Input 12
1 0





Sample Output 11 1

f(x) = x + 1 satisfies the conditions, as follows:

f(0) = 0 + 1 = 1 \equiv 1 \pmod 2
f(1) = 1 + 1 = 2 \equiv 0 \pmod 2






Sample Input 23
0 0 0





Sample Output 20 0 0

f(x) = 0 is also valid.





Sample Input 35
0 1 0 1 0





Sample Output 30 2 0 1 3


",Polynomial Construction,"Arithmetic, Mathematics, Modular Multiplicative Inverse, Fast Fourier Transform, Divide And Conquer",0.5,9,4
1273,"
Score : 500 points


Problem StatementThere are 2N squares arranged from left to right. You are given a string of length 2N representing the color of each of the squares.
The color of the i-th square from the left is black if the i-th character of S is B, and white if that character is W.
You will perform the following operation exactly N times: choose two distinct squares, then invert the colors of these squares and the squares between them. Here, to invert the color of a square is to make it white if it is black, and vice versa.  
Throughout this process, you cannot choose the same square twice or more. That is, each square has to be chosen exactly once.
Find the number of ways to make all the squares white at the end of the process, modulo 10^9+7.
Two ways to make the squares white are considered different if and only if there exists i (1 \leq i \leq N) such that the pair of the squares chosen in the i-th operation is different.




Constraints
1 \leq N \leq 10^5
|S| = 2N
Each character of S is B or W.







InputInput is given from Standard Input in the following format:
N
S





OutputPrint the number of ways to make all the squares white at the end of the process, modulo 10^9+7. If there are no such ways, print 0.






Sample Input 12
BWWB





Sample Output 14

There are four ways to make all the squares white, as follows:

Choose Squares 1, 3 in the first operation, and choose Squares 2, 4 in the second operation.
Choose Squares 2, 4 in the first operation, and choose Squares 1, 3 in the second operation.
Choose Squares 1, 4 in the first operation, and choose Squares 2, 3 in the second operation.
Choose Squares 2, 3 in the first operation, and choose Squares 1, 4 in the second operation.






Sample Input 24
BWBBWWWB





Sample Output 2288






Sample Input 35
WWWWWWWWWW





Sample Output 30


",Cell Inversion,"Bitmask, Stack, Combinatorics, Arithmetic, Dynamic Programming",0.2,10,5
1274,"
Score : 700 points


Problem StatementYou are given a string S consisting of a,b and c. Find the number of strings that can be possibly obtained by repeatedly performing the following operation zero or more times, modulo 998244353:

Choose an integer i such that 1\leq i\leq |S|-1 and the i-th and (i+1)-th characters in S are different. Replace each of the i-th and (i+1)-th characters in S with the character that differs from both of them (among a, b and c).





Constraints
2 \leq |S| \leq 2 × 10^5
S consists of a, b and c.







InputInput is given from Standard Input in the following format:
S





OutputPrint the number of strings that can be possibly obtained by repeatedly performing the operation, modulo 998244353.






Sample Input 1abc





Sample Output 13

abc, aaa and ccc can be obtained.





Sample Input 2abbac





Sample Output 265






Sample Input 3babacabac





Sample Output 36310






Sample Input 4ababacbcacbacacbcbbcbbacbaccacbacbacba





Sample Output 4148010497


",Normalization,"Dyanmic Programming, String, Arithmetic, Exponentiation By Squaring, Bitmask, Combinatorics",0.5,3,2
1275,"
Score : 800 points


Problem StatementThere are N cards placed on a grid with H rows and W columns of squares.
The i-th card has an integer A_i written on it, and it is placed on the square at the R_i-th row from the top and the C_i-th column from the left.
Multiple cards may be placed on the same square.
You will first pick up at most one card from each row.
Then, you will pick up at most one card from each column.
Find the maximum possible sum of the integers written on the picked cards.




Constraints
All values are integers.
1 \leq N \leq 10^5
1 \leq H, W \leq 10^5
1 \leq A_i \leq 10^5
1 \leq R_i \leq H
1 \leq C_i \leq W







InputInput is given from Standard Input in the following format:
N H W
R_1 C_1 A_1
R_2 C_2 A_2
\vdots
R_N C_N A_N





OutputPrint the maximum possible sum of the integers written on the picked cards.






Sample Input 16 2 2
2 2 2
1 1 8
1 1 5
1 2 9
1 2 7
2 1 4





Sample Output 128

The sum of the integers written on the picked cards will be 28, the maximum value possible, if you pick up cards as follows:

Pick up the fourth card from the first row.
Pick up the sixth card from the second row.
Pick up the second card from the first column.
Pick up the fifth card from the second column.






Sample Input 213 5 6
1 3 35902
4 6 19698
4 6 73389
3 6 3031
3 1 4771
1 4 4784
2 1 36357
2 1 24830
5 6 50219
4 6 22645
1 2 30739
1 4 68417
1 5 78537





Sample Output 2430590






Sample Input 31 100000 100000
1 1 1





Sample Output 31


",Card Collector,"Sorting, Greedy Algorithm, Bipartite Graph, Disjoint Set",0.5,4,1
1276,"
Score : 100 points


Problem StatementIn an electric circuit, when two resistors R_1 and R_2 are connected in parallel, the equivalent resistance R_3 can be derived from the following formula:

\frac{1}{R_1} + \frac{1}{R_2} = \frac{1}{R_3}

Given R_1 and R_2, find R_3.




Constraints
1 \leq R_1, R_2 \leq 100
R_1 and R_2 are integers.







InputThe input is given from Standard Input in the following format:
R_1 R_2





OutputPrint the value of R_3.
The output is considered correct if the absolute or relative error is at most 10^{-6}.






Sample Input 12 3





Sample Output 11.2000000000






Sample Input 2100 99





Sample Output 249.7487437186


",Equivalent Resistance,"Arithmetic, Mathematics",0.7,14,9
1277,"
Score : 100 points


Problem StatementYou are given a string S consisting of letters b, d, p and q.
Determine whether S is a mirror string.
Here, a mirror string is a string S such that the following sequence of operations on S results in the same string S:


Reverse the order of the characters in S.


Replace each occurrence of b by d, d by b, p by q, and q by p, simultaneously.






Constraints
1 \leq |S| \leq 10^5
S consists of letters b, d, p, and q.







InputThe input is given from Standard Input in the following format:
S





OutputIf S is a mirror string, print Yes. Otherwise, print No.






Sample Input 1pdbq





Sample Output 1Yes






Sample Input 2ppqb





Sample Output 2No


",Mirror String,"String, Implementation",0.8,12,10
1278,"
Score : 100 points


Problem StatementKode Festival is an anual contest where the hardest stone in the world is determined. (Kode is a Japanese word for ""hardness"".)
This year, 2^N stones participated. The hardness of the i-th stone is A_i.
In the contest, stones are thrown at each other in a knockout tournament.
When two stones with hardness X and Y are thrown at each other, the following will happen:


When X > Y:
  The stone with hardness Y will be destroyed and eliminated.
  The hardness of the stone with hardness X will become X-Y.


When X = Y:
  One of the stones will be destroyed and eliminated.
  The hardness of the other stone will remain the same.


When X < Y:
  The stone with hardness X will be destroyed and eliminated.
  The hardness of the stone with hardness Y will become Y-X.


The 2^N stones will fight in a knockout tournament as follows:


The following pairs will fight: (the 1-st stone versus the 2-nd stone), (the 3-rd stone versus the 4-th stone), ...


The following pairs will fight: (the winner of (1-st versus 2-nd) versus the winner of (3-rd versus 4-th)), (the winner of (5-th versus 6-th) versus the winner of (7-th versus 8-th)), ...


And so forth, until there is only one stone remaining.


Determine the eventual hardness of the last stone remaining.




Constraints
1 \leq N \leq 18
1 \leq A_i \leq 10^9
A_i is an integer.







InputThe input is given from Standard Input in the following format:
N
A_1
A_2
:
A_{2^N}





OutputPrint the eventual hardness of the last stone remaining.






Sample Input 12
1
3
10
19





Sample Output 17






Sample Input 23
1
3
2
4
6
8
100
104





Sample Output 22


",Kode Festival,"Bitmask, Simulation, Divide And Conquer, Array, Bruteforcing, Arithmetic",0.667,8,6
1279,"
Score : 100 points


Problem StatementA 3×3 grid with a integer written in each square, is called a magic square if and only if the integers in each row, the integers in each column, and the integers in each diagonal (from the top left corner to the bottom right corner, and from the top right corner to the bottom left corner), all add up to the same sum.
You are given the integers written in the following three squares in a magic square:

The integer A at the upper row and left column
The integer B at the upper row and middle column
The integer C at the middle row and middle column

Determine the integers written in the remaining squares in the magic square.
It can be shown that there exists a unique magic square consistent with the given information.




Constraints
0 \leq A, B, C \leq 100







InputThe input is given from Standard Input in the following format:
A
B
C





OutputOutput the integers written in the magic square, in the following format:
X_{1,1} X_{1,2} X_{1,3}
X_{2,1} X_{2,2} X_{2,3}
X_{3,1} X_{3,2} X_{3,3}

where X_{i,j} is the integer written in the square at the i-th row and j-th column.






Sample Input 18
3
5





Sample Output 18 3 4
1 5 9
6 7 2






Sample Input 21
1
1





Sample Output 21 1 1
1 1 1
1 1 1


",Magic Square 2,"Mathematics, Matrix, Arithmetic",0.8,6,5
1280,"
Score : 100 points


Problem StatementTakahashi is drawing a segment on grid paper.
From a certain square, a square that is x squares to the right and y squares above, is denoted as square (x, y).
When Takahashi draws a segment connecting the lower left corner of square (A, B) and the lower left corner of square (C, D), find the number of the squares crossed by the segment.
Here, the segment is said to cross a square if the segment has non-empty intersection with the region within the square, excluding the boundary.




Constraints
1 \leq A, B, C, D \leq 10^9
At least one of A \neq C and B \neq D holds.







InputThe input is given from Standard Input in the following format:
A B C D





OutputPrint the number of the squares crossed by the segment.






Sample Input 11 1 3 4





Sample Output 14






Sample Input 22 3 10 7





Sample Output 28


",Segment on Grid Paper,"Euclidean Algorithm, Number Theory, Geometry; 3d, Arithmetic",0.429,14,5
1281,"
Score : 100 points


Problem StatementThere are N persons, conveniently numbered 1 through N. They will take 3y3s Challenge for N-1 seconds.
During the challenge, each person must look at each of the N-1 other persons for 1 seconds, in some order.
If any two persons look at each other during the challenge, the challenge ends in failure.
Find the order in which each person looks at each of the N-1 other persons, to be successful in the challenge.




Constraints
2 \leq N \leq 100







InputThe input is given from Standard Input in the following format:
N





OutputIf there exists no way to be successful in the challenge, print -1.
If there exists a way to be successful in the challenge, print any such way in the following format:
A_{1,1} A_{1,2} ... A_{1, N-1}
A_{2,1} A_{2,2} ... A_{2, N-1}
:
A_{N,1} A_{N,2} ... A_{N, N-1}

where A_{i, j} is the index of the person that the person numbered i looks at during the j-th second.




JudgingThe output is considered correct only if all of the following conditions are satisfied:

1 \leq A_{i,j} \leq N
For each i, A_{i,1}, A_{i,2}, ... , A_{i, N-1} are pairwise distinct.
Let X = A_{i, j}, then A_{X, j} \neq i always holds.







Sample Input 17





Sample Output 12 3 4 5 6 7
5 3 1 6 4 7
2 7 4 1 5 6
2 1 7 5 3 6
1 4 3 7 6 2
2 5 7 3 4 1
2 6 1 4 5 3






Sample Input 22





Sample Output 2-1


",3y3s Challenge,"Arithmetic, Matrix, Implementation, Enumeration, Greedy Algorithm",1.0,3,3
1282,"
Score : 100 points


Problem StatementTakahashi recorded his daily life for the last few days as a integer sequence of length 2N, as follows:

a_1, b_1, a_2, b_2, ... , a_N, b_N

This means that, starting from a certain time T, he was:

sleeping for exactly a_1 seconds
then awake for exactly b_1 seconds
then sleeping for exactly a_2 seconds
:
then sleeping for exactly a_N seconds
then awake for exactly b_N seconds

In this record, he waked up N times.
Takahashi is wondering how many times he waked up early during the recorded period.
Here, he is said to wake up early if he wakes up between 4:00 AM and 7:00 AM, inclusive.
If he wakes up more than once during this period, each of these awakenings is counted as waking up early.
Unfortunately, he forgot the time T.
Find the maximum possible number of times he waked up early during the recorded period.
For your information, a day consists of 86400 seconds, and the length of the period between 4:00 AM and 7:00 AM is 10800 seconds.




Constraints
1 \leq N \leq 10^5
1 \leq a_i, b_i \leq 10^5
a_i and b_i are integers.







InputThe input is given from Standard Input in the following format:
N
a_1 b_1
a_2 b_2
:
a_N b_N





OutputPrint the maximum possible number of times he waked up early during the recorded period.






Sample Input 13
28800 57600
28800 57600
57600 28800





Sample Output 12






Sample Input 210
28800 57600
4800 9600
6000 1200
600 600
300 600
5400 600
6000 5760
6760 2880
6000 12000
9000 600





Sample Output 25


",Early Bird,"Arithmetic, Counting, Prefix sum, Sliding Window, Array",0.0,7,3
1283,"
Score : 500 points


Problem Statement
A cheetah and a cheater are going to play the game of Nim.
In this game they use N piles of stones.
Initially the i-th pile contains a_i stones.
The players take turns alternately, and the cheetah plays first.
In each turn, the player chooses one of the piles, and takes one or more stones from the pile.
The player who can't make a move loses.
However, before the game starts, the cheater wants to cheat a bit to make sure that he can win regardless of the moves by the cheetah.
From each pile, the cheater takes zero or one stone and eats it before the game.
In case there are multiple ways to guarantee his winning, he wants to minimize the number of stones he eats.
Compute the number of stones the cheater will eat.
In case there is no way for the cheater to win the game even with the cheating, print -1 instead.




Constraints
1 ≤ N ≤ 10^5
2 ≤ a_i ≤ 10^9







InputThe input is given from Standard Input in the following format:
N
a_1
:
a_N





OutputPrint the answer.






Sample Input 13
2
3
4





Sample Output 13

The only way for the cheater to win the game is to take stones from all piles and eat them.





Sample Input 23
100
100
100





Sample Output 2-1


",Cheating Nim,"Bitmask, Boolean Operations On Geometric Objects, Greedy Algorithm",1.0,3,3
1284,"

				Max Score: 500 Points 

Problem Statement
					We have a grid with n rows and 7 columns. We call it a calendar. The cell at i-th row and j-th column is denoted (i, j). 



					Initially, each cell at (i, j) contains the integer 7i + j - 8, and each cell is white. 

					Snuke likes painting, so he decided integer m, and did q operations with a calendar. 
					・In i-th operation, he paint black on the cell in which an integer is written such remainder of dividing by m is a_i. 

					Please count the number of connected white parts. 
					Note that if two adjacent cells are white, the cells belong to the same connected part. 





Input Format
						The input format is following:

n m q
a_1 a_2 ... a_q





Output Format
						Print the number of connected part in one line.


Constraints

n ≤ 10^{12}
7n is divisible by m.
1 ≤ q ≤ m ≤ 10^5
0 ≤ a_1 < a_2 < ... < a_q < m



Scoring
						Subtask 1 [100 points] 

n ≤ 100000.

						Subtask 2 [90 points] 

m is divisible by 7.
a_{i + 1} - a_i = 1.

						Subtask 3 [200 points] 

m is divisible by 7.

						Subtask 4 [110 points] 

There are no additional constraints.





Sample Input 1

7 7 3
1 3 5





Sample Output 1

4

						The calendar looks like this: 








Sample Input 2

10 14 8
5 6 7 8 9 10 11 12





Sample Output 2

10

						The calendar looks like this: 






",Calendar 2,"Arithmetic, Grid Graph, Graph Theory, Graph Traversal, Disjoint Set, Mathematics",0.0,8,2
1285,"
Score : 500 points


Problem Statement
There are N computers and N sockets in a one-dimensional world.
The coordinate of the i-th computer is a_i, and the coordinate of the i-th socket is b_i.
It is guaranteed that these 2N coordinates are pairwise distinct.
Snuke wants to connect each computer to a socket using a cable.
Each socket can be connected to only one computer.
In how many ways can he minimize the total length of the cables?
Compute the answer modulo 10^9+7.




Constraints
1 ≤ N ≤ 10^5
0 ≤ a_i, b_i ≤ 10^9
The coordinates are integers.
The coordinates are pairwise distinct.







InputThe input is given from Standard Input in the following format:
N
a_1
:
a_N
b_1
:
b_N





OutputPrint the number of ways to minimize the total length of the cables, modulo 10^9+7.






Sample Input 12
0
10
20
30





Sample Output 12

There are two optimal connections: 0-20, 10-30 and 0-30, 10-20.
In both connections the total length of the cables is 40.





Sample Input 23
3
10
8
7
12
5





Sample Output 21


",1D Matching,"Sorting, Two-pointer, Greedy Algorithm, Combinatorics, Arithmetic",1.0,2,2
1286,"
Score : 1000 points


Problem StatementYou are given a string S consisting of digits between 1 and 9, inclusive.
You will insert at most K commas (,) into this string to separate it into multiple numbers.
Your task is to minimize the maximum number among those produced by inserting commas. Find minimum possible such value.




Constraints
0 ≦ K < |S| ≦ 100,000
S consists of digits between 1 and 9, inclusive.





Partial Scores
In the test set worth 100 points, |S| ≦ 2.
In the test set worth another 100 points, |S| ≦ 16.
In the test set worth another 200 points, |S| ≦ 100.
In the test set worth another 200 points, |S| ≦ 2,000.







InputThe input is given from Standard Input in the following format:
K
S





OutputPrint the minimum possible value.






Sample Input 12
15267315





Sample Output 1315

When the string is separated into 152, 67 and 315, the maximum among these is 315, which is the minimum possible value.





Sample Input 20
12456174517653111





Sample Output 212456174517653111

12456174517653111 itself is the answer.





Sample Input 38
127356176351764127645176543176531763517635176531278461856198765816581726586715987216581





Sample Output 35317635176


",Problem where Commas Separate Digits,"Binary Search, Greedy Algorithm, String, Suffix Array And Lcp Array, Two-pointer",0.0,7,1
1287,"
Score : 600 points


Problem StatementYou are given N integers. The i-th integer is a_i.
Find the number, modulo 998244353, of ways to paint each of the integers red, green or blue so that the following condition is satisfied:

Let R, G and B be the sums of the integers painted red, green and blue, respectively. There exists a triangle with positive area whose sides have lengths R, G and B.





Constraints
3 \leq N \leq 300
1 \leq a_i \leq 300(1\leq i\leq N)
All values in input are integers.







InputInput is given from Standard Input in the following format:
N
a_1
:
a_N





OutputPrint the number, modulo 998244353, of ways to paint each of the integers red, green or blue so that the condition is satisfied.






Sample Input 14
1
1
1
2





Sample Output 118

We can only paint the integers so that the lengths of the sides of the triangle will be 1, 2 and 2, and there are 18 such ways.





Sample Input 26
1
3
2
3
5
2





Sample Output 2150






Sample Input 320
3
1
4
1
5
9
2
6
5
3
5
8
9
7
9
3
2
3
8
4





Sample Output 3563038556


",Three Colors,"Dyanmic Programming, Inclusion And Exclusion, Arithmetic, Exponentiation By Squaring, Combinatorics, Bitmask",0.0,4,1
1288,"
Score: 600 points


Problem Statement
We have N non-negative integers: A_1, A_2, ..., A_N.
Consider painting at least one and at most N-1 integers among them in red, and painting the rest in blue.
Let the beauty of the painting be the \mbox{XOR} of the integers painted in red, plus the \mbox{XOR} of the integers painted in blue.
Find the maximum possible beauty of the painting.

What is \mbox{XOR}?

The bitwise \mbox{XOR} x_1 \oplus x_2 \oplus \ldots \oplus x_n of n non-negative integers x_1, x_2, \ldots, x_n is defined as follows:

 When x_1 \oplus x_2 \oplus \ldots \oplus x_n is written in base two, the digit in the 2^k's place (k \geq 0) is 1 if the number of integers among x_1, x_2, \ldots, x_n whose binary representations have 1 in the 2^k's place is odd, and 0 if that count is even. 

For example, 3 \oplus 5 = 6.






Constraints

All values in input are integers.
2 \leq N \leq 10^5
0 \leq A_i < 2^{60}\ (1 \leq i \leq N)







Input
Input is given from Standard Input in the following format:
N
A_1 A_2 ... A_N





Output
Print the maximum possible beauty of the painting.






Sample Input 13
3 6 5





Sample Output 112

If we paint 3, 6, 5 in blue, red, blue, respectively, the beauty will be (6) + (3 \oplus 5) = 12.
There is no way to paint the integers resulting in greater beauty than 12, so the answer is 12.





Sample Input 24
23 36 66 65





Sample Output 2188






Sample Input 320
1008288677408720767 539403903321871999 1044301017184589821 215886900497862655 504277496111605629 972104334925272829 792625803473366909 972333547668684797 467386965442856573 755861732751878143 1151846447448561405 467257771752201853 683930041385277311 432010719984459389 319104378117934975 611451291444233983 647509226592964607 251832107792119421 827811265410084479 864032478037725181





Sample Output 32012721721873704572

A_i and the answer may not fit into a 32-bit integer type.

",Xor Sum 3,"Bitmask, Xor Basis (gf(2))",0.5,13,6
1289,"
Score : 600 points


Problem StatementGiven are integers L and R. Find the number, modulo 10^9 + 7, of pairs of integers (x, y) (L \leq x \leq y \leq R) such that the remainder when y is divided by x is equal to y \mbox{ XOR } x.

What is \mbox{ XOR }?

The XOR of integers A and B, A \mbox{ XOR } B, is defined as follows:

When A \mbox{ XOR } B is written in base two, the digit in the 2^k's place (k \geq 0) is 1 if either A or B, but not both, has 1 in the 2^k's place, and 0 otherwise.

For example, 3 \mbox{ XOR } 5 = 6. (In base two: 011 \mbox{ XOR } 101 = 110.)






Constraints
1 \leq L \leq R \leq 10^{18}







InputInput is given from Standard Input in the following format:
L R





OutputPrint the number of pairs of integers (x, y) (L \leq x \leq y \leq R) satisfying the condition, modulo 10^9 + 7.






Sample Input 12 3





Sample Output 13

Three pairs satisfy the condition: (2, 2), (2, 3), and (3, 3).





Sample Input 210 100





Sample Output 2604






Sample Input 31 1000000000000000000





Sample Output 368038601

Be sure to compute the number modulo 10^9 + 7.

",Coincidence,"Bitmask, Digit Dp, Arithmetic, Dyanmic Programming",0.2,11,1
1290,"
Score : 900 points


Problem StatementAlice lives on a line. Today, she will travel to some place in a mysterious vehicle.
Initially, the distance between Alice and her destination is D. When she input a number x to the vehicle, it will travel in the direction of the destination by a distance of x if this move would shorten the distance between the vehicle and the destination, and it will stay at its position otherwise. Note that the vehicle may go past the destination when the distance between the vehicle and the destination is less than x.
Alice made a list of N numbers. The i-th number in this list is d_i. She will insert these numbers to the vehicle one by one.
However, a mischievous witch appeared. She is thinking of rewriting one number in the list so that Alice will not reach the destination after N moves.
She has Q plans to do this, as follows:

Rewrite only the q_i-th number in the list with some integer so that Alice will not reach the destination.

Write a program to determine whether each plan is feasible.




Constraints
1≤ N ≤ 5*10^5
1≤ Q ≤ 5*10^5
1≤ D ≤ 10^9
1≤ d_i ≤ 10^9(1≤i≤N)
1≤ q_i ≤ N(1≤i≤Q)
D and each d_i are integers.







InputInput is given from Standard Input in the following format:
N D
d_1 d_2 ... d_N
Q
q_1 q_2 ... q_Q





OutputPrint Q lines. The i-th line should contain YES if the i-th plan is feasible, and NO otherwise.






Sample Input 14 10
3 4 3 3
2
4 3





Sample Output 1NO
YES

For the first plan, Alice will already arrive at the destination by the first three moves, and therefore the answer is NO.
For the second plan, rewriting the third number in the list with 5 will prevent Alice from reaching the destination as shown in the following figure, and thus the answer is YES.






Sample Input 25 9
4 4 2 3 2
5
1 4 2 3 5





Sample Output 2YES
YES
YES
YES
YES

Alice will not reach the destination as it is, and therefore all the plans are feasible.





Sample Input 36 15
4 3 5 4 2 1
6
1 2 3 4 5 6





Sample Output 3NO
NO
YES
NO
NO
YES


",Alice in linear land,"Prefix sum, Greedy Algorithm, Simulation, Binary Search, Offline Queries",0.0,1,0
1291,"
Score : 1400 points


Problem StatementSnuke got an integer sequence from his mother, as a birthday present. The sequence has N elements, and the i-th of them is i.
Snuke performs the following Q operations on this sequence. The i-th operation, described by a parameter q_i, is as follows:

Take the first q_i elements from the sequence obtained by concatenating infinitely many copy of the current sequence, then replace the current sequence with those q_i elements.

After these Q operations, find how many times each of the integers 1 through N appears in the final sequence.




Constraints
1 ≦ N ≦ 10^5
0 ≦ Q ≦ 10^5
1 ≦ q_i ≦ 10^{18}
All input values are integers.







InputThe input is given from Standard Input in the following format:
N Q
q_1
:
q_Q





OutputPrint N lines. The i-th line (1 ≦ i ≦ N) should contain the number of times integer i appears in the final sequence after the Q operations.






Sample Input 15 3
6
4
11





Sample Output 13
3
3
2
0

After the first operation, the sequence becomes: 1,2,3,4,5,1.
After the second operation, the sequence becomes: 1,2,3,4.
After the third operation, the sequence becomes: 1,2,3,4,1,2,3,4,1,2,3.
In this sequence, integers 1,2,3,4,5 appear 3,3,3,2,0 times, respectively.





Sample Input 210 10
9
13
18
8
10
10
9
19
22
27





Sample Output 27
4
4
3
3
2
2
2
0
0


",Sequential operations on Sequence,"Greedy Algorithm, Arithmetic, Priority Queue, Array, Counting",0.0,4,1
1292,"
Score : 1000 points


Problem StatementThere are N towns in Takahashi Kingdom. They are conveniently numbered 1 through N.
Takahashi the king is planning to go on a tour of inspection for M days. He will determine a sequence of towns c, and visit town c_i on the i-th day. That is, on the i-th day, he will travel from his current location to town c_i. If he is already at town c_i, he will stay at that town. His location just before the beginning of the tour is town 1, the capital. The tour ends at town c_M, without getting back to the capital. 
The problem is that there is no paved road in this kingdom. He decided to resolve this issue by paving the road himself while traveling. When he travels from town a to town b, there will be a newly paved one-way road from town a to town b.
Since he cares for his people, he wants the following condition to be satisfied after his tour is over: ""it is possible to travel from any town to any other town by traversing roads paved by him"". How many sequences of towns c satisfy this condition?




Constraints
2≦N≦300
1≦M≦300







InputThe input is given from Standard Input in the following format:
N M





OutputPrint the number of sequences of towns satisfying the condition, modulo 1000000007 (=10^9+7).






Sample Input 13 3





Sample Output 12

As shown below, the condition is satisfied only when c = (2,3,1) or c = (3,2,1). Sequences such as c = (2,3,2), c = (2,1,3), c = (1,2,2) do not satisfy the condition.






Sample Input 2150 300





Sample Output 2734286322






Sample Input 3300 150





Sample Output 30


",Road of the King,"Dyanmic Programming, Strongly Connected Component, Arithmetic, Combinatorics",0.0,3,1
1293,"


					Max Score: $400$ Points
					
Problem Statement
Sample testcase 3 has a mistake, so we erased this case and rejudged all solutions of this problem. (21:01)
						Snuke got a sequence $a$ of length $n$ from AtCoder company. All elements in $a$ are distinct.
						He made a sequence $b$, but actually, he is not remembered it. 
						However, he is remembered a few things about sequence $b$. 

All elements in $b$ are distinct. 
All elements in $b$ is in $a$.
$b_1 \oplus b_2 \oplus \cdots \oplus b_r = k$. ($r$ is length of sequence $b$) [$\oplus$ means XOR]


						For example, if $a = { 1, 2, 3 }$ and $k = 1$, he can make $b = { 1 }, { 2, 3 }, { 3, 2 }$. 
						He wants to restore sequence $b$, but he says that there are too many ways and he can't restore it.
						Please calculate the ways to make $b$ and help him. 
						Since the answer can be large, print the answer modulo $1,000,000,007$. 







Input
						The input is given from Standard Input in the following format:
$n \ k$
$a_1 \ a_2 \ \cdots \ a_n$





Output

Print the number of ways to make sequence $b$. 
Print the answer modulo $1,000,000,007$. 



Constraints

$1 \le n \le 100$
$1 \le a_i, k \le 255$
$i \neq j \Rightarrow a_i \neq a_j$



Subtasks
						Subtask 1 [ $50$ points ] 

$1 \le n \le 4$

						Subtask 2 [ $170$ points ] 

$1 \le n \le 20$

						Subtask 3 [ $180$ points ] 

There are no additional constraints.






Sample Input 1

3 1
1 2 3





Sample Output 1

3

					You can make 3 patterns: $b = \{ 1 \}, \{ 2, 3 \}, \{ 3, 2 \}$




Sample Input 2

3 10
8 7 5





Sample Output 2

6

					You can make 6 patterns: $b = \{ 5, 7, 8 \}, \{ 5, 8, 7 \}, \{ 7, 5, 8 \}, \{ 7, 8, 5 \}, \{ 8, 5, 7 \}, \{ 8, 7, 5 \}$.




Sample Input 4

25 127
5 10 15 20 25 30 35 40 45 50 55 60 65 70 75 80 85 90 95 100 105 110 115 120 125





Sample Output 4

235924722

Please output answer mod $1,000,000,007$.


				writer: E869120 

",Solving XOR-Puzzles,"Dyanmic Programming, Bitmask, Combinatorics, Arithmetic, Precomputation",1.0,2,2
1294,"

				Max Score: $600$ Points 

Problem Statement
					Sigma and his brother Sugim are in the $H \times W$ grid. They wants to buy some souvenirs. 
					Their start position is upper-left cell, and the goal position is lower-right cell. 
					Some cells has a souvenir shop. At $i$-th row and $j$-th column, there is $a_{i, j}$ souvenirs. 
					In one move, they can go left, right, down, and up cell. 
					But they have little time, so they can move only $H+W-2$ times. 
					They wanted to buy souvenirs as many as possible, but they had no computer, so they couldn't get the maximal numbers of souvenirs. 
					Write a program and calculate the maximum souvenirs they can get, and help them. 





Input
						The input is given from standard input in the following format. 
$H \ W$
$a_{1, 1} \ a_{1, 2} \ \cdots \ a_{1, W}$
$a_{2, 1} \ a_{2, 2} \ \cdots \ a_{2, W}$
$\vdots \ \ \ \ \ \ \ \ \ \ \vdots \ \ \ \ \ \ \ \ \ \ \vdots$
$a_{H, 1} \ a_{H, 2} \ \cdots \ a_{H, W}$





Output

Print the maximum number of souvenirs they can get.



Constraints

$1 \le H, W \le 200$
$0 \le a_{i, j} \le 10^5$



Subtasks
						Subtask 1 [ 50 points ] 

The testcase in the subtask satisfies $1 \le H \le 2$.

						Subtask 2 [ 80 points ] 

The testcase in the subtask satisfies $1 \le H \le 3$.

						Subtask 3 [ 120 points ] 

The testcase in the subtask satisfies $1 \le H, W \le 7$.

						Subtask 4 [ 150 points ] 

The testcase in the subtask satisfies $1 \le H, W \le 30$.

						Subtask 5 [ 200 points ] 

There are no additional constraints.






Sample Input 1

3 3
1 0 5
2 2 3
4 2 4





Sample Output 1

21

					The cell at $i$-th row and $j$-th column is denoted $(i, j)$. 
					In this case, one of the optimal solution is this:

Sigma moves $(1, 1) -> (1, 2) -> (1, 3) -> (2, 3) -> (3, 3)$.
Sugim moves $(1, 1) -> (2, 1) -> (3, 1) -> (3, 2) -> (3, 3)$.

					Then, they can get $21$ souvernirs. 




Sample Input 2

6 6
1 2 3 4 5 6
8 6 9 1 2 0
3 1 4 1 5 9
2 6 5 3 5 8
1 4 1 4 2 1
2 7 1 8 2 8





Sample Output 2

97




			Writer : square1001
",Souvenirs,"Dyanmic Programming, Bitmask, Grid Graph, Counting",0.333,6,2
1295,"
Score : 150 points




Problem Statement

            Gorillas in Kyoto University are good at math.
            They are currently trying to solve problems to find the value of an expression that contains two functions, _ , ^.
            Each of these functions takes two input values. _ function returns the smaller of the two input values and ^ function returns the larger.
            Gorillas know that integers in the expression are non-negative and less than or equal to 99,
            but can not find out the length of the expression until they read a terminal symbol ? that represents the end of the expression. The number of characters included in each expression is less than or equal to 1000, but they do not even know this fact.
            Ai, a smart gorilla, noticed that she may be able to know the value of the expression even if they don't read the whole expression.
          

            For example,
          
Assume you read the following sentence from the left.
^(41,3)?
When you read the sixth character, that is, when you read the following expression,
^(41,3
you can tell the second input value of the funcion is whether 3 or an integer between 30 and 39, and the value turns out 41. 

            Since Ai wants to solve problems earlier than other gorillas, she decided to solve the problems such that she reads as fewer characters as possible from the left.
            For each expression, Find the value of the expression and the minimum number of characters Ai needs to read to know the value.
          




Constraints

1 \leq Q \leq 200
The number of characters each expression contains is less than or equal to 1000. 







Input
The input consists of multiple test cases and is given from Standard Input in the following format:

Q
statement_1
...
statement_Q




Each statement_i (1 \leq i \leq Q) is given in the following BNF format.

<statement> ::= <expression> ?
<expression> ::= (^ | _)  ( <expression> , <expression> ) | <number> 
<number> :: = 0 | 1 | 2 | ... | 98 | 99




Output

              Output consists of Q lines.
              On line i (1 \leq i \leq Q), print the value of the expression and the number of character Ai needs to read for the test case i separated by space.
            






Sample Input 1

4
_(4,51)?
^(99,_(3,67))?
_(0,87)?
3?





Sample Output 1

4 5
99 4
0 3
3 2


For the first test case, when you read the fifth character, that is, when you read _(4,5, you will know the value is 4. 
For the second test case, when you read the fourth character, that is, when you read ^(99, you will know the value is 99. 
For the third test case, when you read the third character, that is, when you read _(0, you will know the value is 0. 
For the fourth test case, you will not know the value is 3 untill you read the terminal symbol.





Sample Input 2

7
_(23,^(_(22,40),4))?
_(0,99)?
^(99,_(^(19,2),5))?
_(^(43,20),^(30,29))?
^(_(20,3),_(50,41))?
^(_(20,3),_(3,41))?
^(_(20,3),_(4,41))?





Sample Output 2

22 18
0 3
99 4
30 17
41 17
3 14
4 15




",Speed Solving,"Parsing, Tree, Depth-first Search, Difference Array, Dynamic Programming, Backtracking",1.0,2,2
1296,"


					Max Score: $1200$ Points 

Problem statement
						There are $N$ customers in a restaurant. Each customer is numbered $1$ through $N$. 
						A sushi chef carried out $Q$ operations for customers. 

						The $i$-th operation is follows: 

The sushi chef chooses a customer whose number of dishes of sushi eaten is minimum, in customer $1, 2, 3, \dots, a_i$. If there are multiple customers who are minimum numbers of dishes, he selects the minimum-numbered customers. 
He puts a dish of sushi on the selected seats.
A customer who have selected for professional eats this sushi.
Repeat 1-3, $b_i$ times.


						Please calculate the number of dishes of sushi that have been eaten by each customer.






Input
							The input is given from Standard Input in the following format: 
$N \ Q$
$a_1 \ b_1$
$a_2 \ b_2$
$ ：  \ ： $
$a_Q \ b_Q$





Output

You have to print $N$ lines.
The $i$-th line should contain the number of dishes of sushi had eaten for customer $i (1 \le i \le N)$.



Constraints

$3 \le N, Q \le 100,000$
$1 \le a_i \le N$
$1 \le b_i \le 10^{12}$
Any final results do not exceed $2 \times 10^{13}$.



Subtasks
							Subtask 1 [ $60$ points ] 

$N, Q \le 100$
$b_i = 1$

							Subtask 2 [ $400$ points ] 

$N, Q \le 100$
$b_i \le 10^{12}$

							Subtask 3 [ $240$ points ] 

$N, Q \le 100,000$
$b_i = 1$

							Subtask 4 [ $500$ points ] 

There are no additional constraints.






Sample Input 1

9 3
5 11
8 4
4 7





Sample Output 1

4
4
4
4
2
2
1
1
0

						The change of the number of dishes of sushi have eaten is following: 




Customer 1
Customer 2
Customer 3
Customer 4
Customer 5
Customer 6
Customer 7
Customer 8
Customer 9


1st Operation
3 2 2 2 2 0 0 0 0


2nd Operation
3 2 2 2 2 2 1 1 0


3rd Operation
4 4 4 4 2 2 1 1 0







Sample Input 2

6 6
3 5
6 11
1 6
4 7
5 2
2 5





Sample Output 2

10
10
5
5
4
2





Sample Input 3

5 6
1 1
2 1
3 1
1 1
5 1
3 1





Sample Output 3

2
2
1
1
0





Sample Input 4

10 10
10 10
9 20
8 30
7 40
6 50
5 60
4 70
3 80
2 90
1 100





Sample Output 4

223
123
77
50
33
21
12
7
3
1



				Writer: E869120 

",Sushi,"Binary Indexed Tree, Bit Set, Greedy Algorithm, Difference Array, Arithmetic, Data Structure",1.0,1,1
1297,"


					Max Score: $1500$ Points 

Problem Statement
						There is a $50 \times 50$ field. The cell at $i$-th row and $j$-th column is denoted $(i, j)$ (0-indexed). 
						One day, square1001 puts $250$ bombs in this field. In each cell, there is 1 or 0 bomb. 
						You want to know where the bombs are by asking some questions. 




						You can ask this question many times. 

You can ask the number of bombs in the rectangular area in which upper-left cell is $(a, b)$ and lower-right cell is $(c, d)$.


						Please find all bombs' positions asking as few questions as possible. 

						Note: This problem Input/Output type is special. Please read Input/Output. If you want to use scanf/printf, you have to write fflush(stdout).






Input and output
							The first line input is following this format:
$H \ W \ N \ K$


$H, W$ is field size. In this problem, $H = 50$ and $W = 50$.
$N$ is the number of bombs in the field. In this problem, $N = 250$.
$K$ is modulo. This integer uses to answer the state of the field.


							After this input, You can ask some questions, following this output format: 
$? \ a \ b \ c \ d$

							It means that you want to ask the number of bombs in the rectangular area which upper-left cell is $(a, b)$ and lower-right cell is $(c, d)$.

							You can know the value of the question, from input in this format:
$p$

							$p$ is the result of your question. 

							Finally, you have to output the answer following this format:
$! \ ans$

							The value of $ans$ is $\sum_{i=0}^{H-1} \sum_{j=0}^{W-1} r_{i, j} 2^{iW + j}$ mod $K$.
							Note: $r_{i, j}$ is the number of bombs in cell $(i, j)$.




Constraints

$H, W = 50$
$N = 250$
$1,000,000,000 \le K \le 1,000,010,000$ ($K$ is random)



Score
							There are 5 testcases in the judge. 
							The $score$ in each testcase is defined by following formula: 

$Q$ is the number of questions.
If $Q > 2500$, $score = 0$ (Wrong Answer).
If $930 \le Q \le 2500$, $score = max(\lfloor 125 - 3.2\sqrt{Q - 920} \rfloor, 40)$.
If $880 \le Q < 930$, $score = \lfloor 288 - 22\sqrt{Q - 870} \rfloor$.
If $Q < 880$, $score = min(2860 - 3Q, 300)$.






Sample Input・Output
						In the case of the following arrangement, this input / output is conceivable.
						This case is $H,W=4$, so this example is not include in testcases.

H=4, W=4, N=4
1001
0000
0010
0100

						Example of Input・Output


Input from program
Output


4 4 4 1000000007
 


 
? 0 0 0 1


1
 


 
? 0 1 0 2


0
 


 
? 0 3 1 3


1
 


 
? 2 1 3 2


2
 


 
? 2 2 2 2


1
 


 
! 9225


						These question is not always meaningful. 


				Writer: E869120

",Bombs Searching Game,"Interactive, Divide And Conquer, Bitmask, Arithmetic, Numerical Analysis, Array, Boolean Operations On Geometric Objects",0.0,13,8
1298,"
Score : 1400 points


Problem StatementConsider the following set of rules for encoding strings consisting of 0 and 1:

Strings 0 and 1 can be encoded as 0 and 1, respectively. 
If strings A and B can be encoded as P and Q, respectively, then string AB can be encoded as PQ.
If string A can be encoded as P and K \geq 2 is a positive integer, then string AA...A (A repeated K times) can be encoded as (PxK).

For example, string 001001001, among other possibilities, can be encoded as 001001001, 00(1(0x2)x2)1 and (001x3).
Let's call string A a subset of string B if:

A and B are equal in length and consist of 0 and 1;
for all indices i such that A_i = 1, it's also true that B_i = 1.

You are given string S consisting of 0 and 1. Find the total number of distinct encodings of all subsets of S, modulo 998244353.




Constraints
1 \leq |S| \leq 100
S consists of 0 and 1.







InputInput is given from Standard Input in the following format:
S





OutputPrint the total number of distinct encodings of all subsets of S modulo 998244353.






Sample Input 1011





Sample Output 19

There are four subsets of S:

011 can be encoded as 011 and 0(1x2);
010 can be encoded as 010;
001 can be encoded as 001 and (0x2)1;
000 can be encoded as 000, 0(0x2), (0x2)0 and (0x3).

Thus, the total number of encodings of all subsets of S is 2 + 1 + 2 + 4 = 9.





Sample Input 20000





Sample Output 210

This time S has only one subset, but it can be encoded in 10 different ways.





Sample Input 3101110





Sample Output 3156






Sample Input 4001110111010110001100000100111





Sample Output 4363383189

Don't forget to take the result modulo 998244353.

",Encoding Subsets,"Memoization, String, Arithmetic, Combinatorics, Machine Learning",0.0,2,1
1299,"
Score : 700 points


Problem StatementIn the final of CODE FESTIVAL in some year, there are N participants.
The height and power of Participant i is H_i and P_i, respectively.
Ringo is hosting a game of stacking zabuton (cushions).
The participants will line up in a row in some order, and they will in turn try to add zabuton to the stack of zabuton.
Initially, the stack is empty.
When it is Participant i's turn, if there are H_i or less zabuton already stacked, he/she will add exactly P_i zabuton to the stack. Otherwise, he/she will give up and do nothing.
Ringo wants to maximize the number of participants who can add zabuton to the stack.
How many participants can add zabuton to the stack in the optimal order of participants?




Constraints
1 \leq N \leq 5000
0 \leq H_i \leq 10^9
1 \leq P_i \leq 10^9







InputInput is given from Standard Input in the following format:
N
H_1 P_1
H_2 P_2
:
H_N P_N





OutputPrint the maximum number of participants who can add zabuton to the stack.






Sample Input 13
0 2
1 3
3 4





Sample Output 12

When the participants line up in the same order as the input, Participants 1 and 3 will be able to add zabuton.
On the other hand, there is no order such that all three participants can add zabuton. Thus, the answer is 2.





Sample Input 23
2 4
3 1
4 1





Sample Output 23

When the participants line up in the order 2, 3, 1, all of them will be able to add zabuton.





Sample Input 310
1 3
8 4
8 3
9 1
6 4
2 3
4 2
9 2
8 3
0 1





Sample Output 35


",Zabuton,"Sorting, Dyanmic Programming, Dynamic Programming, Heuristics, Array",0.333,9,2
1300,"
Score : 1500 points


Problem StatementIroha has a sequence of N strings s_1, s_2, ..., s_N.
She will choose some (possibly all) strings from the sequence, then concatenate those strings retaining the relative order, to produce a long string.
Among all strings of length K that she can produce in this way, find the lexicographically smallest one.




Constraints
1 ≦ N ≦ 2000
1 ≦ K ≦ 10^4
For each i, 1 ≦ |s_i| ≦ K.
|s_1| + |s_2| + ... + |s_N| ≦ 10^6
For each i, s_i consists of lowercase letters.
There exists at least one string of length K that Iroha can produce.







InputThe input is given from Standard Input in the following format:
N K
s_1
s_2
:
s_N





OutputPrint the lexicographically smallest string of length K that Iroha can produce.






Sample Input 13 7
at
coder
codar





Sample Output 1atcodar

at and codar should be chosen.





Sample Input 23 7
coder
codar
at





Sample Output 2codarat

codar and at should be chosen.





Sample Input 34 13
kyuri
namida
zzzzzzz
aaaaaa





Sample Output 3namidazzzzzzz

namida and zzzzzzz should be chosen.

",Iroha Loves Strings,"Dyanmic Programming, String, Dynamic Programming, Memoization",0.0,4,0
1301,"
Score : 800 points


Problem StatementThere are N lines in the xy-plane. The i-th line is represented by A_ix+B_iy=C_i.
Any two lines among the N+2 lines, the above N lines plus the x-axis and y-axis, cross each other at exactly one point.
For each pair 1 \leq i < j \leq N, there is a car at the cross point of the i-th and j-th lines.
Even where three or more lines intersect at a point, a car is individually placed for each pair of lines.
That is, there will be k(k-1)/2 cars placed at the intersection of k lines.
Those cars are already very old, and can only be moved parallel to the x-axis or y-axis.
Takahashi will hold an exhibition of antique cars at a place on the xy-plane.
In order to avoid damaging the half-broken cars too much, he will select the place of the exhibition so that the total distance covered will be minimized when all the cars are moved to the place.
If such a place is not uniquely determined, among the places that satisfy the condition above, the place with the minimum x-coordinate will be selected.
If the place is still not uniquely determined, among the places that satisfy the two conditions above, the place with the minimum y-coordinate will be selected.
Find the place of the exhibition that will be selected.




Constraints
2 \leq N \leq 4 × 10^4
1 \leq |A_i|,|B_i| \leq 10^4(1 \leq i \leq N)
0 \leq |C_i| \leq 10^4(1 \leq i \leq N)
No two given lines are parallel.
All input values are integers.







InputsInput is given from Standard Input in the following format:
N
A_1 B_1 C_1
:
A_N B_N C_N





OutputsPrint the x-coordinate and y-coordinate of the place of the exhibition that will be selected, in this order, with a space in between. The output will be judged as correct when the absolute or relative error is at most 10^{-9}.






Sample Input 13
1 1 1
2 -1 2
-1 2 2





Sample Output 11.000000000000000 1.000000000000000


There is a car at each place shown by a blue circle in the figure. The place to be selected is shown by a purple circle.





Sample Input 24
1 1 2
1 -1 0
3 -1 -2
1 -3 4





Sample Output 2-1.000000000000000 -1.000000000000000






Sample Input 37
1 7 8
-2 4 9
3 -8 -5
9 2 -14
6 7 5
-8 -9 3
3 8 10





Sample Output 3-1.722222222222222 1.325000000000000


",CARtesian Coodinate,"Geometry; 3d, Combinatorics, Mathematics, Sorting",0.0,1,0
1302,"
Score : 1500 points


Problem StatementWe have a grid with 3 rows and N columns.
The cell at the i-th row and j-th column is denoted (i, j).
Initially, each cell (i, j) contains the integer i+3j-3.


A grid with N=5 columns

Snuke can perform the following operation any number of times:

Choose a 3×3 subrectangle of the grid. The placement of integers within the subrectangle is now rotated by 180°.



An example sequence of operations (each chosen subrectangle is colored blue)

Snuke's objective is to manipulate the grid so that each cell (i, j) contains the integer a_{i,j}.
Determine whether it is achievable.




Constraints
5≤N≤10^5
1≤a_{i,j}≤3N
All a_{i,j} are distinct.







InputThe input is given from Standard Input in the following format:
N
a_{1,1} a_{1,2} ... a_{1,N}
a_{2,1} a_{2,2} ... a_{2,N}
a_{3,1} a_{3,2} ... a_{3,N}





OutputIf Snuke's objective is achievable, print Yes. Otherwise, print No.






Sample Input 15
9 6 15 12 1
8 5 14 11 2
7 4 13 10 3





Sample Output 1Yes

This case corresponds to the figure in the problem statement.





Sample Input 25
1 2 3 4 5
6 7 8 9 10
11 12 13 14 15





Sample Output 2No






Sample Input 35
1 4 7 10 13
2 5 8 11 14
3 6 9 12 15





Sample Output 3Yes

The objective is already achieved with the initial placement of the integers.





Sample Input 46
15 10 3 4 9 16
14 11 2 5 8 17
13 12 1 6 7 18





Sample Output 4Yes






Sample Input 57
21 12 1 16 13 6 7
20 11 2 17 14 5 8
19 10 3 18 15 4 9





Sample Output 5No


",Rotate 3x3,"Permutation Cycle Decomposition, Mathematics",0.0,1,0
1303,"
Score : 1600 points


Problem StatementThere are A slimes lining up in a row.
Initially, the sizes of the slimes are all 1.
Snuke can repeatedly perform the following operation.

Choose a positive even number M. Then, select M consecutive slimes and form M / 2 pairs from those slimes as follows: pair the 1-st and 2-nd of them from the left, the 3-rd and 4-th of them, ..., the (M-1)-th and M-th of them. Combine each pair of slimes into one larger slime. Here, the size of a combined slime is the sum of the individual slimes before combination. The order of the M / 2 combined slimes remain the same as the M / 2 pairs of slimes before combination.

Snuke wants to get to the situation where there are exactly N slimes, and the size of the i-th (1 ≤ i ≤ N) slime from the left is a_i.
Find the minimum number of operations required to achieve his goal.
Note that A is not directly given as input. Assume A = a_1 + a_2 + ... + a_N.




Constraints
1 ≤ N ≤ 10^5
a_i is an integer.
1 ≤ a_i ≤ 10^9







InputInput is given from Standard Input in the following format:
N
a_1 a_2 ... a_N





OutputPrint the minimum number of operations required to achieve Snuke's goal.






Sample Input 12
3 3





Sample Output 12

One way to achieve Snuke's goal is as follows.
Here, the selected slimes are marked in bold.

(1, 1, 1, 1, 1, 1) → (1, 2, 2, 1)
(1, 2, 2, 1) → (3, 3)






Sample Input 24
2 1 2 2





Sample Output 22

One way to achieve Snuke's goal is as follows.

(1, 1, 1, 1, 1, 1, 1) → (2, 1, 1, 1, 1, 1)
(2, 1, 1, 1, 1, 1) → (2, 1, 2, 2)






Sample Input 31
1





Sample Output 30






Sample Input 410
3 1 4 1 5 9 2 6 5 3





Sample Output 410


",Squeezing Slimes,Greedy Algorithm,0.0,1,0
